function initializeAnalytics(){(function(n,t,i){function u(){i.ajax({type:"POST",url:epmLive.currentWebFullUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'LoadFavoriteStatus', Dataxml: '"+n.favoritesData+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(r){if(r.d){var f=t.parseJson(r.d),u=f.Result;t.responseIsSuccess(u)&&u["#text"]==="false"?t.currentItemID!="-1"&&t.currentFileIsNull=="True"||i("#favoritesStar").fadeIn(1e3):t.responseIsSuccess(u)&&u["#text"]==="true"&&(t.currentItemID!="-1"&&t.currentFileIsNull=="True"?i('a[id="Ribbon.ListItem.EPMLive.FavoriteStatus-Large"]').find("img").fadeOut(function(){i(this).load(function(){i(this).fadeIn()}),i(this).attr("src","_layouts/epmlive/images/star-filled32.png")}):(i("#favoritesStar").addClass("icon-star-active"),i("#favoritesStar").fadeIn(1e3))),i("#favoritesStar").click(function(){var r,u,f;if(i(this).hasClass("icon-star-active"))n.removePageFav();else{r=document.createElement("div"),r.innerHTML=document.getElementById("fav_Add_DivTemp").innerHTML,u={html:r,height:90,width:250,title:"Add Favorite",dialogReturnValueCallback:function(t,i){t===1&&n.addPageFav(i)}},SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",u),f=setInterval(function(){e()},200);function e(){i(".ms-dlgFrameContainer").find("#favTitle").length>0&&!i(".ms-dlgFrameContainer").find("#favTitle").is(":focus")&&(t.currentListTitle&&t.currentListViewTitle?i(".ms-dlgFrameContainer").find("#favTitle").focus().val(t.currentListTitle+"-"+t.currentListViewTitle):i(".ms-dlgFrameContainer").find("#favTitle").focus().val(t.currentFileTitle),clearInterval(f))}}})}},error:function(){}})}function f(){var f="",r,u,e;i.cookie("FrequentApp_CurrentList")&&(f=i.cookie("FrequentApp_CurrentList")),r=t.currentListTitle,t.currentListViewUrl&&r&&f!=r&&(u=new Date,e=30,u.setTime(u.getTime()+e*6e4),i.cookie("FrequentApp_CurrentList",r,{expires:u,path:"/"}),i.ajax({type:"POST",url:epmLive.currentWebFullUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'CreateFrequentApp', Dataxml: '"+n.frequentData+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){n.d},error:function(n){alert(n)}}))}function o(){t.currentListViewUrl||t.currentItemID=="-1"||t.currentFileIsNull!="True"||t.currentItemTitle.trim()=="New Item"||i.ajax({type:"POST",url:epmLive.currentWebFullUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'CreateRecentItem', Dataxml: '"+e+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){n.d},error:function(n){alert(n)}})}function r(n){var t=n,u;if(n.indexOf("Source")!=-1){var i="",f=n.split("?"),r=f[1].split("&");for(u in r)if(r[u].split("=")[0].toLowerCase()==="source"){i=r;break}i&&(t=t.replace(i,""))}return t}n.favoritesData='<Data><Param key="SiteId">'+t.currentSiteId+'<\/Param><Param key="WebId">'+t.currentWebId+'<\/Param><Param key="ListId">'+t.currentListId+'<\/Param><Param key="ListIconClass">'+t.currentListIcon+'<\/Param><Param key="ListView">'+t.currentListViewUrl+'<\/Param><Param key="ItemId">'+t.currentItemID+'<\/Param><Param key="FileIsNull">'+t.currentFileIsNull+'<\/Param><Param key="FString">'+t.currentUrl+'<\/Param><Param key="Type">1<\/Param><Param key="UserId">'+t.currentUserId+'<\/Param><Param key="PageTitle">'+t.pageName+"<\/Param><\/Data>",n.addPageFav=function(n){i.ajax({type:"POST",url:epmLive.currentWebFullUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'AddFavorites', Dataxml: '<Data><Param key=\"SiteId\">"+t.currentSiteId+'<\/Param><Param key="WebId">'+t.currentWebId+'<\/Param><Param key="ListId">'+t.currentListId+'<\/Param><Param key="ListViewUrl">'+t.currentListViewUrl+'<\/Param><Param key="ListIconClass">icon-file-5<\/Param><Param key="ItemId">'+t.currentItemID+'<\/Param><Param key="FString">'+t.currentUrl+'<\/Param><Param key="UserId">'+t.currentUserId+'<\/Param><Param key="Title">'+n+'<\/Param><Param key="FileIsNull">'+t.currentFileIsNull+"<\/Param><\/Data>' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){var u,r,t,f;n.d&&(u=epmLive.parseJson(n.d),r=u.Result,epmLive.responseIsSuccess(r)&&r["#text"]&&(i("#favoritesStar").addClass("icon-star-active"),toastr.options={closeButton:!1,debug:!1,positionClass:"toast-top-right",onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.success("A new item has been added to your favorites list."),t=r["#text"].split(","),f=0,window.epmLiveNavigation.registerLink({kind:f,id:t[0],title:t[6],url:t[9],cssClass:t[7],siteId:t[1],webId:t[2],listId:t[3],itemId:t[4],external:!1})))},error:function(){}})},n.addItemFav=function(n){i.ajax({type:"POST",url:epmLive.currentWebFullUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'AddFavorites', Dataxml: '<Data><Param key=\"SiteId\">"+epmLive.currentSiteId+'<\/Param><Param key="WebId">'+epmLive.currentWebId+'<\/Param><Param key="ListId">'+epmLive.currentListId+'<\/Param><Param key="ListViewUrl">'+epmLive.currentListViewUrl+'<\/Param><Param key="ListIconClass">'+epmLive.currentListIcon+'<\/Param><Param key="ItemId">'+epmLive.currentItemID+'<\/Param><Param key="FString">'+epmLive.currentUrl+'<\/Param><Param key="UserId">'+epmLive.currentUserId+'<\/Param><Param key="Title">'+n+'<\/Param><Param key="FileIsNull">'+epmLive.currentFileIsNull+"<\/Param><\/Data>' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){var u,r,t,f;n.d&&(u=epmLive.parseJson(n.d),r=u.Result,epmLive.responseIsSuccess(r)&&r["#text"]&&(i('a[id="Ribbon.ListItem.EPMLive.FavoriteStatus-Large"]').find("img").attr("src")==="_layouts/epmlive/images/star32.png"&&i('a[id="Ribbon.ListItem.EPMLive.FavoriteStatus-Large"]').find("img").fadeOut(function(){i(this).load(function(){i(this).fadeIn()}),i(this).attr("src","_layouts/epmlive/images/star-filled32.png")}),toastr.options={closeButton:!1,debug:!1,positionClass:"toast-top-right",onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.success("A new item has been added to your favorites list."),t=r["#text"].split(","),f=1,window.epmLiveNavigation.registerLink({kind:f,id:t[0],title:t[6],url:t[9],cssClass:t[7],siteId:t[1],webId:t[2],listId:t[3],itemId:t[4],external:!1})))},error:function(){}})},n.addItemFavFromGrid=function(n,t){i.ajax({type:"POST",url:epmLive.currentWebFullUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'AddFavorites', Dataxml: '<Data><Param key=\"SiteId\">"+epmLive.currentSiteId+'<\/Param><Param key="WebId">'+epmLive.currentWebId+'<\/Param><Param key="ListId">'+epmLive.currentListId+'<\/Param><Param key="ListIconClass">'+epmLive.currentListIcon+'<\/Param><Param key="ItemId">'+t+'<\/Param><Param key="UserId">'+epmLive.currentUserId+'<\/Param><Param key="Title">'+n+'<\/Param><Param key="FileIsNull">'+epmLive.currentFileIsNull+"<\/Param><\/Data>' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){var r,i,t,u;n.d&&(r=epmLive.parseJson(n.d),i=r.Result,epmLive.responseIsSuccess(i)&&i["#text"]&&(toastr.options={closeButton:!1,debug:!1,positionClass:"toast-top-right",onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.success("A new item has been added to your favorites list."),t=i["#text"].split(","),u=1,window.epmLiveNavigation.registerLink({kind:u,id:t[0],title:t[6],url:t[9],cssClass:t[7],siteId:t[1],webId:t[2],listId:t[3],itemId:t[4],external:!1})))},error:function(){}})},n.removePageFav=function(){i.ajax({type:"POST",url:epmLive.currentWebFullUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'RemoveFavorites', Dataxml: '"+n.favoritesData+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){var r,t,u;n.d&&(r=epmLive.parseJson(n.d),t=r.Result,epmLive.responseIsSuccess(t)&&t["#text"]&&(i("#favoritesStar").removeClass("icon-star-active"),toastr.options={closeButton:!1,debug:!1,positionClass:"toast-top-right",onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.success("An existing item has been removed from your favorites list."),u=t["#text"].split(","),window.epmLiveNavigation.removeLink({kind:0,id:u[0]})))},error:function(){}})},n.removeItemFav=function(){i.ajax({type:"POST",url:epmLive.currentWebFullUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'RemoveFavorites', Dataxml: '"+n.favoritesData+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){var r,t,u;n.d&&(r=epmLive.parseJson(n.d),t=r.Result,epmLive.responseIsSuccess(t)&&t["#text"]&&(i('a[id="Ribbon.ListItem.EPMLive.FavoriteStatus-Large"]').find("img").attr("src")==="_layouts/epmlive/images/star-filled32.png"&&i('a[id="Ribbon.ListItem.EPMLive.FavoriteStatus-Large"]').find("img").fadeOut(function(){i(this).load(function(){i(this).fadeIn()}),i(this).attr("src","_layouts/epmlive/images/star32.png")}),toastr.options={closeButton:!1,debug:!1,positionClass:"toast-top-right",onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.success("An existing item has been removed from your favorites list."),u=t["#text"].split(","),window.epmLiveNavigation.removeLink({kind:0,id:u[0]})))},error:function(){}})},n.removeItemFavFromGrid=function(n){i.ajax({type:"POST",url:epmLive.currentWebFullUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'RemoveFavorites', Dataxml: '<Data><Param key=\"SiteId\">"+epmLive.currentSiteId+'<\/Param><Param key="WebId">'+epmLive.currentWebId+'<\/Param><Param key="ListId">'+epmLive.currentListId+'<\/Param><Param key="ListViewUrl"><\/Param><Param key="ListIconClass">'+epmLive.currentListIcon+'<\/Param><Param key="ItemId">'+n+'<\/Param><Param key="UserId">'+epmLive.currentUserId+'<\/Param><Param key="Title">'+epmLive.currentListTitle+'<\/Param><Param key="FileIsNull">'+epmLive.currentFileIsNull+"<\/Param><\/Data>' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){var i,t,r;n.d&&(i=epmLive.parseJson(n.d),t=i.Result,epmLive.responseIsSuccess(t)&&t["#text"]&&(toastr.options={closeButton:!1,debug:!1,positionClass:"toast-top-right",onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.success("An existing item has been removed from your favorites list."),r=t["#text"].split(","),window.epmLiveNavigation.removeLink({kind:0,id:r[0]})))},error:function(){}})},u(),n.frequentData='<Data><Param key="SiteId">'+t.currentSiteId+'<\/Param><Param key="WebId">'+t.currentWebId+'<\/Param><Param key="ListId">'+t.currentListId+'<\/Param><Param key="ListIconClass">'+t.currentListIcon+'<\/Param><Param key="Title">'+t.currentListTitle+'<\/Param><Param key="Type">3<\/Param><Param key="UserId">'+t.currentUserId+"<\/Param><\/Data>",f();var e='<Data><Param key="SiteId">'+t.currentSiteId+'<\/Param><Param key="WebId">'+t.currentWebId+'<\/Param><Param key="ListId">'+t.currentListId+'<\/Param><Param key="ItemId">'+t.currentItemID+'<\/Param><Param key="ListIconClass">'+t.currentListIcon+'<\/Param><Param key="Title">'+t.currentItemTitle+'<\/Param><Param key="Type">2<\/Param><Param key="UserId">'+t.currentUserId+"<\/Param><\/Data>";o(),n.turnOnFav=function(){i("#favoritesStar").hasClass("icon-star-active")||i("#favoritesStar").addClass("icon-star-active")},n.turnOffFav=function(n){n.itemid===""&&r(n.url)==r(t.currentUrl)&&i("#favoritesStar").hasClass("icon-star-active")&&i("#favoritesStar").removeClass("icon-star-active")},n.getAddFavDynamicValue=function(n){return i(i(n).parent().parent().find("#favTitle").get(0)).val()},n.getAddFavItemFromGridDynamicValue=function(n){return i(i(n).parent().parent().find("#favItemTitle").get(0)).val()}})(window.Analytics=window.Analytics||{},window.epmLive,window.jQuery)}ExecuteOrDelayUntilScriptLoaded(initializeAnalytics,"EPMLive.js");
//@ sourceMappingURL=EPMLive.Analytics.min.js.map