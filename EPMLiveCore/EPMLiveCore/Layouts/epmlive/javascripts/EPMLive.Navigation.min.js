(function(){"use strict";function n(){$(function(){var n=window.jQuery,t=function(){var t=function(){return window.epmLiveNavigation.currentWebUrl},i=function(xml){return eval("("+window.xml2json(n.parseXML(xml),"")+")")},r=function(n){return n["@Status"]==0};return{currentWebUrl:t,parseJson:i,responseIsSuccess:r}}(),e=function(){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t=function(t){var i="",o,s,h="",c,f,r,e="",u=0;/[^A-Za-z0-9\+\/\=]/g.exec(t)&&console.log('There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, "+", "/",and "="\nExpect errors in decoding.');t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do c=n.indexOf(t.charAt(u++)),f=n.indexOf(t.charAt(u++)),r=n.indexOf(t.charAt(u++)),e=n.indexOf(t.charAt(u++)),o=c<<2|f>>4,s=(f&15)<<4|r>>2,h=(r&3)<<6|e,i=i+String.fromCharCode(o),r!=64&&(i=i+String.fromCharCode(s)),e!=64&&(i=i+String.fromCharCode(h)),o=s=h="",c=f=r=e="";while(u<t.length);return unescape(i)};return{decode:t}}(),i=function(){var i=function(r,u,f,e){var o=t.currentWebUrl();o?n.ajax({type:"POST",url:(o+"/_vti_bin/WorkEngine.asmx/Execute").replace(/\/\//g,"/"),data:"{ Function: '"+r+"', Dataxml: '"+u+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){if(n.d){var r=t.parseJson(n.d),i=r.Result;t.responseIsSuccess(i)?f(i):e(n)}else e(n)},error:function(n){e(n)}}):window.setTimeout(function(){i(r,u,f,e)},1)};return{execute:i}}(),u=n.cookie,f,r;n.cookie=function(n,t,i){if(n=n+"-u-"+window.epmLiveNavigation.currentUserId,u){if(!t)return u(n);u(n,t,i)}};f=function(){function rt(){for(var t,n=0;n<u.length;n++)if(t=u[n],t.selected()){t.closeNav();break}}function p(t,i){var e=["s4-ribbonrow","s4-workspace"],o,u,f;for(o in e)e.hasOwnProperty(o)&&(u=n("#"+e[o]),u.removeClass("epm-nav-pinned"),u.removeClass("epm-nav-unpinned"),u.addClass("epm-nav-"+t));f=n("#epm-nav-pin");f.removeClass("epm-nav-pin-pinned");f.removeClass("epm-nav-pin-unpinned");f.addClass("epm-nav-pin-"+t);t==="unpinned"&&rt();r.data("pinstate",t);i&&n.cookie(y,t,c)}function st(){var r="epm-nav-top-ql",i;try{i=n.parseJSON(n.cookie(it));i.webUrl===t.currentWebUrl()&&(r=i.id)}catch(u){}return r.replace("epm-nav-top-","epm-nav-sub-")}function l(t){return n("#"+t).find(".epm-nav-sub-menu").find("div[id^=E]")}function ht(){var t=!1,i=n.parseJSON(n.cookie(v)),s,h,e,p,c,w,a,u,o,y;if(i)if(i.id)s=n(r.find("#"+i.id).get(0)),s.length>0&&(h=s.parent(),e=h.parent().get(0).id,e!=="epm-nav-sub-favorites-static-links"&&e!=="epm-nav-sub-recent-static-links"&&e!=="epm-nav-sub-new-static-links"&&(h.addClass(f),t=!0));else if(p=i.index,c=i.uri,window.location.href.indexOf(c)!==-1)for(w=n("#"+st()),a=l(w.parent().attr("id")),u=0;u<a.length;u++)if(u===p){n(a[u]).find('a[href="'+c+'"]:first').parents("table").addClass(f);t=!0;break}o=escape(unescape(window.location.href)).toLowerCase();t&&(y=n(".epm-nav-node-selected"),y.find("a").each(function(){var n=escape(unescape(this.href)).toLowerCase();o.indexOf(n)===-1&&(y.removeClass(f),t=!1)}));t||(n("td.epm-nav-node").each(function(){t||n(this).find("a").each(function(){if(!t){var i=n(this),r=escape(unescape(i.get(0).href)).toLowerCase();o.indexOf(r)!==-1&&(i.parents("table").addClass(f),t=!0)}})}),t||n("#epm-nav-sub-workplace").find("a").each(function(){if(!t){var i=n(this),r=escape(unescape(i.get(0).href)).toLowerCase();o.indexOf(r)!==-1&&(i.parents("li").addClass(f),t=!0)}}))}function ct(t){var i={};t.find(".epm-nav-cat").each(function(){var t=n(this);i[t.text()]=n(t.find("span")[0]).hasClass(o)});ut(t.get(0).id,i)}function ut(t,i){var r=n.parseJSON(n.cookie(h))||{};r[t]=i;n.cookie(h,JSON.stringify(r),c)}function w(t){var p=n.parseJSON(n.cookie(h)),i,r,s,f,c,e,a,v,y;if(p){if(i="epm-nav-sub-ql",t)for(r=0;r<u.length;r++)if(s=u[r],s.provider===t){i=s.id.replace("epm-nav-top-","epm-nav-sub-");break}if(f=p[i],f)if(i==="epm-nav-sub-ql")for(c=l("epm-nav-sub-ql"),e=0;e<c.length;e++)a=c[e],v=a.id.replace("Nodes",""),f[n("#"+v.replace("EPMLiveNavn","EPMLiveNavt")).text()]||TreeView_ToggleNode(window.EPMLiveNav_Data,0,document.getElementById(v)," ",document.getElementById(a.id));else y=n("#"+i).find(".epm-nav-cat"),i==="epm-nav-sub-settings"&&y.each(function(){b(n(this))}),y.each(function(){var t=n(this),r=t.text(),i=f[r];n(t.find("span")[0]).hasClass(o)?i||b(t):i&&ft(t)})}}function ft(t){var u=t.get(0).id,i=n(t.find("span")[0]),r=n("#"+u+"-links");i.removeClass(s);i.addClass(o);r.removeClass(s);r.addClass(o)}function b(t){var u=t.get(0).id,i=n(t.find("span")[0]),r=n("#"+u+"-links");i.removeClass(o);i.addClass(s);r.removeClass(o);r.addClass(s)}function lt(){var t=function(){n("li.epm-nav-node").find("a").each(function(){var t,i,r;if(window.epmLiveNavigation.stopAddingTooltips)return window.epmLiveNavigation.stopAddingTooltips=!1,!1;t=n(this);t.attr("title")||(i=t.find("span"),i&&(n.browser.msie?(r=t.clone().css({display:"inline",width:"auto",visibility:"hidden"}).appendTo("body"),r.width()+i.offset().left+15>t.width()&&t.attr("title",i.text()),r.remove()):t.width()<i.width()&&t.attr("title",i.text())))})};n(".epm-nav-cat").click(function(){var t=n(this),i=n(t.find("span")[0]);i.hasClass(s)?ft(t):b(t);ct(t.parent())});n("#epm-nav-top li").click(function(){window.epmLiveNavigation.stopAddingTooltips=!0;window.setTimeout(function(){t()},1e3)});t()}function at(id,webId,listId,itemId,command,kind,callBackFunction){var removeLink=function(t,r){var u=function(t,i){var u=n("#"+t),r=u.parent();u.fadeOut(300,function(){var t,f,e,o;if(u.remove(),t=r.get(0).id,t==="epm-nav-sub-workspaces-static-links")r.find("a").length===1&&(f=!1,r.find("li").each(function(){n(this).text()==="No favorite workspaces"&&(f=!0)}),f||n('<li class="epm-nav-sub-placeholder">No favorite workspaces<\/li>').insertAfter(n(r.find(".epm-nav-sub-header-bottom").get(1))));else if(t==="epm-nav-sub-favorites-static-links"){var s=!1,h=!1,c=0;r.find("li").each(function(){var t=n(this);t.text()==="Items"&&(c=t.index())});r.find("li").each(function(){var t=n(this);t.hasClass("epm-nav-node")&&(t.index()>c?s=!0:h=!0)});h||(e=!1,r.find("li").each(function(){n(this).text()==="No pages"&&(e=!0)}),e||n('<li class="epm-nav-sub-placeholder">No pages<\/li>').insertAfter(n(r.find(".epm-nav-sub-header-bottom").get(1))));s||(o=!1,r.find("li").each(function(){n(this).text()==="No items"&&(o=!0)}),o||(r.get(0).innerHTML+='<li class="epm-nav-sub-placeholder">No items<\/li>'))}i&&(i==="RI"?(toastr.options={closeButton:!1,debug:!1,positionClass:"toast-top-right",onclick:null,showDuration:300,hideDuration:1e3,timeOut:5e3,extendedTimeOut:1e3,showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.success("An existing item has been removed from your favorites list.")):SP.UI.Notify.removeNotification(i))})};i.execute("RemoveNavigationLink",t,function(){u(t,r)},function(){u(t,r)})},url=window.epmLiveNavigation.currentWebUrl,gaUrl=(url+"/_layouts/15/epmlive/gridaction.aspx?webid="+webId+"&listid="+listId+"&id="+itemId+"&").replace(/\/\//g,"/"),rpUrl=(url+"/_layouts/15/epmlive/redirectionproxy.aspx?webid="+webId+"&listid="+listId+"&id="+itemId+"&").replace(/\/\//g,"/"),redirectUrl="",info,loadWSCreationDialog,isResImportRunning,isSecRunning,idInfo,fKind,$a,notify,nId,options;switch(command){case"nav:add":redirectUrl=rpUrl+"action=new";break;case"nav:team":var wId="",lId="",iId="";if(itemId!=="undefined")try{info=window.epmLiveNavigation.wsTeamDict[webId].split(".");info[2]!=="-1"&&(wId=info[0],lId=info[1],iId=info[2])}catch(e){}redirectUrl=(url+"/_layouts/15/epmlive/gridaction.aspx?").replace(/\/\//g,"/")+"action=buildteam&webid="+(wId||webId);iId&&(redirectUrl=redirectUrl+"&listid="+lId+"&id="+iId)}if(!redirectUrl&&command)if(command.indexOf("epkcommand:")!==-1)redirectUrl=gaUrl+"action=epkcommand&subaction="+command.split(":")[1];else{if(command==="createworkspace"){loadWSCreationDialog=function(){window.CreateEPMLiveWorkspace?window.CreateEPMLiveWorkspace(listId,itemId):window.setTimeout(function(){loadWSCreationDialog()},1)};loadWSCreationDialog();return}redirectUrl=gaUrl+"action="+command}if(redirectUrl&&(redirectUrl=redirectUrl.split("#")[0]),command==="view"||command==="edit"||command==="gotoplanner"||command==="GoToTaskPlanner"){var page="",wUrl=t.currentWebUrl(),urlParts=window.location.href.split("?");page=wUrl==="/"?urlParts[0]:wUrl+urlParts[0].split(escape(wUrl))[1];page=escape(page);redirectUrl+="&source="+page}switch(kind+""){case"-1":return command=="delete"?confirm("Are you sure you want to send the item(s) to the Recycle Bin?")&&(nId=SP.UI.Notify.addNotification("Deleting Item...",!0,"",null),n.get(redirectUrl).always(function(){SP.UI.Notify.removeNotification(nId);callBackFunction!=""&&eval(callBackFunction+"("+id+")")})):(options={url:redirectUrl,showMaximized:!1,dialogReturnValueCallback:function(n){n==1&&KanbanClient.loadKanBanPlanners()}},SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",options)),!0;case"0":return OpenCreateWebPageDialog(redirectUrl),!0;case"1":return window.location.href.toLowerCase().toString().indexOf("isdlg")>-1?callBackFunction!=""?SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",{url:redirectUrl,width:650,height:700,dialogReturnValueCallback:eval(callBackFunction)}):SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",{url:redirectUrl,width:650,height:700}):location.href=redirectUrl,!0;case"2":return window.open(redirectUrl+"&IsDlg=1","","height=100, width=200, toolbar=no, menubar=no, scrollbars=yes, resizable=yes,location=no, directories=no, status=yes"),!0;case"3":return window.open(redirectUrl+"&IsDlg=1","","width="+screen.width+",height="+screen.height+",top=0,left=0, toolbar=no, menubar=no, scrollbars=yes, resizable=yes,location=no, directories=no, status=yes"),!0;case"5":return callBackFunction!=""?SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",{url:redirectUrl,width:700,height:500,dialogReturnValueCallback:eval(callBackFunction)}):SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",{url:redirectUrl,width:700,height:500}),!0;case"6":return isResImportRunning=!1,isSecRunning=!1,command=="epkcommand:rpeditor"?isResImportRunning=window.epmLiveNavigation.isImportResourceRunning():command=="buildteam"?isSecRunning=window.epmLiveNavigation.isSecurityJobRunning(window.epmLive.currentWebUrl,listId,itemId):command=="nav:team"&&window.epmLiveNavigation.wsTeamDict[webId]!=""&&(idInfo=window.epmLiveNavigation.wsTeamDict[webId].split("."),isSecRunning=window.epmLiveNavigation.isSecurityJobRunning(window.epmLive.currentWebUrl,idInfo[1],idInfo[2])),isResImportRunning||isSecRunning?(isResImportRunning?alert("The Resource Planner cannot be opened because there is an active resource import job running."):isSecRunning&&alert("The team cannot be edited because the security queue job has not completed. This should be completed in less than a minute or so - please try again."),!1):(callBackFunction!=""?SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",{url:redirectUrl,showMaximized:!0,dialogReturnValueCallback:eval(callBackFunction)}):SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",{url:redirectUrl,showMaximized:!0}),!0);case"98":if(command!=="nav:addToFav")command!=="nav:remove"&&command!=="nav:removeFavWS"&&command!=="nav:removeFavRI"?n.get(redirectUrl).always(function(){removeLink(id)}):(fKind=null,command==="nav:removeFavWS"?n("#epm-nav-sub-workspaces-static-links").find("a").each(function(){var t=n(this);t.data("webid")===webId&&(id=t.parent().get(0).id)}):command==="nav:removeFavRI"&&n("#epm-nav-sub-favorites-static-links").find("a").each(function(){var t=n(this);t.data("listid")===listId&&t.data("itemid")==itemId&&(id=t.parent().get(0).id,fKind="RI")}),removeLink(id,fKind),command==="nav:remove"&&($a=n("#"+id).find("a"),window.Analytics.turnOffFav({siteid:$a.data("siteid"),webid:$a.data("webid"),listid:$a.data("listid"),itemid:$a.data("itemid"),url:$a.get(0).href})));else{var $link=n(n("#"+id).find("a").get(0)),title=$link.text(),webUrl=$link.attr("href"),_$$=window.epmLive;listId=listId==="undefined"?null:listId;itemId=itemId==="undefined"?null:itemId;var isItem=itemId===null?"False":"True",riFav=!1,data='<Data><Param key="SiteId">'+_$$.currentSiteId+'<\/Param><Param key="WebId">'+webId+'<\/Param><Param key="ListId">'+listId+'<\/Param><Param key="ListViewUrl"><\/Param><Param key="ListIconClass"><\/Param><Param key="ItemId">'+itemId+'<\/Param><Param key="FString">'+webUrl+'<\/Param><Param key="Type">4<\/Param><Param key="UserId">'+_$$.currentUserId+'<\/Param><Param key="Title">'+title+'<\/Param><Param key="FileIsNull"><\/Param><Param key="IsItem">'+isItem+"<\/Param><\/Data>",methodName="AddFavoritesWs",linkKind=3,icon=null;if($link.parent().parent().get(0).id==="epm-nav-sub-recent-static-links"){methodName="AddFavorites";linkKind=1;try{icon=n($link.parent().find("span").get(0)).attr("class").split(" ")[1]}catch(e){}data='<Data><Param key="SiteId">'+_$$.currentSiteId+'<\/Param><Param key="WebId">'+webId+'<\/Param><Param key="ListId">'+listId+'<\/Param><Param key="ListViewUrl"><\/Param><Param key="ListIconClass">'+icon+'<\/Param><Param key="ItemId">'+itemId+'<\/Param><Param key="FString"><\/Param><Param key="Type">2<\/Param><Param key="UserId">'+_$$.currentUserId+'<\/Param><Param key="Title">'+title+'<\/Param><Param key="FileIsNull"><\/Param><Param key="IsItem">True<\/Param><\/Data>';riFav=!0}notify=function(){riFav&&(toastr.options={closeButton:!1,debug:!1,positionClass:"toast-top-right",onclick:null,showDuration:300,hideDuration:1e3,timeOut:5e3,extendedTimeOut:1e3,showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.success("A new item has been added to your favorites list."))};id=(new Date).getTime()+"";i.execute(methodName,data,function(){window.epmLiveNavigation.registerLink({id:id,title:title,url:webUrl,category:null,cssClass:icon,order:null,siteId:_$$.currentSiteId,webId:webId,listId:listId,itemId:itemId,external:!1,visible:!0,active:!0,seprator:!1,kind:linkKind});notify()},function(){window.epmLiveNavigation.registerLink({id:id,title:title,url:webUrl,category:null,cssClass:null,order:null,siteId:_$$.currentSiteId,webId:webId,listId:listId,itemId:itemId,external:!1,visible:!0,active:!0,seprator:!1,kind:linkKind});notify()})}break;case"99":confirm("Are you sure you want to send the item(s) to the Recycle Bin?")&&(nId=SP.UI.Notify.addNotification("Deleting Item...",!0,"",null),command!=="nav:remove"?n.get(redirectUrl,function(data){data=="General Error: You do not have permissions to delete users.\r\n"?(SP.UI.Notify.removeNotification(nId),SP.UI.Notify.addNotification("You do not have permission to delete Resources",!1,"",null)):data.startsWith("General Error:")?(SP.UI.Notify.removeNotification(nId),alert(data.replace("General Error: ",""))):(removeLink(id,nId),SP.UI.Notify.removeNotification(nId),callBackFunction!=""&&eval(callBackFunction+"("+id+")"))}):(removeLink(id,nId),SP.UI.Notify.removeNotification(nId),callBackFunction!=""&&eval(callBackFunction+"("+id+")")));break;default:callBackFunction!=""&&callBackFunction!="undefined"?(callBackFunction=eval(callBackFunction),options={url:redirectUrl,width:700,dialogReturnValueCallback:Function.createCallback(Function.createDelegate(null,callBackFunction),id)}):options=command==="approve"?{url:redirectUrl,width:700,dialogReturnValueCallback:vt}:{url:redirectUrl,width:700};SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",options)}}function vt(n){n==SP.UI.DialogResult.OK&&window.location.reload()}function yt(){var d=window.TreeView_HoverNode,g=window.TreeView_UnhoverNode,it=window.TreeView_ToggleNode,s=0,u,a,e,t,i,b,y,w;n("td.epm-nav-node").find("a").each(function(){var t=n(this),i=t.offset().left;s===0?s=i:i>s&&t.width(112)});n("span#epm-nav-asoitems-info").on("shown.bs.tooltip",function(){var r=n(this),t=r.parent().find("div.tooltip"),i=t.offset();i.top-=25;t.remove();n("body").append(t);t.offset(i)});window.TreeView_HoverNode=function(t,i){var r=n(i);r.hasClass(nt)?r.parent().parent().parent().addClass(tt):d(t,i)};window.TreeView_UnhoverNode=function(t){var i=n(t);i.hasClass(nt)?n(t).parent().parent().parent().removeClass(tt):g(t)};window.TreeView_ToggleNode=function(t,i,r,u,f){var p=null,e=n.parseJSON(n.cookie(h)),o,a,k,v,s;e&&(e=n.parseJSON(n.cookie(h))["epm-nav-sub-ql"],e&&(p=e));var w=p||{},c=null,b=n(r).parents("div");for(o=0;o<b.length;o++)if(a=b[o],k=n(a),k.hasClass("epm-nav-sub")){for(c=a.id,v=l(c),s=0;s<v.length;s++){var d=v[s],y=n(d).is(":visible"),g=d.id.replace("Nodes","");g===r.id&&(y=!y);w[n("#"+g.replace("EPMLiveNavn","EPMLiveNavt")).text()]=y}break}ut(c,w);it(t,i,r,u,f)};window.epmLiveNavigation.handleContextualCommand=function(n,t,i,r,u,f,e){at(n,t,i,r,u,f,e)};n("td.epm-nav-node-root").click(function(){var i=n(this),t=i.parent().find("a").get(0).id;TreeView_ToggleNode(EPMLiveNav_Data,0,document.getElementById(t)," ",document.getElementById(t+"Nodes"))});u=["suiteBar","s4-ribbonrow","s4-workspace"];for(a in u)u.hasOwnProperty(a)&&n("#"+u[a]).click(function(){r.data("pinstate")==="unpinned"&&rt()});e=n("#epm-nav-pin");e.click(function(){window.epmLiveNavigation.togglePinned(!0)});r.hover(function(){e.show()},function(){e.hide()});try{r.slimScroll({height:r.height(),width:r.width(),alwaysVisible:!0})}catch(ot){}t=n("#epm-nav").find(".slimScrollDiv");i=t.find(".slimScrollBar");i.hide();t.css("position","absolute");t.css("left","50px");r.css("left","0");r.css("top","0");i.css("z-index",1001);t.hover(function(){var r=!1;n(".epm-nav-sub").each(function(){var i=n(this);i.is(":visible")&&i.height()>=t.height()&&(r=!0)});r&&i.fadeIn(300)},function(){i.fadeOut(300)});n(window).resize(function(){var i=n("#epm-nav-top").height();t.height(i);r.height(i)});n("a.epm-nav-node").click(function(){var i=n(this),r,t,s;n("#epm-nav-sub-ql").find("a").each(function(){n(this).parent().parent().parent().parent().removeClass(f)});i.parent().parent().parent().parent().addClass(f);var u=-1,e=i.parents("div")[0],o=n(e).siblings("div");if(o)for(r=l(n(o[0]).parent().parent().attr("id")),t=0;t<r.length;t++)s=r[t],s.id===e.id&&(u=t);n.cookie(v,JSON.stringify({index:u,uri:i.attr("href")}),c)});window.epmLiveNavigation.snWidth=r.width();y=function(){var t=window.epmLiveNavigation.workspaceTree();t?b=n("#"+t._element.id):window.setTimeout(function(){y()},1)};y();var o=r.width(),k=function(){var i,t;n("a.rtIn").each(function(){var t=n(this);t.attr("style","")});n(".epm-nav-ws-node").each(function(){n(this).attr("style","")});i=0;try{i=b.width()+40}catch(u){}t=0;o<i&&(t=i+5,r.stop().animate({width:t},300),r.parent().stop().animate({width:t},300));n(".epm-nav-ws-node").each(function(){var i=n(this),r=50+(t===0?o:t)-i.offset().left;i.attr("style","width:"+r+"px")});window.epmLiveNavigation.wsTreeExpanded=!0},p=function(){r.stop().animate({width:o},300);r.parent().stop().animate({width:o},300);n(".epm-nav-ws-node").each(function(){n(this).attr("style","")});window.epmLiveNavigation.resetWSNodeWidth();window.epmLiveNavigation.wsTreeExpanded=!1},ft=function(n){var r=(n.attr("class")||"").toLowerCase(),t,i;r.indexOf("plus")!==-1?(t=function(){(n.attr("class")||"").toLowerCase().indexOf("minus")!==-1?window.setTimeout(function(){k()},100):window.setTimeout(function(){t()},1)},t()):(i=function(){(n.attr("class")||"").toLowerCase().indexOf("plus")!==-1?window.setTimeout(function(){p()},100):window.setTimeout(function(){i()},1)},i())},et=n("#epm-nav-sub-workspaces");n("#EPMNavWorkspacesTree").hover(function(){window.epmLiveNavigation.wsTreeExpanded||k()},function(){p()});r.hover(function(){},function(){et.is(":visible")&&p()});w=function(){var t=n("a.rtIn");t.length?t.each(function(){var i=n(this).parent().parent().find("span"),t;i.length>1&&(t=n(i.get(1)),t&&(t.click(function(){ft(n(this))}),t.hover(function(){window.epmLiveNavigation.wsNodeSelectorClass=n(this).attr("class")})))}):window.setTimeout(function(){w()},1)};w()}function k(i){var c,r,f,l,e,s,o,h,a,v;window.epmLiveNavigation.buildLink=function(n){var e=t.currentWebUrl(),i=window.location.href,f=n.Url?n.Url["#cdata"]:"",r,o,u;return(f+"").toLowerCase().indexOf("/lists/")!==-1?(i=f.replace(/Source={page}&BackTo={page}/g,""),r=i.split("?"),r.length>1&&(r[1]||(i=r[0]))):(o=i.split("?"),u=e+o[0].split(escape(e))[1],u=escape(u),i=f.replace(/{page}/g,u)),{id:n["@Id"],title:n.Title["#cdata"],url:i,category:n["@Category"],cssClass:n["@CssClass"],order:parseInt(n["@Order"]),siteId:n["@SiteId"],webId:n["@WebId"],listId:n["@ListId"],itemId:n["@ItemId"],external:n["@External"]==="True",visible:n["@Visible"]==="True",active:n["@Active"]==="True",seprator:n["@Separator"]==="True"}};c=!1;for(r in i.Nodes)if(i.Nodes.hasOwnProperty(r)){f=i.Nodes[r].NavLink;f.length||(f=[f]);for(l in f)if(f.hasOwnProperty(l))for(e=f[l],s=0;s<u.length;s++)if(o=u[s],o.provider===r)if(r!=="Workspaces")o.registerLink(window.epmLiveNavigation.buildLink(e));else try{h=window.epmLiveNavigation.workspaceTree();h.trackChanges();a=e.Title["#cdata"];c?o.registerWorkspace(window.epmLiveNavigation.buildLink(e),h):(o.registerLink(window.epmLiveNavigation.buildLink(e)),a==="All Workspaces"&&(c=!0,n("#epm-nav-sub-workspaces-static-links").remove().insertBefore("#EPMNavWorkspacesTree")));h.commitChanges()}catch(y){}r==="Workspaces"?(window.epmLiveNavigation.resetWorkspaceTree=function(){var n,r,t;try{for(n=window.epmLiveNavigation.workspaceTree(),n.trackChanges(),r=n.get_allNodes(),t=0;t<r.length;t++)r[t].set_expanded(!1);var u=function(t){var r=n.findNodeByValue(t),i;r&&r!=n&&(i=r.get_parent(),i===n||i.get_expanded()||(i.set_expanded(!0),u(i.get_value())))},f=window.epmLiveNavigation.currentWebId,i=n.findNodeByValue(f);i&&(i.get_parent()!==n?u(f):i.set_expanded(!0),i.set_selected(!0));n.commitChanges()}catch(e){}},v=window.epmLiveNavigation.workspaceTree(),n("a.rtIn").each(function(){var t=n(this),i=t.parent(),r=t.text(),u=v.findNodeByText(r).get_value();i.append('<div id="'+u+'" class="epm-nav-ws-node"><\/div>');t.remove();t.text("");t.append("<span>"+r+"<\/span>");window.epmLiveNavigation.wsInfoDict[u].hasAccess||t.addClass("epm-nav-ws-disabled");i.find(".epm-nav-ws-node").append(t)}),window.epmLiveNavigation.resetWorkspaceTree(),n("#EPMNavWorkspacesTree").fadeIn(300)):r==="Applications"?n(n("#epm-nav-sub-new-static-links").find(".epm-nav-sub-header").get(0)).attr("style","padding-top: 0px !important"):r==="Favorites"&&n(n("#epm-nav-sub-favorites-static-links").find(".epm-nav-sub-header").get(0)).attr("style","padding-top: 0px !important");window.SP.SOD.notifyScriptLoadedAndExecuteWaitingJobs("EPMLiveNavigation_"+r);r!=="Settings"&&w(r)}n(".epm-app-btn").click(function(){document.location.href=n(this).data("url")})}function pt(){for(var f,n,t=[],r=0;r<u.length;r++)f=u[r],n=f.provider,n&&n!==window.epmLiveNavigation.selectedNode&&t.push(n);t.length>0&&i.execute("GetNavigationLinks",t.join(),function(n){k(n);lt()},function(n){console.log(n)})}function d(){var n=null,i;window.epmLiveNavigation&&(n=window.epmLiveNavigation.staticProvider);n!==null?n&&(i=t.parseJson(e.decode(n)),i.Nodes.Workspaces?window.epmLiveNavigation.workspaceTree()?k(i):window.setTimeout(function(){d()},1):k(i)):window.setTimeout(function(){d()},1)}function wt(){n("#epm-nav-top").find("[data-role='top-nav-node']").each(function(){u.push(new ot(this))})}var g=300,nt="epm-nav-node",tt="epm-nav-node-hover",a="epm-nav-node-opened",f="epm-nav-node-selected",o="epm-nav-node-expanded",s="epm-nav-node-collapsed",it="epmnav-selected-tlnode",v="epmnav-selected-link",h="epmnav-expand-state",y="epmnav-pin-state",c={expires:365,path:"/"},r=n("#epm-nav-sub"),u=[],ot=function(i){var s={},p=i,e=n(i),o=n("#epm-nav-sub-"+e.data("id")),h=p.id,rt=e.data("linkprovider"),w=function(){return e.parent().hasClass(f)},ut=function(){return e.parent().hasClass(a)},b=function(n){n?e.parent().addClass(f):e.parent().removeClass(f)},k=function(){o.hide();e.parent().removeClass(a)},d=function(){r.is(":visible")&&r.hide("slide",{direction:"left"},g);k()},ft=function(n,t){var i=new window.Telerik.Web.UI.RadTreeNode,r=t,u,f,e;n.category&&(r=t.findNodeByValue(n.category)||r);i.set_text(n.title);i.set_value(n.webId);n.active?i.set_navigateUrl(n.url):i.set_navigateUrl("javascript:;");window.epmLiveNavigation.wsTeamDict=window.epmLiveNavigation.wsTeamDict||{};window.epmLiveNavigation.wsTeamDict[n.webId]=n.itemId;u=n.itemId.split(".");f="";try{f=u[1]}catch(o){}e="";try{e=u[2]}catch(o){}window.epmLiveNavigation.wsInfoDict=window.epmLiveNavigation.wsInfoDict||{};window.epmLiveNavigation.wsInfoDict[n.webId]={siteId:n.siteId,listId:f,itemId:e,hasAccess:n.active};r.get_nodes().add(i)},et=function(n){n.seprator?ct(n.category):n.url.toLowerCase()==="header"?(l(n.category),st(n)):n.url.toLowerCase()==="placeholder"?(l(n.category),ot(n)):(l(n.category),ht(n))},ot=function(n){var t=n.category,i;t||(t="__STATIC__");i='<li class="epm-nav-sub-placeholder">'+n.title+"<\/li>";s[t].$el.append(i)},st=function(n){var t=n.category,r,i;t||(t="__STATIC__");r="epm-nav-sub-header";o.find("li.epm-nav-section-header").length===0&&(r="epm-nav-section-header");i='<li class="'+r+'">'+n.title+"<\/li>";s[t].$el.append(i);i='<li class="epm-nav-sub-header-bottom"><\/li>';s[t].$el.append(i)},ht=function(t){var u=t.category,o,h,e,l,i,a,y,w,p;for(u||(u="__STATIC__"),o=!1,h=t.cssClass.split(" "),e=0;e<h.length;e++)if(h[e]==="epm-nav-button"){o=!0;t.cssClass=t.cssClass.replace(/epm-nav-button/g,"");break}l="";t.cssClass&&(l='<span class="epm-nav-icon '+t.cssClass+'"><\/span>');i="epm-nav-node epm-nav-trans";a=s[u].$el.parent().get(0).id;(a==="epm-nav-sub-settings"||a==="epm-nav-sub-workplace")&&(i="epm-nav-node");o&&(i=i+" epm-nav-button",i=i.replace(/epm-nav-trans/g,""));y="";t.external&&(y=' target="_blank"');w='<li id="'+t.id+'" class="'+i+'" style="display:none;">'+l+'<a id="epm-nav-link-'+t.id+'" href="'+t.url+'" data-siteid="'+t.siteId+'" data-webid="'+t.webId+'" data-listid="'+t.listId+'" data-itemid="'+t.itemId+'"'+y+"><span>"+t.title+"<\/span><\/a><\/li>";s[u].$el.append(w);p=n("#"+t.id);t.visible&&p.show();p.find("a").click(function(){var t=n(this),i=t.parent();if(!i.hasClass("epm-nav-button")){r.find("a").each(function(){n(this).parent().removeClass(f)});var e="",o="",u=i.parent().get(0).id;u!=="epm-nav-sub-favorites-static-links"&&u!=="epm-nav-sub-recent-static-links"&&u!=="epm-nav-sub-new-static-links"&&(i.addClass(f),e=t.attr("href"),o=t.get(0).id);n.cookie(v,JSON.stringify({id:o,url:e}),c)}})},ct=function(t){var i='<div class="epm-nav-sub-sep"><\/div>';t?n("#"+nt(t)).append(i):o.append(i)},l=function(t){if(t||(t="__STATIC__"),!s[t]){var i=nt(t),r="epm-nav-node-expanded";t==="__STATIC__"&&(r="epm-nav-node-static");t!=="__STATIC__"&&o.append('<div id="'+i+'" class="epm-nav-node epm-nav-node-root epm-nav-cat"><span class="'+r+'">&nbsp;<\/span><span class="epm-nav-cat-title">'+t+"<\/span><\/div>");o.append('<ul id="'+i+'-links" class="epm-nav-links '+r+'"><\/ul>');s[t]={id:i,$el:n("#"+i+"-links")}}},nt=function(n){return o.get(0).id+"-"+n.toLowerCase().replace(/ /g,"-").replace(/_/g,"").replace(/[^\w-]+/g,"").replace(/--/g,"-")},lt=function(){o.fadeIn(300);e.parent().addClass(a)},tt=function(){lt();r.is(":visible")||r.show("slide",{direction:"left"},g)};return e.click(function(){var r,i,f,e;if(w())ut()&&n.cookie(y)==="unpinned"?d():tt();else{for(r in u)u.hasOwnProperty(r)&&(i=u[r],i.id!==h&&i.selected()&&(i.select(!1),i.close()));b(!0);tt();n.cookie(it,JSON.stringify({id:h,webUrl:t.currentWebUrl()}),c);for(f in u)u.hasOwnProperty(f)&&(e=u[f],e.id!==h&&n("#"+e.id.replace("top","sub")).hide())}}),{id:h,provider:rt,selected:w,select:b,close:k,closeNav:d,registerLink:et,registerWorkspace:ft,el:p,$el:e,$menu:o}},et;return window.epmLiveNavigation.togglePinned=function(n){r.data("pinstate")==="pinned"?window.epmLiveNavigation.unpin(n):window.epmLiveNavigation.pin(n)},window.epmLiveNavigation.pin=function(n){p("pinned",n)},window.epmLiveNavigation.unpin=function(n){p("unpinned",n)},window.epmLiveNavigation.removeLink=function(n){var t=r.find("#epm-nav-link-"+n.id);window.epmLiveNavigation.handleContextualCommand(n.id,t.data("webid"),t.data("listid"),t.data("itemid"),"nav:remove","98")},window.epmLiveNavigation.registerLink=function(t){var e,o,s,f,h;if(t){switch(t.kind){case 0:case 1:e="Favorites";break;case 2:case 3:e="Workspaces"}if(e)if(t.kind!==3){for(o=0;o<u.length;o++)if(s=u[o],s.provider===e){if(t.cssClass="epm-nav-sortable "+t.cssClass,s.registerLink(t),f=r.find("#"+t.id),h=n("#epm-nav-sub-"+e.toLowerCase()+"-static-links"),h.find(".epm-nav-sub-placeholder").each(function(){var u=n(this),i=!1,r=u.text();t.kind===0&&r==="No pages"?i=!0:t.kind===1&&r==="No items"?i=!0:t.kind===2&&r==="No favorite workspaces"&&(i=!0);i&&u.remove()}),t.kind<2&&f.find("a").attr("style","width:115px !important;"),t.kind===0||t.kind===2)try{f.remove().insertBefore(n(h.find(".epm-nav-sub-header").get(1)))}catch(c){}t.kind!==2?window.epmLiveNavigation.addFavoritesMenu(f):window.epmLiveNavigation.addFavoriteWSMenu(f);f.addClass("epm-nav-sortable");window.epmLiveNavigation.addDragger(f);f.fadeIn(300);break}}else i.execute("GetNavigationLinks",e,function(t){var o=[],s=t.Nodes.Workspaces.NavLink,h,f,i,c;for(h in s)s.hasOwnProperty(h)&&(f=s[h],r.find("#"+f["@Id"]).length===0&&(i=f.Title["#cdata"],i!=="Workspaces"&&i!=="New Workspace"&&i!=="Favorite Workspaces"&&i!=="All Workspaces"&&(c=function(){var t=window.epmLiveNavigation.buildLink(f),a,s,v,r,y,i,p;if(window.epmLiveNavigation.buildLink){for(a=!1,i=0;i<o.length;i++)if(o[i]===t.title){a=!0;break}if(a){for(s=0;s<u.length;s++)if(v=u[s],v.provider===e){if(r=window.epmLiveNavigation.workspaceTree(),!r.findNodeByText(t.title)){r.trackChanges();v.registerWorkspace(t,r);r.commitChanges();n("a.rtIn").each(function(){var i=n(this),u=i.text(),f,e;u===t.title&&(f=i.parent(),f.append('<div id="'+r.findNodeByText(u).get_value()+'" class="epm-nav-ws-node"><\/div>'),i.remove(),i.text(""),i.append("<span>"+u+"<\/span>"),f.find(".epm-nav-ws-node").append(i),e=i.parent(),e.addClass("epm-nav-sortable"),i.attr("style","width:124px !important; position: relative; top: 2px;"),window.epmLiveNavigation.addFavoriteWSMenu(e))});var w="#"+t.id,h=[],b={},l,k=n(w).text();for(n(n(w).parents("ul")[0]).find("li").each(function(){var t=n(this),i=t.text();i!==k?(h.push(i),b[i]=t):l=t}),h.sort(),y=!1,i=0;i<h.length;i++)y||(p=h[i],p>k&&(l.insertBefore(b[p]),l.removeClass("rtLast"),n(n(l.parents("ul")[0]).find("li:last")[0]).addClass("rtLast"),y=!0))}break}n("#epm-nav-nows-ph").remove();n("#EPMNavWorkspacesTree").fadeIn(300)}else t.cssClass&&(t.kind=2,t.category=null,window.epmLiveNavigation.registerLink(t)),o.push(t.title)}else window.setTimeout(function(){c()},1)},c())));try{n("#epm-nav-sub-workspaces a").length<3&&window.setTimeout(function(){window.epmLiveNavigation.registerLink({kind:3})},200)}catch(l){}},function(n){console.log(n)})}},window.epmLiveNavigation.showAssociatedItems=function(i){var r=function(n){SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",{url:n,showMaximized:!0})},u=function(i){var f=t.currentWebUrl();f?n.ajax({type:"POST",url:(f+"/_layouts/15/epmlive/gridaction.aspx?action=linkeditemspost&listid="+i.listId+"&lookups="+i.lookup+"&field="+i.field+"&LookupFieldList="+i.listName).replace(/\/\//g,"/"),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){r(i.url)},error:function(){r(i.url)}}):window.setTimeout(function(){u(i)},1)};u(i)},window.epmLiveNavigation.createNewOpenDialog=function(n,t,i){var r={id:i,url:window.epmLive.currentWebUrl+"/_layouts/15/epmlive/redirectionproxy.aspx?action=gotolist&webid="+window.epmLive.currentWebId+"&listid="+i,name:t,icon:null},u={url:n,showMaximized:!1,dialogReturnValueCallback:function(n){n==1&&(window.epmLive.SocialStream_SE!=undefined||window.epmLive.SocialStream_SE!=null)&&window.epmLive.SocialStream_SE.toolbarManager.handleCreationAction(n,null,r)}};SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",u)},et=function(){wt();d();p(n.cookie(y)||"pinned");w();ht();yt();ExecuteOrDelayUntilScriptLoaded(pt,"EPMLive.js");window.SP.SOD.notifyScriptLoadedAndExecuteWaitingJobs("EPMLive.Navigation.Initialized")},{init:et,expandProviderNodes:w}}();f.init();r=function(){var t=function(t,r,u,f,e){var p,b,k,d;r=r||[];var h=n(t.find("a").get(0)),s=h.data("itemid"),y=h.data("siteid"),c=h.data("webid"),v=h.data("listid"),w=t.get(0).id;try{s?s.indexOf(".")!==-1&&(b=s.split("."),c=b[0],v=b[1],s=b[2]):(p=window.epmLiveNavigation.wsInfoDict[w],p&&(y=p.siteId,c=w,v=p.listId,s=p.itemId))}catch(it){}var l=(v||"").replace(/-/g,""),o=n("#menu"+l+s),g=function(t,i){var d=function(n){switch(n.toLowerCase()){case"nav:remove":case"nav:addtofav":case"nav:removefavws":case"nav:removefavri":return"icon-star-6";case"view":return"icon-info";case"edit":return"icon-pencil-2";case"delete":return"icon-close-3";case"approve":return"icon-thumbs-up-4";case"comments":return"icon-bubble-dots";case"buildteam":return"icon-user-plus-3";case"workspace":return"icon-tree-2";case"epkcommand:rpeditor":return"icon-users-5";case"perms":return"icon-key";case"createworkspace":return"icon-tree-2";case"epkcommand:costs":return"icon-coins";case"workflows":return"icon-loop-3";case"gotoplanner":return"fui-ext-project";default:return"epm-nav-cm-blank"}},k=w,p,y,h,b;t.length&&t.push({title:"--SEP--"});for(p in r)r.hasOwnProperty(p)&&t.push(r[p]);for(o=n("#menu"+l+s),n(o.find(".epm-nav-cm-loading").get(0)).remove(),y=0;y<t.length;y++){if(h=t[y],u&&(h.kind=0),f&&(h.kind=f),!c||c==="undefined")try{c=i.parent().get(0).id}catch(g){}h.title==="--SEP--"?y!==t.length-1&&o.append(n('<li class="seprator"><\/li>').hide().fadeIn()):(b="",e&&(b=e[h.command]),o.append(n('<li><span class="epm-nav-cm-icon '+d(h.command)+'">&nbsp;<\/span><a href="javascript:epmLiveNavigation.handleContextualCommand(\''+k+"','"+c+"','"+v+"','"+s+"','"+h.command+"','"+h.kind+"','"+b+'\');" style="width: 122px !important; display: inline-block;">'+h.title+"<\/a><\/li>").hide().fadeIn()),o.find("a").click(function(){a()}))}o.find("a").click(function(){var t=n(this);t.parent().find(".icon-star-6").length&&o.hover(function(){},function(){o.remove()})});o.hover(function(){window.epmNavHoveredNode=k});o.mouseleave(function(){window.epmNavHoveredNode=null;window.setTimeout(function(){window.epmNavHoveredNode==null&&a()},200)});n(".epm-nav-links, #EPMNavWorkspacesTree").hover(function(){},function(){window.epmNavHoveredNode=null;window.setTimeout(function(){window.epmNavHoveredNode===null&&a()},200)});n(document).on("click",".epm-nav-dragger",function(){a()});o.offset().top+o.height()>n(window).height()&&o.css("top",o.offset().top-o.height()-30);o.offset().left+o.width()>n(window).width()&&o.css("left",o.offset().left-o.width()-30)},nt=function(){window.epmNavHoveredNode=null;o.css("top",t.offset().top+20);o.css("left",t.offset().left);o.offset().top+o.height()>n(window).height()&&o.css("top",o.offset().top-o.height()-30);o.offset().left+o.width()>n(window).width()&&o.css("left",o.offset().left-o.width()-30);o.fadeIn(200)},a=function(){o.fadeOut(200);n("#menu"+l+s).length&&n("#menu"+l+s).remove()},tt=function(){o.is(":visible")?a():nt()};window.epmNavSelectNode!=l+s&&window.epmNavSelectNode!=null&&n("#menu"+window.epmNavSelectNode).fadeOut(200);window.epmNavSelectNode=l+s;n("body").find("#menu"+l+s).length===0?(n("body").append('<ul class="epm-nav-contextual-menu"  id="menu'+l+s+'" style="display:block;position:absolute;top:'+(t.offset().top+20)+"px;left:"+t.offset().left+'px;"><li class="epm-nav-cm-loading"><span>Loading...<\/span><\/li><\/ul>'),o=n("#menu"+l+s),nt(),y||(c=w,k=window.epmLiveNavigation.wsInfoDict[c],y=k.siteId,v=k.listId,s=k.itemId,h.data("siteid",y),h.data("webid",c),h.data("listid",v),h.data("itemid",s)),d=function(){if(window.epmLive){var n="<Request><Params><SiteId>"+y+"<\/SiteId><WebId>"+c+"<\/WebId><ListId>"+v+"<\/ListId><ItemId>"+s+"<\/ItemId><UserId>"+window.epmLive.currentUserId+"<\/UserId><DebugMode>"+window.epmLive.debugMode+"<\/DebugMode><\/Params><\/Request>";i.execute("GetContextualMenuItems",n,function(n){var u=[],i,r,t;if(n.ContextualMenus.Items&&(i=n.ContextualMenus.Items.Item,i))for(i.length||(i=[i]),r=0;r<i.length;r++)t=i[r],f?u.push({title:t["@Title"],command:t["@Command"],kind:f,imgUrl:t["@ImageUrl"]}):u.push({title:t["@Title"],command:t["@Command"],kind:t["@Kind"],imgUrl:t["@ImageUrl"]});g(u,h)},function(){g([],h)})}else window.setTimeout(function(){d()},1)},d(),n(".epm-menu-btn span").mouseleave(function(){window.epmNavHoveredNode=null;window.setTimeout(function(){window.epmNavHoveredNode==null&&a()},200)}),n(".epm-nav-ws-node").mouseleave(function(){window.epmNavHoveredNode=null;window.setTimeout(function(){window.epmNavHoveredNode==null&&a()},200)}),n(".epm-nav-node").mouseleave(function(){window.epmNavHoveredNode=null;window.setTimeout(function(){window.epmNavHoveredNode==null&&a()},200)})):tt()};return{setupMenu:t}}();window.epmLiveNavigation.addContextualMenu=function(t,i,u,f,e){t.append('<span class="epm-menu-btn"><span class="icon-ellipsis-horizontal"><\/span><\/span>');n(t.find(".epm-menu-btn").get(0)).click(function(){r.setupMenu(t,i,u,f,e)})};window.epmLiveNavigation.isSecurityJobRunning=function(i,r,u){var f=!1,e='<Data><Param key="ListID">'+r+'<\/Param><Param key="itemId">'+u+"<\/Param><\/Data>";return n.ajax({type:"POST",url:i+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'IsSecurityJobAlreadyRunning', Dataxml: '"+e+"' }",async:!1,contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){if(n.d){var r=t.parseJson(n.d),i=r.Result;t.responseIsSuccess(i)&&(f=i.SecurityJob["@Success"]==="True"?!0:!1)}},error:function(n){console.log(n);f=!1}}),f};window.epmLiveNavigation.isImportResourceRunning=function(){var t=!1;return n.ajax({type:"POST",url:window.epmLive.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",async:!1,data:"{ Function: 'IsImportResourceAlreadyRunning', Dataxml: '' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){if(n.d){var r=window.epmLive.parseJson(n.d),i=r.Result;window.epmLive.responseIsSuccess(i)&&(t=i.ResourceImporter["@Success"]==="True"?!0:!1)}},error:function(n){window.epmLive.log(n);t=!1}}),t};var o=function(){var t=function(){var t=function(t){t.find(".epm-nav-cat").each(function(){var t=n(n(this).find("span").get(0));t.removeClass("epm-nav-node-expanded");t.addClass("epm-nav-node-collapsed")});t.find(".epm-nav-links").each(function(){var t=n(this);t.hasClass("epm-nav-node-static")||(t.removeClass("epm-nav-node-expanded"),t.addClass("epm-nav-node-collapsed"))})};return{collapseAll:t}}(),i=n("#epm-nav-sub-settings");t.collapseAll(i);f.expandProviderNodes("Settings")},s=function(){var f=function(){window.epmLiveNavigation.addDragger=function(t){t.get(0).innerHTML.indexOf("epm-nav-dragger")===-1&&(t.prepend('<span class="epm-nav-dragger">&nbsp;<\/span>'),t.hover(function(){n(n(this).find(".epm-nav-dragger").get(0)).css("visibility","visible")},function(){n(n(this).find(".epm-nav-dragger").get(0)).css("visibility","hidden")}))};window.epmLiveNavigation.addFavoritesMenu=function(t){t.append('<span class="epm-menu-btn"><span class="icon-ellipsis-horizontal"><\/span><\/span>');n(t.find(".epm-menu-btn").get(0)).click(function(){r.setupMenu(t,[{title:"Remove",command:"nav:remove",kind:"98"}])})};var t=function(t){var r=[],u=0;t.find(".epm-nav-node").each(function(){r.push(n(this).get(0).id+":"+ ++u)});r.length&&i.execute("ReorderLinks",r.join(),function(){},function(n){console.log(n)})},u=function(n){window.epmLiveNavigation.addDragger(n)},f=function(n){window.epmLiveNavigation.addFavoritesMenu(n)};return{resetOrder:t,addDragger:u,addMenu:f}}(),u=n("#epm-nav-sub-favorites-static-links"),t;u.find(".epm-nav-sortable").each(function(){var t=n(this).parent();t.addClass("epm-nav-sortable");n(t.find("a").get(0)).attr("style","width:115px !important;");f.addDragger(t);f.addMenu(t)});try{t=n("#epm-nav-sub-favorites");u.sortable({items:"li.epm-nav-sortable",placeholder:"epm-nav-drag-placeholder",start:function(i,r){if(t.is(":visible")){var f=r.item.index(),u="page";f>n(t.find(".epm-nav-sub-header").get(1)).index()&&(u="item");r.item.data("kind",u)}},stop:function(i,r){if(t.is(":visible")){var u=!0,o=r.item.data("kind"),f=r.item.index(),e=n(t.find(".epm-nav-sub-header").get(1)).index();o==="page"?f>e&&(u=!1):f<e&&(u=!1);u||n(n(r.item).parent()).sortable("cancel")}},update:function(){f.resetOrder(u)}});u.disableSelection()}catch(e){}},h=function(){var u=function(){var t=function(n,t){n.index()<t?i(n):u(n)},i=function(t){t.append('<span class="epm-menu-btn"><span class="icon-plus-2"><\/span><\/span>');n(t.find("a").get(0)).attr("style","width:115px !important;");n(t.find(".epm-menu-btn").get(0)).click(function(){var i=n(t.find("a").get(0));window.epmLiveNavigation.handleContextualCommand(null,i.data("webid"),i.data("listid"),null,"nav:add",0)})},u=function(t){var i=n(t.find("a").get(0));i.attr("style","width: 115px !important;");t.append('<span class="epm-menu-btn"><span class="icon-ellipsis-horizontal"><\/span><\/span>');n(t.find(".epm-menu-btn").get(0)).click(function(){var u=[],f=!1;n("#epm-nav-sub-favorites-static-links").find("a").each(function(){var t=n(this);t.data("listid")===i.data("listid")&&t.data("itemid")===i.data("itemid")&&(f=!0)});f?u.push({title:"Remove",command:"nav:removeFavRI",kind:98}):u.push({title:"Add",command:"nav:addToFav",kind:98});r.setupMenu(t,u)})};return{addMenu:t}}(),t=n("#epm-nav-sub-recent-static-links"),i;t.find(".epm-nav-sub-header").each(function(){var t=n(this),r=t.text(),u=t.index();r==="Recent Items"&&(i=u)});t.find(".epm-nav-node").each(function(){u.addMenu(n(this),i)})},c=function(){var t=n("#EPMNavWorkspacesTree"),u=function(){window.epmLiveNavigation.addFavoriteWSMenu=function(t){t.append('<span class="epm-menu-btn"><span class="icon-ellipsis-horizontal"><\/span><\/span>');n(t.find(".epm-menu-btn").get(0)).click(function(){var u=t.get(0).id,i=[],f=null,o=!0,e;t.hasClass("epm-nav-ws-node")||t.is(".workspacecentercontextmenu")?window.epmLiveNavigation.wsInfoDict[u].hasAccess?(e=!1,n("#epm-nav-sub-workspaces-static-links").find("a").each(function(){n(this).data("webid")===u&&(e=!0)}),e?i.push({title:"Remove",command:"nav:removeFavWS",kind:98}):i.push({title:"Add",command:"nav:addToFav",kind:98}),f=u):o=!1:(i.push({title:"Remove",command:"nav:removeFavWS",kind:98}),f=n(t.find("a").get(0)).data("webid"));o&&(window.epmLiveNavigation.wsTeamDict[f]!=="X"&&u!==window.epmLive.rootWebId&&i.push({title:"Edit team",command:"nav:team",kind:6}),r.setupMenu(t,i))})};var s=function(t){var r=[],u=0;t.find("li.epm-nav-sortable").each(function(){r.push(n(this).get(0).id+":"+ ++u)});r.length&&i.execute("ReorderLinks",r.join(),function(){},function(n){console.log(n)})},h=function(t){t.prepend('<span class="epm-nav-dragger">&nbsp;<\/span>');t.hover(function(){n(n(this).find(".epm-nav-dragger").get(0)).css("visibility","visible")},function(){n(n(this).find(".epm-nav-dragger").get(0)).css("visibility","hidden")})},c=function(n){var t=window.epmLiveNavigation.wsInfoDict[n.get(0).id];t?t.hasAccess&&window.epmLiveNavigation.addFavoriteWSMenu(n):window.epmLiveNavigation.addFavoriteWSMenu(n)},l=function(){window.epmLiveNavigation.resetWSNodeWidth=function(){n("a.rtIn").each(function(){var t=n(this),o=n(t.find("span").get(0)),r=15,u=o.width();if(u){var f=t.offset().left-50,s=u+f,e=180,i=e-f-r;t.data("originalwidth",t.width());t.data("newwidth",i);s>e-r?t.width(i):t.parent().width(i)}})};window.epmLiveNavigation.resetWSNodeWidth()},u=function(){if(n.fn.bindWithDelay){var t=n("#EPMNavWSTSearch");t.val("");t.bindWithDelay("keyup",function(){var t=n(this).val().trim();t?t.length>1?a(t.toLowerCase()):e():e()},200)}else window.setTimeout(function(){u()},100)},a=function(i){for(var r,e,s=window.epmLiveNavigation.workspaceTree().get_allNodes(),h=!1,u=0;u<s.length;u++)r=s[u],e=r.get_text().trim(),e&&e.toLowerCase().indexOf(i)!==-1?(o(r),r.set_visible(!0),h=!0,f()):r.set_visible(!1);h||t.find(".epm-nav-sub-placeholder").length!==0||t.append(n('<div class="epm-nav-sub-placeholder">No search results<\/div>').hide().fadeIn(200))},f=function(){t.find(".epm-nav-sub-placeholder").each(function(){n(this).remove()})},e=function(){var t,n;for(f(),t=window.epmLiveNavigation.workspaceTree().get_allNodes(),n=0;n<t.length;n++)t[n].set_visible(!0);window.epmLiveNavigation.resetWorkspaceTree()},o=function(n){var t=n.get_parent();t&&t!==window.epmLiveNavigation.workspaceTree()&&(t.set_visible(!0),t.set_expanded(!0),o(t))};return{resetOrder:s,addDragger:h,addMenu:c,initializeSearch:u,configureNodeWidth:l}}(),f=n("#epm-nav-sub-workspaces-static-links");f.find(".epm-nav-sortable").each(function(){var t=n(this).parent();t.addClass("epm-nav-sortable");n(t.find("a").get(0)).attr("style","width:124px !important; position: relative; top: 2px;");u.addDragger(t);u.addMenu(t)});try{f.sortable({items:"li.epm-nav-sortable",placeholder:"epm-nav-drag-placeholder",update:function(){u.resetOrder(f)}});f.disableSelection()}catch(e){}u.configureNodeWidth();u.initializeSearch();t.find("a").each(function(){u.addMenu(n(this).parent())});t.find("a").length===1&&(t.hide(),n("#epm-nav-sub-workspaces-static-links").get(0).innerHTML+='<li id="epm-nav-nows-ph" class="epm-nav-sub-placeholder">No workspaces<\/li>')};ExecuteOrDelayUntilScriptLoaded(o,"EPMLiveNavigation_Settings");ExecuteOrDelayUntilScriptLoaded(s,"EPMLiveNavigation_Favorites");ExecuteOrDelayUntilScriptLoaded(c,"EPMLiveNavigation_Workspaces");ExecuteOrDelayUntilScriptLoaded(h,"EPMLiveNavigation_RecentItems");window.SP.SOD.notifyScriptLoadedAndExecuteWaitingJobs("EPMLive.Navigation.js")})}function t(){ExecuteOrDelayUntilScriptLoaded(n,"EPMLiveNavigation")}ExecuteOrDelayUntilScriptLoaded(t,"jquery.min.js")})();
/*
//# sourceMappingURL=EPMLive.Navigation.min.js.map
*/