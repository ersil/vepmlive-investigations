(function(){"use strict";function n(){$(function(){var n=window.jQuery,t=function(){var t=function(){return window.epmLiveNavigation.currentWebUrl},i=function(xml){return eval("("+window.xml2json(n.parseXML(xml),"")+")")},r=function(n){return n["@Status"]==0};return{currentWebUrl:t,parseJson:i,responseIsSuccess:r}}(),e=function(){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t=function(t){var i="",o,s,h="",c,f,r,e="",u=0;/[^A-Za-z0-9\+\/\=]/g.exec(t)&&console.log('There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, "+", "/",and "="\nExpect errors in decoding.');t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do c=n.indexOf(t.charAt(u++)),f=n.indexOf(t.charAt(u++)),r=n.indexOf(t.charAt(u++)),e=n.indexOf(t.charAt(u++)),o=c<<2|f>>4,s=(f&15)<<4|r>>2,h=(r&3)<<6|e,i=i+String.fromCharCode(o),r!=64&&(i=i+String.fromCharCode(s)),e!=64&&(i=i+String.fromCharCode(h)),o=s=h="",c=f=r=e="";while(u<t.length);return unescape(i)};return{decode:t}}(),i=function(){var i=function(r,u,f,e){var o=t.currentWebUrl();o?n.ajax({type:"POST",url:(o+"/_vti_bin/WorkEngine.asmx/Execute").replace(/\/\//g,"/"),data:"{ Function: '"+r+"', Dataxml: '"+u+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){if(n.d){var r=t.parseJson(n.d),i=r.Result;t.responseIsSuccess(i)?f(i):e(n)}else e(n)},error:function(n){e(n)}}):window.setTimeout(function(){i(r,u,f,e)},1)};return{execute:i}}(),u=n.cookie,r;n.cookie=function(n,t,i){if(n=n+"-u-"+window.epmLiveNavigation.currentUserId,u){if(!t)return u(n);u(n,t,i)}};r=function(){function it(){for(var t,n=0;n<f.length;n++)if(t=f[n],t.selected()){t.closeNav();break}}function w(t){var f=["Ribbon","s4-workspace"],e,i,r;for(e in f)i=n("#"+f[e]),i.removeClass("epm-nav-pinned"),i.removeClass("epm-nav-unpinned"),i.addClass("epm-nav-"+t);r=n("#epm-nav-pin");r.removeClass("epm-nav-pin-pinned");r.removeClass("epm-nav-pin-unpinned");r.addClass("epm-nav-pin-"+t);t==="unpinned"&&it();u.data("pinstate",t);n.cookie(p,t,l)}function ht(){u.data("pinstate")==="pinned"?w("unpinned"):w("pinned")}function ct(){return(n.cookie(tt)||"epm-nav-top-ql").replace("epm-nav-top-","epm-nav-sub-")}function a(t){return n("#"+t).find(".epm-nav-sub-menu").find("div[id^=E]")}function lt(){var t=n.parseJSON(n.cookie(y)),r,f,e,s,i;if(t)if(t.id)n(u.find("#"+t.id).get(0)).parent().addClass(o);else if(r=t.index,f=t.uri,window.location.href.indexOf(f)!==-1)if(e=n("#"+ct()),r&&r!==-1){for(s=a(e.parent().attr("id")),i=0;i<s.length;i++)if(i===r){n(s[i]).find('a[href="'+f+'"]:first').parents("table").addClass(o);break}}else e.find('a[href="'+f+'"]:first').parents("table").addClass(o)}function at(t){var i={};t.find(".epm-nav-cat").each(function(){var t=n(this);i[t.text()]=n(t.find("span")[0]).hasClass(s)});rt(t.get(0).id,i)}function rt(t,i){var r=n.parseJSON(n.cookie(c))||{};r[t]=i;n.cookie(c,JSON.stringify(r),l)}function b(t){var p=n.parseJSON(n.cookie(c)),i,r,o,u,h,e,l,v,y;if(p){if(i="epm-nav-sub-ql",t)for(r=0;r<f.length;r++)if(o=f[r],o.provider===t){i=o.id.replace("epm-nav-top-","epm-nav-sub-");break}if(u=p[i],u)if(i==="epm-nav-sub-ql")for(h=a("epm-nav-sub-ql"),e=0;e<h.length;e++)l=h[e],v=l.id.replace("Nodes",""),u[n("#"+v.replace("EPMLiveNavn","EPMLiveNavt")).text()]||TreeView_ToggleNode(window.EPMLiveNav_Data,0,document.getElementById(v)," ",document.getElementById(l.id));else y=n("#"+i).find(".epm-nav-cat"),i==="epm-nav-sub-settings"&&y.each(function(){k(n(this))}),y.each(function(){var t=n(this),r=t.text(),i=u[r];n(t.find("span")[0]).hasClass(s)?i||k(t):i&&ut(t)})}}function ut(t){var u=t.get(0).id,i=n(t.find("span")[0]),r=n("#"+u+"-links");i.removeClass(h);i.addClass(s);r.removeClass(h);r.addClass(s)}function k(t){var u=t.get(0).id,i=n(t.find("span")[0]),r=n("#"+u+"-links");i.removeClass(s);i.addClass(h);r.removeClass(s);r.addClass(h)}function vt(){var t=function(){n("li.epm-nav-node").find("a").each(function(){var t=n(this),i;t.attr("alt")||(i=t.find("span"),i&&t.width()<i.width()&&(t.attr("alt",i.text()),t.attr("title",i.text())))})};n(".epm-nav-cat").click(function(){var t=n(this),i=n(t.find("span")[0]);i.hasClass(h)?ut(t):k(t);at(t.parent())});n("#epm-nav-top li").click(function(){t()});t()}function yt(t,r,u,f,e,o){var c=function(t,r){var u=function(t,i){var r=n("#"+t);r.fadeOut(300,function(){r.remove()});l&&SP.UI.Notify.removeNotification(i)};i.execute("RemoveNavigationLink",t,function(){u(t,r)},function(){u(t,r)})},a=window.epmLiveNavigation.currentWebUrl,y=(a+"/_layouts/15/epmlive/gridaction.aspx?webid="+r+"&listid="+u+"&id="+f+"&").replace(/\/\//g,"/"),b=(a+"/_layouts/15/epmlive/redirectionproxy.aspx?webid="+r+"&listid="+u+"&id="+f+"&").replace(/\/\//g,"/"),s="",h,l;switch(e){case"nav:add":s=b+"action=new";break;case"nav:team":var p="",w="",v="";if(f==="undefined")try{h=window.epmLiveNavigation.wsTeamDict[r].split(".");h[2]!=="-1"&&(p=h[0],w=h[1],v=h[2])}catch(k){}s=(a+"/_layouts/15/epmlive/gridaction.aspx?").replace(/\/\//g,"/")+"action=buildteam&webid="+(p||r);v&&(s=s+"&listid="+w+"&id="+v)}!s&&e&&(s=e.indexOf("epkcommand:")!==-1?y+"action=epkcommand&subaction="+e.split(":")[1]:y+"action="+e);switch(o){case"0":OpenCreateWebPageDialog(s);break;case"1":location.href=s;break;case"2":window.open(s+"&IsDlg=1","","height=100, width=200, toolbar=no, menubar=no, scrollbars=yes, resizable=yes,location=no, directories=no, status=yes");break;case"3":window.open(s+"&IsDlg=1","","width="+screen.width+",height="+screen.height+",top=0,left=0, toolbar=no, menubar=no, scrollbars=yes, resizable=yes,location=no, directories=no, status=yes");break;case"5":SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",{url:s,width:600,height:500});break;case"6":SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",{url:s,showMaximized:!0});break;case"98":e!=="nav:remove"?n.get(s).always(function(){c(t)}):c(t);break;case"99":confirm("Are you sure you want to send the item(s) to the Recycle Bin?")&&(l=SP.UI.Notify.addNotification("Deleting Item...",!0,"",null),e!=="nav:remove"?n.get(s).always(function(){c(t,l)}):c(t,l));break;default:SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",{url:s,width:700})}}function pt(){var p=window.TreeView_HoverNode,w=window.TreeView_UnhoverNode,b=window.TreeView_ToggleNode,f,s,i,t,h;window.TreeView_HoverNode=function(t,i){var r=n(i);r.hasClass(g)?r.parent().parent().parent().addClass(nt):p(t,i)};window.TreeView_UnhoverNode=function(t){var i=n(t);i.hasClass(g)?n(t).parent().parent().parent().removeClass(nt):w(t)};window.TreeView_ToggleNode=function(t,i,r,u,f){var p=null,e=n.parseJSON(n.cookie(c)),o,l,d,v,s;e&&(e=n.parseJSON(n.cookie(c))["epm-nav-sub-ql"],e&&(p=e));var w=p||{},h=null,k=n(r).parents("div");for(o=0;o<k.length;o++)if(l=k[o],d=n(l),d.hasClass("epm-nav-sub")){for(h=l.id,v=a(h),s=0;s<v.length;s++){var g=v[s],y=n(g).is(":visible"),nt=g.id.replace("Nodes","");nt===r.id&&(y=!y);w[n("#"+nt.replace("EPMLiveNavn","EPMLiveNavt")).text()]=y}break}rt(h,w);b(t,i,r,u,f)};window.epmLiveNavigation.handleContextualCommand=function(n,t,i,r,u,f){yt(n,t,i,r,u,f)};n("td.epm-nav-node-root").click(function(){var i=n(this),t=i.parent().find("a").get(0).id;TreeView_ToggleNode(EPMLiveNav_Data,0,document.getElementById(t)," ",document.getElementById(t+"Nodes"))});f=["suiteBar","s4-ribbonrow","s4-workspace"];for(s in f)n("#"+f[s]).click(function(){u.data("pinstate")==="unpinned"&&it()});i=n("#epm-nav-pin");i.click(function(){ht()});u.hover(function(){i.show()},function(){i.hide()});try{u.slimScroll({height:u.height(),width:u.width()})}catch(ut){}t=n("#epm-nav").find(".slimScrollDiv");h=t.find(".slimScrollBar");t.css("position","absolute");t.css("left","50px");u.css("left","0");h.css("z-index",1001);n(window).resize(function(){var i=n("#epm-nav-top").height();t.height(i);u.height(i)});n("a.epm-nav-node").click(function(){var i=n(this),r,t,s;n("#epm-nav-sub-ql").find("a").each(function(){n(this).parent().parent().parent().parent().removeClass(o)});i.parent().parent().parent().parent().addClass(o);var u=-1,f=i.parents("div")[0],e=n(f).siblings("div");if(e)for(r=a(n(e[0]).parent().parent().attr("id")),t=0;t<r.length;t++)s=r[t],s.id===f.id&&(u=t);n.cookie(y,JSON.stringify({index:u,uri:i.attr("href")}),l)});window.epmLiveNavigation.snWidth=u.width();var k=n("#"+window.epmLiveNavigation.workspaceTree()._element.id),r=u.width(),v=function(){n("a.rtIn").each(function(){var t=n(this);t.attr("style","")});n(".epm-nav-ws-node").each(function(){n(this).attr("style","")});var i=k.width(),t=0;r<i&&(t=i+20+20,u.stop().animate({width:t},300),u.parent().stop().animate({width:t},300));n(".epm-nav-ws-node").each(function(){var i=n(this),u=50+(t===0?r:t)-i.offset().left;i.attr("style","width:"+u+"px")});window.epmLiveNavigation.wsTreeExpanded=!0},e=function(){u.stop().animate({width:r},300);u.parent().stop().animate({width:r},300);n(".epm-nav-ws-node").each(function(){n(this).attr("style","")});window.epmLiveNavigation.resetWSNodeWidth();window.epmLiveNavigation.wsTreeExpanded=!1},d=function(n){var r=n.attr("class").toLowerCase(),t,i;r.indexOf("plus")!==-1?(t=function(){n.attr("class").toLowerCase().indexOf("minus")!==-1?window.setTimeout(function(){v()},100):window.setTimeout(function(){t()},1)},t()):(i=function(){n.attr("class").toLowerCase().indexOf("plus")!==-1?window.setTimeout(function(){e()},100):window.setTimeout(function(){i()},1)},i())},tt=n("#epm-nav-sub-workspaces");n("#EPMNavWorkspacesTree").hover(function(){window.epmLiveNavigation.wsTreeExpanded||v()},function(){e()});u.hover(function(){},function(){tt.is(":visible")&&e()});n("a.rtIn").each(function(){var i=n(this).parent().parent().find("span"),t;i.length>1&&(t=n(i.get(1)),t&&(t.click(function(){d(n(this))}),t.hover(function(){window.epmLiveNavigation.wsNodeSelectorClass=n(this).attr("class")})))})}function ft(i){var c=function(n,t){return{id:n["@Id"],title:n["@Title"],url:(n["#cdata"]||"").replace(/{page}/g,t),category:n["@Category"],cssClass:n["@CssClass"],order:parseInt(n["@Order"]),siteId:n["@SiteId"],webId:n["@WebId"],listId:n["@ListId"],itemId:n["@ItemId"],external:n["@External"]==="True",visible:n["@Visible"]==="True",active:n["@Active"]==="True",seprator:n["@Separator"]==="True"}},a=t.currentWebUrl(),l=a+window.location.href.split(a)[1],v=!1,r,u,y,e,s,o,h,p,w;for(r in i.Nodes){u=i.Nodes[r].NavLink;u.length||(u=[u]);for(y in u)for(e=u[y],s=0;s<f.length;s++)o=f[s],o.provider===r&&(r!=="Workspaces"?o.registerLink(c(e,l)):(h=window.epmLiveNavigation.workspaceTree(),h.trackChanges(),p=e["@Title"],v?o.registerWorkspace(c(e,l),h):(o.registerLink(c(e,l)),p==="All Workspaces"&&(v=!0,n("#epm-nav-sub-workspaces-static-links").remove().insertBefore("#EPMNavWorkspacesTree"))),h.commitChanges()));r==="Workspaces"?(window.epmLiveNavigation.resetWorkspaceTree=function(){var n=window.epmLiveNavigation.workspaceTree(),r,t;for(n.trackChanges(),r=n.get_allNodes(),t=0;t<r.length;t++)r[t].set_expanded(!1);var u=function(t){var r=n.findNodeByValue(t),i;r&&r!=n&&(i=r.get_parent(),i===n||i.get_expanded()||(i.set_expanded(!0),u(i.get_value())))},f=window.epmLiveNavigation.currentWebId,i=n.findNodeByValue(f);i&&(i.get_parent()!==n?u(f):i.set_expanded(!0),i.set_selected(!0));n.commitChanges()},w=window.epmLiveNavigation.workspaceTree(),n("a.rtIn").each(function(){var t=n(this),i=t.parent(),r;i.append('<div id="'+w.findNodeByText(t.text()).get_value()+'" class="epm-nav-ws-node"><\/div>');t.remove();r=t.text();t.text("");t.append("<span>"+r+"<\/span>");i.find(".epm-nav-ws-node").append(t)}),window.epmLiveNavigation.resetWorkspaceTree(),n("#EPMNavWorkspacesTree").fadeIn(300)):r==="Applications"?n(n("#epm-nav-sub-new-static-links").find(".epm-nav-sub-header").get(0)).attr("style","padding-top: 0px !important"):r==="Favorites"&&n(n("#epm-nav-sub-favorites-static-links").find(".epm-nav-sub-header").get(0)).attr("style","padding-top: 0px !important");window.SP.SOD.notifyScriptLoadedAndExecuteWaitingJobs("EPMLiveNavigation_"+r);r!=="Settings"&&b(r)}}function wt(){for(var t=[],r,u,n=0;n<f.length;n++)r=f[n],r.selected()||(u=r.provider,u&&t.push(u));t.length>0&&i.execute("GetNavigationLinks",t.join(),function(n){ft(n);vt()},function(n){console.log(n)})}function et(){var n=null;window.epmLiveNavigation&&(n=window.epmLiveNavigation.staticProvider);n?ft(t.parseJson(e.decode(n))):window.setTimeout(function(){et()},1)}function bt(){n("#epm-nav-top").find("[data-role='top-nav-node']").each(function(){f.push(new st(this))})}var d=300,g="epm-nav-node",nt="epm-nav-node-hover",v="epm-nav-node-opened",o="epm-nav-node-selected",s="epm-nav-node-expanded",h="epm-nav-node-collapsed",tt="epmnav-selected-tlnode",y="epmnav-selected-link",c="epmnav-expand-state",p="epmnav-pin-state",l={expires:365,path:"/"},u=n("#epm-nav-sub"),f=[],st=function(t){var e={},c=t,i=n(t),r=n("#epm-nav-sub-"+i.data("id")),s=c.id,it=i.data("linkprovider"),a=function(){return i.parent().hasClass(o)},rt=function(){return i.parent().hasClass(v)},w=function(n){n?i.parent().addClass(o):i.parent().removeClass(o)},b=function(){r.hide();i.parent().removeClass(v)},k=function(){u.is(":visible")&&u.hide("slide",{direction:"left"},d);b()},ut=function(n,t){var i=new window.Telerik.Web.UI.RadTreeNode,r=t;n.category&&(r=t.findNodeByValue(n.category)||r);i.set_text(n.title);i.set_value(n.webId);n.active?i.set_navigateUrl(n.url):i.set_navigateUrl("javascript:;");window.epmLiveNavigation.wsTeamDict=window.epmLiveNavigation.wsTeamDict||{};window.epmLiveNavigation.wsTeamDict[n.webId]=n.itemId;r.get_nodes().add(i)},ft=function(n){n.seprator?ht(n.category):n.url.toLowerCase()==="header"?(h(n.category),ot(n)):n.url.toLowerCase()==="placeholder"?(h(n.category),et(n)):(h(n.category),st(n))},et=function(n){var t=n.category,i;t||(t="__STATIC__");i='<li class="epm-nav-sub-placeholder">'+n.title+"<\/li>";e[t].$el.append(i)},ot=function(n){var t=n.category,u,i;t||(t="__STATIC__");u="epm-nav-sub-header";r.find("li.epm-nav-section-header").length===0&&(u="epm-nav-section-header");i='<li class="'+u+'">'+n.title+"<\/li>";e[t].$el.append(i);i='<li class="epm-nav-sub-header-bottom"><\/li>';e[t].$el.append(i)},st=function(t){var r=t.category,s,h,f,c,i,a,v,w,p;for(r||(r="__STATIC__"),s=!1,h=t.cssClass.split(" "),f=0;f<h.length;f++)if(h[f]==="epm-nav-button"){s=!0;t.cssClass=t.cssClass.replace(/epm-nav-button/g,"");break}c="";t.cssClass&&(c='<span class="epm-nav-icon '+t.cssClass+'"><\/span>');i="epm-nav-node epm-nav-trans";a=e[r].$el.parent().get(0).id;(a==="epm-nav-sub-settings"||a==="epm-nav-sub-workplace")&&(i="epm-nav-node");s&&(i=i+" epm-nav-button",i=i.replace(/epm-nav-trans/g,""));v="";t.external&&(v=' target="_blank"');w='<li id="'+t.id+'" class="'+i+'" style="display:none;">'+c+'<a id="epm-nav-link-'+t.id+'" href="'+t.url+'" data-siteid="'+t.siteId+'" data-webid="'+t.webId+'" data-listid="'+t.listId+'" data-itemid="'+t.itemId+'"'+v+"><span>"+t.title+"<\/span><\/a><\/li>";e[r].$el.append(w);p=n("#"+t.id);t.visible&&p.show();p.find("a").click(function(){var t=n(this),i=t.parent();i.hasClass("epm-nav-button")||(u.find("a").each(function(){n(this).parent().removeClass(o)}),i.addClass(o),n.cookie(y,JSON.stringify({id:t.get(0).id,url:t.attr("href")}),l))})},ht=function(t){var i='<div class="epm-nav-sub-sep"><\/div>';t?n("#"+g(t)).append(i):r.append(i)},h=function(t){if(t||(t="__STATIC__"),!e[t]){var i=g(t),u="epm-nav-node-expanded";t==="__STATIC__"&&(u="epm-nav-node-static");t!=="__STATIC__"&&r.append('<div id="'+i+'" class="epm-nav-node epm-nav-node-root epm-nav-cat"><span class="'+u+'">&nbsp;<\/span><span class="epm-nav-cat-title">'+t+"<\/span><\/div>");r.append('<ul id="'+i+'-links" class="epm-nav-links '+u+'"><\/ul>');e[t]={id:i,$el:n("#"+i+"-links")}}},g=function(n){return r.get(0).id+"-"+n.toLowerCase().replace(/ /g,"-").replace(/_/g,"").replace(/[^\w-]+/g,"").replace(/--/g,"-")},ct=function(){r.fadeIn(300);i.parent().addClass(v)},nt=function(){ct();u.is(":visible")||u.show("slide",{direction:"left"},d)};return i.click(function(){var i,t;if(a())rt()&&n.cookie(p)==="unpinned"?k():nt();else{for(i in f)t=f[i],t.id!==s&&t.selected()&&(t.select(!1),t.close());w(!0);nt();n.cookie(tt,s,l)}}),{id:s,provider:it,selected:a,select:w,close:b,closeNav:k,registerLink:ft,registerWorkspace:ut,el:c,$el:i,$menu:r}},ot;return window.epmLiveNavigation.removeLink=function(n){var t=u.find("#epm-nav-link-"+n.id);r.handleContextualCommand(n.id,t.data("webid"),t.data("listid"),t.data("itemid"),"nav:remove","98")},window.epmLiveNavigation.registerLink=function(t){var r,e,o,i;if(t){switch(t.kind){case 0:case 1:r="Favorites";break;case 2:case 3:r="Workspaces"}if(r)for(e=0;e<f.length;e++)if(o=f[e],o.provider===r){if(t.kind!==3&&(t.cssClass="epm-nav-sortable "+t.cssClass),o.registerLink(t),i=u.find("#"+t.id),t.kind>-1&&t.kind<3){if(t.kind===0||t.kind===2)try{i.remove().insertBefore(n(n("#epm-nav-sub-"+r.toLowerCase()+"-static-links").find(".epm-nav-sub-header").get(1)))}catch(s){}t.kind!==2?window.epmLiveNavigation.addFavoritesMenu(i):window.epmLiveNavigation.addFavoriteWSMenu(i)}t.kind!==3&&(i.addClass("epm-nav-sortable"),window.epmLiveNavigation.addDragger(i));i.fadeIn(300);break}}},ot=function(){bt();et();w(n.cookie(p)||"pinned");b();lt();pt();ExecuteOrDelayUntilScriptLoaded(wt,"EPMLive.js")},{init:ot,expandProviderNodes:b}}();r.init();var f=function(){var t=function(t,r){var f,h;r=r||[];var u=n(t.find(".epm-nav-contextual-menu").get(0)),o=function(i,f){var v=function(n){switch(n.toLowerCase()){case"nav:remove":case"nav:addtofav":return"icon-star-6";case"view":return"icon-info";case"edit":return"icon-pencil-2";case"delete":return"icon-close-3";case"approve":return"icon-thumbs-up-4";case"comments":return"icon-bubble-dots";case"buildteam":return"icon-user-plus-3";case"workspace":return"icon-tree-2";default:return"epm-nav-cm-blank"}},l=t.get(0).id,a,h,o,c;i.length&&i.push({title:"--SEP--"});for(a in r)i.push(r[a]);for(t.append('<ul class="epm-nav-contextual-menu"><\/ul>'),u=n(t.find(".epm-nav-contextual-menu").get(0)),h=0;h<i.length;h++){if(o=i[h],c=f.data("webid"),!c||c==="undefined")try{c=f.parent().get(0).id}catch(y){}o.title==="--SEP--"?h!==i.length-1&&u.append('<li class="seprator"><\/li>'):u.append('<li><span class="epm-nav-cm-icon '+v(o.command)+'">&nbsp;<\/span><a href="javascript:epmLiveNavigation.handleContextualCommand(\''+l+"','"+c+"','"+f.data("listid")+"','"+f.data("itemid")+"','"+o.command+"','"+o.kind+'\');" style="width: 136px !important;">'+o.title+"<\/a><\/li>")}u.hover(function(){window.epmNavHoveredNode=l});n(".epm-nav-node, .epm-nav-ws-node").hover(function(){var n=this.id;window.epmNavHoveredNode=n;n!==l&&window.setTimeout(function(){window.epmNavHoveredNode===n&&e()},200)});n(".epm-nav-links, #EPMNavWorkspacesTree").hover(function(){},function(){window.epmNavHoveredNode=null;window.setTimeout(function(){window.epmNavHoveredNode===null&&e()},200)});n(document).on("click",".epm-nav-dragger",function(){e()});s()},c=function(){u.fadeIn(200)},e=function(){u.fadeOut(200)},s=function(){u.is(":visible")?e():c()};t.find(".epm-nav-contextual-menu").length===0?(f=n(t.find("a").get(0)),h="<Request><Params><SiteId>"+f.data("siteid")+"<\/SiteId><WebId>"+f.data("webid")+"<\/WebId><ListId>"+f.data("listid")+"<\/ListId><ItemId>"+f.data("itemid")+"<\/ItemId><\/Params><\/Request>",i.execute("GetContextualMenuItems",h,function(n){var u=[],t=n.Items.Item,r,i;if(t)for(t.length||(t=[t]),r=0;r<t.length;r++)i=t[r],u.push({title:i["@Title"],command:i["@Command"],kind:i["@Kind"],imgUrl:i["@ImageUrl"]});o(u,f)},function(){o([],f)})):s()};return{setupMenu:t}}(),o=function(){var t=function(){var t=function(t){t.find(".epm-nav-cat").each(function(){var t=n(n(this).find("span").get(0));t.removeClass("epm-nav-node-expanded");t.addClass("epm-nav-node-collapsed")});t.find(".epm-nav-links").each(function(){var t=n(this);t.hasClass("epm-nav-node-static")||(t.removeClass("epm-nav-node-expanded"),t.addClass("epm-nav-node-collapsed"))})};return{collapseAll:t}}(),i=n("#epm-nav-sub-settings");t.collapseAll(i);r.expandProviderNodes("Settings")},s=function(){var r=function(){window.epmLiveNavigation.addDragger=function(t){t.prepend('<span class="epm-nav-dragger">&nbsp;<\/span>');t.hover(function(){n(n(this).find(".epm-nav-dragger").get(0)).css("visibility","visible")},function(){n(n(this).find(".epm-nav-dragger").get(0)).css("visibility","hidden")})};window.epmLiveNavigation.addFavoritesMenu=function(t){t.append('<span class="epm-menu-btn"><span class="icon-ellipsis-horizontal"><\/span><\/span>');n(t.find(".epm-menu-btn").get(0)).click(function(){f.setupMenu(t,[{title:"Remove",command:"nav:remove",kind:"98"}])})};var t=function(t){var r=[],u=0;t.find(".epm-nav-node").each(function(){r.push(n(this).get(0).id+":"+ ++u)});r.length&&i.execute("ReorderLinks",r.join(),function(){},function(n){console.log(n)})},r=function(n){window.epmLiveNavigation.addDragger(n)},u=function(n){window.epmLiveNavigation.addFavoritesMenu(n)};return{resetOrder:t,addDragger:r,addMenu:u}}(),t=n("#epm-nav-sub-favorites-static-links");t.find(".epm-nav-sortable").each(function(){var t=n(this).parent();t.addClass("epm-nav-sortable");n(t.find("a").get(0)).attr("style","width:115px !important;");r.addDragger(t);r.addMenu(t)});try{t.sortable({items:"li.epm-nav-sortable",placeholder:"epm-nav-drag-placeholder",update:function(){r.resetOrder(t)}});t.disableSelection()}catch(u){}},h=function(){var r=function(){var t=function(n,t){n.index()<t&&i(n)},i=function(t){t.append('<span class="epm-menu-btn"><span class="icon-plus-2"><\/span><\/span>');n(t.find("a").get(0)).attr("style","width:115px !important;");n(t.find(".epm-menu-btn").get(0)).click(function(){var i=n(t.find("a").get(0));window.epmLiveNavigation.handleContextualCommand(null,i.data("webid"),i.data("listid"),null,"nav:add",0)})};return{addMenu:t}}(),t=n("#epm-nav-sub-recent-static-links"),i;t.find(".epm-nav-sub-header").each(function(){var t=n(this),r=t.text(),u=t.index();r==="Recent Items"&&(i=u)});t.find(".epm-nav-node").each(function(){r.addMenu(n(this),i)})},c=function(){var t=function(){window.epmLiveNavigation.addFavoriteWSMenu=function(t){t.append('<span class="epm-menu-btn"><span class="icon-ellipsis-horizontal"><\/span><\/span>');n(t.find(".epm-menu-btn").get(0)).click(function(){var u=t.get(0).id,i=[],r;t.hasClass("epm-nav-ws-node")?(r=!1,n("#epm-nav-sub-workspaces-static-links").find("a").each(function(){n(this).data("webid")===u&&(r=!0)}),r?i.push({title:"Remove",command:"nav:remove",kind:98}):i.push({title:"Add",command:"nav:addToFav"})):i.push({title:"Remove",command:"nav:remove",kind:98});i.push({title:"Manage team",command:"nav:team",kind:6});f.setupMenu(t,i)})};var u=function(t){var r=[],u=0;t.find("li.epm-nav-sortable").each(function(){r.push(n(this).get(0).id+":"+ ++u)});r.length&&i.execute("ReorderLinks",r.join(),function(){},function(n){console.log(n)})},e=function(t){t.prepend('<span class="epm-nav-dragger">&nbsp;<\/span>');t.hover(function(){n(n(this).find(".epm-nav-dragger").get(0)).css("visibility","visible")},function(){n(n(this).find(".epm-nav-dragger").get(0)).css("visibility","hidden")})},o=function(n){window.epmLiveNavigation.addFavoriteWSMenu(n)},s=function(){window.epmLiveNavigation.resetWSNodeWidth=function(){n("a.rtIn").each(function(){var t=n(this),o=n(t.find("span").get(0)),r=15,u=o.width();if(u){var f=t.offset().left-50,s=u+f,e=180,i=e-f-r;t.data("originalwidth",t.width());t.data("newwidth",i);s>e-r?t.width(i):t.parent().width(i)}})};window.epmLiveNavigation.resetWSNodeWidth()},h=function(){var i=n("#EPMNavWSTSearch");i.val("");i.bindWithDelay("keyup",function(){var i=n(this).val().trim();i?i.length>1?c(i.toLowerCase()):t():t()},200)},c=function(n){for(var f=window.epmLiveNavigation.workspaceTree().get_allNodes(),t,u,i=0;i<f.length;i++)t=f[i],u=t.get_text().trim(),u&&u.toLowerCase().indexOf(n)!==-1?(r(t),t.set_visible(!0)):t.set_visible(!1)},t=function(){for(var t=window.epmLiveNavigation.workspaceTree().get_allNodes(),n=0;n<t.length;n++)t[n].set_visible(!0);window.epmLiveNavigation.resetWorkspaceTree()},r=function(n){var t=n.get_parent();t&&t!==window.epmLiveNavigation.workspaceTree()&&(t.set_visible(!0),t.set_expanded(!0),r(t))};return{resetOrder:u,addDragger:e,addMenu:o,initializeSearch:h,configureNodeWidth:s}}(),r=n("#epm-nav-sub-workspaces-static-links");r.find(".epm-nav-sortable").each(function(){var i=n(this).parent();i.addClass("epm-nav-sortable");n(i.find("a").get(0)).attr("style","width:125px !important; position: relative; top: 2px;");t.addDragger(i);t.addMenu(i)});try{r.sortable({items:"li.epm-nav-sortable",placeholder:"epm-nav-drag-placeholder",update:function(){t.resetOrder(r)}});r.disableSelection()}catch(u){}t.configureNodeWidth();t.initializeSearch();n("#EPMNavWorkspacesTree").find("a").each(function(){t.addMenu(n(this).parent())})};ExecuteOrDelayUntilScriptLoaded(o,"EPMLiveNavigation_Settings");ExecuteOrDelayUntilScriptLoaded(s,"EPMLiveNavigation_Favorites");ExecuteOrDelayUntilScriptLoaded(c,"EPMLiveNavigation_Workspaces");ExecuteOrDelayUntilScriptLoaded(h,"EPMLiveNavigation_RecentItems")})}function t(){ExecuteOrDelayUntilScriptLoaded(n,"EPMLiveNavigation")}ExecuteOrDelayUntilScriptLoaded(t,"jquery.min.js")})();
//# sourceMappingURL=EPMLive.Navigation.min.js.map