(function(){"use strict";function n(){$(function(){var $=window.jQuery,$$=function(){var n=function(){return window.epmLiveNavigation.currentWebUrl},t=function(xml){return eval("("+window.xml2json($.parseXML(xml),"")+")")},i=function(n){return n["@Status"]==0};return{currentWebUrl:n,parseJson:t,responseIsSuccess:i}}(),r=function(){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t=function(t){var i="",o,s,h="",c,f,r,e="",u=0;/[^A-Za-z0-9\+\/\=]/g.exec(t)&&console.log('There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, "+", "/",and "="\nExpect errors in decoding.');t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do c=n.indexOf(t.charAt(u++)),f=n.indexOf(t.charAt(u++)),r=n.indexOf(t.charAt(u++)),e=n.indexOf(t.charAt(u++)),o=c<<2|f>>4,s=(f&15)<<4|r>>2,h=(r&3)<<6|e,i=i+String.fromCharCode(o),r!=64&&(i=i+String.fromCharCode(s)),e!=64&&(i=i+String.fromCharCode(h)),o=s=h="",c=f=r=e="";while(u<t.length);return unescape(i)};return{decode:t}}(),epmLiveService=function(){var n=function(t,i,r,u){var f=$$.currentWebUrl();f?$.ajax({type:"POST",url:(f+"/_vti_bin/WorkEngine.asmx/Execute").replace(/\/\//g,"/"),data:"{ Function: '"+t+"', Dataxml: '"+i+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){if(n.d){var i=$$.parseJson(n.d),t=i.Result;$$.responseIsSuccess(t)?r(t):u(n)}else u(n)},error:function(n){u(n)}}):window.setTimeout(function(){n(t,i,r,u)},1)};return{execute:n}}(),t=$.cookie,i,n;$.cookie=function(n,i,r){if(n=n+"-u-"+window.epmLiveNavigation.currentUserId,t){if(!i)return t(n);t(n,i,r)}};i=function(){function nt(){for(var i,n=0;n<t.length;n++)if(i=t[n],i.selected()){i.closeNav();break}}function a(t,i){var f=["s4-ribbonrow","s4-workspace"],e,r,u;for(e in f)f.hasOwnProperty(e)&&(r=$("#"+f[e]),r.removeClass("epm-nav-pinned"),r.removeClass("epm-nav-unpinned"),r.addClass("epm-nav-"+t));u=$("#epm-nav-pin");u.removeClass("epm-nav-pin-pinned");u.removeClass("epm-nav-pin-unpinned");u.addClass("epm-nav-pin-"+t);t==="unpinned"&&nt();n.data("pinstate",t);i&&$.cookie(l,t,o)}function ft(){var t="epm-nav-top-ql",n;try{n=$.parseJSON($.cookie(g));n.webUrl===$$.currentWebUrl()&&(t=n.id)}catch(i){}return t.replace("epm-nav-top-","epm-nav-sub-")}function s(n){return $("#"+n).find(".epm-nav-sub-menu").find("div[id^=E]")}function et(){var t=!1,r=$.parseJSON($.cookie(c)),l,a,f,e,o,v,y,u,h,p;if(r)if(r.id)l=$(n.find("#"+r.id).get(0)),l.length>0&&(a=l.parent(),f=a.parent().get(0).id,f!=="epm-nav-sub-favorites-static-links"&&f!=="epm-nav-sub-recent-static-links"&&f!=="epm-nav-sub-new-static-links"&&(a.addClass(i),t=!0));else if(e=r.index,o=r.uri,window.location.href.indexOf(o)!==-1)if(v=$("#"+ft()),e&&e!==-1){for(y=s(v.parent().attr("id")),u=0;u<y.length;u++)if(u===e){$(y[u]).find('a[href="'+o+'"]:first').parents("table").addClass(i);t=!0;break}}else v.find('a[href="'+o+'"]:first').parents("table").addClass(i),t=!0;h=escape(unescape(window.location.href)).toLowerCase();t&&(p=$(".epm-nav-node-selected"),p.find("a").each(function(){var n=escape(unescape(this.href)).toLowerCase();h.indexOf(n)===-1&&(p.removeClass(i),t=!1)}));t||($("td.epm-nav-node").each(function(){t||$(this).find("a").each(function(){if(!t){var n=$(this),r=escape(unescape(n.get(0).href)).toLowerCase();h.indexOf(r)!==-1&&(n.parents("table").addClass(i),t=!0)}})}),t||$("#epm-nav-sub-workplace").find("a").each(function(){if(!t){var n=$(this),r=escape(unescape(n.get(0).href)).toLowerCase();h.indexOf(r)!==-1&&(n.parents("li").addClass(i),t=!0)}}))}function ot(n){var t={};n.find(".epm-nav-cat").each(function(){var n=$(this);t[n.text()]=$(n.find("span")[0]).hasClass(u)});tt(n.get(0).id,t)}function tt(n,t){var i=$.parseJSON($.cookie(e))||{};i[n]=t;$.cookie(e,JSON.stringify(i),o)}function v(n){var p=$.parseJSON($.cookie(e)),i,r,h,f,c,o,l,a,v;if(p){if(i="epm-nav-sub-ql",n)for(r=0;r<t.length;r++)if(h=t[r],h.provider===n){i=h.id.replace("epm-nav-top-","epm-nav-sub-");break}if(f=p[i],f)if(i==="epm-nav-sub-ql")for(c=s("epm-nav-sub-ql"),o=0;o<c.length;o++)l=c[o],a=l.id.replace("Nodes",""),f[$("#"+a.replace("EPMLiveNavn","EPMLiveNavt")).text()]||TreeView_ToggleNode(window.EPMLiveNav_Data,0,document.getElementById(a)," ",document.getElementById(l.id));else v=$("#"+i).find(".epm-nav-cat"),i==="epm-nav-sub-settings"&&v.each(function(){y($(this))}),v.each(function(){var n=$(this),i=n.text(),t=f[i];$(n.find("span")[0]).hasClass(u)?t||y(n):t&&it(n)})}}function it(n){var r=n.get(0).id,t=$(n.find("span")[0]),i=$("#"+r+"-links");t.removeClass(f);t.addClass(u);i.removeClass(f);i.addClass(u)}function y(n){var r=n.get(0).id,t=$(n.find("span")[0]),i=$("#"+r+"-links");t.removeClass(u);t.addClass(f);i.removeClass(u);i.addClass(f)}function st(){var n=function(){$("li.epm-nav-node").find("a").each(function(){var n,t,i;if(window.epmLiveNavigation.stopAddingTooltips)return window.epmLiveNavigation.stopAddingTooltips=!1,!1;n=$(this);n.attr("title")||(t=n.find("span"),t&&($.browser.msie?(i=n.clone().css({display:"inline",width:"auto",visibility:"hidden"}).appendTo("body"),i.width()+t.offset().left+15>n.width()&&n.attr("title",t.text()),i.remove()):n.width()<t.width()&&n.attr("title",t.text())))})};$(".epm-nav-cat").click(function(){var n=$(this),t=$(n.find("span")[0]);t.hasClass(f)?it(n):y(n);ot(n.parent())});$("#epm-nav-top li").click(function(){window.epmLiveNavigation.stopAddingTooltips=!0;window.setTimeout(function(){n()},1e3)});n()}function ht(id,webId,listId,itemId,command,kind,callBackFunction){var removeLink=function(n,t){var i=function(n,t){var r=$("#"+n),i=r.parent();r.fadeOut(300,function(){var n,u,f,e;if(r.remove(),n=i.get(0).id,n==="epm-nav-sub-workspaces-static-links")i.find("a").length===1&&(u=!1,i.find("li").each(function(){$(this).text()==="No favorite workspaces"&&(u=!0)}),u||$('<li class="epm-nav-sub-placeholder">No favorite workspaces<\/li>').insertAfter($(i.find(".epm-nav-sub-header-bottom").get(1))));else if(n==="epm-nav-sub-favorites-static-links"){var o=!1,s=!1,h=0;i.find("li").each(function(){var n=$(this);n.text()==="Items"&&(h=n.index())});i.find("li").each(function(){var n=$(this);n.hasClass("epm-nav-node")&&(n.index()>h?o=!0:s=!0)});s||(f=!1,i.find("li").each(function(){$(this).text()==="No pages"&&(f=!0)}),f||$('<li class="epm-nav-sub-placeholder">No pages<\/li>').insertAfter($(i.find(".epm-nav-sub-header-bottom").get(1))));o||(e=!1,i.find("li").each(function(){$(this).text()==="No items"&&(e=!0)}),e||(i.get(0).innerHTML+='<li class="epm-nav-sub-placeholder">No items<\/li>'))}t&&(t==="RI"?(toastr.options={closeButton:!1,debug:!1,positionClass:"toast-top-right",onclick:null,showDuration:300,hideDuration:1e3,timeOut:5e3,extendedTimeOut:1e3,showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.success("An existing item has been removed from your favorites list.")):SP.UI.Notify.removeNotification(t))})};epmLiveService.execute("RemoveNavigationLink",n,function(){i(n,t)},function(){i(n,t)})},url=window.epmLiveNavigation.currentWebUrl,gaUrl=(url+"/_layouts/15/epmlive/gridaction.aspx?webid="+webId+"&listid="+listId+"&id="+itemId+"&").replace(/\/\//g,"/"),rpUrl=(url+"/_layouts/15/epmlive/redirectionproxy.aspx?webid="+webId+"&listid="+listId+"&id="+itemId+"&").replace(/\/\//g,"/"),redirectUrl="",info,loadWSCreationDialog,isResImportRunning,isSecRunning,idInfo,fKind,$a,notify,nId,options;switch(command){case"nav:add":redirectUrl=rpUrl+"action=new";break;case"nav:team":var wId="",lId="",iId="";if(itemId!=="undefined")try{info=window.epmLiveNavigation.wsTeamDict[webId].split(".");info[2]!=="-1"&&(wId=info[0],lId=info[1],iId=info[2])}catch(e){}redirectUrl=(url+"/_layouts/15/epmlive/gridaction.aspx?").replace(/\/\//g,"/")+"action=buildteam&webid="+(wId||webId);iId&&(redirectUrl=redirectUrl+"&listid="+lId+"&id="+iId)}if(!redirectUrl&&command)if(command.indexOf("epkcommand:")!==-1)redirectUrl=gaUrl+"action=epkcommand&subaction="+command.split(":")[1];else{if(command==="createworkspace"){loadWSCreationDialog=function(){window.CreateEPMLiveWorkspace?window.CreateEPMLiveWorkspace(listId,itemId):window.setTimeout(function(){loadWSCreationDialog()},1)};loadWSCreationDialog();return}redirectUrl=gaUrl+"action="+command}if(redirectUrl&&(redirectUrl=redirectUrl.split("#")[0]),command==="view"||command==="edit"||command==="gotoplanner"||command==="GoToTaskPlanner"){var page="",wUrl=$$.currentWebUrl(),urlParts=window.location.href.split("?");page=wUrl==="/"?urlParts[0]:wUrl+urlParts[0].split(escape(wUrl))[1];page=escape(page);redirectUrl+="&source="+page}switch(kind+""){case"-1":return command=="delete"?confirm("Are you sure you want to send the item(s) to the Recycle Bin?")&&(nId=SP.UI.Notify.addNotification("Deleting Item...",!0,"",null),$.get(redirectUrl).always(function(){SP.UI.Notify.removeNotification(nId);callBackFunction!=""&&eval(callBackFunction+"("+id+")")})):(options={url:redirectUrl,showMaximized:!1,dialogReturnValueCallback:function(n){n==1&&KanbanClient.loadKanBanPlanners()}},SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",options)),!0;case"0":return OpenCreateWebPageDialog(redirectUrl),!0;case"1":return location.href=redirectUrl,!0;case"2":return window.open(redirectUrl+"&IsDlg=1","","height=100, width=200, toolbar=no, menubar=no, scrollbars=yes, resizable=yes,location=no, directories=no, status=yes"),!0;case"3":return window.open(redirectUrl+"&IsDlg=1","","width="+screen.width+",height="+screen.height+",top=0,left=0, toolbar=no, menubar=no, scrollbars=yes, resizable=yes,location=no, directories=no, status=yes"),!0;case"5":return callBackFunction!=""?SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",{url:redirectUrl,width:700,height:500,dialogReturnValueCallback:eval(callBackFunction)}):SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",{url:redirectUrl,width:700,height:500}),!0;case"6":return isResImportRunning=!1,isSecRunning=!1,command=="epkcommand:rpeditor"?isResImportRunning=window.epmLiveNavigation.isImportResourceRunning():command=="buildteam"?isSecRunning=window.epmLiveNavigation.isSecurityJobRunning(window.epmLive.currentWebUrl,listId,itemId):command=="nav:team"&&window.epmLiveNavigation.wsTeamDict[webId]!=""&&(idInfo=window.epmLiveNavigation.wsTeamDict[webId].split("."),isSecRunning=window.epmLiveNavigation.isSecurityJobRunning(window.epmLive.currentWebUrl,idInfo[1],idInfo[2])),isResImportRunning||isSecRunning?(isResImportRunning?alert("The Resource Planner cannot be opened because there is an active resource import job running."):isSecRunning&&alert("The team cannot be edited because the security queue job has not completed. This should be completed in less than a minute or so - please try again."),!1):(callBackFunction!=""?SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",{url:redirectUrl,showMaximized:!0,dialogReturnValueCallback:eval(callBackFunction)}):SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",{url:redirectUrl,showMaximized:!0}),!0);case"98":if(command!=="nav:addToFav")command!=="nav:remove"&&command!=="nav:removeFavWS"&&command!=="nav:removeFavRI"?$.get(redirectUrl).always(function(){removeLink(id)}):(fKind=null,command==="nav:removeFavWS"?$("#epm-nav-sub-workspaces-static-links").find("a").each(function(){var n=$(this);n.data("webid")===webId&&(id=n.parent().get(0).id)}):command==="nav:removeFavRI"&&$("#epm-nav-sub-favorites-static-links").find("a").each(function(){var n=$(this);n.data("listid")===listId&&n.data("itemid")==itemId&&(id=n.parent().get(0).id,fKind="RI")}),removeLink(id,fKind),command==="nav:remove"&&($a=$("#"+id).find("a"),window.Analytics.turnOffFav({siteid:$a.data("siteid"),webid:$a.data("webid"),listid:$a.data("listid"),itemid:$a.data("itemid"),url:$a.get(0).href})));else{var $link=$($("#"+id).find("a").get(0)),title=$link.text(),webUrl=$link.attr("href"),_$$=window.epmLive;listId=listId==="undefined"?null:listId;itemId=itemId==="undefined"?null:itemId;var isItem=itemId===null?"False":"True",riFav=!1,data='<Data><Param key="SiteId">'+_$$.currentSiteId+'<\/Param><Param key="WebId">'+webId+'<\/Param><Param key="ListId">'+listId+'<\/Param><Param key="ListViewUrl"><\/Param><Param key="ListIconClass"><\/Param><Param key="ItemId">'+itemId+'<\/Param><Param key="FString">'+webUrl+'<\/Param><Param key="Type">4<\/Param><Param key="UserId">'+_$$.currentUserId+'<\/Param><Param key="Title">'+title+'<\/Param><Param key="FileIsNull"><\/Param><Param key="IsItem">'+isItem+"<\/Param><\/Data>",methodName="AddFavoritesWs",linkKind=3,icon=null;if($link.parent().parent().get(0).id==="epm-nav-sub-recent-static-links"){methodName="AddFavorites";linkKind=1;try{icon=$($link.parent().find("span").get(0)).attr("class").split(" ")[1]}catch(e){}data='<Data><Param key="SiteId">'+_$$.currentSiteId+'<\/Param><Param key="WebId">'+webId+'<\/Param><Param key="ListId">'+listId+'<\/Param><Param key="ListViewUrl"><\/Param><Param key="ListIconClass">'+icon+'<\/Param><Param key="ItemId">'+itemId+'<\/Param><Param key="FString"><\/Param><Param key="Type">2<\/Param><Param key="UserId">'+_$$.currentUserId+'<\/Param><Param key="Title">'+title+'<\/Param><Param key="FileIsNull"><\/Param><Param key="IsItem">True<\/Param><\/Data>';riFav=!0}notify=function(){riFav&&(toastr.options={closeButton:!1,debug:!1,positionClass:"toast-top-right",onclick:null,showDuration:300,hideDuration:1e3,timeOut:5e3,extendedTimeOut:1e3,showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.success("A new item has been added to your favorites list."))};id=(new Date).getTime()+"";epmLiveService.execute(methodName,data,function(){window.epmLiveNavigation.registerLink({id:id,title:title,url:webUrl,category:null,cssClass:icon,order:null,siteId:_$$.currentSiteId,webId:webId,listId:listId,itemId:itemId,external:!1,visible:!0,active:!0,seprator:!1,kind:linkKind});notify()},function(){window.epmLiveNavigation.registerLink({id:id,title:title,url:webUrl,category:null,cssClass:null,order:null,siteId:_$$.currentSiteId,webId:webId,listId:listId,itemId:itemId,external:!1,visible:!0,active:!0,seprator:!1,kind:linkKind});notify()})}break;case"99":confirm("Are you sure you want to send the item(s) to the Recycle Bin?")&&(nId=SP.UI.Notify.addNotification("Deleting Item...",!0,"",null),command!=="nav:remove"?$.get(redirectUrl,function(data){data=="General Error: You do not have permissions to delete users.\r\n"?(SP.UI.Notify.removeNotification(nId),SP.UI.Notify.addNotification("You do not have permission to delete Resources",!1,"",null)):data.startsWith("General Error:")?(SP.UI.Notify.removeNotification(nId),alert(data.replace("General Error: ",""))):(removeLink(id,nId),SP.UI.Notify.removeNotification(nId),callBackFunction!=""&&eval(callBackFunction+"("+id+")"))}):(removeLink(id,nId),SP.UI.Notify.removeNotification(nId),callBackFunction!=""&&eval(callBackFunction+"("+id+")")));break;default:callBackFunction!=""&&callBackFunction!="undefined"?(callBackFunction=eval(callBackFunction),options={url:redirectUrl,width:700,dialogReturnValueCallback:Function.createCallback(Function.createDelegate(null,callBackFunction),id)}):options={url:redirectUrl,width:700};SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",options)}}function ct(){var g=window.TreeView_HoverNode,it=window.TreeView_UnhoverNode,rt=window.TreeView_ToggleNode,l=0,u,a,f,t,r,w,v,p;$("td.epm-nav-node").find("a").each(function(){var n=$(this),t=n.offset().left;l===0?l=t:t>l&&n.width(112)});$("span#epm-nav-asoitems-info").on("shown.bs.tooltip",function(){var i=$(this),n=i.parent().find("div.tooltip"),t=n.offset();t.top-=25;n.remove();$("body").append(n);n.offset(t)});window.TreeView_HoverNode=function(n,t){var i=$(t);i.hasClass(k)?i.parent().parent().parent().addClass(d):g(n,t)};window.TreeView_UnhoverNode=function(n){var t=$(n);t.hasClass(k)?$(n).parent().parent().parent().removeClass(d):it(n)};window.TreeView_ToggleNode=function(n,t,i,r,u){var y=null,f=$.parseJSON($.cookie(e)),o,l,b,a,h;f&&(f=$.parseJSON($.cookie(e))["epm-nav-sub-ql"],f&&(y=f));var p=y||{},c=null,w=$(i).parents("div");for(o=0;o<w.length;o++)if(l=w[o],b=$(l),b.hasClass("epm-nav-sub")){for(c=l.id,a=s(c),h=0;h<a.length;h++){var k=a[h],v=$(k).is(":visible"),d=k.id.replace("Nodes","");d===i.id&&(v=!v);p[$("#"+d.replace("EPMLiveNavn","EPMLiveNavt")).text()]=v}break}tt(c,p);rt(n,t,i,r,u)};window.epmLiveNavigation.handleContextualCommand=function(n,t,i,r,u,f,e){ht(n,t,i,r,u,f,e)};$("td.epm-nav-node-root").click(function(){var t=$(this),n=t.parent().find("a").get(0).id;TreeView_ToggleNode(EPMLiveNav_Data,0,document.getElementById(n)," ",document.getElementById(n+"Nodes"))});u=["suiteBar","s4-ribbonrow","s4-workspace"];for(a in u)u.hasOwnProperty(a)&&$("#"+u[a]).click(function(){n.data("pinstate")==="unpinned"&&nt()});f=$("#epm-nav-pin");f.click(function(){window.epmLiveNavigation.togglePinned(!0)});n.hover(function(){f.show()},function(){f.hide()});try{n.slimScroll({height:n.height(),width:n.width(),alwaysVisible:!0})}catch(et){}t=$("#epm-nav").find(".slimScrollDiv");r=t.find(".slimScrollBar");r.hide();t.css("position","absolute");t.css("left","50px");n.css("left","0");n.css("top","0");r.css("z-index",1001);t.hover(function(){var n=!1;$(".epm-nav-sub").each(function(){var i=$(this);i.is(":visible")&&i.height()>=t.height()&&(n=!0)});n&&r.fadeIn(300)},function(){r.fadeOut(300)});$(window).resize(function(){var i=$("#epm-nav-top").height();t.height(i);n.height(i)});$("a.epm-nav-node").click(function(){var t=$(this),r,n,h;$("#epm-nav-sub-ql").find("a").each(function(){$(this).parent().parent().parent().parent().removeClass(i)});t.parent().parent().parent().parent().addClass(i);var u=-1,f=t.parents("div")[0],e=$(f).siblings("div");if(e)for(r=s($(e[0]).parent().parent().attr("id")),n=0;n<r.length;n++)h=r[n],h.id===f.id&&(u=n);$.cookie(c,JSON.stringify({index:u,uri:t.attr("href")}),o)});window.epmLiveNavigation.snWidth=n.width();v=function(){var n=window.epmLiveNavigation.workspaceTree();n?w=$("#"+n._element.id):window.setTimeout(function(){v()},1)};v();var h=n.width(),b=function(){var i,t;$("a.rtIn").each(function(){var n=$(this);n.attr("style","")});$(".epm-nav-ws-node").each(function(){$(this).attr("style","")});i=0;try{i=w.width()+40}catch(r){}t=0;h<i&&(t=i+5,n.stop().animate({width:t},300),n.parent().stop().animate({width:t},300));$(".epm-nav-ws-node").each(function(){var n=$(this),i=50+(t===0?h:t)-n.offset().left;n.attr("style","width:"+i+"px")});window.epmLiveNavigation.wsTreeExpanded=!0},y=function(){n.stop().animate({width:h},300);n.parent().stop().animate({width:h},300);$(".epm-nav-ws-node").each(function(){$(this).attr("style","")});window.epmLiveNavigation.resetWSNodeWidth();window.epmLiveNavigation.wsTreeExpanded=!1},ut=function(n){var r=(n.attr("class")||"").toLowerCase(),t,i;r.indexOf("plus")!==-1?(t=function(){(n.attr("class")||"").toLowerCase().indexOf("minus")!==-1?window.setTimeout(function(){b()},100):window.setTimeout(function(){t()},1)},t()):(i=function(){(n.attr("class")||"").toLowerCase().indexOf("plus")!==-1?window.setTimeout(function(){y()},100):window.setTimeout(function(){i()},1)},i())},ft=$("#epm-nav-sub-workspaces");$("#EPMNavWorkspacesTree").hover(function(){window.epmLiveNavigation.wsTreeExpanded||b()},function(){y()});n.hover(function(){},function(){ft.is(":visible")&&y()});p=function(){var n=$("a.rtIn");n.length?n.each(function(){var t=$(this).parent().parent().find("span"),n;t.length>1&&(n=$(t.get(1)),n&&(n.click(function(){ut($(this))}),n.hover(function(){window.epmLiveNavigation.wsNodeSelectorClass=$(this).attr("class")})))}):window.setTimeout(function(){p()},1)};p()}function p(n){var s,i,r,h,u,e,f,o,c,l;window.epmLiveNavigation.buildLink=function(n){var f=$$.currentWebUrl(),t=window.location.href,u=n.Url?n.Url["#cdata"]:"",i,e,r;return(u+"").toLowerCase().indexOf("/lists/")!==-1?(t=u.replace(/Source={page}&BackTo={page}/g,""),i=t.split("?"),i.length>1&&(i[1]||(t=i[0]))):(e=t.split("?"),r=f+e[0].split(escape(f))[1],r=escape(r),t=u.replace(/{page}/g,r)),{id:n["@Id"],title:n.Title["#cdata"],url:t,category:n["@Category"],cssClass:n["@CssClass"],order:parseInt(n["@Order"]),siteId:n["@SiteId"],webId:n["@WebId"],listId:n["@ListId"],itemId:n["@ItemId"],external:n["@External"]==="True",visible:n["@Visible"]==="True",active:n["@Active"]==="True",seprator:n["@Separator"]==="True"}};s=!1;for(i in n.Nodes)if(n.Nodes.hasOwnProperty(i)){r=n.Nodes[i].NavLink;r.length||(r=[r]);for(h in r)if(r.hasOwnProperty(h))for(u=r[h],e=0;e<t.length;e++)if(f=t[e],f.provider===i)if(i!=="Workspaces")f.registerLink(window.epmLiveNavigation.buildLink(u));else try{o=window.epmLiveNavigation.workspaceTree();o.trackChanges();c=u.Title["#cdata"];s?f.registerWorkspace(window.epmLiveNavigation.buildLink(u),o):(f.registerLink(window.epmLiveNavigation.buildLink(u)),c==="All Workspaces"&&(s=!0,$("#epm-nav-sub-workspaces-static-links").remove().insertBefore("#EPMNavWorkspacesTree")));o.commitChanges()}catch(a){}i==="Workspaces"?(window.epmLiveNavigation.resetWorkspaceTree=function(){var n,r,t;try{for(n=window.epmLiveNavigation.workspaceTree(),n.trackChanges(),r=n.get_allNodes(),t=0;t<r.length;t++)r[t].set_expanded(!1);var u=function(t){var r=n.findNodeByValue(t),i;r&&r!=n&&(i=r.get_parent(),i===n||i.get_expanded()||(i.set_expanded(!0),u(i.get_value())))},f=window.epmLiveNavigation.currentWebId,i=n.findNodeByValue(f);i&&(i.get_parent()!==n?u(f):i.set_expanded(!0),i.set_selected(!0));n.commitChanges()}catch(e){}},l=window.epmLiveNavigation.workspaceTree(),$("a.rtIn").each(function(){var n=$(this),t=n.parent(),i=n.text(),r=l.findNodeByText(i).get_value();t.append('<div id="'+r+'" class="epm-nav-ws-node"><\/div>');n.remove();n.text("");n.append("<span>"+i+"<\/span>");window.epmLiveNavigation.wsInfoDict[r].hasAccess||n.addClass("epm-nav-ws-disabled");t.find(".epm-nav-ws-node").append(n)}),window.epmLiveNavigation.resetWorkspaceTree(),$("#EPMNavWorkspacesTree").fadeIn(300)):i==="Applications"?$($("#epm-nav-sub-new-static-links").find(".epm-nav-sub-header").get(0)).attr("style","padding-top: 0px !important"):i==="Favorites"&&$($("#epm-nav-sub-favorites-static-links").find(".epm-nav-sub-header").get(0)).attr("style","padding-top: 0px !important");window.SP.SOD.notifyScriptLoadedAndExecuteWaitingJobs("EPMLiveNavigation_"+i);i!=="Settings"&&v(i)}$(".epm-app-btn").click(function(){document.location.href=$(this).data("url")})}function lt(){for(var u,n,i=[],r=0;r<t.length;r++)u=t[r],n=u.provider,n&&n!==window.epmLiveNavigation.selectedNode&&i.push(n);i.length>0&&epmLiveService.execute("GetNavigationLinks",i.join(),function(n){p(n);st()},function(n){console.log(n)})}function w(){var n=null,t;window.epmLiveNavigation&&(n=window.epmLiveNavigation.staticProvider);n!==null?n&&(t=$$.parseJson(r.decode(n)),t.Nodes.Workspaces?window.epmLiveNavigation.workspaceTree()?p(t):window.setTimeout(function(){w()},1):p(t)):window.setTimeout(function(){w()},1)}function at(){$("#epm-nav-top").find("[data-role='top-nav-node']").each(function(){t.push(new ut(this))})}var b=300,k="epm-nav-node",d="epm-nav-node-hover",h="epm-nav-node-opened",i="epm-nav-node-selected",u="epm-nav-node-expanded",f="epm-nav-node-collapsed",g="epmnav-selected-tlnode",c="epmnav-selected-link",e="epmnav-expand-state",l="epmnav-pin-state",o={expires:365,path:"/"},n=$("#epm-nav-sub"),t=[],ut=function(r){var e={},v=r,u=$(r),f=$("#epm-nav-sub-"+u.data("id")),s=v.id,tt=u.data("linkprovider"),y=function(){return u.parent().hasClass(i)},it=function(){return u.parent().hasClass(h)},p=function(n){n?u.parent().addClass(i):u.parent().removeClass(i)},w=function(){f.hide();u.parent().removeClass(h)},k=function(){n.is(":visible")&&n.hide("slide",{direction:"left"},b);w()},rt=function(n,t){var i=new window.Telerik.Web.UI.RadTreeNode,r=t,u,f,e;n.category&&(r=t.findNodeByValue(n.category)||r);i.set_text(n.title);i.set_value(n.webId);n.active?i.set_navigateUrl(n.url):i.set_navigateUrl("javascript:;");window.epmLiveNavigation.wsTeamDict=window.epmLiveNavigation.wsTeamDict||{};window.epmLiveNavigation.wsTeamDict[n.webId]=n.itemId;u=n.itemId.split(".");f="";try{f=u[1]}catch(o){}e="";try{e=u[2]}catch(o){}window.epmLiveNavigation.wsInfoDict=window.epmLiveNavigation.wsInfoDict||{};window.epmLiveNavigation.wsInfoDict[n.webId]={siteId:n.siteId,listId:f,itemId:e,hasAccess:n.active};r.get_nodes().add(i)},ut=function(n){n.seprator?st(n.category):n.url.toLowerCase()==="header"?(a(n.category),et(n)):n.url.toLowerCase()==="placeholder"?(a(n.category),ft(n)):(a(n.category),ot(n))},ft=function(n){var t=n.category,i;t||(t="__STATIC__");i='<li class="epm-nav-sub-placeholder">'+n.title+"<\/li>";e[t].$el.append(i)},et=function(n){var t=n.category,r,i;t||(t="__STATIC__");r="epm-nav-sub-header";f.find("li.epm-nav-section-header").length===0&&(r="epm-nav-section-header");i='<li class="'+r+'">'+n.title+"<\/li>";e[t].$el.append(i);i='<li class="epm-nav-sub-header-bottom"><\/li>';e[t].$el.append(i)},ot=function(t){var u=t.category,s,h,f,l,r,a,v,p,y;for(u||(u="__STATIC__"),s=!1,h=t.cssClass.split(" "),f=0;f<h.length;f++)if(h[f]==="epm-nav-button"){s=!0;t.cssClass=t.cssClass.replace(/epm-nav-button/g,"");break}l="";t.cssClass&&(l='<span class="epm-nav-icon '+t.cssClass+'"><\/span>');r="epm-nav-node epm-nav-trans";a=e[u].$el.parent().get(0).id;(a==="epm-nav-sub-settings"||a==="epm-nav-sub-workplace")&&(r="epm-nav-node");s&&(r=r+" epm-nav-button",r=r.replace(/epm-nav-trans/g,""));v="";t.external&&(v=' target="_blank"');p='<li id="'+t.id+'" class="'+r+'" style="display:none;">'+l+'<a id="epm-nav-link-'+t.id+'" href="'+t.url+'" data-siteid="'+t.siteId+'" data-webid="'+t.webId+'" data-listid="'+t.listId+'" data-itemid="'+t.itemId+'"'+v+"><span>"+t.title+"<\/span><\/a><\/li>";e[u].$el.append(p);y=$("#"+t.id);t.visible&&y.show();y.find("a").click(function(){var t=$(this),r=t.parent();if(!r.hasClass("epm-nav-button")){n.find("a").each(function(){$(this).parent().removeClass(i)});var f="",e="",u=r.parent().get(0).id;u!=="epm-nav-sub-favorites-static-links"&&u!=="epm-nav-sub-recent-static-links"&&u!=="epm-nav-sub-new-static-links"&&(r.addClass(i),f=t.attr("href"),e=t.get(0).id);$.cookie(c,JSON.stringify({id:e,url:f}),o)}})},st=function(n){var t='<div class="epm-nav-sub-sep"><\/div>';n?$("#"+d(n)).append(t):f.append(t)},a=function(n){if(n||(n="__STATIC__"),!e[n]){var t=d(n),i="epm-nav-node-expanded";n==="__STATIC__"&&(i="epm-nav-node-static");n!=="__STATIC__"&&f.append('<div id="'+t+'" class="epm-nav-node epm-nav-node-root epm-nav-cat"><span class="'+i+'">&nbsp;<\/span><span class="epm-nav-cat-title">'+n+"<\/span><\/div>");f.append('<ul id="'+t+'-links" class="epm-nav-links '+i+'"><\/ul>');e[n]={id:t,$el:$("#"+t+"-links")}}},d=function(n){return f.get(0).id+"-"+n.toLowerCase().replace(/ /g,"-").replace(/_/g,"").replace(/[^\w-]+/g,"").replace(/--/g,"-")},ht=function(){f.fadeIn(300);u.parent().addClass(h)},nt=function(){ht();n.is(":visible")||n.show("slide",{direction:"left"},b)};return u.click(function(){var i,n,r,u;if(y())it()&&$.cookie(l)==="unpinned"?k():nt();else{for(i in t)t.hasOwnProperty(i)&&(n=t[i],n.id!==s&&n.selected()&&(n.select(!1),n.close()));p(!0);nt();$.cookie(g,JSON.stringify({id:s,webUrl:$$.currentWebUrl()}),o);for(r in t)t.hasOwnProperty(r)&&(u=t[r],u.id!==s&&$("#"+u.id.replace("top","sub")).hide())}}),{id:s,provider:tt,selected:y,select:p,close:w,closeNav:k,registerLink:ut,registerWorkspace:rt,el:v,$el:u,$menu:f}},rt;return window.epmLiveNavigation.togglePinned=function(t){n.data("pinstate")==="pinned"?window.epmLiveNavigation.unpin(t):window.epmLiveNavigation.pin(t)},window.epmLiveNavigation.pin=function(n){a("pinned",n)},window.epmLiveNavigation.unpin=function(n){a("unpinned",n)},window.epmLiveNavigation.removeLink=function(t){var i=n.find("#epm-nav-link-"+t.id);window.epmLiveNavigation.handleContextualCommand(t.id,i.data("webid"),i.data("listid"),i.data("itemid"),"nav:remove","98")},window.epmLiveNavigation.registerLink=function(i){var u,f,e,r,o;if(i){switch(i.kind){case 0:case 1:u="Favorites";break;case 2:case 3:u="Workspaces"}if(u)if(i.kind!==3){for(f=0;f<t.length;f++)if(e=t[f],e.provider===u){if(i.cssClass="epm-nav-sortable "+i.cssClass,e.registerLink(i),r=n.find("#"+i.id),o=$("#epm-nav-sub-"+u.toLowerCase()+"-static-links"),o.find(".epm-nav-sub-placeholder").each(function(){var r=$(this),n=!1,t=r.text();i.kind===0&&t==="No pages"?n=!0:i.kind===1&&t==="No items"?n=!0:i.kind===2&&t==="No favorite workspaces"&&(n=!0);n&&r.remove()}),i.kind<2&&r.find("a").attr("style","width:115px !important;"),i.kind===0||i.kind===2)try{r.remove().insertBefore($(o.find(".epm-nav-sub-header").get(1)))}catch(s){}i.kind!==2?window.epmLiveNavigation.addFavoritesMenu(r):window.epmLiveNavigation.addFavoriteWSMenu(r);r.addClass("epm-nav-sortable");window.epmLiveNavigation.addDragger(r);r.fadeIn(300);break}}else epmLiveService.execute("GetNavigationLinks",u,function(i){var e=[],o=i.Nodes.Workspaces.NavLink,s,f,r,h;for(s in o)o.hasOwnProperty(s)&&(f=o[s],n.find("#"+f["@Id"]).length===0&&(r=f.Title["#cdata"],r!=="Workspaces"&&r!=="New Workspace"&&r!=="Favorite Workspaces"&&r!=="All Workspaces"&&(h=function(){var n=window.epmLiveNavigation.buildLink(f),l,o,a,r,v,i,y;if(window.epmLiveNavigation.buildLink){for(l=!1,i=0;i<e.length;i++)if(e[i]===n.title){l=!0;break}if(l){for(o=0;o<t.length;o++)if(a=t[o],a.provider===u){if(r=window.epmLiveNavigation.workspaceTree(),!r.findNodeByText(n.title)){r.trackChanges();a.registerWorkspace(n,r);r.commitChanges();$("a.rtIn").each(function(){var t=$(this),i=t.text(),u,f;i===n.title&&(u=t.parent(),u.append('<div id="'+r.findNodeByText(i).get_value()+'" class="epm-nav-ws-node"><\/div>'),t.remove(),t.text(""),t.append("<span>"+i+"<\/span>"),u.find(".epm-nav-ws-node").append(t),f=t.parent(),f.addClass("epm-nav-sortable"),t.attr("style","width:124px !important; position: relative; top: 2px;"),window.epmLiveNavigation.addFavoriteWSMenu(f))});var p="#"+n.id,s=[],w={},c,b=$(p).text();for($($(p).parents("ul")[0]).find("li").each(function(){var n=$(this),t=n.text();t!==b?(s.push(t),w[t]=n):c=n}),s.sort(),v=!1,i=0;i<s.length;i++)v||(y=s[i],y>b&&(c.insertBefore(w[y]),c.removeClass("rtLast"),$($(c.parents("ul")[0]).find("li:last")[0]).addClass("rtLast"),v=!0))}break}$("#epm-nav-nows-ph").remove();$("#EPMNavWorkspacesTree").fadeIn(300)}else n.cssClass&&(n.kind=2,n.category=null,window.epmLiveNavigation.registerLink(n)),e.push(n.title)}else window.setTimeout(function(){h()},1)},h())));try{$("#epm-nav-sub-workspaces a").length<3&&window.setTimeout(function(){window.epmLiveNavigation.registerLink({kind:3})},200)}catch(c){}},function(n){console.log(n)})}},window.epmLiveNavigation.showAssociatedItems=function(n){var t=function(n){SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",{url:n,showMaximized:!0})},i=function(n){var r=$$.currentWebUrl();r?$.ajax({type:"POST",url:(r+"/_layouts/15/epmlive/gridaction.aspx?action=linkeditemspost&listid="+n.listId+"&lookups="+n.lookup+"&field="+n.field+"&LookupFieldList="+n.listName).replace(/\/\//g,"/"),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){t(n.url)},error:function(){t(n.url)}}):window.setTimeout(function(){i(n)},1)};i(n)},window.epmLiveNavigation.createNewOpenDialog=function(n,t,i){var r={id:i,url:window.epmLive.currentWebUrl+"/_layouts/15/epmlive/redirectionproxy.aspx?action=gotolist&webid="+window.epmLive.currentWebId+"&listid="+i,name:t,icon:null},u={url:n,showMaximized:!1,dialogReturnValueCallback:function(n){n==1&&(window.epmLive.SocialStream_SE!=undefined||window.epmLive.SocialStream_SE!=null)&&window.epmLive.SocialStream_SE.toolbarManager.handleCreationAction(n,null,r)}};SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",u)},rt=function(){at();w();a($.cookie(l)||"pinned");v();et();ct();ExecuteOrDelayUntilScriptLoaded(lt,"EPMLive.js");window.SP.SOD.notifyScriptLoadedAndExecuteWaitingJobs("EPMLive.Navigation.Initialized")},{init:rt,expandProviderNodes:v}}();i.init();n=function(){var n=function(n,t,i,r,u){var v,p,w,b;t=t||[];var o=$(n.find("a").get(0)),e=o.data("itemid"),a=o.data("siteid"),s=o.data("webid"),c=o.data("listid"),y=n.get(0).id;try{e?e.indexOf(".")!==-1&&(p=e.split("."),s=p[0],c=p[1],e=p[2]):(v=window.epmLiveNavigation.wsInfoDict[y],v&&(a=v.siteId,s=y,c=v.listId,e=v.itemId))}catch(nt){}var h=(c||"").replace(/-/g,""),f=$("#menu"+h+e),k=function(n,o){var k=function(n){switch(n.toLowerCase()){case"nav:remove":case"nav:addtofav":case"nav:removefavws":case"nav:removefavri":return"icon-star-6";case"view":return"icon-info";case"edit":return"icon-pencil-2";case"delete":return"icon-close-3";case"approve":return"icon-thumbs-up-4";case"comments":return"icon-bubble-dots";case"buildteam":return"icon-user-plus-3";case"workspace":return"icon-tree-2";case"epkcommand:rpeditor":return"icon-users-5";case"perms":return"icon-key";case"createworkspace":return"icon-tree-2";case"epkcommand:costs":return"icon-coins";case"workflows":return"icon-loop-3";case"gotoplanner":return"fui-ext-project";default:return"epm-nav-cm-blank"}},b=y,p,v,a,w;n.length&&n.push({title:"--SEP--"});for(p in t)t.hasOwnProperty(p)&&n.push(t[p]);for(f=$("#menu"+h+e),$(f.find(".epm-nav-cm-loading").get(0)).remove(),v=0;v<n.length;v++){if(a=n[v],i&&(a.kind=0),r&&(a.kind=r),!s||s==="undefined")try{s=o.parent().get(0).id}catch(d){}a.title==="--SEP--"?v!==n.length-1&&f.append($('<li class="seprator"><\/li>').hide().fadeIn()):(w="",u&&(w=u[a.command]),f.append($('<li><span class="epm-nav-cm-icon '+k(a.command)+'">&nbsp;<\/span><a href="javascript:epmLiveNavigation.handleContextualCommand(\''+b+"','"+s+"','"+c+"','"+e+"','"+a.command+"','"+a.kind+"','"+w+'\');" style="width: 122px !important; display: inline-block;">'+a.title+"<\/a><\/li>").hide().fadeIn()),f.find("a").click(function(){l()}))}f.find("a").click(function(){var n=$(this);n.parent().find(".icon-star-6").length&&f.hover(function(){},function(){f.remove()})});f.hover(function(){window.epmNavHoveredNode=b});f.mouseleave(function(){window.epmNavHoveredNode=null;window.setTimeout(function(){window.epmNavHoveredNode==null&&l()},200)});$(".epm-nav-links, #EPMNavWorkspacesTree").hover(function(){},function(){window.epmNavHoveredNode=null;window.setTimeout(function(){window.epmNavHoveredNode===null&&l()},200)});$(document).on("click",".epm-nav-dragger",function(){l()});f.offset().top+f.height()>$(window).height()&&f.css("top",f.offset().top-f.height()-30);f.offset().left+f.width()>$(window).width()&&f.css("left",f.offset().left-f.width()-30)},d=function(){window.epmNavHoveredNode=null;f.css("top",n.offset().top+20);f.css("left",n.offset().left);f.offset().top+f.height()>$(window).height()&&f.css("top",f.offset().top-f.height()-30);f.offset().left+f.width()>$(window).width()&&f.css("left",f.offset().left-f.width()-30);f.fadeIn(200);window.setTimeout(function(){window.epmNavHoveredNode===null&&l()},3e3)},l=function(){f.fadeOut(200);$("#menu"+h+e).length&&$("#menu"+h+e).remove()},g=function(){f.is(":visible")?l():d()};window.epmNavSelectNode!=h+e&&window.epmNavSelectNode!=null&&$("#menu"+window.epmNavSelectNode).fadeOut(200);window.epmNavSelectNode=h+e;$("body").find("#menu"+h+e).length===0?($("body").append('<ul class="epm-nav-contextual-menu"  id="menu'+h+e+'" style="display:block;position:absolute;top:'+(n.offset().top+20)+"px;left:"+n.offset().left+'px;"><li class="epm-nav-cm-loading"><span>Loading...<\/span><\/li><\/ul>'),f=$("#menu"+h+e),d(),a||(s=y,w=window.epmLiveNavigation.wsInfoDict[s],a=w.siteId,c=w.listId,e=w.itemId,o.data("siteid",a),o.data("webid",s),o.data("listid",c),o.data("itemid",e)),b=function(){if(window.epmLive){var n="<Request><Params><SiteId>"+a+"<\/SiteId><WebId>"+s+"<\/WebId><ListId>"+c+"<\/ListId><ItemId>"+e+"<\/ItemId><UserId>"+window.epmLive.currentUserId+"<\/UserId><DebugMode>"+window.epmLive.debugMode+"<\/DebugMode><\/Params><\/Request>";epmLiveService.execute("GetContextualMenuItems",n,function(n){var f=[],i,u,t;if(n.ContextualMenus.Items&&(i=n.ContextualMenus.Items.Item,i))for(i.length||(i=[i]),u=0;u<i.length;u++)t=i[u],r?f.push({title:t["@Title"],command:t["@Command"],kind:r,imgUrl:t["@ImageUrl"]}):f.push({title:t["@Title"],command:t["@Command"],kind:t["@Kind"],imgUrl:t["@ImageUrl"]});k(f,o)},function(){k([],o)})}else window.setTimeout(function(){b()},1)},b()):g()};return{setupMenu:n}}();window.epmLiveNavigation.addContextualMenu=function(t,i,r,u,f){t.append('<span class="epm-menu-btn"><span class="icon-ellipsis-horizontal"><\/span><\/span>');$(t.find(".epm-menu-btn").get(0)).click(function(){n.setupMenu(t,i,r,u,f)})};window.epmLiveNavigation.isSecurityJobRunning=function(n,t,i){var r=!1,u='<Data><Param key="ListID">'+t+'<\/Param><Param key="itemId">'+i+"<\/Param><\/Data>";return $.ajax({type:"POST",url:n+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'IsSecurityJobAlreadyRunning', Dataxml: '"+u+"' }",async:!1,contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){if(n.d){var i=$$.parseJson(n.d),t=i.Result;$$.responseIsSuccess(t)&&(r=t.SecurityJob["@Success"]==="True"?!0:!1)}},error:function(n){console.log(n);r=!1}}),r};window.epmLiveNavigation.isImportResourceRunning=function(){var n=!1;return $.ajax({type:"POST",url:window.epmLive.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",async:!1,data:"{ Function: 'IsImportResourceAlreadyRunning', Dataxml: '' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){if(t.d){var r=window.epmLive.parseJson(t.d),i=r.Result;window.epmLive.responseIsSuccess(i)&&(n=i.ResourceImporter["@Success"]==="True"?!0:!1)}},error:function(t){window.epmLive.log(t);n=!1}}),n};var u=function(){var n=function(){var n=function(n){n.find(".epm-nav-cat").each(function(){var n=$($(this).find("span").get(0));n.removeClass("epm-nav-node-expanded");n.addClass("epm-nav-node-collapsed")});n.find(".epm-nav-links").each(function(){var n=$(this);n.hasClass("epm-nav-node-static")||(n.removeClass("epm-nav-node-expanded"),n.addClass("epm-nav-node-collapsed"))})};return{collapseAll:n}}(),t=$("#epm-nav-sub-settings");n.collapseAll(t);i.expandProviderNodes("Settings")},f=function(){var r=function(){window.epmLiveNavigation.addDragger=function(n){n.get(0).innerHTML.indexOf("epm-nav-dragger")===-1&&(n.prepend('<span class="epm-nav-dragger">&nbsp;<\/span>'),n.hover(function(){$($(this).find(".epm-nav-dragger").get(0)).css("visibility","visible")},function(){$($(this).find(".epm-nav-dragger").get(0)).css("visibility","hidden")}))};window.epmLiveNavigation.addFavoritesMenu=function(t){t.append('<span class="epm-menu-btn"><span class="icon-ellipsis-horizontal"><\/span><\/span>');$(t.find(".epm-menu-btn").get(0)).click(function(){n.setupMenu(t,[{title:"Remove",command:"nav:remove",kind:"98"}])})};var t=function(n){var t=[],i=0;n.find(".epm-nav-node").each(function(){t.push($(this).get(0).id+":"+ ++i)});t.length&&epmLiveService.execute("ReorderLinks",t.join(),function(){},function(n){console.log(n)})},i=function(n){window.epmLiveNavigation.addDragger(n)},r=function(n){window.epmLiveNavigation.addFavoritesMenu(n)};return{resetOrder:t,addDragger:i,addMenu:r}}(),i=$("#epm-nav-sub-favorites-static-links"),t;i.find(".epm-nav-sortable").each(function(){var n=$(this).parent();n.addClass("epm-nav-sortable");$(n.find("a").get(0)).attr("style","width:115px !important;");r.addDragger(n);r.addMenu(n)});try{t=$("#epm-nav-sub-favorites");i.sortable({items:"li.epm-nav-sortable",placeholder:"epm-nav-drag-placeholder",start:function(n,i){if(t.is(":visible")){var u=i.item.index(),r="page";u>$(t.find(".epm-nav-sub-header").get(1)).index()&&(r="item");i.item.data("kind",r)}},stop:function(n,i){if(t.is(":visible")){var r=!0,e=i.item.data("kind"),u=i.item.index(),f=$(t.find(".epm-nav-sub-header").get(1)).index();e==="page"?u>f&&(r=!1):u<f&&(r=!1);r||$($(i.item).parent()).sortable("cancel")}},update:function(){r.resetOrder(i)}});i.disableSelection()}catch(u){}},e=function(){var r=function(){var t=function(n,t){n.index()<t?i(n):r(n)},i=function(n){n.append('<span class="epm-menu-btn"><span class="icon-plus-2"><\/span><\/span>');$(n.find("a").get(0)).attr("style","width:115px !important;");$(n.find(".epm-menu-btn").get(0)).click(function(){var t=$(n.find("a").get(0));window.epmLiveNavigation.handleContextualCommand(null,t.data("webid"),t.data("listid"),null,"nav:add",0)})},r=function(t){var i=$(t.find("a").get(0));i.attr("style","width: 115px !important;");t.append('<span class="epm-menu-btn"><span class="icon-ellipsis-horizontal"><\/span><\/span>');$(t.find(".epm-menu-btn").get(0)).click(function(){var r=[],u=!1;$("#epm-nav-sub-favorites-static-links").find("a").each(function(){var n=$(this);n.data("listid")===i.data("listid")&&n.data("itemid")===i.data("itemid")&&(u=!0)});u?r.push({title:"Remove",command:"nav:removeFavRI",kind:98}):r.push({title:"Add",command:"nav:addToFav",kind:98});n.setupMenu(t,r)})};return{addMenu:t}}(),t=$("#epm-nav-sub-recent-static-links"),i;t.find(".epm-nav-sub-header").each(function(){var n=$(this),t=n.text(),r=n.index();t==="Recent Items"&&(i=r)});t.find(".epm-nav-node").each(function(){r.addMenu($(this),i)})},o=function(){var t=$("#EPMNavWorkspacesTree"),i=function(){window.epmLiveNavigation.addFavoriteWSMenu=function(t){t.append('<span class="epm-menu-btn"><span class="icon-ellipsis-horizontal"><\/span><\/span>');$(t.find(".epm-menu-btn").get(0)).click(function(){var r=t.get(0).id,i=[],u=null,e=!0,f;t.hasClass("epm-nav-ws-node")||t.is(".workspacecentercontextmenu")?window.epmLiveNavigation.wsInfoDict[r].hasAccess?(f=!1,$("#epm-nav-sub-workspaces-static-links").find("a").each(function(){$(this).data("webid")===r&&(f=!0)}),f?i.push({title:"Remove",command:"nav:removeFavWS",kind:98}):i.push({title:"Add",command:"nav:addToFav",kind:98}),u=r):e=!1:(i.push({title:"Remove",command:"nav:removeFavWS",kind:98}),u=$(t.find("a").get(0)).data("webid"));e&&(window.epmLiveNavigation.wsTeamDict[u]!=="X"&&r!==window.epmLive.rootWebId&&i.push({title:"Edit team",command:"nav:team",kind:6}),n.setupMenu(t,i))})};var e=function(n){var t=[],i=0;n.find("li.epm-nav-sortable").each(function(){t.push($(this).get(0).id+":"+ ++i)});t.length&&epmLiveService.execute("ReorderLinks",t.join(),function(){},function(n){console.log(n)})},o=function(n){n.prepend('<span class="epm-nav-dragger">&nbsp;<\/span>');n.hover(function(){$($(this).find(".epm-nav-dragger").get(0)).css("visibility","visible")},function(){$($(this).find(".epm-nav-dragger").get(0)).css("visibility","hidden")})},s=function(n){var t=window.epmLiveNavigation.wsInfoDict[n.get(0).id];t?t.hasAccess&&window.epmLiveNavigation.addFavoriteWSMenu(n):window.epmLiveNavigation.addFavoriteWSMenu(n)},h=function(){window.epmLiveNavigation.resetWSNodeWidth=function(){$("a.rtIn").each(function(){var n=$(this),e=$(n.find("span").get(0)),i=15,r=e.width();if(r){var u=n.offset().left-50,o=r+u,f=180,t=f-u-i;n.data("originalwidth",n.width());n.data("newwidth",t);o>f-i?n.width(t):n.parent().width(t)}})};window.epmLiveNavigation.resetWSNodeWidth()},i=function(){if($.fn.bindWithDelay){var n=$("#EPMNavWSTSearch");n.val("");n.bindWithDelay("keyup",function(){var n=$(this).val().trim();n?n.length>1?c(n.toLowerCase()):u():u()},200)}else window.setTimeout(function(){i()},100)},c=function(n){for(var i,e,o=window.epmLiveNavigation.workspaceTree().get_allNodes(),s=!1,u=0;u<o.length;u++)i=o[u],e=i.get_text().trim(),e&&e.toLowerCase().indexOf(n)!==-1?(f(i),i.set_visible(!0),s=!0,r()):i.set_visible(!1);s||t.find(".epm-nav-sub-placeholder").length!==0||t.append($('<div class="epm-nav-sub-placeholder">No search results<\/div>').hide().fadeIn(200))},r=function(){t.find(".epm-nav-sub-placeholder").each(function(){$(this).remove()})},u=function(){var t,n;for(r(),t=window.epmLiveNavigation.workspaceTree().get_allNodes(),n=0;n<t.length;n++)t[n].set_visible(!0);window.epmLiveNavigation.resetWorkspaceTree()},f=function(n){var t=n.get_parent();t&&t!==window.epmLiveNavigation.workspaceTree()&&(t.set_visible(!0),t.set_expanded(!0),f(t))};return{resetOrder:e,addDragger:o,addMenu:s,initializeSearch:i,configureNodeWidth:h}}(),r=$("#epm-nav-sub-workspaces-static-links");r.find(".epm-nav-sortable").each(function(){var n=$(this).parent();n.addClass("epm-nav-sortable");$(n.find("a").get(0)).attr("style","width:124px !important; position: relative; top: 2px;");i.addDragger(n);i.addMenu(n)});try{r.sortable({items:"li.epm-nav-sortable",placeholder:"epm-nav-drag-placeholder",update:function(){i.resetOrder(r)}});r.disableSelection()}catch(u){}i.configureNodeWidth();i.initializeSearch();t.find("a").each(function(){i.addMenu($(this).parent())});t.find("a").length===1&&(t.hide(),$("#epm-nav-sub-workspaces-static-links").get(0).innerHTML+='<li id="epm-nav-nows-ph" class="epm-nav-sub-placeholder">No workspaces<\/li>')};ExecuteOrDelayUntilScriptLoaded(u,"EPMLiveNavigation_Settings");ExecuteOrDelayUntilScriptLoaded(f,"EPMLiveNavigation_Favorites");ExecuteOrDelayUntilScriptLoaded(o,"EPMLiveNavigation_Workspaces");ExecuteOrDelayUntilScriptLoaded(e,"EPMLiveNavigation_RecentItems");window.SP.SOD.notifyScriptLoadedAndExecuteWaitingJobs("EPMLive.Navigation.js")})}function t(){ExecuteOrDelayUntilScriptLoaded(n,"EPMLiveNavigation")}ExecuteOrDelayUntilScriptLoaded(t,"jquery.min.js")})();
//# sourceMappingURL=EPMLive.Navigation.min.js.map
