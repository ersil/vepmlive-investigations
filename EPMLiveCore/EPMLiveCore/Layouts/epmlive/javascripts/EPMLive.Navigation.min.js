(function(){"use strict";function n(){$(function(){var n=window.jQuery,t=function(){var t=function(){return window.epmLiveNavigation.currentWebUrl},i=function(xml){return eval("("+window.xml2json(n.parseXML(xml),"")+")")},r=function(n){return n["@Status"]==0};return{currentWebUrl:t,parseJson:i,responseIsSuccess:r}}(),e=function(){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t=function(t){var i="",o,s,h="",c,f,r,e="",u=0;/[^A-Za-z0-9\+\/\=]/g.exec(t)&&console.log('There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, "+", "/",and "="\nExpect errors in decoding.');t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do c=n.indexOf(t.charAt(u++)),f=n.indexOf(t.charAt(u++)),r=n.indexOf(t.charAt(u++)),e=n.indexOf(t.charAt(u++)),o=c<<2|f>>4,s=(f&15)<<4|r>>2,h=(r&3)<<6|e,i=i+String.fromCharCode(o),r!=64&&(i=i+String.fromCharCode(s)),e!=64&&(i=i+String.fromCharCode(h)),o=s=h="",c=f=r=e="";while(u<t.length);return unescape(i)};return{decode:t}}(),i=function(){var i=function(r,u,f,e){var o=t.currentWebUrl();o?n.ajax({type:"POST",url:(o+"/_vti_bin/WorkEngine.asmx/Execute").replace(/\/\//g,"/"),data:"{ Function: '"+r+"', Dataxml: '"+u+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){if(n.d){var r=t.parseJson(n.d),i=r.Result;t.responseIsSuccess(i)?f(i):e(n)}else e(n)},error:function(n){e(n)}}):window.setTimeout(function(){i(r,u,f,e)},1)};return{execute:i}}(),r=n.cookie,u;n.cookie=function(n,t,i){if(n=n+"-u-"+window.epmLiveNavigation.currentUserId,r){if(!t)return r(n);r(n,t,i)}};u=function(){function tt(){for(var t,n=0;n<u.length;n++)if(t=u[n],t.selected()){t.closeNav();break}}function p(t){var f=["s4-ribbonrow","s4-workspace"],e,i,u;for(e in f)i=n("#"+f[e]),i.removeClass("epm-nav-pinned"),i.removeClass("epm-nav-unpinned"),i.addClass("epm-nav-"+t);u=n("#epm-nav-pin");u.removeClass("epm-nav-pin-pinned");u.removeClass("epm-nav-pin-unpinned");u.addClass("epm-nav-pin-"+t);t==="unpinned"&&tt();r.data("pinstate",t);n.cookie(y,t,c)}function st(){r.data("pinstate")==="pinned"?p("unpinned"):p("pinned")}function ht(){return(n.cookie(nt)||"epm-nav-top-ql").replace("epm-nav-top-","epm-nav-sub-")}function l(t){return n("#"+t).find(".epm-nav-sub-menu").find("div[id^=E]")}function ct(){var t=n.parseJSON(n.cookie(v)),u,e,o,s,i;if(t)if(t.id)n(r.find("#"+t.id).get(0)).parent().addClass(f);else if(u=t.index,e=t.uri,window.location.href.indexOf(e)!==-1)if(o=n("#"+ht()),u&&u!==-1){for(s=l(o.parent().attr("id")),i=0;i<s.length;i++)if(i===u){n(s[i]).find('a[href="'+e+'"]:first').parents("table").addClass(f);break}}else o.find('a[href="'+e+'"]:first').parents("table").addClass(f)}function lt(t){var i={};t.find(".epm-nav-cat").each(function(){var t=n(this);i[t.text()]=n(t.find("span")[0]).hasClass(o)});it(t.get(0).id,i)}function it(t,i){var r=n.parseJSON(n.cookie(h))||{};r[t]=i;n.cookie(h,JSON.stringify(r),c)}function w(t){var p=n.parseJSON(n.cookie(h)),i,r,s,f,c,e,a,v,y;if(p){if(i="epm-nav-sub-ql",t)for(r=0;r<u.length;r++)if(s=u[r],s.provider===t){i=s.id.replace("epm-nav-top-","epm-nav-sub-");break}if(f=p[i],f)if(i==="epm-nav-sub-ql")for(c=l("epm-nav-sub-ql"),e=0;e<c.length;e++)a=c[e],v=a.id.replace("Nodes",""),f[n("#"+v.replace("EPMLiveNavn","EPMLiveNavt")).text()]||TreeView_ToggleNode(window.EPMLiveNav_Data,0,document.getElementById(v)," ",document.getElementById(a.id));else y=n("#"+i).find(".epm-nav-cat"),i==="epm-nav-sub-settings"&&y.each(function(){b(n(this))}),y.each(function(){var t=n(this),r=t.text(),i=f[r];n(t.find("span")[0]).hasClass(o)?i||b(t):i&&rt(t)})}}function rt(t){var u=t.get(0).id,i=n(t.find("span")[0]),r=n("#"+u+"-links");i.removeClass(s);i.addClass(o);r.removeClass(s);r.addClass(o)}function b(t){var u=t.get(0).id,i=n(t.find("span")[0]),r=n("#"+u+"-links");i.removeClass(o);i.addClass(s);r.removeClass(o);r.addClass(s)}function at(){var t=function(){n("li.epm-nav-node").find("a").each(function(){var t=n(this),i;t.attr("alt")||(i=t.find("span"),i&&t.width()<i.width()&&(t.attr("alt",i.text()),t.attr("title",i.text())))})};n(".epm-nav-cat").click(function(){var t=n(this),i=n(t.find("span")[0]);i.hasClass(s)?rt(t):b(t);lt(t.parent())});n("#epm-nav-top li").click(function(){t()});t()}function vt(t,r,u,f,e,o){var l=function(t,r){var u=function(t,i){var r=n("#"+t);r.fadeOut(300,function(){r.remove()});a&&SP.UI.Notify.removeNotification(i)};i.execute("RemoveNavigationLink",t,function(){u(t,r)},function(){u(t,r)})},v=window.epmLiveNavigation.currentWebUrl,p=(v+"/_layouts/15/epmlive/gridaction.aspx?webid="+r+"&listid="+u+"&id="+f+"&").replace(/\/\//g,"/"),k=(v+"/_layouts/15/epmlive/redirectionproxy.aspx?webid="+r+"&listid="+u+"&id="+f+"&").replace(/\/\//g,"/"),s="",c,h,a;switch(e){case"nav:add":s=k+"action=new";break;case"nav:team":var w="",b="",y="";if(f==="undefined")try{c=window.epmLiveNavigation.wsTeamDict[r].split(".");c[2]!=="-1"&&(w=c[0],b=c[1],y=c[2])}catch(d){}s=(v+"/_layouts/15/epmlive/gridaction.aspx?").replace(/\/\//g,"/")+"action=buildteam&webid="+(w||r);y&&(s=s+"&listid="+b+"&id="+y)}!s&&e&&(s=e.indexOf("epkcommand:")!==-1?p+"action=epkcommand&subaction="+e.split(":")[1]:p+"action="+e);switch(o){case"0":OpenCreateWebPageDialog(s);break;case"1":location.href=s;break;case"2":window.open(s+"&IsDlg=1","","height=100, width=200, toolbar=no, menubar=no, scrollbars=yes, resizable=yes,location=no, directories=no, status=yes");break;case"3":window.open(s+"&IsDlg=1","","width="+screen.width+",height="+screen.height+",top=0,left=0, toolbar=no, menubar=no, scrollbars=yes, resizable=yes,location=no, directories=no, status=yes");break;case"5":SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",{url:s,width:600,height:500});break;case"6":SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",{url:s,showMaximized:!0});break;case"98":e!=="nav:addToFav"&&(e!=="nav:remove"&&e!=="nav:removeFavWS"?n.get(s).always(function(){l(t)}):(e==="nav:removeFavWS"&&n("#epm-nav-sub-workspaces-static-links").find("a").each(function(){var i=n(this);i.data("webid")===r&&(t=i.parent().get(0).id)}),l(t),e==="nav:remove"&&(h=n("#"+t).find("a"),window.Analytics.turnOffFav({siteid:h.data("siteid"),webid:h.data("webid"),listid:h.data("listid"),itemid:h.data("itemid"),url:h.get(0).href}))));break;case"99":confirm("Are you sure you want to send the item(s) to the Recycle Bin?")&&(a=SP.UI.Notify.addNotification("Deleting Item...",!0,"",null),e!=="nav:remove"?n.get(s).always(function(){l(t,a)}):l(t,a));break;default:SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",{url:s,width:700})}}function yt(){var b=window.TreeView_HoverNode,k=window.TreeView_UnhoverNode,nt=window.TreeView_ToggleNode,e,a,i,t,y,p,o;window.TreeView_HoverNode=function(t,i){var r=n(i);r.hasClass(d)?r.parent().parent().parent().addClass(g):b(t,i)};window.TreeView_UnhoverNode=function(t){var i=n(t);i.hasClass(d)?n(t).parent().parent().parent().removeClass(g):k(t)};window.TreeView_ToggleNode=function(t,i,r,u,f){var p=null,e=n.parseJSON(n.cookie(h)),o,a,k,v,s;e&&(e=n.parseJSON(n.cookie(h))["epm-nav-sub-ql"],e&&(p=e));var w=p||{},c=null,b=n(r).parents("div");for(o=0;o<b.length;o++)if(a=b[o],k=n(a),k.hasClass("epm-nav-sub")){for(c=a.id,v=l(c),s=0;s<v.length;s++){var d=v[s],y=n(d).is(":visible"),g=d.id.replace("Nodes","");g===r.id&&(y=!y);w[n("#"+g.replace("EPMLiveNavn","EPMLiveNavt")).text()]=y}break}it(c,w);nt(t,i,r,u,f)};window.epmLiveNavigation.handleContextualCommand=function(n,t,i,r,u,f){vt(n,t,i,r,u,f)};n("td.epm-nav-node-root").click(function(){var i=n(this),t=i.parent().find("a").get(0).id;TreeView_ToggleNode(EPMLiveNav_Data,0,document.getElementById(t)," ",document.getElementById(t+"Nodes"))});e=["suiteBar","s4-ribbonrow","s4-workspace"];for(a in e)n("#"+e[a]).click(function(){r.data("pinstate")==="unpinned"&&tt()});i=n("#epm-nav-pin");i.click(function(){st()});r.hover(function(){i.show()},function(){i.hide()});try{r.slimScroll({height:r.height(),width:r.width()})}catch(ft){}t=n("#epm-nav").find(".slimScrollDiv");y=t.find(".slimScrollBar");t.css("position","absolute");t.css("left","50px");r.css("left","0");y.css("z-index",1001);n(window).resize(function(){var i=n("#epm-nav-top").height();t.height(i);r.height(i)});n("a.epm-nav-node").click(function(){var i=n(this),r,t,s;n("#epm-nav-sub-ql").find("a").each(function(){n(this).parent().parent().parent().parent().removeClass(f)});i.parent().parent().parent().parent().addClass(f);var u=-1,e=i.parents("div")[0],o=n(e).siblings("div");if(o)for(r=l(n(o[0]).parent().parent().attr("id")),t=0;t<r.length;t++)s=r[t],s.id===e.id&&(u=t);n.cookie(v,JSON.stringify({index:u,uri:i.attr("href")}),c)});window.epmLiveNavigation.snWidth=r.width();o=window.epmLiveNavigation.workspaceTree();o&&(p=n("#"+o._element.id));var u=r.width(),w=function(){var i,t;n("a.rtIn").each(function(){var t=n(this);t.attr("style","")});n(".epm-nav-ws-node").each(function(){n(this).attr("style","")});i=0;try{i=p.width()}catch(f){}t=0;u<i&&(t=i+20+20,r.stop().animate({width:t},300),r.parent().stop().animate({width:t},300));n(".epm-nav-ws-node").each(function(){var i=n(this),r=50+(t===0?u:t)-i.offset().left;i.attr("style","width:"+r+"px")});window.epmLiveNavigation.wsTreeExpanded=!0},s=function(){r.stop().animate({width:u},300);r.parent().stop().animate({width:u},300);n(".epm-nav-ws-node").each(function(){n(this).attr("style","")});window.epmLiveNavigation.resetWSNodeWidth();window.epmLiveNavigation.wsTreeExpanded=!1},rt=function(n){var r=n.attr("class").toLowerCase(),t,i;r.indexOf("plus")!==-1?(t=function(){n.attr("class").toLowerCase().indexOf("minus")!==-1?window.setTimeout(function(){w()},100):window.setTimeout(function(){t()},1)},t()):(i=function(){n.attr("class").toLowerCase().indexOf("plus")!==-1?window.setTimeout(function(){s()},100):window.setTimeout(function(){i()},1)},i())},ut=n("#epm-nav-sub-workspaces");n("#EPMNavWorkspacesTree").hover(function(){window.epmLiveNavigation.wsTreeExpanded||w()},function(){s()});r.hover(function(){},function(){ut.is(":visible")&&s()});n("a.rtIn").each(function(){var i=n(this).parent().parent().find("span"),t;i.length>1&&(t=n(i.get(1)),t&&(t.click(function(){rt(n(this))}),t.hover(function(){window.epmLiveNavigation.wsNodeSelectorClass=n(this).attr("class")})))})}function ut(i){var c=function(n,t){return{id:n["@Id"],title:n["@Title"],url:(n["#cdata"]||"").replace(/{page}/g,t),category:n["@Category"],cssClass:n["@CssClass"],order:parseInt(n["@Order"]),siteId:n["@SiteId"],webId:n["@WebId"],listId:n["@ListId"],itemId:n["@ItemId"],external:n["@External"]==="True",visible:n["@Visible"]==="True",active:n["@Active"]==="True",seprator:n["@Separator"]==="True"}},a=t.currentWebUrl(),l=a+window.location.href.split(a)[1],v=!1,r,f,y,e,s,o,h,p,b;for(r in i.Nodes){f=i.Nodes[r].NavLink;f.length||(f=[f]);for(y in f)for(e=f[y],s=0;s<u.length;s++)o=u[s],o.provider===r&&(r!=="Workspaces"?o.registerLink(c(e,l)):(h=window.epmLiveNavigation.workspaceTree(),h.trackChanges(),p=e["@Title"],v?o.registerWorkspace(c(e,l),h):(o.registerLink(c(e,l)),p==="All Workspaces"&&(v=!0,n("#epm-nav-sub-workspaces-static-links").remove().insertBefore("#EPMNavWorkspacesTree"))),h.commitChanges()));r==="Workspaces"?(window.epmLiveNavigation.resetWorkspaceTree=function(){var n=window.epmLiveNavigation.workspaceTree(),r,t;for(n.trackChanges(),r=n.get_allNodes(),t=0;t<r.length;t++)r[t].set_expanded(!1);var u=function(t){var r=n.findNodeByValue(t),i;r&&r!=n&&(i=r.get_parent(),i===n||i.get_expanded()||(i.set_expanded(!0),u(i.get_value())))},f=window.epmLiveNavigation.currentWebId,i=n.findNodeByValue(f);i&&(i.get_parent()!==n?u(f):i.set_expanded(!0),i.set_selected(!0));n.commitChanges()},b=window.epmLiveNavigation.workspaceTree(),n("a.rtIn").each(function(){var t=n(this),i=t.parent(),r;i.append('<div id="'+b.findNodeByText(t.text()).get_value()+'" class="epm-nav-ws-node"><\/div>');t.remove();r=t.text();t.text("");t.append("<span>"+r+"<\/span>");i.find(".epm-nav-ws-node").append(t)}),window.epmLiveNavigation.resetWorkspaceTree(),n("#EPMNavWorkspacesTree").fadeIn(300)):r==="Applications"?n(n("#epm-nav-sub-new-static-links").find(".epm-nav-sub-header").get(0)).attr("style","padding-top: 0px !important"):r==="Favorites"&&n(n("#epm-nav-sub-favorites-static-links").find(".epm-nav-sub-header").get(0)).attr("style","padding-top: 0px !important");window.SP.SOD.notifyScriptLoadedAndExecuteWaitingJobs("EPMLiveNavigation_"+r);r!=="Settings"&&w(r)}}function pt(){for(var t=[],r,f,n=0;n<u.length;n++)r=u[n],r.selected()||(f=r.provider,f&&t.push(f));t.length>0&&i.execute("GetNavigationLinks",t.join(),function(n){ut(n);at()},function(n){console.log(n)})}function ft(){var n=null;window.epmLiveNavigation&&(n=window.epmLiveNavigation.staticProvider);n?ut(t.parseJson(e.decode(n))):window.setTimeout(function(){ft()},1)}function wt(){n("#epm-nav-top").find("[data-role='top-nav-node']").each(function(){u.push(new ot(this))})}var k=300,d="epm-nav-node",g="epm-nav-node-hover",a="epm-nav-node-opened",f="epm-nav-node-selected",o="epm-nav-node-expanded",s="epm-nav-node-collapsed",nt="epmnav-selected-tlnode",v="epmnav-selected-link",h="epmnav-expand-state",y="epmnav-pin-state",c={expires:365,path:"/"},r=n("#epm-nav-sub"),u=[],ot=function(t){var o={},l=t,i=n(t),e=n("#epm-nav-sub-"+i.data("id")),s=l.id,it=i.data("linkprovider"),p=function(){return i.parent().hasClass(f)},rt=function(){return i.parent().hasClass(a)},w=function(n){n?i.parent().addClass(f):i.parent().removeClass(f)},b=function(){e.hide();i.parent().removeClass(a)},d=function(){r.is(":visible")&&r.hide("slide",{direction:"left"},k);b()},ut=function(n,t){var i=new window.Telerik.Web.UI.RadTreeNode,r=t;n.category&&(r=t.findNodeByValue(n.category)||r);i.set_text(n.title);i.set_value(n.webId);n.active?i.set_navigateUrl(n.url):i.set_navigateUrl("javascript:;");window.epmLiveNavigation.wsTeamDict=window.epmLiveNavigation.wsTeamDict||{};window.epmLiveNavigation.wsTeamDict[n.webId]=n.itemId;r.get_nodes().add(i)},ft=function(n){n.seprator?ht(n.category):n.url.toLowerCase()==="header"?(h(n.category),ot(n)):n.url.toLowerCase()==="placeholder"?(h(n.category),et(n)):(h(n.category),st(n))},et=function(n){var t=n.category,i;t||(t="__STATIC__");i='<li class="epm-nav-sub-placeholder">'+n.title+"<\/li>";o[t].$el.append(i)},ot=function(n){var t=n.category,r,i;t||(t="__STATIC__");r="epm-nav-sub-header";e.find("li.epm-nav-section-header").length===0&&(r="epm-nav-section-header");i='<li class="'+r+'">'+n.title+"<\/li>";o[t].$el.append(i);i='<li class="epm-nav-sub-header-bottom"><\/li>';o[t].$el.append(i)},st=function(t){var u=t.category,s,h,e,l,i,a,y,w,p;for(u||(u="__STATIC__"),s=!1,h=t.cssClass.split(" "),e=0;e<h.length;e++)if(h[e]==="epm-nav-button"){s=!0;t.cssClass=t.cssClass.replace(/epm-nav-button/g,"");break}l="";t.cssClass&&(l='<span class="epm-nav-icon '+t.cssClass+'"><\/span>');i="epm-nav-node epm-nav-trans";a=o[u].$el.parent().get(0).id;(a==="epm-nav-sub-settings"||a==="epm-nav-sub-workplace")&&(i="epm-nav-node");s&&(i=i+" epm-nav-button",i=i.replace(/epm-nav-trans/g,""));y="";t.external&&(y=' target="_blank"');w='<li id="'+t.id+'" class="'+i+'" style="display:none;">'+l+'<a id="epm-nav-link-'+t.id+'" href="'+t.url+'" data-siteid="'+t.siteId+'" data-webid="'+t.webId+'" data-listid="'+t.listId+'" data-itemid="'+t.itemId+'"'+y+"><span>"+t.title+"<\/span><\/a><\/li>";o[u].$el.append(w);p=n("#"+t.id);t.visible&&p.show();p.find("a").click(function(){var t=n(this),i=t.parent();i.hasClass("epm-nav-button")||(r.find("a").each(function(){n(this).parent().removeClass(f)}),i.addClass(f),n.cookie(v,JSON.stringify({id:t.get(0).id,url:t.attr("href")}),c))})},ht=function(t){var i='<div class="epm-nav-sub-sep"><\/div>';t?n("#"+g(t)).append(i):e.append(i)},h=function(t){if(t||(t="__STATIC__"),!o[t]){var i=g(t),r="epm-nav-node-expanded";t==="__STATIC__"&&(r="epm-nav-node-static");t!=="__STATIC__"&&e.append('<div id="'+i+'" class="epm-nav-node epm-nav-node-root epm-nav-cat"><span class="'+r+'">&nbsp;<\/span><span class="epm-nav-cat-title">'+t+"<\/span><\/div>");e.append('<ul id="'+i+'-links" class="epm-nav-links '+r+'"><\/ul>');o[t]={id:i,$el:n("#"+i+"-links")}}},g=function(n){return e.get(0).id+"-"+n.toLowerCase().replace(/ /g,"-").replace(/_/g,"").replace(/[^\w-]+/g,"").replace(/--/g,"-")},ct=function(){e.fadeIn(300);i.parent().addClass(a)},tt=function(){ct();r.is(":visible")||r.show("slide",{direction:"left"},k)};return i.click(function(){var i,t;if(p())rt()&&n.cookie(y)==="unpinned"?d():tt();else{for(i in u)t=u[i],t.id!==s&&t.selected()&&(t.select(!1),t.close());w(!0);tt();n.cookie(nt,s,c)}}),{id:s,provider:it,selected:p,select:w,close:b,closeNav:d,registerLink:ft,registerWorkspace:ut,el:l,$el:i,$menu:e}},et;return window.epmLiveNavigation.removeLink=function(n){var t=r.find("#epm-nav-link-"+n.id);window.epmLiveNavigation.handleContextualCommand(n.id,t.data("webid"),t.data("listid"),t.data("itemid"),"nav:remove","98")},window.epmLiveNavigation.registerLink=function(t){var f,e,o,i,s;if(t){switch(t.kind){case 0:case 1:f="Favorites";break;case 2:case 3:f="Workspaces"}if(f)for(e=0;e<u.length;e++)if(o=u[e],o.provider===f){if(t.kind!==3&&(t.cssClass="epm-nav-sortable "+t.cssClass),o.registerLink(t),i=r.find("#"+t.id),t.kind>-1&&t.kind<3){if(s=n("#epm-nav-sub-"+f.toLowerCase()+"-static-links"),s.find(".epm-nav-sub-placeholder").each(function(){var r=n(this),i=!1,u=r.text();t.kind===0&&u==="No pages"?i=!0:t.kind===1&&u==="No items"&&(i=!0);i&&r.remove()}),t.kind<2&&i.find("a").attr("style","width:115px !important;"),t.kind===0||t.kind===2)try{i.remove().insertBefore(n(s.find(".epm-nav-sub-header").get(1)))}catch(h){}t.kind!==2?window.epmLiveNavigation.addFavoritesMenu(i):window.epmLiveNavigation.addFavoriteWSMenu(i)}t.kind!==3&&(i.addClass("epm-nav-sortable"),window.epmLiveNavigation.addDragger(i));i.fadeIn(300);break}}},et=function(){wt();ft();p(n.cookie(y)||"pinned");w();ct();yt();ExecuteOrDelayUntilScriptLoaded(pt,"EPMLive.js")},{init:et,expandProviderNodes:w}}();u.init();var f=function(){var t=function(t,r){var f,h;r=r||[];var u=n(t.find(".epm-nav-contextual-menu").get(0)),o=function(i,f){var v=function(n){switch(n.toLowerCase()){case"nav:remove":case"nav:addtofav":case"nav:removefavws":return"icon-star-6";case"view":return"icon-info";case"edit":return"icon-pencil-2";case"delete":return"icon-close-3";case"approve":return"icon-thumbs-up-4";case"comments":return"icon-bubble-dots";case"buildteam":return"icon-user-plus-3";case"workspace":return"icon-tree-2";default:return"epm-nav-cm-blank"}},l=t.get(0).id,a,h,o,c;i.length&&i.push({title:"--SEP--"});for(a in r)i.push(r[a]);for(t.append('<ul class="epm-nav-contextual-menu"><\/ul>'),u=n(t.find(".epm-nav-contextual-menu").get(0)),h=0;h<i.length;h++){if(o=i[h],c=f.data("webid"),!c||c==="undefined")try{c=f.parent().get(0).id}catch(y){}o.title==="--SEP--"?h!==i.length-1&&u.append('<li class="seprator"><\/li>'):(u.append('<li><span class="epm-nav-cm-icon '+v(o.command)+'">&nbsp;<\/span><a href="javascript:epmLiveNavigation.handleContextualCommand(\''+l+"','"+c+"','"+f.data("listid")+"','"+f.data("itemid")+"','"+o.command+"','"+o.kind+'\');" style="width: 136px !important;">'+o.title+"<\/a><\/li>"),u.find("a").click(function(){e()}))}u.hover(function(){window.epmNavHoveredNode=l});n(".epm-nav-node, .epm-nav-ws-node").hover(function(){var n=this.id;window.epmNavHoveredNode=n;n!==l&&window.setTimeout(function(){window.epmNavHoveredNode===n&&e()},200)});n(".epm-nav-links, #EPMNavWorkspacesTree").hover(function(){},function(){window.epmNavHoveredNode=null;window.setTimeout(function(){window.epmNavHoveredNode===null&&e()},200)});n(document).on("click",".epm-nav-dragger",function(){e()});s()},c=function(){u.fadeIn(200)},e=function(){u.fadeOut(200)},s=function(){u.is(":visible")?e():c()};t.find(".epm-nav-contextual-menu").length===0?(f=n(t.find("a").get(0)),h="<Request><Params><SiteId>"+f.data("siteid")+"<\/SiteId><WebId>"+f.data("webid")+"<\/WebId><ListId>"+f.data("listid")+"<\/ListId><ItemId>"+f.data("itemid")+"<\/ItemId><UserId>"+window.epmLive.currentUserId+"<\/UserId><\/Params><\/Request>",i.execute("GetContextualMenuItems",h,function(n){var u=[],t=n.ContextualMenus.Items.Item,r,i;if(t)for(t.length||(t=[t]),r=0;r<t.length;r++)i=t[r],u.push({title:i["@Title"],command:i["@Command"],kind:i["@Kind"],imgUrl:i["@ImageUrl"]});o(u,f)},function(){o([],f)})):s()};return{setupMenu:t}}(),o=function(){var t=function(){var t=function(t){t.find(".epm-nav-cat").each(function(){var t=n(n(this).find("span").get(0));t.removeClass("epm-nav-node-expanded");t.addClass("epm-nav-node-collapsed")});t.find(".epm-nav-links").each(function(){var t=n(this);t.hasClass("epm-nav-node-static")||(t.removeClass("epm-nav-node-expanded"),t.addClass("epm-nav-node-collapsed"))})};return{collapseAll:t}}(),i=n("#epm-nav-sub-settings");t.collapseAll(i);u.expandProviderNodes("Settings")},s=function(){var r=function(){window.epmLiveNavigation.addDragger=function(t){t.prepend('<span class="epm-nav-dragger">&nbsp;<\/span>');t.hover(function(){n(n(this).find(".epm-nav-dragger").get(0)).css("visibility","visible")},function(){n(n(this).find(".epm-nav-dragger").get(0)).css("visibility","hidden")})};window.epmLiveNavigation.addFavoritesMenu=function(t){t.append('<span class="epm-menu-btn"><span class="icon-ellipsis-horizontal"><\/span><\/span>');n(t.find(".epm-menu-btn").get(0)).click(function(){f.setupMenu(t,[{title:"Remove",command:"nav:remove",kind:"98"}])})};var t=function(t){var r=[],u=0;t.find(".epm-nav-node").each(function(){r.push(n(this).get(0).id+":"+ ++u)});r.length&&i.execute("ReorderLinks",r.join(),function(){},function(n){console.log(n)})},r=function(n){window.epmLiveNavigation.addDragger(n)},u=function(n){window.epmLiveNavigation.addFavoritesMenu(n)};return{resetOrder:t,addDragger:r,addMenu:u}}(),t=n("#epm-nav-sub-favorites-static-links");t.find(".epm-nav-sortable").each(function(){var t=n(this).parent();t.addClass("epm-nav-sortable");n(t.find("a").get(0)).attr("style","width:115px !important;");r.addDragger(t);r.addMenu(t)});try{t.sortable({items:"li.epm-nav-sortable",placeholder:"epm-nav-drag-placeholder",update:function(){r.resetOrder(t)}});t.disableSelection()}catch(u){}},h=function(){var r=function(){var t=function(n,t){n.index()<t&&i(n)},i=function(t){t.append('<span class="epm-menu-btn"><span class="icon-plus-2"><\/span><\/span>');n(t.find("a").get(0)).attr("style","width:115px !important;");n(t.find(".epm-menu-btn").get(0)).click(function(){var i=n(t.find("a").get(0));window.epmLiveNavigation.handleContextualCommand(null,i.data("webid"),i.data("listid"),null,"nav:add",0)})};return{addMenu:t}}(),t=n("#epm-nav-sub-recent-static-links"),i;t.find(".epm-nav-sub-header").each(function(){var t=n(this),r=t.text(),u=t.index();r==="Recent Items"&&(i=u)});t.find(".epm-nav-node").each(function(){r.addMenu(n(this),i)})},c=function(){var t=function(){window.epmLiveNavigation.addFavoriteWSMenu=function(t){t.append('<span class="epm-menu-btn"><span class="icon-ellipsis-horizontal"><\/span><\/span>');n(t.find(".epm-menu-btn").get(0)).click(function(){var u=t.get(0).id,i=[],r;t.hasClass("epm-nav-ws-node")?(r=!1,n("#epm-nav-sub-workspaces-static-links").find("a").each(function(){n(this).data("webid")===u&&(r=!0)}),r?i.push({title:"Remove",command:"nav:removeFavWS",kind:98}):i.push({title:"Add",command:"nav:addToFav",kind:98})):i.push({title:"Remove",command:"nav:removeFavWS",kind:98});i.push({title:"Manage team",command:"nav:team",kind:6});f.setupMenu(t,i)})};var u=function(t){var r=[],u=0;t.find("li.epm-nav-sortable").each(function(){r.push(n(this).get(0).id+":"+ ++u)});r.length&&i.execute("ReorderLinks",r.join(),function(){},function(n){console.log(n)})},e=function(t){t.prepend('<span class="epm-nav-dragger">&nbsp;<\/span>');t.hover(function(){n(n(this).find(".epm-nav-dragger").get(0)).css("visibility","visible")},function(){n(n(this).find(".epm-nav-dragger").get(0)).css("visibility","hidden")})},o=function(n){window.epmLiveNavigation.addFavoriteWSMenu(n)},s=function(){window.epmLiveNavigation.resetWSNodeWidth=function(){n("a.rtIn").each(function(){var t=n(this),o=n(t.find("span").get(0)),r=15,u=o.width();if(u){var f=t.offset().left-50,s=u+f,e=180,i=e-f-r;t.data("originalwidth",t.width());t.data("newwidth",i);s>e-r?t.width(i):t.parent().width(i)}})};window.epmLiveNavigation.resetWSNodeWidth()},h=function(){var i=n("#EPMNavWSTSearch");i.val("");i.bindWithDelay("keyup",function(){var i=n(this).val().trim();i?i.length>1?c(i.toLowerCase()):t():t()},200)},c=function(n){for(var f=window.epmLiveNavigation.workspaceTree().get_allNodes(),t,u,i=0;i<f.length;i++)t=f[i],u=t.get_text().trim(),u&&u.toLowerCase().indexOf(n)!==-1?(r(t),t.set_visible(!0)):t.set_visible(!1)},t=function(){for(var t=window.epmLiveNavigation.workspaceTree().get_allNodes(),n=0;n<t.length;n++)t[n].set_visible(!0);window.epmLiveNavigation.resetWorkspaceTree()},r=function(n){var t=n.get_parent();t&&t!==window.epmLiveNavigation.workspaceTree()&&(t.set_visible(!0),t.set_expanded(!0),r(t))};return{resetOrder:u,addDragger:e,addMenu:o,initializeSearch:h,configureNodeWidth:s}}(),r=n("#epm-nav-sub-workspaces-static-links");r.find(".epm-nav-sortable").each(function(){var i=n(this).parent();i.addClass("epm-nav-sortable");n(i.find("a").get(0)).attr("style","width:125px !important; position: relative; top: 2px;");t.addDragger(i);t.addMenu(i)});try{r.sortable({items:"li.epm-nav-sortable",placeholder:"epm-nav-drag-placeholder",update:function(){t.resetOrder(r)}});r.disableSelection()}catch(u){}t.configureNodeWidth();t.initializeSearch();n("#EPMNavWorkspacesTree").find("a").each(function(){t.addMenu(n(this).parent())})};ExecuteOrDelayUntilScriptLoaded(o,"EPMLiveNavigation_Settings");ExecuteOrDelayUntilScriptLoaded(s,"EPMLiveNavigation_Favorites");ExecuteOrDelayUntilScriptLoaded(c,"EPMLiveNavigation_Workspaces");ExecuteOrDelayUntilScriptLoaded(h,"EPMLiveNavigation_RecentItems")})}function t(){ExecuteOrDelayUntilScriptLoaded(n,"EPMLiveNavigation")}ExecuteOrDelayUntilScriptLoaded(t,"jquery.min.js")})();
//# sourceMappingURL=EPMLive.Navigation.min.js.map