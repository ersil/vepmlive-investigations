(function(){function t(){ExecuteOrDelayUntilScriptLoaded(n,"EPMLiveNavigation")}var n=function(){$(function(){var n=window.jQuery,t=function(){var t=function(t,i,r,u){var f=window.epmLive;n.ajax({type:"POST",url:f.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: '"+t+"', Dataxml: '"+i+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){if(n.d){var i=f.parseJson(n.d),t=i.Result;f.responseIsSuccess(t)?r(t):u(n)}else u(n)},error:function(n){u(n)}})};return{execute:t}}(),i=function(){var l=300,a="epm-nav-node",v="epm-nav-node-hover",o="epm-nav-node-opened",u="epm-nav-node-selected",y="epmnav-selected-tlnode",p="epmnav-selected-link",s="epmnav-expand-state",h="epmnav-pin-state",f={expires:365,path:"/"},i=n("#epm-nav-sub"),r=[],k=function(t){var c={},v=t,e=n(t),s=n("#epm-nav-sub-"+e.data("id")),a=v.id,nt=e.data("linkprovider"),p=function(){return e.parent().hasClass(u)},tt=function(){return e.parent().hasClass(o)},w=function(n){n?e.parent().addClass(u):e.parent().removeClass(u)},b=function(){s.hide();e.parent().removeClass(o)},k=function(){i.is(":visible")&&i.hide("slide",{direction:"left"},l);b()},it=function(n){n.seprator?ut(n.category):(ft(n.category),rt(n))},rt=function(t){var i=t.category,r;i||(i="__STATIC__");r='<li id="'+t.id+'" class="epm-nav-node" style="display:none;"><a id="epm-nav-link-'+t.id+'" href="'+t.url+'" alt="'+t.title+'">'+t.title+"<\/a><\/li>";c[i].$el.append(r);t.external&&n("#epm-nav-link-"+t.id).attr("target","_blank");t.visible&&n("#"+t.id).show()},ut=function(t){var i='<div class="epm-nav-sub-sep"><\/div>';t?n("#"+d(t)).append(i):s.append(i)},ft=function(t){if(t||(t="__STATIC__"),!c[t]){var i=d(t),r="epm-nav-node-collapsed";t==="__STATIC__"&&(r="epm-nav-node-static");t!=="__STATIC__"&&s.append('<div id="'+i+'-header" class="epm-nav-node epm-nav-node-root epm-nav-cat"><span class="'+r+'">&nbsp;<\/span><span class="epm-nav-cat-title" alt="'+t+'">'+t+"<\/span><\/div>");s.append('<ul id="'+i+'" class="epm-nav-links '+r+'"><\/ul>');c[t]={id:i,$el:n("#"+i)}}},d=function(n){return s.get(0).id+"-"+n.toLowerCase().replace(/ /g,"-").replace(/_/g,"").replace(/[^\w-]+/g,"").replace(/--/g,"-")},et=function(){s.show();e.parent().addClass(o)},g=function(){et();i.is(":visible")||i.show("slide",{direction:"left"},l)};return e.click(function(){var i,t;if(p())tt()&&n.cookie(h)==="unpinned"?k():g();else{for(i in r)t=r[i],t.id!==a&&t.selected()&&(t.select(!1),t.close());w(!0);g();n.cookie(y,a,f)}}),{id:a,provider:nt,selected:p,select:w,close:b,closeNav:k,registerLink:it,el:v,$el:e,$menu:s}},w=function(){for(var t,n=0;n<r.length;n++)if(t=r[n],t.selected()){t.closeNav();break}},c=function(t){var e=["s4-ribbonrow","s4-workspace"],o,r,u;for(o in e)r=n("#"+e[o]),r.removeClass("epm-nav-pinned"),r.removeClass("epm-nav-unpinned"),r.addClass("epm-nav-"+t);u=n("#epm-nav-pin");u.removeClass("epm-nav-pin-pinned");u.removeClass("epm-nav-pin-unpinned");u.addClass("epm-nav-pin-"+t);t==="unpinned"&&w();i.data("pinstate",t);n.cookie(h,t,f)},d=function(){i.data("pinstate")==="pinned"?c("unpinned"):c("pinned")},g=function(t,i){var r=n.parseJSON(n.cookie(s))||{};r[t]=i;n.cookie(s,JSON.stringify(r),f)},nt=function(){var h=window.TreeView_HoverNode,c=window.TreeView_UnhoverNode,l=window.TreeView_ToggleNode,u,o,t,r,s;window.TreeView_HoverNode=function(t,i){var r=n(i);r.hasClass(a)?r.parent().parent().parent().addClass(v):h(t,i)};window.TreeView_UnhoverNode=function(t){var i=n(t);i.hasClass(a)?n(t).parent().parent().parent().removeClass(v):c(t)};window.TreeView_ToggleNode=function(t,i,r,u,f){for(var p=[],c=null,w=n(r).parents("div"),a,b,v,o,y,h,s=0;s<w.length;s++)if(a=w[s],b=n(a),b.hasClass("epm-nav-sub")){for(c=a.id,v=e(c),o=0;o<v.length;o++)y=v[o],h=n(y).is(":visible"),y.id.replace("Nodes","")===r.id&&(h=!h),p[o]=h;break}g(c,p);l(t,i,r,u,f)};u=["suiteBar","s4-ribbonrow","s4-workspace"];for(o in u)n("#"+u[o]).click(function(){i.data("pinstate")==="unpinned"&&w()});t=n("#epm-nav-pin");t.click(function(){d()});i.hover(function(){t.show()},function(){t.hide()});i.slimScroll({height:i.height(),width:i.width()});r=n("#epm-nav").find(".slimScrollDiv");s=r.find(".slimScrollBar");r.css("position","absolute");r.css("left","50px");i.css("left","0");s.css("z-index",1001);n("a.epm-nav-node").click(function(){var r=-1,u=n(this),o=u.parents("div")[0],s=n(o).siblings("div"),i,t,h;if(s)for(i=e(n(s[0]).parent().parent().attr("id")),t=0;t<i.length;t++)h=i[t],h.id===o.id&&(r=t);n.cookie(p,JSON.stringify({index:r,uri:u.attr("href")}),f)})},b=function(){return(n.cookie(y)||"epm-nav-top-ql").replace("epm-nav-top-","epm-nav-sub-")},e=function(t){return n("#"+t).find(".epm-nav-sub-menu").find("div[id^=E]")},tt=function(){var o=n.parseJSON(n.cookie(s)),i,r,u,t,f,h;if(o&&(i=b(),r=o[i],r&&i==="epm-nav-sub-ql"))for(u=e("epm-nav-sub-ql"),t=0;t<u.length;t++)r[t]&&(f=u[t].id,h=f.replace("Nodes",""),TreeView_ToggleNode(window.EPMLiveNav_Data,0,document.getElementById(h)," ",document.getElementById(f)))},it=function(){var f=n.parseJSON(n.cookie(p)),i,r,o,s,t;if(f&&(i=f.index,r=f.uri,window.location.href.indexOf(r)!==-1))if(o=n("#"+b()),i&&i!==-1){for(s=e(o.parent().attr("id")),t=0;t<s.length;t++)if(t===i){n(s[t]).find('a[href="'+r+'"]:first').parents("table").addClass(u);break}}else o.find('a[href="'+r+'"]:first').parents("table").addClass(u)},rt=function(){for(var i=[],u,f,n=0;n<r.length;n++)u=r[n],u.selected()||(f=u.provider,f&&i.push(f));i.length>0&&t.execute("GetNavigationLinks",i.join(),function(n){var o=epmLive.currentWebUrl,h=o+window.location.href.split(o)[1],u,f,s,t,i,e;for(u in n.Nodes){f=n.Nodes[u].NavLink;for(s in f)for(t=f[s],i=0;i<r.length;i++)e=r[i],e.provider===u&&e.registerLink({id:t["@Id"],title:t["@Title"],url:t["#cdata"].replace(/{page}/g,h),category:t["@Category"],cssClass:t["@CssClass"],order:parseInt(t["@Order"]),external:t["@Exernal"]==="True",visible:t["@Visible"]==="True",seprator:t["@Separator"]==="True"})}},function(n){console.log(n)})},ut=function(){var t=n.cookie(h);n("#epm-nav-top").find("[data-role='top-nav-node']").each(function(){r.push(new k(this))});c(t||"pinned");tt();it();nt();ExecuteOrDelayUntilScriptLoaded(rt,"EPMLive.js")};return{init:ut}}();i.init()})};ExecuteOrDelayUntilScriptLoaded(t,"jquery.min.js")})();
//@ sourceMappingURL=EPMLive.Navigation.min.js.map