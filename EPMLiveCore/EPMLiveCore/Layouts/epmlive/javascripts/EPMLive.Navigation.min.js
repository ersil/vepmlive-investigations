(function(){function t(){ExecuteOrDelayUntilScriptLoaded(n,"EPMLiveNavigation")}var n=function(){$(function(){var n=window.jQuery,t=function(){var t=function(t,i,r,u){var f=window.epmLive;n.ajax({type:"POST",url:f.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: '"+t+"', Dataxml: '"+i+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){if(n.d){var i=f.parseJson(n.d),t=i.Result;f.responseIsSuccess(t)?r(t):u(n)}else u(n)},error:function(n){u(n)}})};return{execute:t}}(),i=function(){var v=300,y="epm-nav-node",p="epm-nav-node-hover",h="epm-nav-node-opened",u="epm-nav-node-selected",e="epm-nav-node-expanded",f="epm-nav-node-collapsed",w="epmnav-selected-tlnode",b="epmnav-selected-link",c="epmnav-expand-state",l="epmnav-pin-state",o={expires:365,path:"/"},i=n("#epm-nav-sub"),r=[],g=function(t){var s={},a=t,f=n(t),e=n("#epm-nav-sub-"+f.data("id")),c=a.id,nt=f.data("linkprovider"),y=function(){return f.parent().hasClass(u)},tt=function(){return f.parent().hasClass(h)},p=function(n){n?f.parent().addClass(u):f.parent().removeClass(u)},b=function(){e.hide();f.parent().removeClass(h)},k=function(){i.is(":visible")&&i.hide("slide",{direction:"left"},v);b()},it=function(n){n.seprator?ut(n.category):(ft(n.category),rt(n))},rt=function(t){var i=t.category,r;i||(i="__STATIC__");r='<li id="'+t.id+'" class="epm-nav-node" style="display:none;"><a id="epm-nav-link-'+t.id+'" href="'+t.url+'" alt="'+t.title+'">'+t.title+"<\/a><\/li>";s[i].$el.append(r);t.external&&n("#epm-nav-link-"+t.id).attr("target","_blank");t.visible&&n("#"+t.id).show()},ut=function(t){var i='<div class="epm-nav-sub-sep"><\/div>';t?n("#"+d(t)).append(i):e.append(i)},ft=function(t){if(t||(t="__STATIC__"),!s[t]){var i=d(t),r="epm-nav-node-collapsed";t==="__STATIC__"&&(r="epm-nav-node-static");t!=="__STATIC__"&&e.append('<div id="'+i+'" class="epm-nav-node epm-nav-node-root epm-nav-cat"><span class="'+r+'">&nbsp;<\/span><span class="epm-nav-cat-title" alt="'+t+'">'+t+"<\/span><\/div>");e.append('<ul id="'+i+'-links" class="epm-nav-links '+r+'"><\/ul>');s[t]={id:i,$el:n("#"+i+"-links")}}},d=function(n){return e.get(0).id+"-"+n.toLowerCase().replace(/ /g,"-").replace(/_/g,"").replace(/[^\w-]+/g,"").replace(/--/g,"-")},et=function(){e.show();f.parent().addClass(h)},g=function(){et();i.is(":visible")||i.show("slide",{direction:"left"},v)};return f.click(function(){var i,t;if(y())tt()&&n.cookie(l)==="unpinned"?k():g();else{for(i in r)t=r[i],t.id!==c&&t.selected()&&(t.select(!1),t.close());p(!0);g();n.cookie(w,c,o)}}),{id:c,provider:nt,selected:y,select:p,close:b,closeNav:k,registerLink:it,el:a,$el:f,$menu:e}},k=function(){for(var t,n=0;n<r.length;n++)if(t=r[n],t.selected()){t.closeNav();break}},a=function(t){var f=["s4-ribbonrow","s4-workspace"],e,r,u;for(e in f)r=n("#"+f[e]),r.removeClass("epm-nav-pinned"),r.removeClass("epm-nav-unpinned"),r.addClass("epm-nav-"+t);u=n("#epm-nav-pin");u.removeClass("epm-nav-pin-pinned");u.removeClass("epm-nav-pin-unpinned");u.addClass("epm-nav-pin-"+t);t==="unpinned"&&k();i.data("pinstate",t);n.cookie(l,t,o)},nt=function(){i.data("pinstate")==="pinned"?a("unpinned"):a("pinned")},tt=function(t,i){var r=n.parseJSON(n.cookie(c))||{};r[t]=i;n.cookie(c,JSON.stringify(r),o)},it=function(){var h=window.TreeView_HoverNode,c=window.TreeView_UnhoverNode,l=window.TreeView_ToggleNode,u,f,r,t,e;window.TreeView_HoverNode=function(t,i){var r=n(i);r.hasClass(y)?r.parent().parent().parent().addClass(p):h(t,i)};window.TreeView_UnhoverNode=function(t){var i=n(t);i.hasClass(y)?n(t).parent().parent().parent().removeClass(p):c(t)};window.TreeView_ToggleNode=function(t,i,r,u,f){for(var p=[],c=null,w=n(r).parents("div"),a,b,v,e,y,h,o=0;o<w.length;o++)if(a=w[o],b=n(a),b.hasClass("epm-nav-sub")){for(c=a.id,v=s(c),e=0;e<v.length;e++)y=v[e],h=n(y).is(":visible"),y.id.replace("Nodes","")===r.id&&(h=!h),p[e]=h;break}tt(c,p);l(t,i,r,u,f)};u=["suiteBar","s4-ribbonrow","s4-workspace"];for(f in u)n("#"+u[f]).click(function(){i.data("pinstate")==="unpinned"&&k()});r=n("#epm-nav-pin");r.click(function(){nt()});i.hover(function(){r.show()},function(){r.hide()});i.slimScroll({height:i.height(),width:i.width()});t=n("#epm-nav").find(".slimScrollDiv");e=t.find(".slimScrollBar");t.css("position","absolute");t.css("left","50px");i.css("left","0");e.css("z-index",1001);n(window).resize(function(){var r=n("#epm-nav-top").height();t.height(r);i.height(r)});n("a.epm-nav-node").click(function(){var r=-1,u=n(this),f=u.parents("div")[0],e=n(f).siblings("div"),i,t,h;if(e)for(i=s(n(e[0]).parent().parent().attr("id")),t=0;t<i.length;t++)h=i[t],h.id===f.id&&(r=t);n.cookie(b,JSON.stringify({index:r,uri:u.attr("href")}),o)})},d=function(){return(n.cookie(w)||"epm-nav-top-ql").replace("epm-nav-top-","epm-nav-sub-")},s=function(t){return n("#"+t).find(".epm-nav-sub-menu").find("div[id^=E]")},rt=function(){var e=n.parseJSON(n.cookie(c)),i,r,u,t,f,o;if(e&&(i=d(),r=e[i],r&&i==="epm-nav-sub-ql"))for(u=s("epm-nav-sub-ql"),t=0;t<u.length;t++)r[t]&&(f=u[t].id,o=f.replace("Nodes",""),TreeView_ToggleNode(window.EPMLiveNav_Data,0,document.getElementById(o)," ",document.getElementById(f)))},ut=function(){var f=n.parseJSON(n.cookie(b)),i,r,e,o,t;if(f&&(i=f.index,r=f.uri,window.location.href.indexOf(r)!==-1))if(e=n("#"+d()),i&&i!==-1){for(o=s(e.parent().attr("id")),t=0;t<o.length;t++)if(t===i){n(o[t]).find('a[href="'+r+'"]:first').parents("table").addClass(u);break}}else e.find('a[href="'+r+'"]:first').parents("table").addClass(u)},ft=function(){for(var u=[],o,s,i=0;i<r.length;i++)o=r[i],o.selected()||(s=o.provider,s&&u.push(s));u.length>0&&t.execute("GetNavigationLinks",u.join(),function(t){var c=epmLive.currentWebUrl,a=c+window.location.href.split(c)[1],o,s,l,i,u,h;for(o in t.Nodes){s=t.Nodes[o].NavLink;for(l in s)for(i=s[l],u=0;u<r.length;u++)h=r[u],h.provider===o&&h.registerLink({id:i["@Id"],title:i["@Title"],url:i["#cdata"].replace(/{page}/g,a),category:i["@Category"],cssClass:i["@CssClass"],order:parseInt(i["@Order"]),external:i["@Exernal"]==="True",visible:i["@Visible"]==="True",seprator:i["@Separator"]==="True"})}n(".epm-nav-cat").click(function(){var r=n(this),u=r.get(0).id,t=n(r.find("span")[0]),i=n("#"+u+"-links");t.hasClass(f)?(t.removeClass(f),t.addClass(e),i.removeClass(f),i.addClass(e)):(t.removeClass(e),t.addClass(f),i.removeClass(e),i.addClass(f))})},function(n){console.log(n)})},et=function(){var t=n.cookie(l);n("#epm-nav-top").find("[data-role='top-nav-node']").each(function(){r.push(new g(this))});a(t||"pinned");rt();ut();it();ExecuteOrDelayUntilScriptLoaded(ft,"EPMLive.js")};return{init:et}}();i.init()})};ExecuteOrDelayUntilScriptLoaded(t,"jquery.min.js")})();
//@ sourceMappingURL=EPMLive.Navigation.min.js.map