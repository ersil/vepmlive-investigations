function GetGridId(n){return n.id.substr(9)}function setupPage(records,UseReporting,PageSize,grid,startpage){var gridid=GetGridId(grid),pages=Math.ceil(records/PageSize),prev=document.getElementById("PagePrevious"+gridid),next=document.getElementById("PageNext"+gridid),pagediv=document.getElementById("pagediv"+gridid),viewalldiv=document.getElementById("viewalldiv"+gridid),pagetable=document.getElementById("pagetable"+gridid),p,rec,mygrid;UseReporting?pages>1?(grid.bPageSetup||(grid.bPageSetup=!0,p=$("#pagediv"+gridid).parent(),$("#pagediv"+gridid).remove(),p.append('<div id="pagediv'+gridid+'"/>'),startpage=="0"&&(startpage="1"),$("#pagediv"+gridid).paginate({count:pages,start:startpage,display:12,border:!0,rotate:!1,images:!1,mouse:"press",onChange:ChangePage,gridid:GetGridId(grid)})),viewalldiv.style.display="",pagetable.style.display=""):(viewalldiv.style.display="none",pagetable.style.display="none"):(pagediv.style.display="inline-block",rec=records.split("|"),mygrid=eval("mygrid"+gridid),mygrid.PAGEfirstItem=parseInt(rec[2])*-1,mygrid.PAGElastItem=rec[1],rec[0]=="0"||mygrid.PAGEfItemHide==mygrid.PAGEfirstItem?(prev.style.background="#EFEFEF",mygrid.PAGEfItemHide=mygrid.PAGEfirstItem):prev.style.background="#DDDDDD",rec[3]=="true"?next.style.background="#DDDDDD":(prev.style.background="#EFEFEF",mygrid.PAGElastItem=0),rec[3]!="true"&&rec[0]=="0"&&(pagetable.style.display="none"))}function GetPageHeight(){var n;return self.innerHeight?n=self.innerHeight:document.documentElement&&document.documentElement.clientHeight?n=document.documentElement.clientHeight:document.body&&(n=document.body.clientHeight),n}function GetItemTop(n){for(var t=n.offsetTop;n.offsetParent;)if(t=t+n.offsetParent.offsetTop,n==document.getElementsByTagName("body")[0])break;else n=n.offsetParent;return t}function SetGridSize(grid){var gridid=GetGridId(grid),bodyheight,divOuter;if(OnlyGrid){var outer=document.getElementById("gridouter"+gridid),height=GetPageHeight(),top=GetItemTop(outer),currentDialog=SP.UI.ModalDialog.get_childDialog();outer.style.height=currentDialog?height-top-105+"px":height-top-35+"px"}else bodyheight=grid.GetBodyScrollHeight()+60,bodyheight<100&&(bodyheight=100),gridid=GetGridId(grid),divOuter=document.getElementById("gridouter"+gridid),divOuter.style.height=bodyheight>parseInt(eval("mygrid"+gridid+".GridHeight"))?eval("mygrid"+gridid+".GridHeight")+"px":bodyheight+"px"}function GetWebUrl(){return _spPageContextInfo.webServerRelativeUrl=="/"?"":_spPageContextInfo.webServerRelativeUrl}function GridListSettings(n){var t=new SP.Guid(n),i=GetWebUrl()+"/_layouts/15/listedit.aspx?List="+SP.Utilities.HttpUtility.urlKeyValueEncode(t.toString("B").toUpperCase());SP.Utilities.HttpUtility.navigateTo(i)}function GridListEditView(n,t){var i=new SP.Guid(n),r=new SP.Guid(t),u=GetWebUrl()+"/_layouts/15/epmlive/gridaction.aspx?action=editview&List="+SP.Utilities.HttpUtility.urlKeyValueEncode(i.toString("B").toUpperCase())+"&View="+SP.Utilities.HttpUtility.urlKeyValueEncode(r.toString("B").toUpperCase())+"&Source="+escape(document.location.href);SP.Utilities.HttpUtility.navigateTo(u)}function GridListCreateView(n){var t=new SP.Guid(n),i=GetWebUrl()+"/_layouts/15/ViewNew.aspx?List="+SP.Utilities.HttpUtility.urlKeyValueEncode(t.toString("B").toUpperCase())+"&Source="+escape(document.location.href);SP.Utilities.HttpUtility.navigateTo(i)}function GridUnSearch(gridid){var grid=Grids["GanttGrid"+gridid];eval("mygrid"+gridid+".CurPage='0'");eval("mygrid"+gridid+".Searcher=''");ReloadGridWithNewParams(gridid)}function GridSearch(gridid,searchfield,searchvalue,searchtype){var grid=Grids["GanttGrid"+gridid];grid?(grid=Grids["GanttGrid"+gridid],eval("mygrid"+gridid+".CurPage='0'"),eval("mygrid"+gridid+".Searcher='&searchfield="+searchfield+"&searchvalue="+escape(searchvalue)+"&searchtype="+searchtype+"'"),ReloadGridWithNewParams(gridid)):(EPM.UI.Loader.current().startLoading({id:"WebPart"+eval("mygrid"+gridid+".Qualifier")}),eval("mygrid"+gridid+".Searcher='&searchfield="+searchfield+"&searchvalue="+escape(searchvalue)+"&searchtype="+searchtype+"'"),TreeGrid({Data:{Url:GetWebUrl()+"/_layouts/epmlive/getganttitems.aspx?data="+eval("mygrid"+gridid+".Params")+eval("mygrid"+gridid+".Searcher")},SuppressMessage:2,Debug:""},"griddiv"+gridid))}function GridOnLoaded(grid){var gridid=GetGridId(grid);grid.Lang.Format.DecimalSeparator=eval("mygrid"+gridid+".DecimalSeparator");grid.Lang.Format.GroupSeparator=eval("mygrid"+gridid+".GroupSeparator")}function GridOnReady(grid){TGSetEvent("OnRenderFinish",grid.id,GridOnRenderFinish);TGSetEvent("OnGetHtmlValue",grid.id,GridOnGetHtmlValue);TGSetEvent("OnClick",grid.id,GridClick);TGSetEvent("OnClickOutside",grid.id,GridClickOutside);TGSetEvent("OnMouseOutRow",grid.id,GridOnMouseOutRow);TGSetEvent("OnMouseOverOutside",grid.id,GridOnMouseOverOutside);TGSetEvent("OnMouseOverRow",grid.id,GridOnMouseOverRow);TGSetEvent("OnSelect",grid.id,GridOnSelect);TGSetEvent("OnFocus",grid.id,GridOnFocus);TGSetEvent("OnDblClick",grid.id,GridOnDblClick);var gridid=GetGridId(grid),LinkType=eval("mygrid"+gridid+".LinkType");LinkType==""&&(grid.LinkTitleField=="LinkTitle"?eval("mygrid"+gridid+".LinkType='edit'"):grid.LinkTitleField=="LinkTitleNoMenu"&&eval("mygrid"+gridid+".LinkType='view'"))}function GridOnRenderFinish(grid){var gridid,ribbon,wp;if(grid.id.substr(0,9)=="GanttGrid"){if(TGSetEvent("OnAfterValueChanged",grid.id,GridOnAfterValueChanged),grid.EditRow=0,gridid=GetGridId(grid),!eval("mygrid"+gridid+".loadedmenu")){eval("mygrid"+gridid+".loadedmenu = true;");grid.bPageSetup=!1;try{eval("loadMenu"+gridid+"();")}catch(e){}eval("mygrid"+gridid+".Groups=''");eval("mygrid"+gridid+".Cols=''");eval("mygrid"+gridid+".NoPage=''");ribbon=eval("mygrid"+gridid+".RibbonBehavior");OnlyGrid&&(ribbon=="1"?(wp=document.getElementById("MSOZoneCell_WebPart"+eval("mygrid"+gridid+".Qualifier")),fireEvent(wp,"mouseup")):ribbon=="2"||(wp=document.getElementById("MSOZoneCell_WebPart"+eval("mygrid"+gridid+".Qualifier")),fireEvent(wp,"mouseup")))}ArrGantts.indexOf(grid.id)>-1&&grid.PagInfo&&setupPage(grid.PagInfo,eval("mygrid"+gridid+".UseReporting"),grid.PagSize,grid,eval("mygrid"+gridid+".CurPage"));SetGridSize(grid);eval("EPM.UI.Loader.current().stopLoading('WebPart"+eval("mygrid"+gridid+".Qualifier")+"')");document.getElementById("searchload"+grid.id.substr(9)).style.display="";RefreshCommandUI()}}function GridOnGetHtmlValue(grid,row,col,val){if(row.Def.Name=="R"){if(col=="Title"){var gridid=GetGridId(grid);return eval("mygrid"+gridid+".LinkType")!=""&&(val="<a href=\"javascript:GridGoToItem('"+grid.id+"','"+row.id+"');\">"+val+"<\/a>"),grid.GetValue(row,"HasComments")=="1"?val=val+"&nbsp;<a href=\"javascript:GridComments('"+grid.id+"','"+row.id+'\');return false;"><img src="/_layouts/15/epmlive/images/mywork/comment-small.png" border="0"><\/a>':grid.GetValue(row,"HasComments")=="2"&&(val=val+"&nbsp;<a href=\"javascript:GridComments('"+grid.id+"','"+row.id+'\');return false;"><img src="/_layouts/15/epmlive/images/mywork/commentsnew-small.png" border="0"><\/a>'),grid.GetValue(row,"wsurl")!=""&&(val=val+"&nbsp;<a href=\"javascript:GridWorkspace('"+grid.id+"','"+row.id+'\');return false;"><img src="/_layouts/15/epmlive/images/itemworkspace.png" border="0"><\/a>'),val}}else if(row.id=="Header"&&col=="State")return"State"}function GridWorkspace(n,t){var r=Grids[n],i=r.GetRowById(t),u;CurrentGrid=r;CurrentRow=i;n=GetGridId(r);u=window.epmLiveNavigation.currentWebUrl+"/_layouts/epmlive/gridaction.aspx?action=workspace&webid="+i.webid+"&listid="+i.listid+"&ID="+i.itemid+"&Source="+escape(location.href);location.href=u}function GridComments(n,t){var u=Grids[n],r=u.GetRowById(t),f,i;CurrentGrid=u;CurrentRow=r;n=GetGridId(u);f=window.epmLiveNavigation.currentWebUrl+"/_layouts/epmlive/gridaction.aspx?action=comments&webid="+r.webid+"&listid="+r.listid+"&ID="+r.itemid+"&Source="+escape(location.href);i=window.SP.UI.$create_DialogOptions();i.url=f;i.width=600;i.allowMaximize=!1;i.showClose=!0;window.SP.UI.ModalDialog.showModalDialog(i)}function GridCommentsCallBack(){GetRowData(CurrentGrid,CurrentRow)}function GridGoToItem(gridid,rowid){var grid=Grids[gridid],row=grid.GetRowById(rowid),LinkType,url,options;CurrentGrid=grid;CurrentRow=row;gridid=GetGridId(grid);LinkType=eval("mygrid"+gridid+".LinkType");url=new RegExp(/%\d[\dA-F]/g).test(location.href)?GetWebUrl()+"/_layouts/epmlive/gridaction.aspx?action="+LinkType+"&webid="+row.webid+"&listid="+row.listid+"&ID="+row.itemid+"&Source="+location.href:GetWebUrl()+"/_layouts/epmlive/gridaction.aspx?action="+LinkType+"&webid="+row.webid+"&listid="+row.listid+"&ID="+row.itemid+"&Source="+escape(location.href);eval("mygrid"+gridid+"._usepopup")?(options=window.SP.UI.$create_DialogOptions(),options.url=url,options.width=700,options.allowMaximize=!1,options.showClose=!0,options.dialogReturnValueCallback=GridCommentsCallBack,window.SP.UI.ModalDialog.showModalDialog(options)):location.href=url}function GridOnMouseOverOutside(n){n.CurHoverRow&&n.SetAttribute(n.GetRowById(n.CurHoverRow),"Title","ButtonText"," ",1);n.CurHoverRow=""}function GridOnMouseOverRow(n,t){n.CurHoverRow!=t.id&&(n.CurHoverRow=t.id,CurrentGrid=n,n.GetValue(t,"itemid")!=""&&(n.SetAttribute(t,"Title","ButtonText",'<div class="gridmenuspan" style="position:absolute;overflow:visible;margin-right:5px" id="'+t.id+'"><a data-itemid="'+n.GetValue(t,"itemid")+'" data-listid="'+n.GetValue(t,"listid")+'" data-webid="'+n.GetValue(t,"webid")+'" data-siteid="'+n.GetValue(t,"siteid")+'" ><\/a><\/div>',1),CurrentGrid=n,CurrentRow=t,window.epmLiveNavigation.addContextualMenu($("#"+t.id),[],null,null,{"delete":"GridGanttDeleteRow",comments:"GridCommentsCallBack",edit:"GridCommentsCallBack"})))}function GridOnSelect(n,t,i){n.id.substr(0,9)=="GanttGrid"&&(t.Kind=="Data"&&(t.itemid||n.SelectRange(t.firstChild,null,t.lastChild,null,!i,0)),setTimeout("RefreshCommandUI()",200))}function GridOnFocus(grid,row,col){if(curGrid=eval("mygrid"+grid.id.substr(9)),grid.id.substr(0,9)=="GanttGrid"&&row.Kind=="Data"){col=="Panel"?grid.SelectRow(row):row.itemid&&(grid.ActionClearSelection(),grid.SelectRow(row));var gridid=GetGridId(grid),ribbon=eval("mygrid"+gridid+".RibbonBehavior");ribbon!="1"&&ribbon!="2"&&SelectRibbonTab("Ribbon.ListItem",!0)}}function GridOnDblClick(n,t,i){n.id.substr(0,9)=="GanttGrid"&&EditGridRow(n,t,i)}function GridOnAfterValueChanged(n){n.id.substr(0,9)=="GanttGrid"&&(n.EditRowChanged=!0)}function ChangePage(pg,gridid){var grid=Grids["GanttGrid"+gridid];eval("mygrid"+gridid+".CurPage='"+pg+"'");ReloadGridWithNewParams(gridid)}function GridSort(n){n.ChangeSort("Title")}function GridHideShowSearch(n){var t=document.getElementById("searchdiv"+n.id.substr(9));t.style.display=t.style.display=="none"?"":"none";SetGridSize(n)}function GridHideShowFilter(n){var t=n.GetRowById("Filter");try{t.Visible?n.HideRow(t):n.ShowRow(t)}catch(i){}}function GridGanttDeleteRow(n){CurrentGrid.RemoveRow(CurrentGrid.GetRowById(n),1)}function GridClickOutside(n){n.EditRow&&StopEditGridRow(n,n.GetRowById("Header"))}function GridClick(n,t,i){n.EditRow&&StopEditGridRow(n,t);i=="Edit"&&EditGridRow(n,t,"")}function NewItemCallback(n,t){n&&GridNewItem(curGrid._gridid,t)}function GridNewItem(gridid,newid){var grid=Grids["GanttGrid"+gridid],row=grid.AddRow(null,null,!0,null,null),listid=eval("mygrid"+gridid+"._listid"),webid=eval("mygrid"+gridid+"._webid");grid.SetValue(row,"siteid",window.epmLive.currentSiteId);grid.SetValue(row,"webid",webid);grid.SetValue(row,"listid",listid);grid.SetValue(row,"itemid",newid);grid.SetAttribute(row,"Title","HtmlPrefix","<img src='/_layouts/15/epmlive/images/mywork/loading16.gif'>",1);grid.SetAttribute(row,"Title","ButtonText"," ",1);GetRowData(grid,row)}function StopEditGridRow(n,t){var t,r,u,f,e,i;if(t.id!=n.EditRow){if(t=n.GetRowById(n.EditRow),n.EditRow=null,n.EndEdit(!0),n.EditRowChanged){n.SetAttribute(t,"Title","HtmlPrefix","<img src='/_layouts/15/epmlive/images/mywork/loading16.gif'>",1);r="";u="";for(i in n.Cols)n.GetAttribute(t,i,"CanEdit")=="1"&&i!="G"&&(r+='<Field Name="'+i+'">'+escape(n.GetValue(t,i))+"<\/Field>"),u+=","+i;f='<Row id="'+t.id+'" siteid="'+t.siteid+'" webid="'+t.webid+'" listid="'+t.listid+'" itemid="'+t.itemid+'" Cols="'+u+'">'+r+"<\/Row>";e=window.epmLiveNavigation.currentWebUrl;$.ajax({type:"POST",url:(e+"/_vti_bin/WorkEngine.asmx/ExecuteJSON").replace(/\/\//g,"/"),data:"{ Function: 'webparts_SetGridRowEdit', Dataxml: '"+f+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(response){var oResp=eval("("+response.d+")"),col;oResp.Result.Status=="0"?n.AddDataFromServer(oResp.Result.InnerText):alert(oResp.Result.Error.Text);n.SetAttribute(t,"Title","HtmlPrefix","",1);for(col in n.Cols)n.SetAttribute(t,col,"CanEdit","0",1);n.AcceptChanges(t)},error:function(i){alert("Error: "+i);n.SetAttribute(t,"Title","HtmlPrefix","",1)}})}else{n.EditRow="";for(i in n.Cols)n.SetAttribute(t,i,"CanEdit","0",1),n.SetAttribute(t,"Title","HtmlPrefix","",1)}n.EditRowChanged=!1}}function GetRowData(n,t){var i="",r,u,f;for(r in n.Cols)i+=","+r;n.SetAttribute(t,"Title","HtmlPrefix","<img src='/_layouts/15/epmlive/images/mywork/loading16.gif'>",1);u='<Row id="'+t.id+'" siteid="'+t.siteid+'" webid="'+t.webid+'" listid="'+t.listid+'" itemid="'+t.itemid+'" Cols="'+i+'"><\/Row>';f=window.epmLiveNavigation.currentWebUrl;$.ajax({type:"POST",url:(f+"/_vti_bin/WorkEngine.asmx/ExecuteJSON").replace(/\/\//g,"/"),data:"{ Function: 'webparts_GetGridRow', Dataxml: '"+u+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(response){var oResp=eval("("+response.d+")"),col;oResp.Result.Status=="0"?n.AddDataFromServer(oResp.Result.InnerText):alert(oResp.Result.Error.Text);n.SetAttribute(t,"Title","HtmlPrefix","",1);for(col in n.Cols)n.SetAttribute(t,col,"CanEdit","0",1);n.AcceptChanges(t)},error:function(i){alert("Error: "+i);n.SetAttribute(t,"Title","HtmlPrefix","",1)}})}function LoadGrid(gridid){var gUrl=GetWebUrl()+"/_layouts/15/epmlive/getganttitems.aspx?data="+eval("mygrid"+gridid+".Params")+eval("mygrid"+gridid+".Searcher");epmdebug&&(gUrl+="&epmdebug=true");EPM.UI.Loader.current().startLoading({id:"WebPart"+eval("mygrid"+gridid+".Qualifier")});TreeGrid({Data:{Url:gUrl},SuppressMessage:3,Debug:""},"griddiv"+gridid)}function EditGridRow(n,t){var r,i,u,f;if(t.itemid&&n.EditRow!=t.id&&t.id!="Header"){r=window.epmLiveNavigation.currentWebUrl;i="";for(u in n.Cols)i+=","+u;i=i.substr(1);f='<Row id="'+t.id+'" siteid="'+t.siteid+'" webid="'+t.webid+'" listid="'+t.listid+'" itemid="'+t.itemid+'" Cols="'+i+'"/>';n.SetAttribute(t,"Title","HtmlPrefix","<img src='/_layouts/15/epmlive/images/mywork/loading16.gif'>",1);$.ajax({type:"POST",url:(r+"/_vti_bin/WorkEngine.asmx/ExecuteJSON").replace(/\/\//g,"/"),data:"{ Function: 'webparts_GetGridRowEdit', Dataxml: '"+f+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(response){var oResp=eval("("+response.d+")");oResp.Result.Status=="0"?(n.EditRow=t.id,n.AddDataFromServer(oResp.Result.InnerText),n.SetAttribute(t,"Title","HtmlPrefix",'<span class="icon-pencil" style="color: #CCC;padding-right:5px"><\/span>',1),n.StartEdit()):alert(oResp.Result.Error.Text)},error:function(n){alert("Error: "+n)}})}}function ChangeGroups(gridid,data){var sGroups="";for(var v in data)sGroups+=","+data[v].value;return sGroups!=""&&(sGroups=sGroups.substr(1)),eval("mygrid"+gridid+".Groups='"+sGroups+"'"),ReloadGridWithNewParams(gridid),!0}function ViewAllPages(gridid){if(confirm("Are you sure you want to view all items? If there are a lot of items, this process can take some time.")){eval("mygrid"+gridid+".NoPage='true'");var pagediv=document.getElementById("pagediv"+gridid),viewalldiv=document.getElementById("viewalldiv"+gridid);return pagediv.style.display="none",viewalldiv.style.display="none",ReloadGridWithNewParams(gridid),!0}}function ChangeColumns(gridid,data){return eval("mygrid"+gridid+".Cols='"+data.selectedKeys+"'"),ReloadGridWithNewParams(gridid),!0}function ReloadGridWithNewParams(gridid){EPM.UI.Loader.current().startLoading({id:"WebPart"+eval("mygrid"+gridid+".Qualifier")});var dataurl=eval("DataUrl"+gridid);Grids["GanttGrid"+gridid].Data.Data.Url=dataurl+"&Page="+eval("mygrid"+gridid+".CurPage")+"&Cols="+eval("mygrid"+gridid+".Cols")+"&GB="+eval("mygrid"+gridid+".Groups")+"&NP="+eval("mygrid"+gridid+".NoPage")+eval("mygrid"+gridid+".Searcher");Grids["GanttGrid"+gridid].Reload()}function GanttZoomIn(n){var t=Grids["GanttGrid"+n];t.ActionZoomIn()}function GanttZoomOut(n){var t=Grids["GanttGrid"+n];t.ActionZoomOut()}function GanttScrollTo(gridid){var grid=Grids["GanttGrid"+gridid],row=grid.FRow,GanttStartField,sDate,date;row!=null&&(GanttStartField=eval("mygrid"+gridid+".GanttStart"),sDate=grid.GetValue(row,GanttStartField),sDate!=""&&(date=new Date(sDate),grid.ScrollToDate(date,"left")))}function GridOnMouseOutRow(n,t){n.SetAttribute(t,"Title","ButtonText"," ",1)}var ArrGantts=[],GridProperties={},OnlyGrid=!1,CurrentGrid,CurrentRow;Array.prototype.indexOf||(Array.prototype.indexOf=function(n){for(var t=0;t<this.length;t++)if(this[t]===n)return t;return-1});$(window).resize(function(){for(var n in Grids)n.substr(0,9)=="GanttGrid"&&SetGridSize(Grids[n])});
/*
//# sourceMappingURL=GanttGrid.min.js.map
*/