function GetGridId(n){return n.id.substr(9)}function setupPage(n,t,i,r,u){var f=GetGridId(r),l=Math.ceil(n/i),s=document.getElementById("PagePrevious"+f),h=document.getElementById("PageNext"+f),y=document.getElementById("pagediv"+f),a=document.getElementById("viewalldiv"+f),c=document.getElementById("pagetable"+f),v,o,e;t?l>1?r.bPageSetup||(r.bPageSetup=!0,a.style.display="block",c.style.display="block",v=$("#pagediv"+f).parent(),$("#pagediv"+f).remove(),v.append('<div id="pagediv'+f+'"/>'),u=="0"&&(u="1"),$("#pagediv"+f).paginate({count:l,start:u,display:12,border:!0,rotate:!1,images:!1,mouse:"press",onChange:ChangePage,gridid:GetGridId(r)})):(a.style.display="none",c.style.display="none"):(y.style.display="inline-block",o=n.split("|"),e=eval("mygrid"+f),e.PAGEfirstItem=parseInt(o[2])*-1,e.PAGElastItem=o[1],o[0]=="0"||e.PAGEfItemHide==e.PAGEfirstItem?(s.style.background="#EFEFEF",s.style.opacity="0.5",e.PAGEfItemHide=e.PAGEfirstItem):(s.style.background="#DDDDDD",s.style.opacity="1"),o[3]=="true"?(h.style.background="#DDDDDD",h.style.opacity="1"):(h.style.background="#EFEFEF",h.style.opacity="0.5",e.PAGElastItem=0),o[3]!="true"&&o[0]=="0"&&(c.style.display="none"))}function GetPageHeight(){var n;return self.innerHeight?n=self.innerHeight:document.documentElement&&document.documentElement.clientHeight?n=document.documentElement.clientHeight:document.body&&(n=document.body.clientHeight),n}function GetItemTop(n){for(var t=n.offsetTop;n.offsetParent;)if(t=t+n.offsetParent.offsetTop,n==document.getElementsByTagName("body")[0])break;else n=n.offsetParent;return t}function SetGridSize(n){var t=GetGridId(n),i,e;if(OnlyGrid){var r=document.getElementById("gridouter"+t),u=GetPageHeight(),f=GetItemTop(r),o=SP.UI.ModalDialog.get_childDialog();r.style.height=o?u-f-105+"px":u-f-35+"px"}else i=n.GetBodyScrollHeight()+60,i<100&&(i=100),t=GetGridId(n),e=document.getElementById("gridouter"+t),e.style.height=i>parseInt(eval("mygrid"+t+".GridHeight"))?eval("mygrid"+t+".GridHeight")+"px":i+"px"}function GetWebUrl(){return _spPageContextInfo.webServerRelativeUrl=="/"?"":_spPageContextInfo.webServerRelativeUrl}function GridListSettings(n){var t=new SP.Guid(n),i=GetWebUrl()+"/_layouts/15/listedit.aspx?List="+SP.Utilities.HttpUtility.urlKeyValueEncode(t.toString("B").toUpperCase());SP.Utilities.HttpUtility.navigateTo(i)}function GridListEditView(n,t){var i=new SP.Guid(n),r=new SP.Guid(t),u=GetWebUrl()+"/_layouts/15/epmlive/gridaction.aspx?action=editview&List="+SP.Utilities.HttpUtility.urlKeyValueEncode(i.toString("B").toUpperCase())+"&View="+SP.Utilities.HttpUtility.urlKeyValueEncode(r.toString("B").toUpperCase())+"&Source="+escape(document.location.href);SP.Utilities.HttpUtility.navigateTo(u)}function GridListCreateView(n){var t=new SP.Guid(n),i=GetWebUrl()+"/_layouts/15/ViewNew.aspx?List="+SP.Utilities.HttpUtility.urlKeyValueEncode(t.toString("B").toUpperCase())+"&Source="+escape(document.location.href);SP.Utilities.HttpUtility.navigateTo(i)}function GridUnSearch(n){var t=Grids["GanttGrid"+n];eval("mygrid"+n+".CurPage='0'");eval("mygrid"+n+".Searcher=''");ReloadGridWithNewParams(n)}function GridSearch(n,t,i,r){var u=Grids["GanttGrid"+n];u?(u=Grids["GanttGrid"+n],eval("mygrid"+n+".CurPage='0'"),eval("mygrid"+n+".Searcher='&searchfield="+t+"&searchvalue="+escape(i)+"&searchtype="+r+"'"),ReloadGridWithNewParams(n)):(EPM.UI.Loader.current().startLoading({id:"WebPart"+eval("mygrid"+n+".Qualifier")}),eval("mygrid"+n+".Searcher='&searchfield="+t+"&searchvalue="+escape(i)+"&searchtype="+r+"'"),TreeGrid({Data:{Url:GetWebUrl()+"/_layouts/epmlive/getganttitems.aspx?data="+eval("mygrid"+n+".Params")+eval("mygrid"+n+".Searcher")},Export:{Url:GetWebUrl()+"/_layouts/15/epmlive/getgriditemsexport.aspx"},SuppressMessage:2,Debug:""},"griddiv"+n))}function GridOnLoaded(n){var t=GetGridId(n);n.Lang.Format.DecimalSeparator=eval("mygrid"+t+".DecimalSeparator");n.Lang.Format.GroupSeparator=eval("mygrid"+t+".GroupSeparator")}function GridOnReady(n){TGSetEvent("OnRenderFinish",n.id,GridOnRenderFinish);TGSetEvent("OnGetHtmlValue",n.id,GridOnGetHtmlValue);TGSetEvent("OnClick",n.id,GridClick);TGSetEvent("OnClickOutside",n.id,GridClickOutside);TGSetEvent("OnMouseOutRow",n.id,GridOnMouseOutRow);TGSetEvent("OnMouseOverOutside",n.id,GridOnMouseOverOutside);TGSetEvent("OnMouseOverRow",n.id,GridOnMouseOverRow);TGSetEvent("OnSelect",n.id,GridOnSelect);TGSetEvent("OnFocus",n.id,GridOnFocus);TGSetEvent("OnDblClick",n.id,GridOnDblClick);var t=GetGridId(n),i=eval("mygrid"+t+".LinkType");i==""&&(n.LinkTitleField=="LinkTitle"?eval("mygrid"+t+".LinkType='edit'"):n.LinkTitleField=="LinkTitleNoMenu"&&eval("mygrid"+t+".LinkType='view'"))}function GridOnRenderFinish(n){var t,r,i;if(n.id.substr(0,9)=="GanttGrid"){if(TGSetEvent("OnAfterValueChanged",n.id,GridOnAfterValueChanged),n.EditRow=0,t=GetGridId(n),!eval("mygrid"+t+".loadedmenu")){eval("mygrid"+t+".loadedmenu = true;");n.bPageSetup=!1;try{eval("loadMenu"+t+"();")}catch(u){}eval("mygrid"+t+".Groups=''");eval("mygrid"+t+".Cols=''");eval("mygrid"+t+".NoPage=''");r=eval("mygrid"+t+".RibbonBehavior");OnlyGrid&&(r=="1"?(i=document.getElementById("MSOZoneCell_WebPart"+eval("mygrid"+t+".Qualifier")),fireEvent(i,"mouseup")):r=="2"||(i=document.getElementById("MSOZoneCell_WebPart"+eval("mygrid"+t+".Qualifier")),fireEvent(i,"mouseup")))}ArrGantts.indexOf(n.id)>-1&&setupPage(n.PagInfo,eval("mygrid"+t+".UseReporting"),n.PagSize,n,eval("mygrid"+t+".CurPage"));SetGridSize(n);eval("EPM.UI.Loader.current().stopLoading('WebPart"+eval("mygrid"+t+".Qualifier")+"')");document.getElementById("searchload"+n.id.substr(9)).style.display="";RefreshCommandUI()}}function GridOnGetHtmlValue(n,t,i,r){if(t.Def.Name=="R"){if(i=="Title"){var f=GetGridId(n),u=GetGridItemUrl(n,t);return u&&u!==""||(u="javascript:;"),eval("mygrid"+f+".LinkType")!=""&&(r="<a onclick=\"GridGoToItem('"+n.id+"','"+t.id+'\'); return false;" href="'+u+'">'+r+"<\/a>"),n.GetValue(t,"HasComments")=="1"?r=r+"&nbsp;<a href=\"javascript:GridComments('"+n.id+"','"+t.id+'\');"><img src="/_layouts/15/epmlive/images/mywork/comment-small.png" border="0"><\/a>':n.GetValue(t,"HasComments")=="2"&&(r=r+"&nbsp;<a href=\"javascript:GridComments('"+n.id+"','"+t.id+'\');"><img src="/_layouts/15/epmlive/images/mywork/commentsnew-small.png" border="0"><\/a>'),n.GetValue(t,"wsurl")!=""&&(r=r+"&nbsp;<a href=\"javascript:GridWorkspace('"+n.id+"','"+t.id+'\');"><img src="/_layouts/15/epmlive/images/itemworkspace.png" border="0"><\/a>'),n.GetValue(t,"HasPlan")=="1"&&(r=r+'&nbsp;<a href="#"><span class="epm-nav-cm-icon fui-ext-project">&nbsp;<\/span><\/a>'),r}}else if(t.id=="Header"&&i=="State")return"State"}function GridWorkspace(n,t){var r=Grids[n],i=r.GetRowById(t),u;CurrentGrid=r;CurrentRow=i;n=GetGridId(r);u=window.epmLiveNavigation.currentWebUrl+"/_layouts/epmlive/gridaction.aspx?action=workspace&webid="+i.webid+"&listid="+i.listid+"&ID="+i.itemid+"&Source="+escape(location.href);location.href=u}function GridComments(n,t){var u=Grids[n],r=u.GetRowById(t),f,i;CurrentGrid=u;CurrentRow=r;n=GetGridId(u);f=window.epmLiveNavigation.currentWebUrl+"/_layouts/epmlive/gridaction.aspx?action=comments&webid="+r.webid+"&listid="+r.listid+"&ID="+r.itemid+"&Source="+escape(location.href);i=window.SP.UI.$create_DialogOptions();i.url=f;i.width=600;i.allowMaximize=!1;i.showClose=!0;window.SP.UI.ModalDialog.showModalDialog(i)}function GridCommentsCallBack(){GetRowData(CurrentGrid,CurrentRow)}function GetGridItemUrl(n,t){var r=GetGridId(n),i=eval("mygrid"+r+".LinkType"),u;return new RegExp(/%\d[\dA-F]/g).test(location.href)?GetWebUrl()+"/_layouts/epmlive/gridaction.aspx?action="+i+"&webid="+t.webid+"&listid="+t.listid+"&ID="+t.itemid+"&Source="+location.href:GetWebUrl()+"/_layouts/epmlive/gridaction.aspx?action="+i+"&webid="+t.webid+"&listid="+t.listid+"&ID="+t.itemid+"&Source="+escape(location.href)}function GridGoToItem(n,t){var r=Grids[n],f=r.GetRowById(t),u,i;CurrentGrid=r;CurrentRow=f;n=GetGridId(r);u=GetGridItemUrl(r,f);eval("mygrid"+n+"._usepopup")?(i=window.SP.UI.$create_DialogOptions(),i.url=u,i.width=700,i.allowMaximize=!1,i.showClose=!0,i.dialogReturnValueCallback=GridCommentsCallBack,window.SP.UI.ModalDialog.showModalDialog(i)):location.href=u}function GridOnMouseOverOutside(n){n.CurHoverRow&&n.SetAttribute(n.GetRowById(n.CurHoverRow),"Title","ButtonText"," ",1);n.CurHoverRow=""}function GridOnMouseOverRow(n,t){n.CurHoverRow!=t.id&&(n.CurHoverRow=t.id,CurrentGrid=n,n.GetValue(t,"itemid")!=""&&(n.SetAttribute(t,"Title","ButtonText",'<div style="position:absolute;overflow:visible;margin-right:5px" id="'+t.id+'"><a data-itemid="'+n.GetValue(t,"itemid")+'" data-listid="'+n.GetValue(t,"listid")+'" data-webid="'+n.GetValue(t,"webid")+'" data-siteid="'+n.GetValue(t,"siteid")+'" ><\/a><\/div>',1),CurrentGrid=n,CurrentRow=t,window.epmLiveNavigation.addContextualMenu($("#"+t.id),[],null,null,{"delete":"GridGanttDeleteRow",comments:"GridCommentsCallBack",edit:"GridCommentsCallBack"})))}function GridOnSelect(n,t,i){n.id.substr(0,9)=="GanttGrid"&&(t.Kind=="Data"&&(t.itemid||n.SelectRange(t.firstChild,null,t.lastChild,null,!i,0)),setTimeout("RefreshCommandUI()",200))}function GridOnFocus(n,t,i){if(curGrid=eval("mygrid"+n.id.substr(9)),n.id.substr(0,9)=="GanttGrid"&&t.Kind=="Data"){i=="Panel"?n.SelectRow(t):t.itemid&&(n.ActionClearSelection(),n.SelectRow(t));var u=GetGridId(n),r=eval("mygrid"+u+".RibbonBehavior");r!="1"&&r!="2"&&SelectRibbonTab("Ribbon.ListItem",!0)}}function GridOnDblClick(n,t,i){n.id.substr(0,9)=="GanttGrid"&&EditGridRow(n,t,i)}function GridOnAfterValueChanged(n){n.id.substr(0,9)=="GanttGrid"&&(n.EditRowChanged=!0)}function ChangePage(n,t){var i=Grids["GanttGrid"+t];eval("mygrid"+t+".CurPage='"+n+"'");ReloadGridWithNewParams(t)}function GridSort(n){n.ChangeSort("Title")}function GridHideShowSearch(n){var t=document.getElementById("searchdiv"+n.id.substr(9));t.style.display=t.style.display=="none"?"":"none";SetGridSize(n)}function GridHideShowFilter(n){var t=n.GetRowById("Filter");try{t.Visible?n.HideRow(t):n.ShowRow(t)}catch(i){}}function GridGanttDeleteRow(n){CurrentGrid.RemoveRow(CurrentGrid.GetRowById(n),1)}function GridClickOutside(n){n.EditRow&&StopEditGridRow(n,n.GetRowById("Header"))}function GridClick(n,t,i){n.EditRow&&StopEditGridRow(n,t);i=="Edit"&&EditGridRow(n,t,"")}function NewItemCallback(n,t){n&&GridNewItem(curGrid._gridid,t)}function GridNewItem(n,t){var i=Grids["GanttGrid"+n],r=i.AddRow(null,null,!0,null,null),u=eval("mygrid"+n+"._listid"),f=eval("mygrid"+n+"._webid");i.SetValue(r,"siteid",window.epmLive.currentSiteId);i.SetValue(r,"webid",f);i.SetValue(r,"listid",u);i.SetValue(r,"itemid",t);i.SetAttribute(r,"Title","HtmlPrefix","<img src='/_layouts/15/epmlive/images/mywork/loading16.gif'>",1);i.SetAttribute(r,"Title","ButtonText"," ",1);GetRowData(i,r);i.Reload()}function StopEditGridRow(n,t){var t,r,u,f,e,i;if(t.id!=n.EditRow){if(t=n.GetRowById(n.EditRow),n.EditRow=null,n.EndEdit(!0),n.EditRowChanged){n.SetAttribute(t,"Title","HtmlPrefix","<img src='/_layouts/15/epmlive/images/mywork/loading16.gif'>",1);r="";u="";for(i in n.Cols)n.GetAttribute(t,i,"CanEdit")=="1"&&i!="G"&&(r+='<Field Name="'+i+'">'+escape(n.GetValue(t,i))+"<\/Field>"),u+=","+i;f='<Row id="'+t.id+'" siteid="'+t.siteid+'" webid="'+t.webid+'" listid="'+t.listid+'" itemid="'+t.itemid+'" Cols="'+u+'">'+r+"<\/Row>";e=window.epmLiveNavigation.currentWebUrl;$.ajax({type:"POST",url:(e+"/_vti_bin/WorkEngine.asmx/ExecuteJSON").replace(/\/\//g,"/"),data:"{ Function: 'webparts_SetGridRowEdit', Dataxml: '"+f+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){var r=eval("("+i.d+")"),u;r.Result.Status=="0"?n.AddDataFromServer(r.Result.InnerText):alert(r.Result.Error.Text);n.SetAttribute(t,"Title","HtmlPrefix","",1);for(u in n.Cols)n.SetAttribute(t,u,"CanEdit","0",1);n.AcceptChanges(t)},error:function(i){alert("Error: "+i);n.SetAttribute(t,"Title","HtmlPrefix","",1)}})}else{n.EditRow="";for(i in n.Cols)n.SetAttribute(t,i,"CanEdit","0",1),n.SetAttribute(t,"Title","HtmlPrefix","",1)}n.EditRowChanged=!1}}function GetRowData(n,t){var i,r,u,f;if(t.itemid){i="";for(r in n.Cols)i+=","+r;n.SetAttribute(t,"Title","HtmlPrefix","<img src='/_layouts/15/epmlive/images/mywork/loading16.gif'>",1);u='<Row id="'+t.id+'" siteid="'+t.siteid+'" webid="'+t.webid+'" listid="'+t.listid+'" itemid="'+t.itemid+'" Cols="'+i+'"><\/Row>';f=window.epmLiveNavigation.currentWebUrl;$.ajax({type:"POST",url:(f+"/_vti_bin/WorkEngine.asmx/ExecuteJSON").replace(/\/\//g,"/"),data:"{ Function: 'webparts_GetGridRow', Dataxml: '"+u+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){var r=eval("("+i.d+")"),u;r.Result.Status=="0"?n.AddDataFromServer(r.Result.InnerText):alert(r.Result.Error.Text);n.SetAttribute(t,"Title","HtmlPrefix","",1);for(u in n.Cols)n.SetAttribute(t,u,"CanEdit","0",1);n.AcceptChanges(t)},error:function(i){alert("Error: "+i);n.SetAttribute(t,"Title","HtmlPrefix","",1)}})}}function LoadGrid(n){var t=GetWebUrl()+"/_layouts/15/epmlive/getganttitems.aspx?data="+eval("mygrid"+n+".Params")+eval("mygrid"+n+".Searcher");epmdebug&&(t+="&epmdebug=true");EPM.UI.Loader.current().startLoading({id:"WebPart"+eval("mygrid"+n+".Qualifier")});TreeGrid({Data:{Url:t},Export:{Url:GetWebUrl()+"/_layouts/15/epmlive/getgriditemsexport.aspx"},SuppressMessage:3,Debug:""},"griddiv"+n)}function EditGridRow(n,t){var r,i,u,f;if(t.itemid&&n.EditRow!=t.id&&t.id!="Header"){r=window.epmLiveNavigation.currentWebUrl;i="";for(u in n.Cols)i+=","+u;i=i.substr(1);f='<Row id="'+t.id+'" siteid="'+t.siteid+'" webid="'+t.webid+'" listid="'+t.listid+'" itemid="'+t.itemid+'" Cols="'+i+'"/>';n.SetAttribute(t,"Title","HtmlPrefix","<img src='/_layouts/15/epmlive/images/mywork/loading16.gif'>",1);$.ajax({type:"POST",url:(r+"/_vti_bin/WorkEngine.asmx/ExecuteJSON").replace(/\/\//g,"/"),data:"{ Function: 'webparts_GetGridRowEdit', Dataxml: '"+f+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){var r=eval("("+i.d+")");r.Result.Status=="0"?(n.EditRow=t.id,n.AddDataFromServer(r.Result.InnerText),n.SetAttribute(t,"Title","HtmlPrefix",'<span class="icon-pencil" style="color: #CCC;padding-right:5px"><\/span>',1),n.StartEdit()):alert(r.Result.Error.Text)},error:function(n){alert("Error: "+n)}})}}function ChangeGroups(n,t){var i="";for(var r in t)i+=","+t[r].value;return i!=""&&(i=i.substr(1)),eval("mygrid"+n+".Groups='"+i+"'"),ReloadGridWithNewParams(n,"FromGroupBy"),!0}function ViewAllPages(n){if(confirm("Are you sure you want to view all items? If there are a lot of items, this process can take some time.")){eval("mygrid"+n+".NoPage='true'");var t=document.getElementById("pagediv"+n),i=document.getElementById("viewalldiv"+n);return t.style.display="none",i.style.display="none",ReloadGridWithNewParams(n),!0}}function ChangeColumns(n,t){return eval("mygrid"+n+".Cols='"+t.selectedKeys+"'"),ReloadGridWithNewParams(n),!0}function ReloadGridWithNewParams(n,t){EPM.UI.Loader.current().startLoading({id:"WebPart"+eval("mygrid"+n+".Qualifier")});var i=eval("DataUrl"+n);Grids["GanttGrid"+n].Data.Data.Url=t=="FromGroupBy"?i+"&FromGroupBy=1&Page="+eval("mygrid"+n+".CurPage")+"&Cols="+eval("mygrid"+n+".Cols")+"&GB="+eval("mygrid"+n+".Groups")+"&NP="+eval("mygrid"+n+".NoPage")+eval("mygrid"+n+".Searcher"):i+"&Page="+eval("mygrid"+n+".CurPage")+"&Cols="+eval("mygrid"+n+".Cols")+"&GB="+eval("mygrid"+n+".Groups")+"&NP="+eval("mygrid"+n+".NoPage")+eval("mygrid"+n+".Searcher");Grids["GanttGrid"+n].Data.Export.Url=GetWebUrl()+"/_layouts/15/epmlive/getgriditemsexport.aspx";Grids["GanttGrid"+n].Reload()}function GanttZoomIn(n){var t=Grids["GanttGrid"+n];t.ActionZoomIn()}function GanttZoomOut(n){var t=Grids["GanttGrid"+n];t.ActionZoomOut()}function GanttScrollTo(n){var t=Grids["GanttGrid"+n],r=t.FRow,u,i,f;r!=null&&(u=eval("mygrid"+n+".GanttStart"),i=t.GetValue(r,u),i!=""&&(f=new Date(i),t.ScrollToDate(f,"left")))}function GridOnMouseOutRow(n,t){n.SetAttribute(t,"Title","ButtonText"," ",1)}function getHTML(n,t,i,r){if(t.Kind=="Data"&&i!="Title")try{if(n.GetValue(t,i).indexOf("<img")==0){var u=n.GetValue(t,i),f=u.split("/")[u.split("/").length-1];r=f.split('"')[0]}return r}catch(e){}}var ArrGantts=[],GridProperties={},OnlyGrid=!1,CurrentGrid,CurrentRow;Array.prototype.indexOf||(Array.prototype.indexOf=function(n){for(var t=0;t<this.length;t++)if(this[t]===n)return t;return-1});$(window).resize(function(){for(var n in Grids)n.substr(0,9)=="GanttGrid"&&SetGridSize(Grids[n])});Grids.OnGetExportValue=function(n,t,i,r){var u=getHTML(n,t,i,n.GetValue(t,i));if(u)return r+u};
//# sourceMappingURL=GanttGrid.min.js.map