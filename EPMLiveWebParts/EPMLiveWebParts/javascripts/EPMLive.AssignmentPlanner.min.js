function registerAssignmentPlannerScript(){(function(n,t,i,r){n.id=null;n.userId=null;n.startDate=null;n.dueDate=null;n.newStartDate=null;n.newDueDate=null;n.iconUrl=t.currentWebUrl+"/_layouts/epmlive/images/mywork/";n.maxVScroll=null;n.forceHeight=!1;n.showingComments=!1;n.epmrgv=null;n.curDateRangeType=null;n.firstLoad=!0;n.grid={g:null,checkedForChanges:!1,filteringOn:!0,groupingOn:!0,dataFunction:null,dataXml:null,actions:{calculateUsage:function(n,t){return t.StartDate&&t.DueDate&&t.Work&&t.AssignedToText?t.AssignedToText+"*"+t.Work/n.DiffGanttDate(t.DueDate,t.StartDate,"d"):""},rowSelectionChanged:function(t,i,r){return t.SetValue(i,"R",r?"":n.grid.actions.calculateUsage(t,i),!0),!0},updateFlag:function(r,u){var f,e,o;u.Def.Name!=="Header"&&u.Def.Name!=="Fixed"&&u.Def.Name!=="Group"&&u.Def.Name!=="Solid"&&(r.CloseDialog(),f=1,e=r.GetValue(u,"FlagValue"),(e==="1"||e===1)&&(f=0),o='<MyPersonalization><Item ID="{0}"/><List ID="{1}"/><Web ID="{2}"/><Site ID="{3}" URL="{4}"/><Personalizations><Personalization Key="AssignmentPlannerFlag" Value="{5}" /><\/Personalizations><\/MyPersonalization>'.format(u.ID,u.ListId,u.WebId,u.SiteId,t.currentSiteUrl,f),i.ajax({type:"POST",url:t.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'SetMyPersonalization', Dataxml: '"+o+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){var e,o;i.d?(e=t.parseJson(i.d),t.responseIsSuccess(e.Result)?(r.SetValue(u,"FlagValue",f,1),o='<img src="'+n.iconUrl+'unflagged.png" class="AP_Flag"/>',f&&(o='<img src="'+n.iconUrl+'flagged.png" class="AP_Flag"/>'),r.SetValue(u,"Flag",o,1)):t.logFailure(e.Result)):t.log("response.d: "+i.d)},error:function(n){t.log(n)}}))},processComments:function(i,r){var u=i.GetValue(r,"CommentCount"),f,e;return i.GetValue(r,"CommentProcessed")?u:(i.SetValue(r,"CommentProcessed",!0,0),f=function(i){var u,r;if(t.utils.isInt(i))return i===n.userId;if(i.indexOf(",")!==-1)for(u=i.split(","),r=0;r<u.length;r++)if(parseInt(u[r]===n.userId))return!0;return!1},u)?(e=f(i.GetValue(r,"CommentersRead")),'<div id="AP_CommentCount_{0}" class="{1}" onclick="window.epmLive.assignmentPlanner.actions.showComments();" style="cursor:pointer;">{2}<\/div>'.format(r.id,e?"AP_CommentRead":"AP_Comment",u)):'<div class="AP_CommentDisabled">&nbsp;<\/div>'},cellValueChanged:function(n,t,i){var r,e,f,u;if((i==="StartDate"||i==="DueDate")&&(r=n.Rows,r)){e=n.GetValue(t,i);for(f in r)r.hasOwnProperty(f)&&(u=r[f],u.Kind==="Data"&&u.id!==t.id&&u.ID===t.ID&&n.SetValue(u,i,e,1))}return!0}},resetNoDataRow:function(){var t=i("#"+n.id)[0],r,u,f;t&&(r=t.firstChild,n.grid.g.GetFirstVisible()||(t.removeChild(r),u=t.insertRow(0),f=u.insertCell(0),f.innerHTML="No assignments found."))},totalRowsSelected:function(){return this.g.GetSelRows().length},hasChanges:function(){this.checkedForChanges?this.checkedForChanges=!1:(this.checkedForChanges=!0,setTimeout("window.RefreshCommandUI()",1e3));var n=this.g.HasChanges().toString(2);return n[n.length-1]==="1"},reload:function(){var i=function(n,t){var u=n.split("?"),r;if(u.length>=2){var f=u.shift(),e=u.join("?"),o=encodeURIComponent(t)+"=",i=e.split(/[&;]/g);for(r=i.length;r-->0;)i[r].lastIndexOf(o,0)!==-1&&i.splice(r,1);n=f+"?"+i.join("&")}return n},t=i(window.location.href,"epmrgv");t=i(t,"startdate");t=i(t,"duedate");t=t+(t.indexOf("?")!==-1?"&":"?")+"epmrgv="+n.views.currentView.id+"&startdate="+n.newStartDate+"&duedate="+n.newDueDate;window.location=t},showColumnSelector:function(){n.grid.g.ActionShowColumns("Selectable")},hideRow:function(t){var i=n.grid.g;i.HideRow(i.GetRowById(t))},showRow:function(t){var i=n.grid.g;i.ShowRow(i.GetRowById(t))},hideFilters:function(){this.hideRow("AR1");this.filteringOn=!1;i.browser.msie&&window.setTimeout(function(){var t=n.grid.g;t.Render()},1)},showFilters:function(){this.showRow("AR1");this.filteringOn=!0;i.browser.msie&&window.setTimeout(function(){var t=n.grid.g;t.Render()},1)},hideGrouping:function(){var e=n.grid.g,t=null,r=e.Rows,u,f;for(u in r)if(r.hasOwnProperty(u)&&(f=r[u],f.Kind==="Group")){t=f.id;break}t&&(this.hideRow(t),this.groupingOn=!1);i.browser.msie&&window.setTimeout(function(){var t=n.grid.g;t.Render()},1)},showGrouping:function(){var e=n.grid.g,t=null,r=e.Rows,u,f;for(u in r)if(r.hasOwnProperty(u)&&(f=r[u],f.Kind==="Group")){t=f.id;break}t&&(this.showRow(t),this.groupingOn=!0);i.browser.msie&&window.setTimeout(function(){var t=n.grid.g;t.Render()},1)},toggleFiltering:function(){return this.filteringOn?this.hideFilters():this.showFilters(),this.filteringOn},toggleGrouping:function(){return this.groupingOn?this.hideGrouping():this.showGrouping(),this.groupingOn},removeSorting:function(){n.grid.g.ChangeSort("StartDate")},canZoomIn:function(){return n.grid.g.CanZoomIn()},zoomIn:function(){if(n.grid.canZoomIn()){var t=n.grid.g;t.ActionZoomIn();i.browser.msie&&window.setTimeout(function(){var t=n.grid.g;t.Render()},1)}},canZoomOut:function(){return n.grid.g.CanZoomOut()},zoomOut:function(){if(n.grid.canZoomOut()){var t=n.grid.g;t.ActionZoomOut();i.browser.msie&&window.setTimeout(function(){var t=n.grid.g;t.Render()},1)}},zoomToFit:function(){n.grid.g.ActionZoomFit()},scrollTo:function(){var t=n.grid.g,r=t.FRow,i;r&&(i=t.GetValue(r,"StartDate"),i&&t.ScrollToDate(new Date(i),"left"))},reloadData:function(t){if(t===1){n.views.previousView=n.views.currentView.id;var i=n.grid.g;i.Reload(i.Source,null,!1)}}};n.views={collection:{},currentView:null,previousView:null,userHasGlobalViewModificationPermission:!1,build:function(t){var i=n.grid.g,f,e,a,r,h;t.cols=[];t.filters=[];var v=i.Cols,u=i.GetCols("Visible"),y=0;for(f=0;f<u.length;f++)y+=i.Cols[u[f]].Width;for(e=0;e<u.length;e++){var c=u[e],o=i.Cols[c],s=o.Width,l=o.FixedWidth?o.FixedWidth===1?!0:!1:!1;l||(s=Math.round(s*100/y*1e3)/1e3);c==="Panel"&&(s=14,l=!0);t.cols.push({name:c,width:s,isfixedwidth:l,section:o.Sec})}t.filteringon=n.grid.filteringOn;a=i.GetRowById("AR1");for(r in v)v.hasOwnProperty(r)&&(h=a[r+"Filter"],h&&h!==0&&t.filters.push({column:r,value:a[r],cell:h}));return t.groupingon=n.grid.groupingOn,t.grouping=i.Group,t.sorting=i.Sort,t},getXml:function(n){for(var t,r,u,i='<View Id="{0}" Name="{1}" IsDefault="{2}" IsPersonal="{3}"><Cols>'.format(n.id,n.name,n.isdefault,n.ispersonal),f=0;f<n.cols.length;f++)t=n.cols[f],i+='<Col Name="{0}" Width="{1}" IsFixedWidth="{2}" Section="{3}"/>'.format(t.name,t.width,t.isfixedwidth,t.section);if(i+='<\/Cols><Filters RowVisible="{0}">'.format(n.filteringon||!1),n.filters)for(r=0;r<n.filters.length;r++)u=n.filters[r],i+='<Filter Column="{0}" Value="{1}" Cell="{2}"/>'.format(u.column,u.value,u.cell);return i+'<\/Filters><Grouping RowVisible="{0}">{1}<\/Grouping><Sorting>{2}<\/Sorting><\/View>'.format(n.groupingon||!1,n.grouping||"",n.sorting||"")},save:function(r){var u=n.grid.g;(u.StaticCursor=1,r.id=r.name!=="Default View"?t.md5(r.name):"dv",!this.collection[r.id]||confirm('Would you like to overwrite the "'+r.name+'" view?'))&&(r=this.build(r),i.ajax({type:"POST",url:t.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'AssignmentPlanner_SaveViews', Dataxml: '<View>"+this.getXml(r)+"<\/View>' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){if(i.d){var u=t.parseJson(i.d);t.responseIsSuccess(u.Result)?(window.SP.UI.Notify.addNotification('The view "{0}" has been saved.'.format(r.name),!1),n.views.collection[r.id]=r,n.views.apply(r.id)):t.logFailure(u.Result)}else t.log("response.d: "+i.d)},error:function(n){t.log(n)}}))},showSaveDialog:function(){var f=n.grid.g,r=document.createElement("div"),u;r.innerHTML=i("#APSaveView-{0}".format(n.id)).html();i(i(r).find("#APSaveView-Name-{0}".format(n.id))).val(this.currentView.name);this.currentView.isdefault&&i(i(r).find("#APSaveView-Default-{0}".format(n.id))).attr("checked","checked");u=i(r).find("#APSaveView-Personal-{0}".format(n.id));i(u).is(":disabled")||this.currentView.ispersonal&&i(u).attr("checked","checked");var e=i.browser.msie,o=e?120:115,s=e?220:215,t=window.SP.UI.$create_DialogOptions();t.title="Save View";t.html=r;t.height=o;t.width=s;t.allowMaximize=!1;t.showClose=!1;t.dialogReturnValueCallback=Function.createDelegate(null,n.views.showSaveDialogClosed);f.StaticCursor=0;f.ActionBlur();window.SP.UI.ModalDialog.showModalDialog(t)},apply:function(r){var f,s,d,g,ot,e,c,nt,tt,l,a,h,v,it,rt,y,ut,ft,et,p,w,b,k,at;if(n.actions.updateSplashStatus("Applying view"),f=null,s=t.getUrlParamByName("epmrgv"),s&&n.firstLoad?this.collection[s]&&(r=s,n.epmrgv=s):this.previousView&&(this.currentView=null,r=this.previousView),r)f=this.collection[r];else{d="dv";g=null;for(ot in this.collection)e=this.collection[ot],e.ispersonal&&e.isdefault?g=e.id:e.isdefault&&(d=e.id),f=this.collection[g||d]}if(!this.currentView||this.currentView.id!==f.id){var u=n.grid.g,o=[],st=[];for(c=0;c<f.cols.length;c++)nt=f.cols[c],tt=nt.name,u.MoveCol(tt,nt.section,1,1),o.push(tt);for(u.Render(),u.Update(),l=u.Group.split(","),u.DoGrouping(null),a=0;a<l.length;a++)u.HideCol(l[a]);for(h=u.GetCols("Visible"),h=h.concat(l),v=0;v<h.length;v++){for(it=!1,rt=h[v],y=0;y<o.length;y++)it=o[y]===rt;it||st.push(rt)}for(u.ChangeColsVisibility(o,st,0),ut=[],ft=[],et=0;et<o;et++)ut.push(null),ft.push(0);if(u.ChangeFilter(o,ut,ft,0,0,null),p=f.filters,p){var ht=[],ct=[],lt=[];for(w=0;w<p.length;w++)b=p[w],ht.push(b.column),ct.push(b.value),lt.push(b.cell);u.ChangeFilter(ht,ct,lt,0,0,null)}if(f.filterrowvisible?n.grid.showFilters():n.grid.hideFilters(),u.ChangeSort(f.sorting),f.groupingrowvisible?n.grid.showGrouping():n.grid.hideGrouping(),u.DoGrouping(f.grouping||null),u.Update(),u.Render(),this.currentView=f,this.previousView=null,window.RefreshCommandUI(),n.firstLoad&&window.setTimeout(function(){n.firstLoad=!1;u.SuppressMessage=0},2e3),u.Resources){k=0;for(at in u.Resources)if(k++,k>1)break;k===1&&u.ExpandAll()}n.grid.zoomToFit();i(".GSHeaderRow").each(function(){var n=i(this),t=n.text().trim().replace(/ +?/g,"").replace(String.fromCharCode(65279),"");(t==="Resource"||t==="ResourceUsage")&&n.find("td").each(function(){i(this).css("font-weight","bold")})});i("#EPMSplashContainer").hide();i.browser.msie&&window.setTimeout(function(){var t=n.grid.g;t.Update();t.Render()},10)}},load:function(){function r(t){function f(n){var t,i;return n&&(t=n.toLowerCase(),t==="true"?n=!0:t==="false"?n=!1:(i=parseInt(n),isNaN(i)||(n=i))),n}var e,r,o,s,u,i,b,h,c,k,l,a,d,g,v,y,nt,p,w,tt,it;for(t.length||(t=[t]),e=0;e<t.length;e++){r={};o=t[e];for(s in o)if(o.hasOwnProperty(s))if(u=s.replace(/@/,"").toLowerCase(),i=o[s],u==="cols"){for(i=i.Col,i.length||(i=[i]),b=[],h=0;h<i.length;h++){c=i[h];k={};for(l in c)c.hasOwnProperty(l)&&(k[l.replace(/@/,"").toLowerCase()]=f(c[l]));b.push(k)}r[u]=b}else if(u==="filters"){for(a in i)if(i.hasOwnProperty(a))if(d=a.replace(/@/,"").toLowerCase(),d==="filter"){for(i=i.Filter,i.length||(i=[i]),g=[],v=0;v<i.length;v++){y=i[v];nt={};for(p in y)y.hasOwnProperty(p)&&(nt[p.replace(/@/,"").toLowerCase()]=f(y[p]));g.push(nt)}r[u]=g}else r["filter"+d]=f(i[a])}else if(u==="grouping")for(w in i)i.hasOwnProperty(w)&&(tt=w.replace(/@/,"").toLowerCase(),it=f(i[w]),tt==="#text"?r[u]=it:r["grouping"+tt]=it);else r[u]=u!=="id"?f(i):i;n.views.collection[r.id]=r}}n.actions.updateSplashStatus("Loading views");i.ajax({type:"POST",url:t.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'AssignmentPlanner_LoadViews', Dataxml: '<Views/>' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(u){if(u.d){var e=t.parseJson(u.d),f=e.Result;t.responseIsSuccess(f)?(r(f.AssignmentPlannerViews.Views.View),n.views.apply()):(t.logFailure(f),i("#EPMSplashContainer").hide())}else t.log("response.d: "+u.d),i("#EPMSplashContainer").hide()},error:function(n){t.log(n);i("#EPMSplashContainer").hide()}})},getXmlForRibbon:function(){function r(i){var f,u,r;n.append("<MenuSection DisplayMode='Menu' Id='Ribbon.AssignmentPlanner.Views.Dropdown.Menu.{0}' Title='{0} Views'>".format(i));n.append("<Controls Id='Ribbon.AssignmentPlanner.Views.Dropdown.Menu.{0}.Controls'>".format(i));f=i==="Personal";for(u in t)t.hasOwnProperty(u)&&(r=t[u],r.name&&r.ispersonal===f&&n.append("<Button Id='Ribbon.AssignmentPlanner.views.{0}' Command='AssignmentPlanner.Cmd.CurrentViewDropDown.Select' LabelText='{1}' CommandValueId='{0}'/>".format(r.id,r.name)));n.append("<\/Controls>");n.append("<\/MenuSection>")}var t=this.collection,i=this.currentView,n=new window.Sys.StringBuilder;return n.append("<Menu Id='Ribbon.AssignmentPlanner.Views.Dropdown.Menu'>"),n.append("<MenuSection DisplayMode='Menu' Id='Ribbon.AssignmentPlanner.Views.Dropdown.Menu.Default' Title='Current View'>"),n.append("<Controls Id='Ribbon.AssignmentPlanner.Views.Dropdown.Menu.Default.Controls'>"),n.append("<Button Id='Ribbon.AssignmentPlanner.views.{0}' Command='AssignmentPlanner.Cmd.CurrentViewDropDown.Select' LabelText='{1}' CommandValueId='{0}'/>".format(i.id,i.name)),n.append("<\/Controls>"),n.append("<\/MenuSection>"),r("Global"),r("Personal"),n.append("<\/Menu>"),n.toString()},remove:function(){var r=this.currentView;if(!this.userHasGlobalViewModificationPermission&&!r.ispersonal){alert("You are not allowed to delete a global view");return}if(r.id==="dv"){alert("You cannot delete the Default View");return}confirm('Are you sure you want to delete the "'+r.name+'" view?')&&i.ajax({type:"POST",url:t.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'AssignmentPlanner_DeleteViews', Dataxml: '<View>"+this.getXml(r)+"<\/View>' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){if(i.d){var u=t.parseJson(i.d);t.responseIsSuccess(u.Result)?(window.SP.UI.Notify.addNotification('The view "{0}" has been deleted.'.format(r.name),!1),delete n.views.collection[r.id],n.views.apply()):t.logFailure(u.Result)}else t.log("response.d: "+i.d)},error:function(n){t.log(n)}})},rename:function(r){if(r){var u=this.currentView,f=u.name;if(u.name=r,!this.userHasGlobalViewModificationPermission&&!u.ispersonal){alert("You are not allowed to rename a global view");return}if(u.id==="dv"){alert("You cannot rename the Default View");return}confirm('Are you sure you want to rename the "'+f+'" view?')&&i.ajax({type:"POST",url:t.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'AssignmentPlanner_UpdateViews', Dataxml: '<View>"+this.getXml(u)+"<\/View>' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){if(i.d){var r=t.parseJson(i.d);t.responseIsSuccess(r.Result)?(window.SP.UI.Notify.addNotification('The view "{0}" has been renamed to "{1}".'.format(f,u.name),!1),n.views.currentView.name=u.name,n.views.collection[u.id].name=u.name,window.RefreshCommandUI()):t.logFailure(r.Result)}else t.log("response.d: "+i.d)},error:function(n){t.log(n)}})}},showRenameDialog:function(){var u=n.grid.g,r=document.createElement("div");r.innerHTML=i("#APRenameView-{0}".format(n.id)).html();i(i(r).find("#APRenameView-CurrentName-{0}".format(n.id))).html(this.currentView.name);var f=i.browser.msie,e=f?95:100,o=f?235:240,t=window.SP.UI.$create_DialogOptions();t.title="Rename View";t.html=r;t.height=e;t.width=o;t.allowMaximize=!1;t.showClose=!1;t.dialogReturnValueCallback=Function.createDelegate(null,n.views.showRenameDialogClosed);u.StaticCursor=0;u.ActionBlur();window.SP.UI.ModalDialog.showModalDialog(t)},showSaveDialogClosed:function(t,i){t===window.SP.UI.DialogResult.OK&&n.views.save(i)},showRenameDialogClosed:function(t,i){t===window.SP.UI.DialogResult.OK&&n.views.rename(i)}};n.models={collection:[],load:function(){var r=function(t){n.models.collection=[];t.length||(t=[t]);for(var i=0;i<t.length;i++)n.models.collection.push(t[i]["@Name"])};i.ajax({type:"POST",url:t.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'AssignmentPlanner_LoadModels', Dataxml: '<Models/>' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){if(n.d){var u=t.parseJson(n.d),i=u.Result;t.responseIsSuccess(i)?r(i.AssignmentPlannerModels.Models.Model):t.logFailure(i)}else t.log("response.d: "+n.d)},error:function(n){t.log(n)}})},save:function(){var f=function(t){return n.models.collection[t]?!0:!1},r=prompt("Please enter model name:",""),u=!0;if(f(r)&&(u=confirm("The model with name {0} already exists. Do you want to overwrite this model?".format(r))),u){var e=n.grid.g,o=e.GetXmlData("Data,Resources"),s=t.utils.base64.encode(o);i.ajax({type:"POST",url:t.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'AssignmentPlanner_SaveModels', Dataxml: '<Models><Model Name=\""+r+'"><![CDATA['+s+"]\]><\/Model><\/Models>' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){if(i.d){var u=t.parseJson(i.d),r=u.Result;t.responseIsSuccess(r)?(window.SP.UI.Notify.addNotification("Model has been saved successfully.",!1),n.models.load()):t.logFailure(r)}else t.log("response.d: "+i.d)},error:function(n){t.log(n)}})}},showOpenDialog:function(){var e=n.grid.g,u=document.createElement("div"),o,r,f;for(u.innerHTML=i("#APOpenModel-{0}".format(n.id)).html(),o=i(u).find("#APOpenModel-ModelList-{0}".format(n.id)),r=0;r<n.models.collection.length;r++)f=n.models.collection[r],i(o).append('<option value="'+f+'">'+f+"<\/option>");var s=i.browser.msie,h=s?90:85,c=s?215:210,t=window.SP.UI.$create_DialogOptions();t.title="Open Model";t.html=u;t.height=h;t.width=c;t.allowMaximize=!1;t.showClose=!1;t.dialogReturnValueCallback=Function.createDelegate(null,n.models.showOpenDialogClosed);e.StaticCursor=0;e.ActionBlur();window.SP.UI.ModalDialog.showModalDialog(t)},open:function(t){if(t){var u=n.grid.g,r=u.Source;n.grid.dataFunction||(n.grid.dataFunction=r.Data.Param.Function);n.grid.dataXml||(n.grid.dataXml=r.Data.Param.Dataxml);r.Data.Param.Function="AssignmentPlanner_GetModel";r.Data.Param.Dataxml=i("<div/>").text('<AssignmentPlannerModel Name="'+t+'"><\/AssignmentPlannerModel>').html();u.Reload(r,null,!1);window.setTimeout(function(){try{n.grid.hideFilters()}catch(t){}try{n.grid.hideGrouping()}catch(t){}},1e3)}},clear:function(){var r=n.grid.dataFunction,u=n.grid.dataXml,i,t;r&&u&&(i=n.grid.g,t=i.Source,t.Data.Param.Function=r,t.Data.Param.Dataxml=u,i.Reload(t,null,!1),window.setTimeout(function(){try{n.grid.hideFilters()}catch(t){}try{n.grid.hideGrouping()}catch(t){}},1e3))},showOpenDialogClosed:function(t,i){t===window.SP.UI.DialogResult.OK&&n.models.open(i)}};n.actions={close:function(){window.SP.UI.ModalDialog.commonModalDialogClose(window.SP.UI.DialogResult.cancel)},publish:function(){var l=n.grid.g,u="<Publish><Data><Items>",y=t.parseJson(l.GetChanges()),f=y.Grid.Changes.I,s,e,a,h,r,o,c,v;for(f.length||(f=[f]),s=0;s<f.length;s++){e=f[s];h=[];for(r in e)if(e.hasOwnProperty(r)){if(r==="@id"){a=e[r];continue}(r==="@StartDate"||r==="@DueDate")&&h.push({property:r.replace("@",""),value:e[r]})}if(a){for(o=l.GetRowById(a),u+='<Item SiteId="'+o.SiteId+'" WebId="'+o.WebId+'" ListId="'+o.ListId+'" ItemId="'+o.ID+'" ',c=0;c<h.length;c++)v=h[c],u+=v.property+'="'+v.value+'" ';u+="/>"}}u+="<\/Items><\/Data><\/Publish>";i.ajax({type:"POST",url:t.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'AssignmentPlanner_Publish', Dataxml: '"+u+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){if(n.d){var i=t.parseJson(n.d);t.responseIsSuccess(i.Result)?(window.SP.UI.Notify.addNotification("All updates have been published.",!1),l.AcceptChanges(),window.RefreshCommandUI()):t.logFailure(i.Result)}else t.log("response.d: "+n.d)},error:function(n){t.log(n)}})},print:function(){n.grid.g.ActionPrint()},exportExcel:function(){n.grid.g.ActionExport()},showComments:function(){n.actions.redirect("showcomments")},onCommentsPopupColsed:function(){n.showingComments=!1},redirect:function(i){var o=n.grid.g,e=o.GetSelRows();if(e.length===1){var r=e[0],u=r.ID,f="{0}/_layouts/epmlive/redirectionproxy.aspx?webid={1}&listname={2}".format(t.currentWebUrl,r.WebId,r.Work__Type);switch(i){case"edit":n.actions.displayPopUp("{0}&action=edit&id={1}".format(f,u),null,!0,!0,n.grid.reloadData);break;case"showcomments":n.showingComments||(n.actions.displayPopUp("{0}&action={1}&id={2}".format(f,i,u),null,!0,!0,n.actions.onCommentsPopupColsed,null,600,500),n.showingComments=!0);break;default:n.actions.displayPopUp("{0}&action={1}&id={2}".format(f,i,u))}}},displayPopUp:function(n,t,i,u,f,e,o,s){(i===r||i===null)&&(i=!0);u||(u=!0);f||(f=function(){});var h={title:t,allowMaximize:i,showClose:u,url:n,dialogReturnValueCallback:Function.createCallback(Function.createDelegate(null,f),e)};o&&(h.width=o);s&&(h.height=s);window.SP.UI.ModalDialog.showModalDialog(h)},setFromTo:function(){i(".ms-cui-ctl-medium").each(function(){var t=i(this);this.id==="Ribbon.AssignmentPlanner.Views.From-Medium"?t.find(".ms-cui-ctl-mediumlabel").first().text("From: "+n.startDate):this.id==="Ribbon.AssignmentPlanner.Views.To-Medium"&&t.find(".ms-cui-ctl-mediumlabel").first().text("To: "+n.dueDate)})},updateDateRange:function(i,r){var f=n.grid.g,e,u;r?(u=new Date(r),i==="From"?u<=new Date(n.dueDate)?(n.newStartDate="{0}/{1}/{2}".format(u.getMonth()+1,u.getDate(),u.getFullYear()),n.newDueDate=n.dueDate,n.grid.reload()):alert("The start date must be less than or equal to the due date."):u>=new Date(n.startDate)?(n.newDueDate="{0}/{1}/{2}".format(u.getMonth()+1,u.getDate(),u.getFullYear()),n.newStartDate=n.startDate,n.grid.reload()):alert("The due date must be greater than or equal to the start date.")):(window.curTempDate=n.dueDate,n.curDateRangeType="To",i==="From"&&(window.curTempDate=n.startDate,n.curDateRangeType="From"),e={url:"{0}/_layouts/epmlive/SelectDate.aspx".format(t.currentWebUrl),width:280,height:280,title:"Select {0} Date:".format(i),dialogReturnValueCallback:Function.createDelegate(null,n.actions.updateDateRangeClosed)},f.StaticCursor=0,f.ActionBlur(),window.SP.UI.ModalDialog.showModalDialog(e))},updateDateRangeClosed:function(t,i){t===window.SP.UI.DialogResult.OK&&n.actions.updateDateRange(n.curDateRangeType,i)},updateSplashStatus:function(n){i("#EPMSplashStatus").text(n+" . . .")}};window.Grids.OnReady=function(t){t.id===n.id&&(n.grid.g=window.Grids[n.id],n.views.load(),window.setTimeout(function(){var t=i(".SummaryTask.GSPx0xx");t.hover(function(){i(this).css("cursor","pointer")});t.removeClass("GSPx0xx").addClass("GSPx1xx EPM_AssignmentPlanner_Selector");t.attr("data-selected","false");i(window).resize(function(){n.actions.setFromTo()})},1e3))};window.Grids.OnLoaded=function(t){if(t.id===n.id){if(!n.forceHeight){var i=n.maxVScroll;i?t.MaxVScroll=i:t.NoVScroll=1}n.actions.updateSplashStatus("Rendering data")}};window.Grids.OnRenderFinish=function(t){if(t.id===n.id&&n.forceHeight){var r=i(parent.document.getElementsByTagName("iframe")[1]).parent().height()-i(document.getElementById("s4-ribbonrow")).height();i("td.HideCol0Title").each(function(){var n=i(this);n.text()==="Resource"&&(r-=n.parent().parent().parent().height())});i("#EpmLiveAssignmentPlannerGrid").height(r+40)}};window.Grids.OnUpdated=function(){n.grid.resetNoDataRow()};window.Grids.OnColumnsChanged=function(t,i){var u,r;if(t.id===n.id){u=t.GetLastCol("1");for(r in i)i[r]&&t.MoveCol(r,u,!0,0)}};window.Grids.OnGanttMenu=function(){return!0};window.Grids.OnDblClick=function(t,i,r){if(t.id===n.id&&r==="G")return!0};window.Grids.OnClick=function(t,r,u,f,e,o){var v=function(n,i){for(var r=n.firstChild;r;)t.SelectRow(r,i),r=r.nextSibling;window.RefreshCommandUI()},h,a,l,s,c;if(t.id===n.id){if(t.Cols[u].Type!=="Date")if(r.Kind==="Data"&&r.Def.Name==="R"){if(u==="Flag")return n.grid.actions.updateFlag(t,r),!0;if(o.shiftKey&&o.ctrlKey||!o.shiftKey&&!o.ctrlKey?(a=r.Selected,u!=="Panel"&&t.ActionClearSelection(),h=t.SelectRow(r,!a)):o.shiftKey?(l=t.GetSelRows(),t.ActionClearSelection(),h=l?t.SelectRange(l[0],null,r,null,1,1):t.SelectRow(r,!r.Selected)):h=t.SelectRow(r,!r.Selected),h!==null)return window.RefreshCommandUI(),!0}else r.Kind==="Data"&&r.Def.Name==="GroupAssignedToText"&&u==="Panel"&&(s=i(r.r0).find(".EPM_AssignmentPlanner_Selector"),c=!0,s.attr("data-selected")==="true"?(s.removeClass("GSPx2xx").addClass("GSPx1xx"),c=!1):s.removeClass("GSPx1xx").addClass("GSPx2xx"),v(r,c),s.attr("data-selected",c));i.browser.msie&&window.setTimeout(function(){var t=n.grid.g;t.Update();t.Render()},10)}};window.Grids.OnDataError=function(i,r,u,f,e){try{var o=t.parseJson(e),s=t.parseJson(o["soap:Envelope"]["soap:Body"].ExecuteResponse.ExecuteResult);alert(s.Result.Error["#text"]);n.actions.close()}catch(h){t.log(h)}};window.Grids.OnFilterFinish=function(n){i.browser.msie&&window.setTimeout(function(){n.Update();n.Render()},100)};window.SP.SOD.notifyScriptLoadedAndExecuteWaitingJobs("EPMLive.AssignmentPlanner.js")})(window.epmLiveAssignmentPlanner=window.epmLiveAssignmentPlanner||{},window.epmLive,window.jQuery)}ExecuteOrDelayUntilScriptLoaded(registerAssignmentPlannerScript,"EPMLive.js");try{document.getElementsByTagName("html")[0].className="ms-dialog"}catch(e){}try{document.getElementById("s4-ribbonrow").style.height="140px"}catch(e){}
/*
//# sourceMappingURL=EPMLive.AssignmentPlanner.min.js.map
*/