function registerEpmLiveResourceGridScript(){(function(n,t,i,r,u){function f(){var n=document.getElementById("EPMResourceGrid"),t=e(),i=o(n);n.style.height=t-i-35+"px"}function e(){var n;return self.innerHeight?n=self.innerHeight:document.documentElement&&document.documentElement.clientHeight?n=document.documentElement.clientHeight:document.body&&(n=document.body.clientHeight),n}function o(n){for(var t=n.offsetTop;n.offsetParent;)if(t=t+n.offsetParent.offsetTop,n==document.getElementsByTagName("body")[0])break;else n=n.offsetParent;return t}n.id=r.observable(null);n.autoFocus=!0;n.maxVScroll=null;n.webpartQualifier=null;n.pfeInstalled=!1;n.firstLoad=!0;n.epmrgv=null;n.resourceDictionary=null;n.resources=null;n.myResources=null;n.exportInProgress=!1;n.importInProgress=!1;n.webpartHeight=!1;n.userIsSiteAdmin=!1;n.allSelected=!1;n.ribbonBehavior=0;n.IsRootWeb=!1;n.WebId=null;n.ListId=null;n.ResListId=null;n.ItemId=null;n.LaunchInForm=!1;n.UserHaveResourceCenterPermission=!0;n.reports={wcReportId:null,opened:!1,collection:{},getXmlForRibbon:function(){var t=new window.Sys.StringBuilder,u=!1,r,i,f;t.append("<Menu Id='Ribbon.ResourceGrid.Views.Dropdown.Menu'>");t.append("<MenuSection DisplayMode='Menu' Id='Ribbon.ResourceGrid.Reporting.ReportsDropDown.Menu' Title='Reports'>");t.append("<Controls Id='Ribbon.ResourceGrid.Reporting.ReportsDropDown.Menu.Controls'>");r=n.reports.collection;for(i in r)r.hasOwnProperty(i)&&i!=="workvscapacity"&&(u=!0,f=r[i],t.append("<Button Id='Ribbon.ResourceGrid.Reports.{0}' Command='ResourceGrid.Cmd.ReportsDropDown.Select' LabelText=\"{1}\" CommandValueId='{0}'/>".format(i,f.name)));return u||t.append("<Button Id='Ribbon.ResourceGrid.Reports.{0}' Command='ResourceGrid.Cmd.ReportsDropDown.Select' LabelText='{1}' CommandValueId='{0}'/>".format("Loading","Loading...")),t.append("<\/Controls>"),t.append("<\/MenuSection>"),t.append("<\/Menu>"),t.toString()},open:function(i){var r,u;if(i&&i!=="0"&&i!==0&&i!=="Loading"){n.reports.opened=!0;var o=n.grid.grids[n.id()],e=o.GetSelRows(),f="";for(r=0;r<e.length;r++)u=e[r],u.Kind==="Data"&&u.Def.Name==="R"&&(f+="&rp:Resources="+u.ResourceID);n.reports.opened=!0;i=="Resource Work vs. Capacity"?window.open(n.reports.collection[t.md5(i)].url+f):window.open(n.reports.collection[i].url+f);window.setTimeout(function(){n.reports.opened=!1},2e3)}},load:function(){function r(i){for(var u,o,r,f,e=0;e<i.length;e++)if(u=i[e],u.Report.length>0)for(o=0;o<u.Report.length;o++)r=u.Report[o],f=r["@Name"],n.reports.collection[t.md5(f)]={name:f,url:r["@Url"],hasResourcesParam:r["@HasResourcesParam"]==="True"};else u.Report&&(r=u.Report,f=r["@Name"],n.reports.collection[t.md5(f)]={name:f,url:r["@Url"],hasResourcesParam:r["@HasResourcesParam"]==="True"})}i.ajax({type:"POST",url:t.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'Reporting_GetReportsByFolder', Dataxml: '<Reports><Folder>Report Library/epmlivetl/Resources<\/Folder><\/Reports>' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){if(i.d){var f=t.parseJson(i.d),u=f.Result;if(t.responseIsSuccess(u))try{u.GetReportsByFolder.Data.Folder&&u.GetReportsByFolder.Data.Folder.Folder&&r(u.GetReportsByFolder.Data.Folder.Folder)}catch(e){n.actions.areReportsLoaded=!0}else t.logFailure(u)}else t.log("response.d: "+i.d);n.actions.areReportsLoaded=!0},error:function(i){t.log(i);n.actions.areReportsLoaded=!0}})}};n.grid={grids:window.Grids,filteringOn:!0,groupingOn:!0,showColumnSelector:function(){this.g().ActionShowColumns("Selectable")},hideRow:function(n){var t=this.g();t.HideRow(t.GetRowById(n))},showRow:function(n){var t=this.g();t.ShowRow(t.GetRowById(n))},hideFilters:function(){this.hideRow("Filter");this.filteringOn=!1},showFilters:function(){this.showRow("Filter");this.filteringOn=!0},hideGrouping:function(){var u=this.g(),n=null,t=u.Rows,i,r;for(i in t)if(t.hasOwnProperty(i)&&(r=t[i],r.Kind==="Group")){n=r.id;break}n&&(this.hideRow(n),this.groupingOn=!1)},showGrouping:function(){var u=this.g(),n=null,t=u.Rows,i,r;for(i in t)if(t.hasOwnProperty(i)&&(r=t[i],r.Kind==="Group")){n=r.id;break}n&&(this.showRow(n),this.groupingOn=!0)},toggleFiltering:function(){return this.filteringOn?this.hideFilters():this.showFilters(),this.filteringOn},toggleGrouping:function(){return this.groupingOn?this.hideGrouping():this.showGrouping(),this.groupingOn},removeSorting:function(){this.g().ChangeSort("Title")},resetNoDataRow:function(){var t=i("#"+n.id())[0],r,u,f;t&&(r=t.firstChild,this.g().GetFirstVisible()||(t.removeChild(r),u=t.insertRow(0),f=u.insertCell(0),f.innerHTML="No resource found."))},reload:function(){var t=window.location.href.replace(new RegExp("&epmrgv="+n.epmrgv,"gi"),"").replace(new RegExp("epmrgv="+n.epmrgv,"gi"),"");t=(t+(t.indexOf("?")!==-1?"&":"?")+"epmrgv="+n.views.currentView.id).replace(new RegExp("&&","g"),"&");window.location=t},rowsSelected:function(){try{return n.grid.grids[n.id()].GetSelRows().length}catch(t){return 0}},resourceUpdated:function(r,u,f){var o,h;if(r===1){var e=n.grid.grids[n.id()],c=f.row||{id:0},s=f.changeType;if(s==="Deleted"){e.AddDataFromServer("<Grid><Changes><I id='"+c.id+"' Deleted='1'/><\/Changes><\/Grid>");n.actions.reIndexResources();return}if(o=c.id,s==="Added"){o="";for(h in e.Rows)e.Rows.hasOwnProperty(h)&&(o+=e.Rows[h].id+",");o=o.slice(0,-1)}i.ajax({type:"POST",url:t.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'GetResourcePoolDataGridChanges', Dataxml: '<ResourcePoolDataGridChanges><Params><ChangeType>"+s+"<\/ChangeType><Rows>"+o+"<\/Rows><\/Params><\/ResourcePoolDataGridChanges>' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){if(i.d){var r=t.parseJson(i.d);try{e.AddDataFromServer(r.ResourcePoolDataGridChanges.Data["#cdata"]);e.RenderBody();e.Render();e.Update();n.grid.fixIE();s==="Added"&&n.actions.reIndexResources()}catch(u){t.log(error)}}else t.log("response.d: "+i.d)},error:function(n){t.log(n)}})}},contextMenuResourceChanged:function(t){var r=n.grid.grids[n.id()],u,i;t&&(u=r.GetSelRows(),i=u[0],i||(i=r.GetRowById(t)),n.grid.resourceUpdated(1,null,{row:i,changeType:"Changed"}))},viewFormResourceChanged:function(t,i,r){n.grid.resourceUpdated(1,null,{row:r.row,changeType:r.changeType})},contextMenuResourceDelete:function(t){var r=n.grid.grids[n.id()],u,i;t&&(u=r.GetSelRows(),i=u[0],i||(i=r.GetRowById(t)),n.grid.resourceUpdated(1,null,{row:i,changeType:"Deleted"}))},fixIE:function(){var r,t;try{if(i.browser.msie)for(r=function(){var t=n.grid.g();t.Update();t.SetScrollTop(t.GetScrollTop()+2);t.SetScrollTop(t.GetScrollTop()-2);t.Update()},t=0;t<=50;t++)window.setTimeout(function(){r()},t*100)}catch(u){}},teamUpdated:function(t,i,r){n.IsRootWeb&&n.ListId==""&&n.ItemId==""?n.grid.resourceUpdated(t,i,r):n.grid.reload()}};n.grid.g=r.dependentObservable(function(){return this.grids[n.id()]},n.grid);n.views={collection:{},totalViews:0,currentView:null,previousView:null,userHasGlobalViewModificationPermission:!1,build:function(t){var i=n.grid.g(),f,e,a,r,h;t.cols=[];t.filters=[];var v=i.Cols,u=i.GetCols("Visible"),y=0;for(f=0;f<u.length;f++)y+=i.Cols[u[f]].Width;for(e=0;e<u.length;e++){var c=u[e],o=i.Cols[c],s=o.Width,l=o.FixedWidth?o.FixedWidth===1?!0:!1:!1;l||(s=Math.round(s*100/y*1e3)/1e3);c==="Panel"&&(s=14,l=!0);t.cols.push({name:c,width:s,isfixedwidth:l,section:o.Sec})}t.filteringon=n.grid.filteringOn;a=i.GetRowById("Filter");for(r in v)v.hasOwnProperty(r)&&(h=a[r+"Filter"],h&&h!==0&&t.filters.push({column:r,value:a[r],cell:h}));return t.groupingon=n.grid.groupingOn,t.grouping=i.Group,t.sorting=i.Sort,t},getXml:function(n){for(var t,r,u,i='<View Id="{0}" Name="{1}" IsDefault="{2}" IsPersonal="{3}"><Cols>'.format(n.id,escape(n.name),n.isdefault,n.ispersonal),f=0;f<n.cols.length;f++)t=n.cols[f],i+='<Col Name="{0}" Width="{1}" IsFixedWidth="{2}" Section="{3}"/>'.format(t.name,t.width,t.isfixedwidth,t.section);if(i+='<\/Cols><Filters RowVisible="{0}">'.format(n.filteringon||!1),n.filters)for(r=0;r<n.filters.length;r++)u=n.filters[r],i+='<Filter Column="{0}" Value="{1}" Cell="{2}"/>'.format(u.column,u.value,u.cell);return i+'<\/Filters><Grouping RowVisible="{0}">{1}<\/Grouping><Sorting>{2}<\/Sorting><\/View>'.format(n.groupingon||!1,n.grouping||"",n.sorting||"")},save:function(r){var u=n.grid.g();(u.StaticCursor=1,r.id=r.name!=="Default View"?t.md5(r.name):"dv",!this.collection[r.id]||confirm('Would you like to overwrite the "'+r.name+'" view?'))&&(r=this.build(r),i.ajax({type:"POST",url:t.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'SaveResourcePoolViews', Dataxml: '<ResourceGridViews>"+this.getXml(r)+"<\/ResourceGridViews>' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){var u,f;i.d?(u=t.parseJson(i.d),t.responseIsSuccess(u.Result)?(f=window.SP.UI.Notify.addNotification('The view "{0}" has been saved.'.format(r.name),!1),n.views.collection[r.id]=r,n.views.apply(r.id),setTimeout(function(){SP.UI.Notify.removeNotification(f)},1e3)):t.logFailure(u.Result)):t.log("response.d: "+i.d)},error:function(n){t.log(n)}}))},showSaveDialog:function(){var f=n.grid.g(),r=document.createElement("div"),u;r.innerHTML=i("#RWPSaveView-{0}".format(n.id())).html();i(i(r).find("#RWPSaveView-Name-{0}".format(n.id()))).val(this.currentView.name);this.currentView.isdefault&&i(i(r).find("#RWPSaveView-Default-{0}".format(n.id()))).attr("checked","checked");u=i(r).find("#RWPSaveView-Personal-{0}".format(n.id()));i(u).is(":disabled")||this.currentView.ispersonal&&i(u).attr("checked","checked");var e=i.browser.msie,o=e?140:135,s=e?230:225,t=window.SP.UI.$create_DialogOptions();t.title="Save View";t.html=r;t.height=o;t.width=s;t.allowMaximize=!1;t.showClose=!1;f.StaticCursor=0;f.ActionBlur();window.SP.UI.ModalDialog.showModalDialog(t)},apply:function(r){var f=null,l=t.getUrlParamByName("epmrgv"),it,rt,ct,o,u,lt,e,ut,a,p,w,ft,c,b,et,k,d,ot,st,ht,g,nt,tt;if(l&&n.firstLoad&&this.collection[l]&&(r=l,n.epmrgv=l),r)f=this.collection[r];else{it="dv";rt=null;for(ct in this.collection)o=this.collection[ct],o.ispersonal&&o.isdefault?rt=o.id:o.isdefault&&(it=o.id),f=this.collection[rt||it]}if(!this.currentView||this.currentView.id!==f.id){for(u=n.grid.g(),lt=n.actions.myResourcesOn,u.getColWidth||(u.getColWidth=function(n){if(n&&this.Cols[n]){var i=this.Cols[n].Width;return t.utils.isInt(i)||i.indexOf("-")!==-1&&(i=i.split("-")[0]),+i}return 0}),e=[],ut=[],a=0;a<f.cols.length;a++){var s=f.cols[a],h=s.name,v=u.Cols[h],y=0,at=u.getColWidth(h);s.isfixedwidth?(h==="Panel"&&(s.width=14),y=s.width-at):(y=-at,v&&(v.RelWidth=s.width));y!==0&&(v&&(v.Width+=y),u.Update());u.MoveCol(h,0,1,0);e.push(h)}for(u.Update(),u.Render(),u.Update(),p=u.Group.split(","),u.DoGrouping(null),w=0;w<p.length;w++)ft=p[w],ft&&u.HideCol(ft);for(c=u.GetCols("Visible"),c=c.concat(p),b=0;b<c.length;b++){for(et=!1,k=c[b],d=0;d<e.length;d++)if(e[d]===k){et=!0;break}!et&&k&&ut.push(k)}for(u.ChangeColsVisibility(e,ut,0),ot=[],st=[],ht=0;ht<e;ht++)ot.push(null),st.push(0);if(u.ChangeFilter(e,ot,st,0,0,null),g=f.filters,g){var vt=[],yt=[],pt=[];for(nt=0;nt<g.length;nt++)tt=g[nt],vt.push(tt.column),yt.push(tt.value),pt.push(tt.cell);u.ChangeFilter(vt,yt,pt,0,0,null)}else u.ChangeFilter("","","",0,0,null);f.filterrowvisible?n.grid.showFilters():n.grid.hideFilters();u.ChangeSort(f.sorting);n.grid.hideGrouping();u.DoGrouping(f.grouping||null);u.Render();u.Update();n.actions.myResourcesOn=!1;lt&&n.actions.toggleMyResources();this.currentView=f;window.RefreshCommandUI();n.actions.createToolBar("test");n.firstLoad&&(n.actions.resetEasyScroll(),window.setTimeout(function(){n.firstLoad=!1},2e3));window.setTimeout(function(){var t=n.grid.g();i(".EPMLiveResourceGridGroup").click(function(n){var r,u,f,e;try{if(i(n.currentTarget).attr("class").indexOf("Panel")===-1&&(r=i(this).parent(),r&&(r=r[0],r))){u=r.attributes;for(f in u)u.hasOwnProperty(f)&&(e=u[f],e.name==="onmousemove"&&(r=t.Rows[e.value.split('"')[1]],r.Expanded===1?t.Collapse(r):t.Expand(r),n.stopPropagation()))}}catch(o){}});n.grid.fixIE()},10)}},load:function(){function r(t){function f(n){var t,i;return n&&(t=n.toLowerCase(),t==="true"?n=!0:t==="false"?n=!1:(i=parseInt(n),isNaN(i)||(n=i))),n}var s,u,h,c,r,i,b,l,a,k,v,y,d,g,p,e,nt,o,tt,w,it,rt;for(t.length||(t=[t]),s=0;s<t.length;s++){u={};h=t[s];for(c in h)if(h.hasOwnProperty(c))if(r=c.replace(/@/,"").toLowerCase(),i=h[c],r.toLowerCase()==="name"&&(i=unescape(i)),r==="cols"){for(i=i.Col,i.length||(i=[i]),b=[],l=0;l<i.length;l++){a=i[l];k={};for(v in a)a.hasOwnProperty(v)&&(k[v.replace(/@/,"").toLowerCase()]=f(a[v]));b.push(k)}u[r]=b}else if(r==="filters"){for(y in i)if(i.hasOwnProperty(y))if(d=y.replace(/@/,"").toLowerCase(),d==="filter"){for(i=i.Filter,i.length||(i=[i]),g=[],p=0;p<i.length;p++){e=i[p];nt={};for(o in e)e.hasOwnProperty(o)&&(tt=o.replace(/@/,"").toLowerCase(),nt[tt]=tt==="value"?e[o]:f(e[o]));g.push(nt)}u[r]=g}else u["filter"+d]=f(i[y])}else if(r==="grouping")for(w in i)i.hasOwnProperty(w)&&(it=w.replace(/@/,"").toLowerCase(),rt=f(i[w]),it==="#text"?u[r]=rt:u["grouping"+it]=rt);else u[r]=r!=="id"?f(i):i;n.views.collection[u.id]=u;n.views.totalViews++}}i.ajax({type:"POST",url:t.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'GetResourcePoolViews', Dataxml: '<Views/>' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){if(i.d){var f=t.parseJson(i.d),u=f.Result;t.responseIsSuccess(u)?(n.views.totalViews=0,r(u.ResourcePoolViews.Views.View),n.views.apply()):t.logFailure(u)}else t.log("response.d: "+i.d);n.actions.isViewApplied=!0},error:function(i){t.log(i);n.actions.isViewApplied=!0}})},getXmlForRibbon:function(){function r(i){var e,f,r;n.append("<MenuSection DisplayMode='Menu' Id='Ribbon.ResourceGrid.Views.Dropdown.Menu.{0}' Title='{0} Views'>".format(i));n.append("<Controls Id='Ribbon.ResourceGrid.Views.Dropdown.Menu.{0}.Controls'>".format(i));e=i==="Personal";for(f in t)if(t.hasOwnProperty(f)&&(r=t[f],r.name&&r.ispersonal===e)){if(r.id==="dv"&&u>1)continue;n.append("<Button Id='Ribbon.ResourceGrid.views.{0}' Command='ResourceGrid.Cmd.CurrentViewDropDown.Select' LabelText=\"{1}\" CommandValueId='{0}'/>".format(r.id,r.name))}n.append("<\/Controls>");n.append("<\/MenuSection>")}var t=this.collection,i=this.currentView,u=this.totalViews,n=new window.Sys.StringBuilder;return n.append("<Menu Id='Ribbon.ResourceGrid.Views.Dropdown.Menu'>"),n.append("<MenuSection DisplayMode='Menu' Id='Ribbon.ResourceGrid.Views.Dropdown.Menu.Default' Title='Current View'>"),n.append("<Controls Id='Ribbon.ResourceGrid.Views.Dropdown.Menu.Default.Controls'>"),n.append("<Button Id='Ribbon.ResourceGrid.views.{0}' Command='ResourceGrid.Cmd.CurrentViewDropDown.Select' LabelText=\"{1}\" CommandValueId='{0}'/>".format(i.id,i.name)),n.append("<\/Controls>"),n.append("<\/MenuSection>"),r("Global"),r("Personal"),n.append("<\/Menu>"),n.toString()},remove:function(){var r=this.currentView;if(!this.userHasGlobalViewModificationPermission&&!r.ispersonal){alert("You are not allowed to delete a global view");return}if(r.id==="dv"){alert("You cannot delete the Default View");return}confirm('Are you sure you want to delete the "'+r.name+'" view?')&&i.ajax({type:"POST",url:t.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'DeleteResourcePoolViews', Dataxml: '<ResourceGridViews>"+this.getXml(r)+"<\/ResourceGridViews>' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){var u,f;i.d?(u=t.parseJson(i.d),t.responseIsSuccess(u.Result)?(f=window.SP.UI.Notify.addNotification('The view "{0}" has been deleted.'.format(r.name),!1),delete n.views.collection[r.id],n.views.totalViews--,n.views.apply(),setTimeout(function(){SP.UI.Notify.removeNotification(f)},1e3)):t.logFailure(u.Result)):t.log("response.d: "+i.d)},error:function(n){t.log(n)}})},rename:function(r){if(r){var u=this.currentView,f=u.name;if(u.name=r,!this.userHasGlobalViewModificationPermission&&!u.ispersonal){alert("You are not allowed to rename a global view");return}if(u.id==="dv"){alert("You cannot rename the Default View");return}confirm('Are you sure you want to rename the "'+f+'" view?')&&i.ajax({type:"POST",url:t.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'UpdateResourcePoolViews', Dataxml: '<ResourceGridViews>"+this.getXml(u)+"<\/ResourceGridViews>' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){var r,e;i.d?(r=t.parseJson(i.d),t.responseIsSuccess(r.Result)?(e=window.SP.UI.Notify.addNotification('The view "{0}" has been renamed to "{1}".'.format(f,u.name),!1),n.views.currentView.name=u.name,n.views.collection[u.id].name=u.name,window.RefreshCommandUI(),setTimeout(function(){SP.UI.Notify.removeNotification(e)},1e3)):t.logFailure(r.Result)):t.log("response.d: "+i.d)},error:function(n){t.log(n)}})}},showRenameDialog:function(){var u=n.grid.g(),r=document.createElement("div");r.innerHTML=i("#RWPRenameView-{0}".format(n.id())).html();i(i(r).find("#RWPRenameView-CurrentName-{0}".format(n.id()))).html(this.currentView.name);var f=i.browser.msie,e=f?135:140,o=f?235:240,t=window.SP.UI.$create_DialogOptions();t.title="Rename View";t.html=r;t.height=e;t.width=o;t.allowMaximize=!1;t.showClose=!1;u.StaticCursor=0;u.ActionBlur();window.SP.UI.ModalDialog.showModalDialog(t)}};n.actions={easyScrollOn:!1,myResourcesOn:!1,loadRibbon:function(){SP.SOD.executeOrDelayUntilScriptLoaded(function(){var r=function(t){window._ribbonStartInit(t,!0,null);i("#s4-ribbonrow").height(35);var r=window.setInterval(function(){document.getElementById("Ribbon.ResourceGridTab")||n.ribbonBehavior==0&&(window.SelectRibbonTab(t,!0),f())},1);window.setTimeout(function(){window.clearInterval(r);try{var t=function(){var r=[i(document.getElementById("Ribbon.ResourceGridTab-title")),i(document.getElementById("Ribbon.ResourceGridViewTab-title"))],u,n;for(u in r)r.hasOwnProperty(u)&&(n=r[u],n.attr("style","border-top: 1px solid #E1E1E1 !important; height: 33px !important; margin-top: -4px !important"),n.find("a").attr("style","padding-top: 4px !important;"),n.attr("aria-selected")==="false"&&n.attr("style","height: 33px !important; margin-top: -3px !important"),n.click(function(){window.setTimeout(function(){t()},100)}))};t();window.epmLiveMasterPageVersion>=5.5&&(epmLiveResourceGrid.loaderStopped||(i(document.getElementById("s4-ribbonrow")).height(35),window.EPM.UI.Loader.current().stopLoading("WebPart"+n.webpartQualifier),epmLiveResourceGrid.loaderStopped=!0));f();n.grid.fixIE();f()}catch(u){}},750)},u=SP.Ribbon.PageManager.get_instance(),t=null;try{t=u.get_ribbon()}catch(e){}t||typeof _ribbonStartInit=="function"&&(r("Ribbon.ResourceGridTab"),i("#EPMResourceGrid").focus())},"sp.ribbon.js")},dataTicketRequest:function(){for(var u,f,s=n.grid.g(),o=s.GetSelRows(),r=[],e=0;e<o.length;e++)if(u=o[e],u.Def.Name==="R")i.inArray(u.EXTID,r)===-1&&r.push(u.EXTID);else if(u.Def.Name==="Group")for(f=u.firstChild;f;)i.inArray(f.EXTID,r)===-1&&r.push(f.EXTID),f=f.nextSibling;return r.length>0?i.ajax({type:"POST",url:t.currentWebUrl+"/_vti_bin/PortfolioEngine.asmx/Execute",data:"{ Function: 'GenerateDataTicket', Dataxml: '<GenerateDataTicket><Ticket>"+r.join(",")+"<\/Ticket><\/GenerateDataTicket>' }",contentType:"application/json; charset=utf-8",dataType:"json"}):null},retriveDataTicket:function(n){if(n.d){var i=t.parseJson(n.d),r=i.GenerateDataTicket;if(t.responseIsSuccess(r.Result))return r.Data.Ticket["@Id"];t.logFailure(i.Result)}else t.log("response.d: "+n.d);return null},displayPopUp:function(n,t,i,r,u,f,e,o){var h,s;i||(i=!0);u||(u=function(){});h=e&&o?{title:t,allowMaximize:i,showMaximized:!0,showClose:r,url:n,dialogReturnValueCallback:Function.createCallback(Function.createDelegate(null,u),f),width:e,height:o}:{title:t,allowMaximize:i,showClose:r,url:n,dialogReturnValueCallback:Function.createCallback(Function.createDelegate(null,u),f)};t==="Assignment Planner"&&(s=document.createElement("iframe"),s.setAttribute("src",n),s.setAttribute("width","99%"),s.setAttribute("height","98%"),h.url=null,h.html=s);window.SP.UI.ModalDialog.showModalDialog(h)},RefreshItems:function(){toastr.options={closeButton:!1,debug:!1,positionClass:"toast-top-right",onclick:null,showDuration:"3000",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};window.RefreshCommandUI();i.ajax({type:"POST",url:t.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'RefreshResources', Dataxml: '<RefreshResources/>' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){var r,i,u;n.d?(r=t.parseJson(n.d),i=r.Result,t.responseIsSuccess(i)?(u=i.RefreshResources,u["@Success"]==="0"?window.parent.toastr.success("Refresh job started successfully. Status can be viewed on the Work Queue page within Settings."):window.parent.toastr.error("Unable to start Refresh Job. There was some error.")):window.parent.toastr.error("Unable to start Refresh Job. There was some error.")):window.parent.toastr.error("Unable to start Refresh Job. There was no response from the server.");window.RefreshCommandUI()},error:function(n){window.parent.toastr.error("Unable to start Refresh Job. The response was: ("+n.status+") "+n.statusText);window.RefreshCommandUI()}})},analyzeResources:function(){var r=window.epmLiveNavigation.isImportResourceRunning(),i;r?alert("The Resource Analyzer cannot be opened because there is an active resource import job running."):(i=n.actions.dataTicketRequest(),i&&i.success(function(i){var r=n.actions.retriveDataTicket(i),u;r&&(u="{0}/_layouts/ppm/rpanalyzer.aspx?dataid={1}".format(t.currentWebUrl,r),n.actions.displayPopUp(u,"Resource Analyzer",!0,!0,null,null,700,700))}))},redirect:function(i){var y=n.grid.grids[n.id()],e=y.GetSelRows(),o=e[0],u=null,s,h,c,v,r;if(n.grid.rowsSelected()>0&&(u=i==="viewprofile"?o.ResourceID:o.ID),i==="sendnotification"){var f=[],l=!1,a=0;for(s=0;s<e.length;s++)if(h=e[s],h.Kind==="Data"&&h.Def.Name==="R"){if(c=h.Email,a=f.toString().length+c.length,a>1950){l=!0;break}c&&f.push(c)}l?(v=confirm("You can send "+f.length+" out of "+e.length+" notifications, do you want to continue?"),v==!0&&(window.location.href="mailto:{0}".format(f.join(";")))):window.location.href="mailto:{0}".format(f.join(";"));return}r="{0}/_layouts/epmlive/redirectionproxy.aspx?listname=Resources&webid={1}".format(t.currentWebUrl,t.currentWebId);switch(i){case"add":n.actions.displayPopUp("{0}&action=new".format(r),null,!0,!0,n.grid.resourceUpdated,{row:null,changeType:"Added"});break;case"edit":n.actions.displayPopUp("{0}&action=edit&id={1}".format(r,u),null,!0,!0,n.grid.resourceUpdated,{row:o,changeType:"Changed"});break;case"showcomments":n.actions.displayPopUp("{0}&action={1}&id={2}".format(r,i,u),null,!0,!0,null,null,700,700);break;case"view":n.actions.displayPopUp("{0}&action={1}&id={2}".format(r,i,u),null,!0,!0,n.grid.viewFormResourceChanged,{row:o,changeType:"Changed"});break;default:n.actions.displayPopUp("{0}&action={1}&id={2}".format(r,i,u))}},loadResourcePlanner:function(){var r=window.epmLiveNavigation.isImportResourceRunning(),i;r?alert("The Resource Planner cannot be opened because there is an active resource import job running."):(i=n.actions.dataTicketRequest(),i&&i.success(function(i){var r=n.actions.retriveDataTicket(i),u;r&&(u="{0}/_layouts/ppm/RPEditor.aspx?dataid={1}&isresource=1".format(t.currentWebUrl,r),n.actions.displayPopUp(u,"Resource Planner",!0,!1,null,null,700,700))}))},loadAssignmentPlanner:function(){for(var f,e,o=n.grid.g(),u=o.GetSelRows(),i=[],r=0;r<u.length;r++)f=u[r],i.push(f.ID);i.length>0&&(e="{0}/_layouts/epmlive/AssignmentPlanner.aspx?resources={1}&IsDlg=1".format(t.currentWebUrl,i.join(",")),n.actions.displayPopUp(e,"Assignment Planner",!0,!0,null,null,1e3,700))},deleteResource:function(){var u=n.grid.g(),r=u.GetSelRows()[0];if(r.Kind==="Data"&&r.Def.Name==="R"){if(!confirm("Are you sure you want to delete this resource?"))return;i.ajax({type:"POST",url:t.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'DeleteResourcePoolResource', Dataxml: '<DeleteResourcePoolResource><Resource Id=\""+r.ID+"\"/><\/DeleteResourcePoolResource>' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(u){var f,o,e,s;if(u.d)if(f=t.parseJson(u.d),t.responseIsSuccess(f.Result)){if(o=f.Result.DeleteResourcePoolResource.Resource,e=o["@Status"],e==="0")n.grid.resourceUpdated(1,null,{row:r,changeType:"Deleted"});else if(s=o["#cdata"],e==="1")alert(s);else if(e==="2"){if(!confirm(s))return;i.ajax({type:"POST",url:t.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'DeleteResourcePoolResource', Dataxml: '<DeleteResourcePoolResource><Resource Id=\""+r.ID+'" ConfirmDelete="True"/><\/DeleteResourcePoolResource>\' }',contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){if(i.d){var u=t.parseJson(i.d);t.responseIsSuccess(u.Result)?n.grid.resourceUpdated(1,null,{row:r,changeType:"Deleted"}):t.logFailure(u.Result)}else t.log("resp.d: "+i.d)},error:function(n){t.log(n)}})}}else t.logFailure(f.Result);else t.log("response.d: "+u.d)},error:function(n){t.log(n)}})}},resetEasyScroll:function(){var t=n.grid.g();i("#EPMLiveResourceGridSelector").watermark("Type here to search...");n.resourceDictionary==null&&n.actions.reIndexResources();i("#EPMLiveResourceGridSelector").autocomplete({source:function(t,r){var u=i.ui.autocomplete.filter(n.actions.myResourcesOn?n.myResources:n.resources,t.term);r(u)},select:function(i,r){var f=n.resourceDictionary[r.item.value],u;f&&(u=t.Rows[f],t.ExpandParents(u),t.ActionClearSelection(),t.SelectRow(u,!0),t.SetScrollTop(t.GetRowTop(u)));n.actions.toggleEasyScroll();window.setTimeout(function(){window.RefreshCommandUI()},100)}});i("#s4-ribbonrow").click(function(t){for(var u,e=!0,o=i(t.target).parents(),r=0;r<5;r++)try{if(u=o[r],u&&i(u)[0].id.indexOf("Ribbon.ResourceGrid.Actions.Find")!==-1){e=!1;f();break}}catch(s){}e&&(n.actions.hideEasyScroll(!0),f())})},toggleEasyScroll:function(){var u=i(".callout"),t,r,f,e;if(u.length&&(u=u[0]),t=i(u),t.is(":visible"))n.actions.hideEasyScroll(!1);else{if(n.resources.length===0)return!1;r=document.getElementById("Ribbon.ResourceGrid.Actions.Find-Large");r||(r=document.getElementById("Ribbon.ResourceGrid.Actions.Find-Small"));r&&i(".epmliveToolBar").length==0&&(f=i(r),e=f.offset(),t.css({top:e.top+f.height()}),t.css({left:e.left+f.width()/2-31}),i("#EPMLiveResourceGridSelector").val(""),t.show(),i("#EPMLiveResourceGridSelector").focus(),n.actions.easyScrollOn=!0)}return n.actions.easyScrollOn},reIndexResources:function(){var f=n.grid.g(),i,r,t,u;n.resourceDictionary={};n.resources=[];n.myResources=[];i=f.Rows;for(r in i)i.hasOwnProperty(r)&&(t=i[r],t.Kind==="Data"&&t.Def.Name==="R"&&(u=t.Title,n.resources.push(u),n.resourceDictionary[u]=r,t.IsMyResource===1&&n.myResources.push(u)))},toggleMyResources:function(){var t=n.grid.g();n.actions.myResourcesOn?(t.ChangeFilter("IsMyResource","0",6,0,1,null),n.actions.myResourcesOn=!1):(t.ChangeFilter("IsMyResource","1",1,0,1,null),n.actions.myResourcesOn=!0)},hideEasyScroll:function(t){var r=i(".callout"),u;r.length&&(r=r[0]);u=i(r);u.is(":visible")&&(u.hide(),n.actions.easyScrollOn=!1,t&&window.setTimeout(function(){window.RefreshCommandUI()},100))},exportResources:function(){var o,e,f,u,r;for(n.exportInProgress=!0,window.RefreshCommandUI(),o=i("#EPMLiveStatusbar").height(),e=t.ui.statusbar.collection(),f=0;f<e.length;f++)e[f].remove();u=t.ui.statusbar.add("Status","Exporting resources to Excel spreadsheet...");u.color("yellow");r=u.collection()[0];i.ajax({type:"POST",url:t.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'ExportResources', Dataxml: '<ExportResources/>' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){var s,f,e,o;i.d?(s=t.parseJson(i.d),f=s.Result,t.responseIsSuccess(f)?(e=f.ResourceExporter,e["@Success"]==="True"?(r.message('Resources exported succesfully. Click <a href="'+t.currentWebUrl+"/_layouts/epmlive/filedownloader.aspx?fileid="+e["@File"]+'&filename=Resources.xlsm&ct=application/ms-excel">here<\/a> to download the spreadsheet.'),u.color("blue")):(o=e["@Message"],t.log(o),r.title("Error"),r.message("Unable to export resources. The response was: "+o),u.color("red"))):(t.log(f),r.title("Error"),r.message("Unable to export resources. The response was: "+f),u.color("red"))):(t.log(i.d),r.title("Error"),r.message("Unable to export resources. There was no response from the server."),u.color("red"));n.exportInProgress=!1;window.RefreshCommandUI()},error:function(i){t.log(i);r.title("Error");r.message("Unable to export resources. The response was: ("+i.status+") "+i.statusText);u.color("red");n.exportInProgress=!1;window.RefreshCommandUI()}})},importResources:function(){i.ajax({type:"POST",url:t.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'IsImportResourceAlreadyRunning', Dataxml: '' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(r){var e,u,o,s,f;r.d&&(e=t.parseJson(r.d),u=e.Result,t.responseIsSuccess(u)&&(u.ResourceImporter["@Success"]==="True"?(o=confirm("A resource import job is currently running and is "+u.ResourceImporter["@PercentComplete"]+"% complete. Would you like to cancel it and run this new import job instead?"),o&&(s='<Data><Param key="JobID">'+u.ResourceImporter["@JobUid"]+"<\/Param><\/Data>",i.ajax({type:"POST",url:t.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'CancelTimerJob', Dataxml: '"+s+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(){var n=window.SP.UI.$create_DialogOptions();n.title="Import Resources";n.url=t.currentWebUrl+"/_layouts/epmlive/importresources.aspx";n.dialogReturnValueCallback=window.epmLiveResourceGrid.actions.onImportResourcesCompleted;window.SP.UI.ModalDialog.showModalDialog(n)},error:function(i){t.log(i);status.title("Error");status.message("Unable to cancel timer job for import resources. The response was: ("+i.status+") "+i.statusText);statusbar.color("red");n.importInProgress=!1;window.RefreshCommandUI()}}))):(f=window.SP.UI.$create_DialogOptions(),f.title="Import Resources",f.url=t.currentWebUrl+"/_layouts/epmlive/importresources.aspx",f.dialogReturnValueCallback=window.epmLiveResourceGrid.actions.onImportResourcesCompleted,window.SP.UI.ModalDialog.showModalDialog(f))))},error:function(i){t.log(i);status.title("Error");status.message("Unable to check if any import resources job is running. The response was: ("+i.status+") "+i.statusText);statusbar.color("red");n.importInProgress=!1;window.RefreshCommandUI()}})},onImportResourcesCompleted:function(t){t===1&&n.grid.reload()},canExport:function(){return!n.exportInProgress&&n.userIsSiteAdmin},canImport:function(){return!n.importInProgress&&n.userIsSiteAdmin},createToolBar:function(t){(function r(){var h,v,c,l,e,y,s,a,p,w,g,b,nt,rt,d,ut,ft;if(n.actions.isViewApplied&&n.actions.areReportsLoaded){i("#resourcePoolToolBar").length>0&&i("#resourcePoolToolBar").remove();var f=window.Grids[window.epmLive.resourceGridId],et=f.Cols,o=[];for(e in f.Cols)et.hasOwnProperty(e)&&e.toLowerCase()!="panel"&&o.push(f.Cols[e]);function ot(n,t){return n.Name<t.Name?-1:n.Name>t.Name?1:0}o.sort(ot);h="";v=[];for(e in o)f.Header[o[e].Name].trim()&&v.push(f.Header[o[e].Name]+"|"+o[e].Name);function st(n,t){return n.split("|")[0].toLowerCase()<t.split("|")[0].toLowerCase()?-1:n.split("|")[0].toLowerCase()>t.split("|")[0].toLowerCase()?1:0}if(h=v.sort(st).join(","),c={},l=[],n.views.currentView.cols!=null&&n.views.currentView.cols!=u)for(e in n.views.currentView.cols)l.push(n.views.currentView.cols[e].name);for(s=1,y=h.split(","),s=0;s<y.length;s++)a=y[s].split("|"),c[a[1].trim()]={value:a[0].trim(),checked:i.inArray(a[1].trim().toString(),l)!=-1};p={heading:"none",divider:"no",options:[]};w=n.views.collection;for(g in w)b=w[g],nt={text:b.name,events:[{eventName:"click","function":function(){n.views.apply(i(this).attr("viewId"));i(this).closest("ul").toggle();i(this).closest("ul").siblings("a").eq(0).children("span").eq(1).text(n.views.currentView.name);i(this).closest("li").siblings().each(function(){i(this).css("display","")});i(this).closest("li").css("display","none")}}],properties:{viewId:b.id}},p.options.push(nt);var tt=n.reports.collection,it=[],k="";for(rt in tt)d=tt[rt],ut={iconClass:"",text:d.name,events:[{eventName:"click","function":function(t){var e,f,r,u,o;if(k="",t.target.innerHTML=="Resource Work vs. Capacity")for(e=n.grid.grids[n.id()],f=e.GetSelRows(),r=0;r<f.length;r++)u=f[r],u.Kind==="Data"&&u.Def.Name==="R"&&(k+="&rp:Resources="+u.ResourceID);o=i(this).attr("reportUrl")+k;window.open(o,"_blank")}}],properties:{reportUrl:d.url}},it.push(ut);ft=[{id:"resourcePoolToolBar"},{placement:"left",content:[{controlId:"btnInvite",controlType:"button",iconClass:"icon-plus-2",value:"Invite",events:[{eventName:"click","function":function(){n.LaunchInForm?window.location.href=n.actions.getNewFormUrl+"?source="+encodeURIComponent(window.location.pathname):n.IsRootWeb&&n.ListId==""&&n.ItemId==""?n.actions.displayPopUp(n.actions.getNewFormUrl,"Add User",!0,!0,n.grid.teamUpdated,{row:null,changeType:"Added"}):n.actions.displayPopUp(n.actions.getNewFormUrl,"Add User",!0,!0,n.grid.teamUpdated,{row:null,changeType:"Added"},800,700)}}]},{controlId:"msColumns",controlType:"multiselect",title:"",value:"",iconClass:"icon-insert-template",toolTip:"select columns",sections:[{heading:"none",divider:"no",options:c}],applyButtonConfig:{text:"Apply","function":function(n){var o=n.selectedKeys,u,e,r,t,s;for(u in n.sections){e=n.sections[u];r=e.options;for(t in r)s=r[t],i.inArray(t,o)!=-1?f.ShowCol(t):f.HideCol(t)}f.Rerender()}},onchangeFunction:function(){}},{controlId:"ddlTools",controlType:"dropdown",title:"",value:"Tools",iconClass:"icon-tools",sections:[{heading:"Plan",divider:"yes",options:[{iconClass:"icon-users-5 icon-dropdown",text:"Resource Planner",events:[{eventName:"click","function":function(){n.actions.loadResourcePlanner()}}]},{iconClass:"icon-calendar-5 icon-dropdown",text:"Assignment Planner",events:[{eventName:"click","function":function(){n.actions.loadAssignmentPlanner()}}]}]},{heading:"Analyze",divider:"yes",options:[{iconClass:"icon-stats-3 icon-dropdown",text:"Resource Analyzer",events:[{eventName:"click","function":function(){n.actions.analyzeResources()}}]}]},{heading:"Admin",divider:"yes",options:[{iconClass:"icon-download-6 icon-dropdown",text:"Import Excel",events:[{eventName:"click","function":function(){i(".dropdown-menu").hide();n.actions.importResources()}}]},{iconClass:"icon-upload-6 icon-dropdown",text:"Export Excel",events:[{eventName:"click","function":function(){i(".dropdown-menu").hide();n.actions.exportResources()}}]},{iconClass:"icon-loop-2 icon-dropdown",text:"Refresh",events:[{eventName:"click","function":function(){i(".dropdown-menu").hide();n.actions.RefreshItems()}}]}]},{heading:"none",divider:"yes",options:[{iconClass:"icon-envelop icon-dropdown",text:"Send Notification",events:[{eventName:"click","function":function(){i(".dropdown-menu").hide();n.actions.redirect("sendnotification")}}]}]}]},{controlId:"ddlReports",controlType:"dropdown",title:"",value:"Reporting",iconClass:"icon-pie-3",sections:[{heading:"none",divider:"no",options:it}]}]},{placement:"right",content:[{controlId:"genericId",controlType:"search",toolTip:"search",custom:"yes",customControlId:""},{controlId:"genericId",controlType:"search",toolTip:"search",custom:"no",events:[{eventName:"keypress","function":function(n){var t=n.which;t==13&&(i("#toolBarResGridSelector").val()!=""?f.ChangeFilter("Title",i("#toolBarResGridSelector").val(),11,0,0,null):f.ChangeFilter("","","",0,0,null))}}]},{controlId:"btnFilter",controlType:"button",iconClass:"icon-filter",toolTip:"toggle filters",title:"none",events:[{eventName:"click","function":function(){n.grid.toggleFiltering()}}]},{controlId:"btnDefaultSort",controlType:"button",iconClass:"icon-menu-2",toolTip:"default sort",title:"none",events:[{eventName:"click","function":function(){n.grid.removeSorting()}}]},{controlType:"groupByFields",toolTip:"manage grouping",availableGroups:h,saveFunction:function(n){var u=null,r=[],f,t;if(n.length>0){for(f in n)t=n[f],r.push(t.value),i.inArray(t.value,l)==-1&&i(".multiselect-container").find(".cbColumn[value='"+t.value+"']").attr("checked",!0);r.length>0&&(u=r.join(","))}window.Grids[window.epmLive.resourceGridId].DoGrouping(u)}},{controlId:"msColumns",controlType:"multiselect",title:"",value:"",iconClass:"icon-insert-template",toolTip:"select columns",sections:[{heading:"none",divider:"no",options:c}],applyButtonConfig:{text:"Apply","function":function(n){var o=n.selectedKeys,u,e,r,t,s;for(u in n.sections){e=n.sections[u];r=e.options;for(t in r)s=r[t],i.inArray(t,o)!=-1?f.ShowCol(t):f.HideCol(t)}f.Rerender()}},onchangeFunction:function(){}},{controlId:"ddlViewControl",controlType:"dropdown",title:"View:",value:n.views.currentView.name,iconClass:"none",sections:[p,{heading:"none",divider:"yes",options:[{iconClass:"icon-pencil icon-dropdown",text:"Rename View",events:[{eventName:"click","function":function(){n.views.showRenameDialog()}}]},{iconClass:"icon-disk icon-dropdown",text:"Save View",events:[{eventName:"click","function":function(){n.views.showSaveDialog()}}]},{iconClass:"fui-cross icon-dropdown",text:"Delete View",events:[{eventName:"click","function":function(){n.views.remove()}}]}]}]}]}];window.epmLiveGenericToolBar.generateToolBar(t,ft);n.userIsSiteAdmin?(i("#ddlTools_ul_menu li:nth-of-type(8)").show(),i("#ddlTools_ul_menu li:nth-of-type(9)").show(),i("#ddlTools_ul_menu li:nth-of-type(10)").show(),i("#ddlTools_ul_menu li:nth-of-type(11)").show(),i("#ddlTools_ul_menu li:nth-of-type(12)").show()):(i("#ddlTools_ul_menu li:nth-of-type(8)").hide(),i("#ddlTools_ul_menu li:nth-of-type(9)").hide(),i("#ddlTools_ul_menu li:nth-of-type(10)").hide(),i("#ddlTools_ul_menu li:nth-of-type(11)").hide(),i("#ddlTools_ul_menu li:nth-of-type(12)").hide());n.UserHaveResourceCenterPermission?i("#resourcePoolToolBar ul:first li:first").show():(i("#resourcePoolToolBar ul:first li:first").hide(),i("#resourcePoolToolBar ul:first li:first").next().css("paddingLeft","15px"))}else setTimeout(r,500)})()},getNewFormUrl:"",isViewApplied:!1,areReportsLoaded:!1};window.Grids.OnClick=function(t,i,r,u,f,e){var s,c,h,o;if(n.ribbonBehavior==0&&window.SelectRibbonTab("Ribbon.ResourceGridTab",!0),n.actions.hideEasyScroll(!0),i.Kind==="Data"&&i.Def.Name==="R"){if(e.shiftKey&&e.ctrlKey||!e.shiftKey&&!e.ctrlKey?(c=i.Selected,r!=="Panel"&&t.ActionClearSelection(),s=t.SelectRow(i,!c)):e.shiftKey?(h=t.GetSelRows(),t.ActionClearSelection(),s=h?t.SelectRange(h[0],null,i,null,1,1):t.SelectRow(i,!i.Selected)):s=t.SelectRow(i,!i.Selected),s!==null)return window.RefreshCommandUI(),!0}else if(i.Def.Name==="Group"){if(r==="Panel"){for(t.SelectRow(i,!i.Selected),o=i.firstChild;o;)t.SelectRow(o,i.Selected),o=o.nextSibling;return window.RefreshCommandUI(),!0}}else i.Kind==="Header"&&r==="Panel"&&(n.allSelected=!n.allSelected,window.setTimeout(function(){window.RefreshCommandUI()},100))};window.Grids.OnMouseOutRow=function(n,t){n.SetAttribute(t,"Title","ButtonText"," ",1)};window.Grids.OnMouseOverOutside=function(n){n.CurHoverRow&&n.SetAttribute(n.GetRowById(n.CurHoverRow),"Title","ButtonText"," ",1);n.CurHoverRow="0"};window.Grids.OnMouseOverRow=function(n,r){n.CurHoverRow!=r.id&&(n.CurHoverRow=r.id,CurrentGrid=n,n.GetValue(r,"itemid")!=""&&(n.SetAttribute(r,"Title","ButtonText",'<div class="gridmenuspan" style="position:absolute;overflow:visible" id="'+r.id+'"><a data-itemid="'+n.GetValue(r,"itemid")+'" data-listid="'+n.GetValue(r,"listid")+'" data-webid="'+t.rootWebId+'" data-siteid="'+n.GetValue(r,"siteid")+'" ><\/a><\/div>',1),window.epmLiveNavigation.addContextualMenu(i("#"+r.id),[],!1,!1,{edit:"window.epmLiveResourceGrid.grid.contextMenuResourceChanged","delete":"window.epmLiveResourceGrid.grid.contextMenuResourceDelete"})))};window.Grids.OnExpand=function(n){i.browser.msie&&window.setTimeout(function(){n.Update();n.SetScrollTop(n.GetScrollTop()+2);n.SetScrollTop(n.GetScrollTop()-2);n.Update()},4e3)};window.Grids.OnColumnsChanged=function(n,t){var f=n.GetLastCol("0"),r,i;for(r in t)t[r]&&n.MoveCol(r,f,!0,0);if(i=t.ProfilePic,!i&&!t.length)try{i=t.ProfilePic}catch(e){}i!==u&&(n.SetAttribute(null,"ProfilePic","Visible","0",0),n.Rerender())};window.Grids.OnReady=function(t){window.epmLive.resourceGridId=t.id;n.id(t.id);n.views.load();n.reports.load();n.actions.createToolBar("test")};window.Grids.OnUpdated=function(){n.grid.resetNoDataRow()};window.Grids.OnLoaded=function(){var o=i.browser.msie?20:5,r=n.webpartHeight,u=r,e;r||(u=i("#s4-workspace").height()-(i("#s4-titlerow").height()+i("#EPMLiveStatusbar").height()+i("#EPMLiveStatusbarTemplate").height()+i("#EPMLiveStatuTemplate").height()+i("#s4-statusbarcontainer").height()+o)-100);(!window.epmLiveMasterPageVersion||window.epmLiveMasterPageVersion<5.5)&&(n.loader?(t.utils.fireEvent(document.getElementById("MSOZoneCell_WebPart"+n.webpartQualifier),"mouseup"),n.loader.close()):i("#ResourceGridLoader").hide());r||(i("#MSOZoneCell_WebPart"+n.webpartQualifier).height(u),i("#WebPart"+n.webpartQualifier).height(u));e=i(window);n.winHeight=e.height();window.setTimeout(function(){n.actions.loadRibbon()},1500);i("#s4-workspace").click(function(){n.ribbonBehavior==0&&window.SelectRibbonTab("Ribbon.ResourceGridTab",!0);f()})};i(window).resize(function(){f()});window.Grids.OnGetHtmlValue=function(n,t,i,r){if(t.Def.Name==="Group"){if(i!=="Panel"&&i!=="Title")return""}else if(n.Cols[i]&&n.Cols[i].Type==="Lines")return r};window.Grids.OnGetColor=function(n,t,r,u,f,e){if(r==="Title"&&(u===230||u===180||u===255)&&(f===242||f===217||f===255)&&(e===251||e===243||e===255)&&t.r0){var o=i(t.r0).find(".GSCellPanel");o&&(u===230&&f===242&&e===251?i(o).addClass("EPMLiveResourceGridPanelHovered"):u===180&&f===217&&e===243?i(o).addClass("EPMLiveResourceGridPanelHoveredSelected"):i(o).removeClass("EPMLiveResourceGridPanelHovered EPMLiveResourceGridPanelHoveredSelected"))}return null};window.SP.SOD.notifyScriptLoadedAndExecuteWaitingJobs("EPMLive.ResourceGrid.js")})(window.epmLiveResourceGrid=window.epmLiveResourceGrid||{},window.epmLive,window.jQuery,window.ko)}ExecuteOrDelayUntilScriptLoaded(registerEpmLiveResourceGridScript,"EPMLive.js");window.console||(console={});console.error=console.error||function(){};console.log=console.log||function(){};