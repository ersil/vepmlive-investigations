(function(n,t,i,r){"use strict";var f=function(){var u=function(){function s(){r.lang("en",{calendar:{lastDay:"[Yesterday -]  MMMM D",sameDay:"[Today -] MMMM D",nextDay:"[Tomorrow -] MMMM D",lastWeek:"[Last] dddd [-] MMMM D",nextWeek:"dddd [-] MMMM D",sameElse:"MMMM D YYYY"}})}function l(){t.subscribe("se.logsLoaded",e.render);t.subscribe("se.logRendered",function(t,i,r){t.click(function(){e.showDetails(n(this),i)});r&&t.click()});n("html").keydown(function(n){n.which===38?(n.preventDefault(),e.navigate("up")):n.which===40&&(n.preventDefault(),e.navigate("down"))})}var c=window.epmLive.currentWebUrl.slice(1),u={apiUrl:"/"+c+"/_vti_bin/SocialEngine.svc",ui:{classes:{active:"epm-se-active"}}},f={logs:n("#epm-se-logs div#epm-se-log-list ul"),logList:n("#epm-se-logs div#epm-se-log-list"),details:n("#epm-se-logs div#epm-se-log-details"),message:n("#epm-se-logs div.epm-se-message")},o={log:i.compile(n("script#epm-se-log-template").html()),details:i.compile(n("script#epm-se-log-details-template").html())},h=function(){function n(n){if(window.epmLive.currentUserTimeZone)try{return r.tz(n,window.epmLive.currentUserTimeZone.olsonName)}catch(t){window.epmLive.debugMode&&console.log(t.message)}return n}var t=function(t){var i=n(t);return r.lang("en",{calendar:{lastDay:"[Yesterday]  MMM D",sameDay:"[Today] MMM D",nextDay:"[Tomorrow] MMM D",lastWeek:"[Last] ddd MMM D",nextWeek:"ddd MMM D",sameElse:"MMMM D YYYY"}}),i=i.calendar(),s(),i},i=function(t){return n(t).format("LLLL")};return{getFriendlyTime:t,getLongTime:i}}(),e=function(){function i(n){var s,r,t,f,c,e,i,o;switch(n.kind){case"Info":n.icon="icon-info-2";break;case"Error":n.icon="icon-warning-2"}for(s=n.user,r=null,t=0;t<u.data.users.length;t++)if(f=u.data.users[t],f.id===s){r=f;break}for(n.user=r,c=n.web,e=null,i=0;i<u.data.webs.length;i++)if(o=u.data.webs[i],o.id===c){e=o;break}return n.web=e,n.details=n.details.trim(),n.stackTrace=n.stackTrace.trim(),n.friendlyTime=h.getFriendlyTime(n.time),n.longTime=h.getLongTime(n.time),n}var r=function(){for(var n,r=0;r<u.data.collection.length;r++)n=u.data.collection[r],n=i(n),f.logs.append(o.log(n)),t.publish("se.logRendered",f.logs.find("li#epm-se-log-"+n.id),n,r===0)},e=function(n,t){n.parent().find("li").removeClass(u.ui.classes.active);n.addClass(u.ui.classes.active);f.details.html(o.details(t));f.details.find("pre").each(function(n,t){hljs.highlightBlock(t)})},s=function(t){var e=n(f.logs.find("li."+u.ui.classes.active).get(0)),i=e.index(),r;(t!=="up"||i!==0)&&(t!=="down"||i!==u.data.collection.length-1)&&(t==="up"?i--:i++,r=n(f.logs.find("li").get(i)),r.click(),f.logList.scrollTop(r.position().top))};return{render:r,showDetails:e,navigate:s}}(),a=function(){s();l()},v=function(){n.get(u.apiUrl+"/logs?v="+(new Date).getTime()).then(function(n){if(!n||n.error){try{f.message.text(n.error.message);f.message.show()}catch(i){}return}u.data=n;t.publish("se.logsLoaded")})};return{configure:a,loadLogs:v}}();u.configure();u.loadLogs()},u=function(){window.epmLive?f():window.setTimeout(function(){u()},1)};n(function(){u()})})(jQuery,amplify,Handlebars,moment);
/*
//# sourceMappingURL=EPMLive.SocialStream.Logs.min.js.map
*/