(function(n,t,i,r){"use strict";var f=function(){var u=function(){function h(){r.lang("en",{calendar:{lastDay:"[Yesterday -]  MMMM D",sameDay:"[Today -] MMMM D",nextDay:"[Tomorrow -] MMMM D",lastWeek:"[Last] dddd [-] MMMM D",nextWeek:"dddd [-] MMMM D",sameElse:"MMMM D YYYY"}})}function c(){t.subscribe("se.logsLoaded",e.render);t.subscribe("se.logRendered",function(t,i,r){t.click(function(){e.showDetails(n(this),i)});r&&t.click()});n("html").keydown(function(n){n.preventDefault();n.which===38?e.navigate("up"):n.which===40&&e.navigate("down")})}var s=window.epmLive.currentWebUrl.slice(1),u={apiUrl:"/"+s+"/_vti_bin/SocialEngine.svc",ui:{classes:{active:"epm-se-active"}}},f={logs:n("#epm-se-logs div#epm-se-log-list ul"),logList:n("#epm-se-logs div#epm-se-log-list"),details:n("#epm-se-logs div#epm-se-log-details"),message:n("#epm-se-logs div.epm-se-message")},o={log:i.compile(n("script#epm-se-log-template").html()),details:i.compile(n("script#epm-se-log-details-template").html())},e=function(){function i(n){var s,r,t,f,h,e,i,o;switch(n.kind){case"Info":n.icon="icon-info-2";break;case"Error":n.icon="icon-warning-2"}for(s=n.user,r=null,t=0;t<u.data.users.length;t++)if(f=u.data.users[t],f.id===s){r=f;break}for(n.user=r,h=n.web,e=null,i=0;i<u.data.webs.length;i++)if(o=u.data.webs[i],o.id===h){e=o;break}return n.web=e,n.details=n.details.trim(),n.stackTrace=n.stackTrace.trim(),n}var r=function(){for(var n,r=0;r<u.data.collection.length;r++)n=u.data.collection[r],n=i(n),f.logs.append(o.log(n)),t.publish("se.logRendered",f.logs.find("li#epm-se-log-"+n.id),n,r===0)},e=function(n,t){n.parent().find("li").removeClass(u.ui.classes.active);n.addClass(u.ui.classes.active);f.details.html(o.details(t));f.details.find("pre").each(function(n,t){hljs.highlightBlock(t)})},s=function(t){var e=n(f.logs.find("li."+u.ui.classes.active).get(0)),i=e.index(),r;(t!=="up"||i!==0)&&(t!=="down"||i!==u.data.collection.length-1)&&(t==="up"?i--:i++,r=n(f.logs.find("li").get(i)),r.click(),f.logList.scrollTop(r.position().top))};return{render:r,showDetails:e,navigate:s}}(),l=function(){h();c()},a=function(){n.get(u.apiUrl+"/logs?v="+(new Date).getTime()).then(function(n){if(!n||n.error){try{f.message.text(n.error.message);f.message.show()}catch(i){}return}u.data=n;t.publish("se.logsLoaded")})};return{configure:l,loadLogs:a}}();u.configure();u.loadLogs()},u=function(){window.epmLive?f():window.setTimeout(function(){u()},1)};n(function(){u()})})(jQuery,amplify,Handlebars,moment);
/*
//# sourceMappingURL=EPMLive.SocialStream.Logs.min.js.map
*/