using System;
using System.Collections;
using System.Collections.Generic;
using System.Collections.Specialized;
using System.Collections.Specialized.Fakes;
using System.Globalization;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Web.Fakes;
using System.Web.UI;
using System.Web.UI.Fakes;
using System.Xml.Fakes;
using EPMLiveCore;
using EPMLiveCore.API;
using EPMLiveCore.API.Fakes;
using EPMLiveCore.Fakes;
using EPMLiveCore.Infrastructure;
using EPMLiveCore.Infrastructure.Fakes;
using EPMLiveWebParts.Fakes;
using Microsoft.SharePoint;
using Microsoft.SharePoint.Fakes;
using Microsoft.SharePoint.Utilities.Fakes;
using Microsoft.SharePoint.WebControls.Fakes;
using Microsoft.SharePoint.WebPartPages.Fakes;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using Microsoft.Web.CommandUI.Fakes;
using Shouldly;

namespace EPMLiveWebParts.Tests
{
    public partial class GridListViewTests
    {
        private StringBuilder trimByIdString;
        private StringBuilder loadXmlString;
        private StringBuilder registerDataExtensionString;


        private void SetupForAddContextualTab()
        {
            trimByIdString = new StringBuilder();
            loadXmlString = new StringBuilder();
            registerDataExtensionString = new StringBuilder();
            SetupShims();
            _testablePrivate.SetField("tb", new TimeDebug(DummyString, DummyString));
            ShimSPRibbon.GetCurrentPage = (_) => new ShimSPRibbon().Instance;
            ShimRibbon.AllInstances.TrimByIdString = (_, value) =>
            {
                trimByIdString.Append(value.Replace("\r\n", "").Replace("\n", ""));
            };
            ShimXmlDocument.AllInstances.LoadXmlString = (_, value) =>
            {
                loadXmlString.Append(value.Replace("\r\n", "").Replace("\n", ""));
            };
            ShimRibbon.AllInstances.RegisterDataExtensionXmlNodeString = (_, __, value) =>
            {
                registerDataExtensionString.Append(value.Replace("\r\n", "").Replace("\n", ""));
            };
            ShimSPWeb.AllInstances.PropertiesGet = (_) =>
            {
                var propertyBag = new ShimSPPropertyBag();
                var sd = new ShimStringDictionary(propertyBag);
                sd.ItemGetString = (key) =>
                {
                    return DummyString;
                };
                return propertyBag;
            };
            ShimSPList.AllInstances.TitleGet = (_) => DummyString;
            ShimCoreFunctions.getConfigSettingSPWebString = (_, __) => DummyString;
            ShimSPList.AllInstances.ParentWebGet = (_) => _sharepointShims.WebShim.Instance;
            ShimCacheStore.AllInstances.GetStringStringFuncOfObjectBoolean = (_1, key, _3, _4, _5) =>
            {
                if (key == "GAI")
                {
                    var a = new ArrayList();
                    var lInfo = new AssociatedListInfo();
                    lInfo.icon = DummyUrl;
                    lInfo.LinkedField = DummyString;
                    lInfo.ListId = Guid.NewGuid();
                    lInfo.Title = DummyString;
                    a.Add(lInfo);
                    return new CachedValue(a);
                }
                else if (key == "GR-0")
                {
                    return new CachedValue(new ShimRibbonProperties().Instance);
                }
                return null;
            };
        }

        [TestMethod]
        public void AddContextualTab_GivenArguments_ConfirmRibbonExtensions()
        {
            // Arrange
            SetupForAddContextualTab();

            // Act
            _testablePrivate.Invoke("AddContextualTab", 
                new object[] { });

            // Assert
            _testablePrivate.ShouldSatisfyAllConditions(
                () => trimByIdString.ToString().ShouldBe("Ribbon.ListItem.New.NewFolderRibbon.List.Actions.CreateVisioDiagramRibbon.List.Actions.OpenWithAccessRibbon.List.Actions.ExportToProjectRibbon.List.ViewFormat.GanttRibbon.List.Datasheet"),
                () => loadXmlString.ToString().ShouldBe("<ToggleButtonId=\"Ribbon.List.ViewFormat.Gantt\"Sequence=\"20\"Command=\"DisplayGanttView\"Image32by32=\"/_layouts/epmlive/images/ganttview.gif\"LabelText=\"Gantt View\"QueryCommand=\"QueryDisplayGanttView\"TemplateAlias=\"o1\"/><Group                Id=\"Ribbon.List.EPMLiveGanttView\"                Sequence=\"30\"                Command=\"EPMLiveGanttViewGroup\"                Description=\"\"                Title=\"Gantt\"                Image32by32Popup=\"/_layouts/0/images/formatmap32x32.png\" Image32by32PopupTop=\"-448\" Image32by32PopupLeft=\"-192\"                Template=\"Ribbon.Templates.Flexible2\"          >            <Controls Id=\"Ribbon.List.GanttView.Controls\">              <Button                Id=\"Ribbon.List.EPMLiveGanttView.ZoomIn\"                Sequence=\"10\"                Command=\"ZoomIn\"                Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-16\" Image16by16Left=\"-56\"                Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-448\" Image32by32Left=\"-192\"                LabelText=\"Zoom In\"                TemplateAlias=\"o1\"              />              <Button                Id=\"Ribbon.List.EPMLiveGanttView.ZoomOut\"                Sequence=\"20\"                Command=\"ZoomOut\"                Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-240\" Image16by16Left=\"-176\"                Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-64\" Image32by32Left=\"-32\"                LabelText=\"Zoom Out\"                TemplateAlias=\"o1\"              />              <Button                Id=\"Ribbon.List.EPMLiveGanttView.ScrollToTask\"                Sequence=\"30\"                Command=\"ScrollTask\"                Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-32\" Image16by16Left=\"-240\"                Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-448\" Image32by32Left=\"-352\"                LabelText=\"Scroll To Task\"                TemplateAlias=\"o1\"              />            </Controls>          </Group><MaxSize Id=\"Ribbon.List.EPMLiveGanttView.MaxSize\" Sequence=\"10\" GroupId=\"Ribbon.List.EPMLiveGanttView\" Size=\"LargeLarge\" /><Button Id=\"Ribbon.List.CustomViews.Filters\" Sequence=\"4\" Command=\"ShowFilters\" Image16by16=\"/_layouts/images/fcofilter.png\" Image32by32=\"/_layouts/images/menufilter.gif\" LabelText=\"Hide/Show Search\" ToolTipTitle=\"Filters\" ToolTipDescription=\"\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Datasheet.Save\" Sequence=\"10\" Command=\"DatasheetSave\" Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-256\" Image16by16Left=\"0\" Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-416\" Image32by32Left=\"-256\" LabelText=\"Save Items\" ToolTipTitle=\"Save Items\" ToolTipDescription=\"Save all items in grid.\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Datasheet.Print\" Sequence=\"10\" Command=\"PrintGantt\" Image16by16=\"/_layouts/epmlive/images/print.gif\" Image32by32=\"/_layouts/epmlive/images/printmenu.gif\" LabelText=\"Print\" ToolTipTitle=\"Print\" ToolTipDescription=\"\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Share.RefreshItems\" Sequence=\"1\" Command=\"RefreshItems\"  Image32by32=\"/_layouts/epmlive/images/refresh.png\" LabelText=\"Refresh Items\" ToolTipTitle=\"Refresh Items\" ToolTipDescription=\"Refresh all items in grid.\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Share.ExportToExcel\" Sequence=\"3\" Command=\"ExportToExcel\" LabelText=\"Export To Excel\" TemplateAlias=\"o1\" ToolTipTitle=\"Export to Excel\" ToolTipDescription=\"Analyze items in this list using Microsoft Excel.\" Image16by16=\"/_layouts/epmlive/images/ribbon/export-excel16.png\" Image32by32=\"/_layouts/15/1033/images/formatmap32x32.png?rev=23\" Image32by32Top=\"-239\" Image32by32Left=\"-307\"/><Button Id=\"Ribbon.List.Share.PFEImportCostsData\" Sequence=\"2\" Command=\"PFEImportCostsData\" LabelText=\"Import Costs\" TemplateAlias=\"o1\" ToolTipTitle=\"Import Costs\" ToolTipDescription=\"Import costs data into portfolio engine database.\" Image16by16=\"/_layouts/epmlive/images/ribbon/import-costs-16.png\" Image32by32=\"/_layouts/epmlive/images/ribbon/import-costs-32.png\"/><Button Id=\"Ribbon.ListItem.EPMLive.EditComments\" Sequence=\"140\" Command=\"EditComments\" LabelText=\"Comments\" TemplateAlias=\"o2\" Image16by16=\"_layouts/epmlive/images/comments16.gif\"/>"),
                () => registerDataExtensionString.ToString().ShouldBe("Ribbon.List.ViewFormat.Controls._childrenRibbon.List.Groups._childrenRibbon.List.Scaling._childrenRibbon.List.CustomViews.Controls._childrenRibbon.ListItem.Actions.Controls._childrenRibbon.List.Share.Controls._childrenRibbon.List.Actions.Controls._childrenRibbon.List.Actions.Controls._childrenRibbon.List.Actions.Controls._childrenRibbon.ListItem.Manage.Controls._children"));
         }

        [TestMethod]
        public void AddContextualTab_GivenArguments_bRollups_True_ConfirmRibbonExtensions()
        {
            // Arrange
            SetupForAddContextualTab();
            _testablePrivate.SetFieldOrProperty("bRollups", true);

            // Act
            _testablePrivate.Invoke("AddContextualTab",
                new object[] { });

            // Assert
            _testablePrivate.ShouldSatisfyAllConditions(
                () => trimByIdString.ToString().ShouldBe("Ribbon.ListItem.New.NewFolderRibbon.List.Actions.CreateVisioDiagramRibbon.List.Actions.OpenWithAccessRibbon.List.Actions.ExportToProjectRibbon.List.ViewFormat.GanttRibbon.List.Datasheet"),
                () => loadXmlString.ToString().ShouldBe("<ToggleButtonId=\"Ribbon.List.ViewFormat.Gantt\"Sequence=\"20\"Command=\"DisplayGanttView\"Image32by32=\"/_layouts/epmlive/images/ganttview.gif\"LabelText=\"Gantt View\"QueryCommand=\"QueryDisplayGanttView\"TemplateAlias=\"o1\"/><Group                Id=\"Ribbon.List.EPMLiveGanttView\"                Sequence=\"30\"                Command=\"EPMLiveGanttViewGroup\"                Description=\"\"                Title=\"Gantt\"                Image32by32Popup=\"/_layouts/0/images/formatmap32x32.png\" Image32by32PopupTop=\"-448\" Image32by32PopupLeft=\"-192\"                Template=\"Ribbon.Templates.Flexible2\"          >            <Controls Id=\"Ribbon.List.GanttView.Controls\">              <Button                Id=\"Ribbon.List.EPMLiveGanttView.ZoomIn\"                Sequence=\"10\"                Command=\"ZoomIn\"                Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-16\" Image16by16Left=\"-56\"                Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-448\" Image32by32Left=\"-192\"                LabelText=\"Zoom In\"                TemplateAlias=\"o1\"              />              <Button                Id=\"Ribbon.List.EPMLiveGanttView.ZoomOut\"                Sequence=\"20\"                Command=\"ZoomOut\"                Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-240\" Image16by16Left=\"-176\"                Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-64\" Image32by32Left=\"-32\"                LabelText=\"Zoom Out\"                TemplateAlias=\"o1\"              />              <Button                Id=\"Ribbon.List.EPMLiveGanttView.ScrollToTask\"                Sequence=\"30\"                Command=\"ScrollTask\"                Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-32\" Image16by16Left=\"-240\"                Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-448\" Image32by32Left=\"-352\"                LabelText=\"Scroll To Task\"                TemplateAlias=\"o1\"              />            </Controls>          </Group><MaxSize Id=\"Ribbon.List.EPMLiveGanttView.MaxSize\" Sequence=\"10\" GroupId=\"Ribbon.List.EPMLiveGanttView\" Size=\"LargeLarge\" /><Button Id=\"Ribbon.List.CustomViews.Filters\" Sequence=\"4\" Command=\"ShowFilters\" Image16by16=\"/_layouts/images/fcofilter.png\" Image32by32=\"/_layouts/images/menufilter.gif\" LabelText=\"Hide/Show Search\" ToolTipTitle=\"Filters\" ToolTipDescription=\"\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Datasheet.Save\" Sequence=\"10\" Command=\"DatasheetSave\" Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-256\" Image16by16Left=\"0\" Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-416\" Image32by32Left=\"-256\" LabelText=\"Save Items\" ToolTipTitle=\"Save Items\" ToolTipDescription=\"Save all items in grid.\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Datasheet.Print\" Sequence=\"10\" Command=\"PrintGantt\" Image16by16=\"/_layouts/epmlive/images/print.gif\" Image32by32=\"/_layouts/epmlive/images/printmenu.gif\" LabelText=\"Print\" ToolTipTitle=\"Print\" ToolTipDescription=\"\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Share.RefreshItems\" Sequence=\"1\" Command=\"RefreshItems\"  Image32by32=\"/_layouts/epmlive/images/refresh.png\" LabelText=\"Refresh Items\" ToolTipTitle=\"Refresh Items\" ToolTipDescription=\"Refresh all items in grid.\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Share.ExportToExcel\" Sequence=\"3\" Command=\"ExportToExcel\" LabelText=\"Export To Excel\" TemplateAlias=\"o1\" ToolTipTitle=\"Export to Excel\" ToolTipDescription=\"Analyze items in this list using Microsoft Excel.\" Image16by16=\"/_layouts/epmlive/images/ribbon/export-excel16.png\" Image32by32=\"/_layouts/15/1033/images/formatmap32x32.png?rev=23\" Image32by32Top=\"-239\" Image32by32Left=\"-307\"/><Button Id=\"Ribbon.List.Share.PFEImportCostsData\" Sequence=\"2\" Command=\"PFEImportCostsData\" LabelText=\"Import Costs\" TemplateAlias=\"o1\" ToolTipTitle=\"Import Costs\" ToolTipDescription=\"Import costs data into portfolio engine database.\" Image16by16=\"/_layouts/epmlive/images/ribbon/import-costs-16.png\" Image32by32=\"/_layouts/epmlive/images/ribbon/import-costs-32.png\"/><Button Id=\"Ribbon.ListItem.EPMLive.GoToWorkspace\" Sequence=\"12\" Command=\"GoToWorkspace\" LabelText=\"Go To Workspace\" TemplateAlias=\"o1\" Image32by32=\"/_layouts/epmlive/images/gotoworkspace.png\" /><Button Id=\"Ribbon.ListItem.EPMLive.EditComments\" Sequence=\"140\" Command=\"EditComments\" LabelText=\"Comments\" TemplateAlias=\"o2\" Image16by16=\"_layouts/epmlive/images/comments16.gif\"/>"),
                () => registerDataExtensionString.ToString().ShouldBe("Ribbon.List.ViewFormat.Controls._childrenRibbon.List.Groups._childrenRibbon.List.Scaling._childrenRibbon.List.CustomViews.Controls._childrenRibbon.ListItem.Actions.Controls._childrenRibbon.List.Share.Controls._childrenRibbon.List.Actions.Controls._childrenRibbon.List.Actions.Controls._childrenRibbon.List.Actions.Controls._childrenRibbon.ListItem.Actions.Controls._childrenRibbon.ListItem.Manage.Controls._children"));
        }

        [TestMethod]
        public void AddContextualTab_GivenArguments_requestList_True_ConfirmRibbonExtensions()
        {
            // Arrange
            SetupForAddContextualTab();
            _testablePrivate.SetFieldOrProperty("requestList", true);

            // Act
            _testablePrivate.Invoke("AddContextualTab",
                new object[] { });

            // Assert
            _testablePrivate.ShouldSatisfyAllConditions(
                () => trimByIdString.ToString().ShouldBe("Ribbon.ListItem.New.NewFolderRibbon.List.Actions.CreateVisioDiagramRibbon.List.Actions.OpenWithAccessRibbon.List.Actions.ExportToProjectRibbon.List.ViewFormat.GanttRibbon.List.Datasheet"),
                () => loadXmlString.ToString().ShouldBe("<ToggleButtonId=\"Ribbon.List.ViewFormat.Gantt\"Sequence=\"20\"Command=\"DisplayGanttView\"Image32by32=\"/_layouts/epmlive/images/ganttview.gif\"LabelText=\"Gantt View\"QueryCommand=\"QueryDisplayGanttView\"TemplateAlias=\"o1\"/><Group                Id=\"Ribbon.List.EPMLiveGanttView\"                Sequence=\"30\"                Command=\"EPMLiveGanttViewGroup\"                Description=\"\"                Title=\"Gantt\"                Image32by32Popup=\"/_layouts/0/images/formatmap32x32.png\" Image32by32PopupTop=\"-448\" Image32by32PopupLeft=\"-192\"                Template=\"Ribbon.Templates.Flexible2\"          >            <Controls Id=\"Ribbon.List.GanttView.Controls\">              <Button                Id=\"Ribbon.List.EPMLiveGanttView.ZoomIn\"                Sequence=\"10\"                Command=\"ZoomIn\"                Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-16\" Image16by16Left=\"-56\"                Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-448\" Image32by32Left=\"-192\"                LabelText=\"Zoom In\"                TemplateAlias=\"o1\"              />              <Button                Id=\"Ribbon.List.EPMLiveGanttView.ZoomOut\"                Sequence=\"20\"                Command=\"ZoomOut\"                Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-240\" Image16by16Left=\"-176\"                Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-64\" Image32by32Left=\"-32\"                LabelText=\"Zoom Out\"                TemplateAlias=\"o1\"              />              <Button                Id=\"Ribbon.List.EPMLiveGanttView.ScrollToTask\"                Sequence=\"30\"                Command=\"ScrollTask\"                Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-32\" Image16by16Left=\"-240\"                Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-448\" Image32by32Left=\"-352\"                LabelText=\"Scroll To Task\"                TemplateAlias=\"o1\"              />            </Controls>          </Group><MaxSize Id=\"Ribbon.List.EPMLiveGanttView.MaxSize\" Sequence=\"10\" GroupId=\"Ribbon.List.EPMLiveGanttView\" Size=\"LargeLarge\" /><Button Id=\"Ribbon.List.CustomViews.Filters\" Sequence=\"4\" Command=\"ShowFilters\" Image16by16=\"/_layouts/images/fcofilter.png\" Image32by32=\"/_layouts/images/menufilter.gif\" LabelText=\"Hide/Show Search\" ToolTipTitle=\"Filters\" ToolTipDescription=\"\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Datasheet.Save\" Sequence=\"10\" Command=\"DatasheetSave\" Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-256\" Image16by16Left=\"0\" Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-416\" Image32by32Left=\"-256\" LabelText=\"Save Items\" ToolTipTitle=\"Save Items\" ToolTipDescription=\"Save all items in grid.\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Datasheet.Print\" Sequence=\"10\" Command=\"PrintGantt\" Image16by16=\"/_layouts/epmlive/images/print.gif\" Image32by32=\"/_layouts/epmlive/images/printmenu.gif\" LabelText=\"Print\" ToolTipTitle=\"Print\" ToolTipDescription=\"\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Share.RefreshItems\" Sequence=\"1\" Command=\"RefreshItems\"  Image32by32=\"/_layouts/epmlive/images/refresh.png\" LabelText=\"Refresh Items\" ToolTipTitle=\"Refresh Items\" ToolTipDescription=\"Refresh all items in grid.\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Share.ExportToExcel\" Sequence=\"3\" Command=\"ExportToExcel\" LabelText=\"Export To Excel\" TemplateAlias=\"o1\" ToolTipTitle=\"Export to Excel\" ToolTipDescription=\"Analyze items in this list using Microsoft Excel.\" Image16by16=\"/_layouts/epmlive/images/ribbon/export-excel16.png\" Image32by32=\"/_layouts/15/1033/images/formatmap32x32.png?rev=23\" Image32by32Top=\"-239\" Image32by32Left=\"-307\"/><Button Id=\"Ribbon.List.Share.PFEImportCostsData\" Sequence=\"2\" Command=\"PFEImportCostsData\" LabelText=\"Import Costs\" TemplateAlias=\"o1\" ToolTipTitle=\"Import Costs\" ToolTipDescription=\"Import costs data into portfolio engine database.\" Image16by16=\"/_layouts/epmlive/images/ribbon/import-costs-16.png\" Image32by32=\"/_layouts/epmlive/images/ribbon/import-costs-32.png\"/><Button Id=\"Ribbon.ListItem.EPMLive.GoToWorkspace\" Sequence=\"12\" Command=\"GoToWorkspace\" LabelText=\"Go To Workspace\" TemplateAlias=\"o1\" Image32by32=\"/_layouts/epmlive/images/gotoworkspace.png\" /><Button Id=\"Ribbon.ListItem.EPMLive.CreateWorkspace\" Sequence=\"13\" Command=\"CreateWorkspace\" LabelText=\"Create Workspace\" TemplateAlias=\"o1\" Image32by32=\"_layouts/epmlive/images/createworkspace.png\"/><Button Id=\"Ribbon.ListItem.EPMLive.EditComments\" Sequence=\"140\" Command=\"EditComments\" LabelText=\"Comments\" TemplateAlias=\"o2\" Image16by16=\"_layouts/epmlive/images/comments16.gif\"/>"),
                () => registerDataExtensionString.ToString().ShouldBe("Ribbon.List.ViewFormat.Controls._childrenRibbon.List.Groups._childrenRibbon.List.Scaling._childrenRibbon.List.CustomViews.Controls._childrenRibbon.ListItem.Actions.Controls._childrenRibbon.List.Share.Controls._childrenRibbon.List.Actions.Controls._childrenRibbon.List.Actions.Controls._childrenRibbon.List.Actions.Controls._childrenRibbon.ListItem.Actions.Controls._childrenRibbon.ListItem.Actions.Controls._childrenRibbon.ListItem.Manage.Controls._children"));
        }

        [TestMethod]
        public void AddContextualTab_GivenArguments_PlannerV2Menu_NotNull_ConfirmRibbonExtensions()
        {
            // Arrange
            SetupForAddContextualTab();
            _testablePrivate.SetFieldOrProperty("PlannerV2Menu", DummyString);

            // Act
            _testablePrivate.Invoke("AddContextualTab",
                new object[] { });

            // Assert
            _testablePrivate.ShouldSatisfyAllConditions(
                () => trimByIdString.ToString().ShouldBe("Ribbon.ListItem.New.NewFolderRibbon.List.Actions.CreateVisioDiagramRibbon.List.Actions.OpenWithAccessRibbon.List.Actions.ExportToProjectRibbon.List.ViewFormat.GanttRibbon.List.Datasheet"),
                () => loadXmlString.ToString().ShouldBe("<ToggleButtonId=\"Ribbon.List.ViewFormat.Gantt\"Sequence=\"20\"Command=\"DisplayGanttView\"Image32by32=\"/_layouts/epmlive/images/ganttview.gif\"LabelText=\"Gantt View\"QueryCommand=\"QueryDisplayGanttView\"TemplateAlias=\"o1\"/><Group                Id=\"Ribbon.List.EPMLiveGanttView\"                Sequence=\"30\"                Command=\"EPMLiveGanttViewGroup\"                Description=\"\"                Title=\"Gantt\"                Image32by32Popup=\"/_layouts/0/images/formatmap32x32.png\" Image32by32PopupTop=\"-448\" Image32by32PopupLeft=\"-192\"                Template=\"Ribbon.Templates.Flexible2\"          >            <Controls Id=\"Ribbon.List.GanttView.Controls\">              <Button                Id=\"Ribbon.List.EPMLiveGanttView.ZoomIn\"                Sequence=\"10\"                Command=\"ZoomIn\"                Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-16\" Image16by16Left=\"-56\"                Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-448\" Image32by32Left=\"-192\"                LabelText=\"Zoom In\"                TemplateAlias=\"o1\"              />              <Button                Id=\"Ribbon.List.EPMLiveGanttView.ZoomOut\"                Sequence=\"20\"                Command=\"ZoomOut\"                Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-240\" Image16by16Left=\"-176\"                Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-64\" Image32by32Left=\"-32\"                LabelText=\"Zoom Out\"                TemplateAlias=\"o1\"              />              <Button                Id=\"Ribbon.List.EPMLiveGanttView.ScrollToTask\"                Sequence=\"30\"                Command=\"ScrollTask\"                Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-32\" Image16by16Left=\"-240\"                Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-448\" Image32by32Left=\"-352\"                LabelText=\"Scroll To Task\"                TemplateAlias=\"o1\"              />            </Controls>          </Group><MaxSize Id=\"Ribbon.List.EPMLiveGanttView.MaxSize\" Sequence=\"10\" GroupId=\"Ribbon.List.EPMLiveGanttView\" Size=\"LargeLarge\" /><Button Id=\"Ribbon.List.CustomViews.Filters\" Sequence=\"4\" Command=\"ShowFilters\" Image16by16=\"/_layouts/images/fcofilter.png\" Image32by32=\"/_layouts/images/menufilter.gif\" LabelText=\"Hide/Show Search\" ToolTipTitle=\"Filters\" ToolTipDescription=\"\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Datasheet.Save\" Sequence=\"10\" Command=\"DatasheetSave\" Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-256\" Image16by16Left=\"0\" Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-416\" Image32by32Left=\"-256\" LabelText=\"Save Items\" ToolTipTitle=\"Save Items\" ToolTipDescription=\"Save all items in grid.\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Datasheet.Print\" Sequence=\"10\" Command=\"PrintGantt\" Image16by16=\"/_layouts/epmlive/images/print.gif\" Image32by32=\"/_layouts/epmlive/images/printmenu.gif\" LabelText=\"Print\" ToolTipTitle=\"Print\" ToolTipDescription=\"\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Share.RefreshItems\" Sequence=\"1\" Command=\"RefreshItems\"  Image32by32=\"/_layouts/epmlive/images/refresh.png\" LabelText=\"Refresh Items\" ToolTipTitle=\"Refresh Items\" ToolTipDescription=\"Refresh all items in grid.\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Share.ExportToExcel\" Sequence=\"3\" Command=\"ExportToExcel\" LabelText=\"Export To Excel\" TemplateAlias=\"o1\" ToolTipTitle=\"Export to Excel\" ToolTipDescription=\"Analyze items in this list using Microsoft Excel.\" Image16by16=\"/_layouts/epmlive/images/ribbon/export-excel16.png\" Image32by32=\"/_layouts/15/1033/images/formatmap32x32.png?rev=23\" Image32by32Top=\"-239\" Image32by32Left=\"-307\"/><Button Id=\"Ribbon.List.Share.PFEImportCostsData\" Sequence=\"2\" Command=\"PFEImportCostsData\" LabelText=\"Import Costs\" TemplateAlias=\"o1\" ToolTipTitle=\"Import Costs\" ToolTipDescription=\"Import costs data into portfolio engine database.\" Image16by16=\"/_layouts/epmlive/images/ribbon/import-costs-16.png\" Image32by32=\"/_layouts/epmlive/images/ribbon/import-costs-32.png\"/>dummy<Button Id=\"Ribbon.ListItem.EPMLive.EditComments\" Sequence=\"140\" Command=\"EditComments\" LabelText=\"Comments\" TemplateAlias=\"o2\" Image16by16=\"_layouts/epmlive/images/comments16.gif\"/>"),
                () => registerDataExtensionString.ToString().ShouldBe("Ribbon.List.ViewFormat.Controls._childrenRibbon.List.Groups._childrenRibbon.List.Scaling._childrenRibbon.List.CustomViews.Controls._childrenRibbon.ListItem.Actions.Controls._childrenRibbon.List.Share.Controls._childrenRibbon.List.Actions.Controls._childrenRibbon.List.Actions.Controls._childrenRibbon.List.Actions.Controls._childrenRibbon.ListItem.Manage.Controls._childrenRibbon.ListItem.Manage.Controls._children"));
        }

        [TestMethod]
        public void AddContextualTab_GivenArguments_bBuildTeam_True_ConfirmRibbonExtensions()
        {
            // Arrange
            SetupForAddContextualTab();
            ShimCacheStore.AllInstances.GetStringStringFuncOfObjectBoolean = (_1, key, _3, _4, _5) =>
            {
                var prop = new RibbonProperties();
                var pvt = new PrivateObject(prop);
                pvt.SetFieldOrProperty("bBuildTeam", true);
                return new CachedValue(prop);
            };

            // Act
            _testablePrivate.Invoke("AddContextualTab",
                new object[] { });

            // Assert
            _testablePrivate.ShouldSatisfyAllConditions(
                () => trimByIdString.ToString().ShouldBe("Ribbon.ListItem.New.NewFolderRibbon.List.Actions.CreateVisioDiagramRibbon.List.Actions.OpenWithAccessRibbon.List.Actions.ExportToProjectRibbon.List.ViewFormat.GanttRibbon.List.Datasheet"),
                () => loadXmlString.ToString().ShouldBe("<ToggleButtonId=\"Ribbon.List.ViewFormat.Gantt\"Sequence=\"20\"Command=\"DisplayGanttView\"Image32by32=\"/_layouts/epmlive/images/ganttview.gif\"LabelText=\"Gantt View\"QueryCommand=\"QueryDisplayGanttView\"TemplateAlias=\"o1\"/><Group                Id=\"Ribbon.List.EPMLiveGanttView\"                Sequence=\"30\"                Command=\"EPMLiveGanttViewGroup\"                Description=\"\"                Title=\"Gantt\"                Image32by32Popup=\"/_layouts/0/images/formatmap32x32.png\" Image32by32PopupTop=\"-448\" Image32by32PopupLeft=\"-192\"                Template=\"Ribbon.Templates.Flexible2\"          >            <Controls Id=\"Ribbon.List.GanttView.Controls\">              <Button                Id=\"Ribbon.List.EPMLiveGanttView.ZoomIn\"                Sequence=\"10\"                Command=\"ZoomIn\"                Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-16\" Image16by16Left=\"-56\"                Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-448\" Image32by32Left=\"-192\"                LabelText=\"Zoom In\"                TemplateAlias=\"o1\"              />              <Button                Id=\"Ribbon.List.EPMLiveGanttView.ZoomOut\"                Sequence=\"20\"                Command=\"ZoomOut\"                Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-240\" Image16by16Left=\"-176\"                Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-64\" Image32by32Left=\"-32\"                LabelText=\"Zoom Out\"                TemplateAlias=\"o1\"              />              <Button                Id=\"Ribbon.List.EPMLiveGanttView.ScrollToTask\"                Sequence=\"30\"                Command=\"ScrollTask\"                Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-32\" Image16by16Left=\"-240\"                Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-448\" Image32by32Left=\"-352\"                LabelText=\"Scroll To Task\"                TemplateAlias=\"o1\"              />            </Controls>          </Group><MaxSize Id=\"Ribbon.List.EPMLiveGanttView.MaxSize\" Sequence=\"10\" GroupId=\"Ribbon.List.EPMLiveGanttView\" Size=\"LargeLarge\" /><Button Id=\"Ribbon.List.CustomViews.Filters\" Sequence=\"4\" Command=\"ShowFilters\" Image16by16=\"/_layouts/images/fcofilter.png\" Image32by32=\"/_layouts/images/menufilter.gif\" LabelText=\"Hide/Show Search\" ToolTipTitle=\"Filters\" ToolTipDescription=\"\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Datasheet.Save\" Sequence=\"10\" Command=\"DatasheetSave\" Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-256\" Image16by16Left=\"0\" Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-416\" Image32by32Left=\"-256\" LabelText=\"Save Items\" ToolTipTitle=\"Save Items\" ToolTipDescription=\"Save all items in grid.\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Datasheet.Print\" Sequence=\"10\" Command=\"PrintGantt\" Image16by16=\"/_layouts/epmlive/images/print.gif\" Image32by32=\"/_layouts/epmlive/images/printmenu.gif\" LabelText=\"Print\" ToolTipTitle=\"Print\" ToolTipDescription=\"\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Share.RefreshItems\" Sequence=\"1\" Command=\"RefreshItems\"  Image32by32=\"/_layouts/epmlive/images/refresh.png\" LabelText=\"Refresh Items\" ToolTipTitle=\"Refresh Items\" ToolTipDescription=\"Refresh all items in grid.\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Share.ExportToExcel\" Sequence=\"3\" Command=\"ExportToExcel\" LabelText=\"Export To Excel\" TemplateAlias=\"o1\" ToolTipTitle=\"Export to Excel\" ToolTipDescription=\"Analyze items in this list using Microsoft Excel.\" Image16by16=\"/_layouts/epmlive/images/ribbon/export-excel16.png\" Image32by32=\"/_layouts/15/1033/images/formatmap32x32.png?rev=23\" Image32by32Top=\"-239\" Image32by32Left=\"-307\"/><Button Id=\"Ribbon.List.Share.PFEImportCostsData\" Sequence=\"2\" Command=\"PFEImportCostsData\" LabelText=\"Import Costs\" TemplateAlias=\"o1\" ToolTipTitle=\"Import Costs\" ToolTipDescription=\"Import costs data into portfolio engine database.\" Image16by16=\"/_layouts/epmlive/images/ribbon/import-costs-16.png\" Image32by32=\"/_layouts/epmlive/images/ribbon/import-costs-32.png\"/><Button Id=\"Ribbon.ListItem.EPMLive.EditComments\" Sequence=\"140\" Command=\"EditComments\" LabelText=\"Comments\" TemplateAlias=\"o2\" Image16by16=\"_layouts/epmlive/images/comments16.gif\"/><Button Id=\"Ribbon.ListItem.EPMLive.BuildTeam\" Sequence=\"150\" Command=\"BuildTeam\" LabelText=\"Edit Team\" TemplateAlias=\"o2\" Image16by16=\"_layouts/epmlive/images/buildteam16.gif\"/>"),
                () => registerDataExtensionString.ToString().ShouldBe("Ribbon.List.ViewFormat.Controls._childrenRibbon.List.Groups._childrenRibbon.List.Scaling._childrenRibbon.List.CustomViews.Controls._childrenRibbon.ListItem.Actions.Controls._childrenRibbon.List.Share.Controls._childrenRibbon.List.Actions.Controls._childrenRibbon.List.Actions.Controls._childrenRibbon.List.Actions.Controls._childrenRibbon.ListItem.Manage.Controls._childrenRibbon.ListItem.Manage.Controls._children"));
        }

        [TestMethod]
        public void AddContextualTab_GivenArguments_EPKEnabled_True_ConfirmRibbonExtensions()
        {
            // Arrange
            SetupForAddContextualTab();
            _testablePrivate.SetFieldOrProperty("EPKEnabled", true);
            ShimCacheStore.AllInstances.GetStringStringFuncOfObjectBoolean = (_1, key, _3, _4, _5) =>
            {
                var prop = new RibbonProperties();
                var pvt = new PrivateObject(prop);
                pvt.SetFieldOrProperty("aEPKButtons", new ArrayList()
                {
                    "costs",
                    "workplan",
                    "resplan",
                    "portfolio",
                    "costanalyzer",
                    "costanalyzerv2",
                    "resanalyzer",
                    "modeler",
                    "optimizer"
                });
                pvt.SetFieldOrProperty("aEPKActivex", new ArrayList()
                {
                    "resplan",
                });
                return new CachedValue(prop);
            };

            // Act
            _testablePrivate.Invoke("AddContextualTab",
                new object[] { });

            // Assert
            _testablePrivate.ShouldSatisfyAllConditions(
                () => trimByIdString.ToString().ShouldBe("Ribbon.ListItem.New.NewFolderRibbon.List.Actions.CreateVisioDiagramRibbon.List.Actions.OpenWithAccessRibbon.List.Actions.ExportToProjectRibbon.List.ViewFormat.GanttRibbon.List.Datasheet"),
                () => loadXmlString.ToString().ShouldBe("<ToggleButtonId=\"Ribbon.List.ViewFormat.Gantt\"Sequence=\"20\"Command=\"DisplayGanttView\"Image32by32=\"/_layouts/epmlive/images/ganttview.gif\"LabelText=\"Gantt View\"QueryCommand=\"QueryDisplayGanttView\"TemplateAlias=\"o1\"/><Group                Id=\"Ribbon.List.EPMLiveGanttView\"                Sequence=\"30\"                Command=\"EPMLiveGanttViewGroup\"                Description=\"\"                Title=\"Gantt\"                Image32by32Popup=\"/_layouts/0/images/formatmap32x32.png\" Image32by32PopupTop=\"-448\" Image32by32PopupLeft=\"-192\"                Template=\"Ribbon.Templates.Flexible2\"          >            <Controls Id=\"Ribbon.List.GanttView.Controls\">              <Button                Id=\"Ribbon.List.EPMLiveGanttView.ZoomIn\"                Sequence=\"10\"                Command=\"ZoomIn\"                Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-16\" Image16by16Left=\"-56\"                Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-448\" Image32by32Left=\"-192\"                LabelText=\"Zoom In\"                TemplateAlias=\"o1\"              />              <Button                Id=\"Ribbon.List.EPMLiveGanttView.ZoomOut\"                Sequence=\"20\"                Command=\"ZoomOut\"                Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-240\" Image16by16Left=\"-176\"                Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-64\" Image32by32Left=\"-32\"                LabelText=\"Zoom Out\"                TemplateAlias=\"o1\"              />              <Button                Id=\"Ribbon.List.EPMLiveGanttView.ScrollToTask\"                Sequence=\"30\"                Command=\"ScrollTask\"                Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-32\" Image16by16Left=\"-240\"                Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-448\" Image32by32Left=\"-352\"                LabelText=\"Scroll To Task\"                TemplateAlias=\"o1\"              />            </Controls>          </Group><MaxSize Id=\"Ribbon.List.EPMLiveGanttView.MaxSize\" Sequence=\"10\" GroupId=\"Ribbon.List.EPMLiveGanttView\" Size=\"LargeLarge\" /><Button Id=\"Ribbon.List.CustomViews.Filters\" Sequence=\"4\" Command=\"ShowFilters\" Image16by16=\"/_layouts/images/fcofilter.png\" Image32by32=\"/_layouts/images/menufilter.gif\" LabelText=\"Hide/Show Search\" ToolTipTitle=\"Filters\" ToolTipDescription=\"\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Datasheet.Save\" Sequence=\"10\" Command=\"DatasheetSave\" Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-256\" Image16by16Left=\"0\" Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-416\" Image32by32Left=\"-256\" LabelText=\"Save Items\" ToolTipTitle=\"Save Items\" ToolTipDescription=\"Save all items in grid.\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Datasheet.Print\" Sequence=\"10\" Command=\"PrintGantt\" Image16by16=\"/_layouts/epmlive/images/print.gif\" Image32by32=\"/_layouts/epmlive/images/printmenu.gif\" LabelText=\"Print\" ToolTipTitle=\"Print\" ToolTipDescription=\"\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Share.RefreshItems\" Sequence=\"1\" Command=\"RefreshItems\"  Image32by32=\"/_layouts/epmlive/images/refresh.png\" LabelText=\"Refresh Items\" ToolTipTitle=\"Refresh Items\" ToolTipDescription=\"Refresh all items in grid.\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Share.ExportToExcel\" Sequence=\"3\" Command=\"ExportToExcel\" LabelText=\"Export To Excel\" TemplateAlias=\"o1\" ToolTipTitle=\"Export to Excel\" ToolTipDescription=\"Analyze items in this list using Microsoft Excel.\" Image16by16=\"/_layouts/epmlive/images/ribbon/export-excel16.png\" Image32by32=\"/_layouts/15/1033/images/formatmap32x32.png?rev=23\" Image32by32Top=\"-239\" Image32by32Left=\"-307\"/><Button Id=\"Ribbon.List.Share.PFEImportCostsData\" Sequence=\"2\" Command=\"PFEImportCostsData\" LabelText=\"Import Costs\" TemplateAlias=\"o1\" ToolTipTitle=\"Import Costs\" ToolTipDescription=\"Import costs data into portfolio engine database.\" Image16by16=\"/_layouts/epmlive/images/ribbon/import-costs-16.png\" Image32by32=\"/_layouts/epmlive/images/ribbon/import-costs-32.png\"/><Button Id=\"Ribbon.ListItem.EPMLive.EditComments\" Sequence=\"140\" Command=\"EditComments\" LabelText=\"Comments\" TemplateAlias=\"o2\" Image16by16=\"_layouts/epmlive/images/comments16.gif\"/><Button                Id=\"Ribbon.ListItem.Manage.EPKCosts\"                Sequence=\"41\"                Command=\"EPKSingleAction\"                CommandValueId=\"Costs\"                Image32by32=\"/_layouts/epmlive/images/editcosts.png\"                LabelText=\"Edit Costs\"                TemplateAlias=\"o1\"                /><Button                Id=\"Ribbon.ListItem.Manage.EPKWorkPlan\"                Sequence=\"42\"                Command=\"EPKSingleAction\"                CommandValueId=\"Workplan\"                Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-112\" Image16by16Left=\"-128\"                LabelText=\"Work Planner\"                TemplateAlias=\"o2\"                /><Button                    Id=\"Ribbon.ListItem.Manage.EPKResourcePlanner.MultiAction\"                    Sequence=\"43\"                    Command=\"EPKMultiAction\"                    CommandValueId=\"ResourcePlanner\"                    Image32by32=\"/_layouts/epmlive/images/ribbon32.png\" Image32by32Top=\"-65\"                    LabelText=\"Edit Resource Plan\"                    TemplateAlias=\"o1\"                    /><ToggleButton                Id=\"Ribbon.List.ViewFormat.EPKCostView\"                Sequence=\"45\"                Command=\"EPKCostView\"                Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-96\" Image32by32Left=\"-256\"                LabelText=\"Cost View\"                QueryCommand=\"QueryEPKCostView\"                TemplateAlias=\"o1\"                /><Group Id=\"Ribbon.ListItem.EPMLiveAnalyze\" Sequence=\"42\" Command=\"EPMLiveAnalyzeGroup\" Description=\"\" Title=\"Analyze\" Template=\"Ribbon.Templates.Flexible2\"><Controls Id=\"Ribbon.ListItem.EPMLiveAnalyze.Controls\"><Button                Id=\"Ribbon.ListItem.Manage.EPKCostAnalyzer\"                Sequence=\"100\"                Command=\"EPKMultiAction\"                CommandValueId=\"CostAnalyzer\"                Image16by16=\"/_layouts/epmlive/images/costanalyzer16.png\"                Image32by32=\"/_layouts/epmlive/images/costanalyzer.png\"                LabelText=\"Cost Analyzer\"                TemplateAlias=\"o1\"                /><Button                Id=\"Ribbon.ListItem.Manage.EPKResourceAnalyzer\"                Sequence=\"101\"                Command=\"EPKMultiAction\"                Image16by16=\"/_layouts/epmlive/images/ribbon16.png\" Image16by16Top=\"-32\" Image16by16Left=\"-208\"                Image32by32=\"/_layouts/epmlive/images/ribbon32.png\" Image32by32Top=\"-385\" Image32by32Left=\"-160\"                LabelText=\"Resource Analyzer\"                TemplateAlias=\"o1\"                /><Button                Id=\"Ribbon.ListItem.Manage.EPKModeler\"                Sequence=\"102\"                Command=\"EPKMultiAction\"                Image16by16=\"/_layouts/epmlive/images/target.gif\"                Image32by32=\"/_layouts/epmlive/images/target.gif\"                LabelText=\"Modeler\"                TemplateAlias=\"o1\"                /><Button                Id=\"Ribbon.ListItem.Manage.EPKOptimizer\"                Sequence=\"105\"                Command=\"EPKMultiAction\"                Image16by16=\"/_layouts/ppm/images/optimizer.png\"                Image32by32=\"/_layouts/ppm/images/optimizer.png\"                LabelText=\"Optimizer\"                TemplateAlias=\"o1\"                /></Controls></Group><MaxSize Id=\"Ribbon.ListItem.EPMLiveAnalyze.MaxSize\" Sequence=\"10\" GroupId=\"Ribbon.ListItem.EPMLiveAnalyze\" Size=\"LargeMedium\" />"),
                () => registerDataExtensionString.ToString().ShouldBe("Ribbon.List.ViewFormat.Controls._childrenRibbon.List.Groups._childrenRibbon.List.Scaling._childrenRibbon.List.CustomViews.Controls._childrenRibbon.ListItem.Actions.Controls._childrenRibbon.List.Share.Controls._childrenRibbon.List.Actions.Controls._childrenRibbon.List.Actions.Controls._childrenRibbon.List.Actions.Controls._childrenRibbon.ListItem.Manage.Controls._childrenRibbon.ListItem.Manage.Controls._childrenRibbon.ListItem.Manage.Controls._childrenRibbon.ListItem.Manage.Controls._childrenRibbon.List.ViewFormat.Controls._childrenRibbon.ListItem.Groups._childrenRibbon.ListItem.Scaling._children"));
        }

        [TestMethod]
        public void AddContextualTab_GivenArguments_bAssociatedItems_True_ConfirmRibbonExtensions()
        {
            // Arrange
            SetupForAddContextualTab();
            _testablePrivate.SetFieldOrProperty("bAssociatedItems", true);

            // Act
            _testablePrivate.Invoke("AddContextualTab",
                new object[] { });

            // Assert
            _testablePrivate.ShouldSatisfyAllConditions(
                () => trimByIdString.ToString().ShouldBe("Ribbon.ListItem.New.NewFolderRibbon.List.Actions.CreateVisioDiagramRibbon.List.Actions.OpenWithAccessRibbon.List.Actions.ExportToProjectRibbon.List.ViewFormat.GanttRibbon.List.Datasheet"),
                () => loadXmlString.ToString().ShouldBe("<ToggleButtonId=\"Ribbon.List.ViewFormat.Gantt\"Sequence=\"20\"Command=\"DisplayGanttView\"Image32by32=\"/_layouts/epmlive/images/ganttview.gif\"LabelText=\"Gantt View\"QueryCommand=\"QueryDisplayGanttView\"TemplateAlias=\"o1\"/><Group                Id=\"Ribbon.List.EPMLiveGanttView\"                Sequence=\"30\"                Command=\"EPMLiveGanttViewGroup\"                Description=\"\"                Title=\"Gantt\"                Image32by32Popup=\"/_layouts/0/images/formatmap32x32.png\" Image32by32PopupTop=\"-448\" Image32by32PopupLeft=\"-192\"                Template=\"Ribbon.Templates.Flexible2\"          >            <Controls Id=\"Ribbon.List.GanttView.Controls\">              <Button                Id=\"Ribbon.List.EPMLiveGanttView.ZoomIn\"                Sequence=\"10\"                Command=\"ZoomIn\"                Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-16\" Image16by16Left=\"-56\"                Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-448\" Image32by32Left=\"-192\"                LabelText=\"Zoom In\"                TemplateAlias=\"o1\"              />              <Button                Id=\"Ribbon.List.EPMLiveGanttView.ZoomOut\"                Sequence=\"20\"                Command=\"ZoomOut\"                Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-240\" Image16by16Left=\"-176\"                Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-64\" Image32by32Left=\"-32\"                LabelText=\"Zoom Out\"                TemplateAlias=\"o1\"              />              <Button                Id=\"Ribbon.List.EPMLiveGanttView.ScrollToTask\"                Sequence=\"30\"                Command=\"ScrollTask\"                Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-32\" Image16by16Left=\"-240\"                Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-448\" Image32by32Left=\"-352\"                LabelText=\"Scroll To Task\"                TemplateAlias=\"o1\"              />            </Controls>          </Group><MaxSize Id=\"Ribbon.List.EPMLiveGanttView.MaxSize\" Sequence=\"10\" GroupId=\"Ribbon.List.EPMLiveGanttView\" Size=\"LargeLarge\" /><Button Id=\"Ribbon.List.CustomViews.Filters\" Sequence=\"4\" Command=\"ShowFilters\" Image16by16=\"/_layouts/images/fcofilter.png\" Image32by32=\"/_layouts/images/menufilter.gif\" LabelText=\"Hide/Show Search\" ToolTipTitle=\"Filters\" ToolTipDescription=\"\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Datasheet.Save\" Sequence=\"10\" Command=\"DatasheetSave\" Image16by16=\"/_layouts/0/images/formatmap16x16.png\" Image16by16Top=\"-256\" Image16by16Left=\"0\" Image32by32=\"/_layouts/0/images/formatmap32x32.png\" Image32by32Top=\"-416\" Image32by32Left=\"-256\" LabelText=\"Save Items\" ToolTipTitle=\"Save Items\" ToolTipDescription=\"Save all items in grid.\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Datasheet.Print\" Sequence=\"10\" Command=\"PrintGantt\" Image16by16=\"/_layouts/epmlive/images/print.gif\" Image32by32=\"/_layouts/epmlive/images/printmenu.gif\" LabelText=\"Print\" ToolTipTitle=\"Print\" ToolTipDescription=\"\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Share.RefreshItems\" Sequence=\"1\" Command=\"RefreshItems\"  Image32by32=\"/_layouts/epmlive/images/refresh.png\" LabelText=\"Refresh Items\" ToolTipTitle=\"Refresh Items\" ToolTipDescription=\"Refresh all items in grid.\" TemplateAlias=\"o1\"/><Button Id=\"Ribbon.List.Share.ExportToExcel\" Sequence=\"3\" Command=\"ExportToExcel\" LabelText=\"Export To Excel\" TemplateAlias=\"o1\" ToolTipTitle=\"Export to Excel\" ToolTipDescription=\"Analyze items in this list using Microsoft Excel.\" Image16by16=\"/_layouts/epmlive/images/ribbon/export-excel16.png\" Image32by32=\"/_layouts/15/1033/images/formatmap32x32.png?rev=23\" Image32by32Top=\"-239\" Image32by32Left=\"-307\"/><Button Id=\"Ribbon.List.Share.PFEImportCostsData\" Sequence=\"2\" Command=\"PFEImportCostsData\" LabelText=\"Import Costs\" TemplateAlias=\"o1\" ToolTipTitle=\"Import Costs\" ToolTipDescription=\"Import costs data into portfolio engine database.\" Image16by16=\"/_layouts/epmlive/images/ribbon/import-costs-16.png\" Image32by32=\"/_layouts/epmlive/images/ribbon/import-costs-32.png\"/><Button Id=\"Ribbon.ListItem.EPMLive.EditComments\" Sequence=\"140\" Command=\"EditComments\" LabelText=\"Comments\" TemplateAlias=\"o2\" Image16by16=\"_layouts/epmlive/images/comments16.gif\"/><Group Id=\"Ribbon.ListItem.EPMLive.Associated\" Sequence=\"41\" Command=\"LinkedItems\" Description=\"\" Title=\"Associated Items\" Template=\"Ribbon.Templates.Flexible2\"><Controls Id=\"Ribbon.ListItem.EPMLive.Associated.Controls\"><Button Sequence=\"20\" Command=\"LinkedItemsButton\" Id=\"Ribbon.ListItem.EPMLive.LinkedItemsButton.dummy.dummy\" LabelText=\"dummy\" TemplateAlias=\"o1\" Image16by16=\"http://fake.url\"/></Controls></Group><MaxSize Id=\"Ribbon.ListItem.EPMLive.Associated.MaxSize\" Sequence=\"10\" GroupId=\"Ribbon.ListItem.EPMLive.Associated\" Size=\"MediumMedium\" />"),
                () => registerDataExtensionString.ToString().ShouldBe("Ribbon.List.ViewFormat.Controls._childrenRibbon.List.Groups._childrenRibbon.List.Scaling._childrenRibbon.List.CustomViews.Controls._childrenRibbon.ListItem.Actions.Controls._childrenRibbon.List.Share.Controls._childrenRibbon.List.Actions.Controls._childrenRibbon.List.Actions.Controls._childrenRibbon.List.Actions.Controls._childrenRibbon.ListItem.Manage.Controls._childrenRibbon.ListItem.Groups._childrenRibbon.ListItem.Scaling._children"));
        }

    }
}
