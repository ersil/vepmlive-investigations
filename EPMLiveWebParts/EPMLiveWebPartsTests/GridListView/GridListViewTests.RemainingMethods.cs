using System;
using System.Collections.Generic;
using System.Collections.Specialized;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Web.Fakes;
using System.Web.UI.Fakes;
using EPMLiveCore;
using EPMLiveWebParts.Fakes;
using Microsoft.SharePoint.Fakes;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using Shouldly;

namespace EPMLiveWebParts.Tests
{
    public partial class GridListViewTests
    {
        [TestMethod]
        public void GridListView_renderGrid_GivenArguments_ConfirmOutput()
        {
            // Arrange
            SetupShims();

            // Act
            _testablePrivate.Invoke("renderGrid",
                new object[] { writer, web });

            // Assert
            _testablePrivate.ShouldSatisfyAllConditions(
                () => writeCount.ShouldBe(334),
                () => writerContent.ToString().Length.ShouldBe(74585),
                () => writerContent.ToString().ShouldBe("<style>.ms-usereditor { width:200px; }.grid_hover { border: 10px solid #91CDF2; background-color: #F2FAFF } </style><div id=\"peoplegrid\" style=\"display:none; border: 1px solid #808080; padding: 3px; background-color: #F9F9F9; width=200px;\"><div id=\"peoplechecktest-grid-id\" style=\"overflow: auto; width: 200px; height: 100px;  background-color: #FFFFFF; border: 1px solid #808080; margin-top:2px; padding:3px;\" class=\"ms-descriptiontext\"></div><table border=\"0\" width=\"100%\"><tr><td><a onclick=\"javascript:viewCheckstest-grid-id('test-grid-id');\"><img id=\"peoplecheckimgtest-grid-id\" src=\"_layouts/images/TPMAX1.GIF\" border=\"0\"></a><br></td><td align=\"right\"><font class=\"ms-descriptiontext\"><a onclick=\"javascript:mygridtest-grid-id.editStop();\">Close</a></font></td></tr></table><div id=\"divPetest-grid-id\" style=\"display:none;\"></div></div><div id=\"peoplesinglegrid\" style=\"display:none; border: 1px solid #808080; padding: 3px; background-color: #F9F9F9; width=200px;\"><div id=\"peoplechecksingletest-grid-id\" style=\"width: 200px; height: 100px;  background-color: #FFFFFF; border: 1px solid #808080; margin-top:2px; padding:0px;\" class=\"ms-descriptiontext\"><select size=\"6\" onclick=\"changeUsertest-grid-id(this);\" id=\"peoplecheckselecttest-grid-id\"  style=\"width:100%;height:100%\"><option>test</option></select></div><table border=\"0\" width=\"200\"><tr><td><a onclick=\"javascript:viewDropDowntest-grid-id('test-grid-id');\"><img id=\"peoplechecksingleimgtest-grid-id\" src=\"_layouts/images/TPMAX1.GIF\" border=\"0\"></a><br></td><td align=\"right\"><font class=\"ms-descriptiontext\"><a onclick=\"javascript:mygridtest-grid-id.editStop();\">Close</a></font></td></tr></table><div id=\"divPestest-grid-id\" style=\"display:none;\"></div></div><div id=\"multichoicegrid\" style=\"display:none; border: 1px solid #808080; padding: 3px; background-color: #F9F9F9; width:200px;height:180px\"><div id=\"multichoiceinnertest-grid-id\" style=\"width: 195px; height: 160px;  background-color: #FFFFFF; border: 1px solid #808080; margin-top:2px; padding:0px;overflow:auto\" class=\"ms-descriptiontext\">test</div><table border=\"0\" width=\"200\"><tr><td align=\"right\"><font class=\"ms-descriptiontext\"><a onclick=\"javascript:mygridtest-grid-id.editStop();\">Close</a></font></td></tr></table></div><div id=\"gridmenutest-grid-id\" style=\"position:absolute;left:0px;display:none;\" class=\"js-callout-mainElement ms-core-defaultFont  ms-alignLeft ms-shadow\"><ul class=\"ms-core-menu-list\" style=\"width: 173px;\"></ul></div><script>_css_prefix=\"/_layouts/epmlive/DHTML/xgrid/\"; _js_prefix=\"/_layouts/epmlive/DHTML/xgrid/\"; </script><script src=\"_layouts/epmlive/DHTML/xgrid/dhtmlxcommon.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/dhtmlxgrid.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/dhtmlxgridcell.js\"></script><script src=\"_layouts/epmlive/DHTML/xtreegrid/dhtmlxtreegrid.js\"></script><script src=\"_layouts/epmlive/DHTML/xtreegrid/ext/dhtmlxtreegrid_filter.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_post.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_nxml.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_filter.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_math.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_srnd.js\"></script><script src=\"/_layouts/epmlive/DHTML/xgrid/excells/dhtmlxgrid_excell_calendar.js\"></script><script src=\"/_layouts/epmlive/DHTML/xgrid/excells/dhtmlxgrid_excell_combo.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/excells/dhtmlxgrid_excell_dhxcalendar.js\"></script><script src=\"_layouts/epmlive/DHTML/xcombo/dhtmlxcombo.js\"></script><script src=\"_layouts/epmlive/DHTML/calendar/dhtmlxcalendar.js\"></script><script src=\"_layouts/epmlive/DHTML/xdataproc/dhtmlxdataprocessor.js\"></script><script type=\"text/javascript\" src=\"_layouts/epmlive/modal/modal.js\"></script> <script language=\"JavaScript\" src=\"_layouts/epmlive/dhtml/xmenu/dhtmlxmenu.js\"></script><script language=\"JavaScript\" src=\"_layouts/epmlive/dhtml/xmenu/ext/dhtmlxmenu_ext.js\"></script><style>.menuTable{background-color:#ffffff;}.secondMenuTable{background-color:#ffffff;}.contextMenuover, .contextMenudown{background-color:#9ac2e5;}.contextMenuover td{color:#000000;} </style><script src=\"_layouts/epmlive/epmlivegrid.js\"></script><script language=\"javascript\">var searchfieldstest-grid-id = {test-field: [ \"Yes\", \"No\" ]};function switchsearchtest-grid-id()            {                var searcher = document.getElementById('searchtest-grid-id');                var searchtext = document.getElementById('searchtexttest-grid-id');                var searchchoice = document.getElementById('searchchoicetest-grid-id');                var searchtypechoice = document.getElementById('searchtypetest-grid-id');                var searchfield = searcher.options[searcher.selectedIndex].value;                var sList = searchfieldstest-grid-id[searchfield];                if(sList) {                    searchtext.style.display='none';                    searchchoice.style.display='';                    searchchoice.options.length = 0;                    searchtypechoice.options[2].selected = true;                    searchtypechoice.disabled = true;                    for(var i=0; i < sList.length; i++) {                        var d = sList[i];                        searchchoice.options.add(new Option(d, d));                        if(d=='test-search-string') {                            searchchoice.options[searchchoice.options.length-1].selected = true;                        }                     }                 } else {                    searchtext.style.display='';                    searchchoice.style.display='none';                    searchtypechoice.disabled = false;                }            }function unSearchtest-grid-id(){var gri = document.getElementById('grid');gri.style.display = 'none';var loader = document.getElementById('loadinggrid');loader.style.display = '';var unsearch = document.getElementById('unsearchtest-grid-id');unsearch.style.display=\"none\";var searchtext = document.getElementById('searchtexttest-grid-id');searchtext.value = '';curPagetest-grid-id = 0;sftest-grid-id = null;svtest-grid-id = null;sttest-grid-id = null;loadXtest-grid-id();}function doSearchtest-grid-id(){var gri = document.getElementById('grid');                     gri.style.display = 'none';                     var loader = document.getElementById('loadinggrid');                     loader.style.display = '';                var searcher = document.getElementById('searchtest-grid-id');                var unsearch = document.getElementById('unsearchtest-grid-id');                unsearch.style.display=\"table-cell\";                var searchchoice = document.getElementById('searchchoicetest-grid-id');                var searchtext = document.getElementById('searchtexttest-grid-id');                var searchtypechoice = document.getElementById('searchtypetest-grid-id');                var searchfield = searcher.options[searcher.selectedIndex].value;                var searchtype = searchtypechoice.options[searchtypechoice.selectedIndex].value;                var sList = searchfieldstest-grid-id[searchfield];                var searchvalue = \"\";                if(sList){                    searchvalue = searchchoice.options[searchchoice.selectedIndex].value;                } else {                     searchvalue = searchtext.value;                }curPagetest-grid-id = 0;                         sftest-grid-id = searchfield;                         svtest-grid-id = searchvalue;                         sttest-grid-id = searchtype;                                loadXtest-grid-id(searcher.options[searcher.selectedIndex].value, searchvalue, searchtype);                            }function enablesearchertest-grid-id(){}</script><div id=\"search\" style=\"width:100%; height:25px; padding:10px\" class=\"ms-listviewtable\"><table><tr><td>Search: <select id=\"searchtest-grid-id\" onChange=\"switchsearchtest-grid-id();\" style=\"border: 1px solid #ABABAB; height:20px\"><option value=\"test-field\">test-field</option></select>&nbsp;&nbsp;<select id=\"searchtypetest-grid-id\" style=\"border: 1px solid #ABABAB; height:20px\"><option value=\"1\" selected>Contains</option><option value=\"8\" >Begins With</option><option value=\"2\" >Equals</option><option value=\"3\" >Does Not Equal</option><option value=\"4\" >Greater Than</option><option value=\"5\" >Greater Than or Equal</option><option value=\"6\" >Less Than</option><option value=\"7\" >Less Than or Equal</option></select>&nbsp;&nbsp;</td><td><div style=\"border: 1px solid #ABABAB;width: 150px;height: 20px;\">                    <div id=\"unsearchtest-grid-id\" class=\"\" style=\"padding-left:4px;display: none;min-width: 12px;align:top\">                        <img alt=\"Clear Search\" src=\"/_layouts/epmlive/images/unsearch.png\" style=\"padding-bottom:2px\" onclick=\"unSearchtest-grid-id()\"/>                    </div>                    <div style=\"display: table-cell\">                        <input type=\"text\" id=\"searchtexttest-grid-id\" value=\"test-search-string\" class=\"\" style=\"border: 0px; width:100%; margin-top:-5px; height:14px; font-family: 'Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size:13px\"/>                        <select id=\"searchchoicetest-grid-id\" style=\"border: 0px; width:100%\">                        </select>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    </div>                    <div class=\"\" style=\"padding-right:2px; padding-left:5px;padding-top:2px;display: table-cell;min-width: 10px;cursor:pointer\">                        <img onclick=\"GridSearch('test-grid-id')\" src=\"/_layouts/epmlive/images/find_icon.png\"/>                    </div>                </div></td></tr></table></div><script language=\"javascript\">switchsearchtest-grid-id();</script><div id=\"grid\" style=\"width:100%;display:none;\" class=\"ms-listviewtable\"></div><div id=\"errordivtest-grid-id\" style=\"font-color:red;font-size:11px;\"></div><div  width=\"100%\" id=\"loadinggrid\" align=\"center\"><img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/> Loading Items...</div><script language=\"javascript\">function viewCheckstest-grid-id(btn){var pp = document.getElementById('divPe' + btn);var ppi = document.getElementById('peoplecheckimg' + btn);if(pp.style.display == \"none\"){pp.style.display = \"\";ppi.src = \"_layouts/images/TPMIN1.GIF\";}else{pp.style.display = \"none\";ppi.src = \"_layouts/images/TPMAX1.GIF\";}}function viewDropDowntest-grid-id(btn){var pp = document.getElementById('divPes' + btn);var ppi = document.getElementById('peoplechecksingleimg' + btn);if(pp.style.display == \"none\"){pp.style.display = \"\";ppi.src = \"_layouts/images/TPMIN1.GIF\";}else{pp.style.display = \"none\";ppi.src = \"_layouts/images/TPMAX1.GIF\";}}function gridfiltertest-grid-id(value){var vals = value.split('|');mygridtest-grid-id.filterBy(vals[0],vals[1]);}function setSizetest-grid-id(){mygridtest-grid-id._askRealRows();}function printgridtest-grid-id() {var temp = mygridtest-grid-id.hdr.rows[2];var parent = temp.parentNode;parent.removeChild(temp,true);mygridtest-grid-id.printView();parent.appendChild(temp);}function switchFilterLoadtest-grid-id(){mygridtest-grid-id.switchFilter();mygridtest-grid-id.setSizes();}</script><script>var mygridtest-grid-idHidden = false;var listidtest-grid-id = '00000000-0000-0000-0000-000000000000';mygridtest-grid-id = new dhtmlXGridObject('grid');mygridtest-grid-id.setImagePath(\"_layouts/epmlive/dhtml/xgrid/imgs/\");mygridtest-grid-id.getTitles = function(){                            var lookups = \"\";            mygridtest-grid-id.forEachRow(function (id) {\t\t\t    var c = this.cells(id, 0);\t\t\t    if (c.isCheckbox() && !c.cell.firstChild.disabled && c.cell.firstChild.checked)                {                    var title = this.getUserData(id,\"title\");        \t        var itemid = this.getUserData(id,\"itemid\");                    if(itemid != \"\")                    {                        lookups += \",\" + title;                    }                }\t\t    });            if(lookups == \"\")            {                var rowId = mygridtest-grid-id.getSelectedRowId();                lookups = \",\" + mygridtest-grid-id.getUserData(rowId,\"title\");            }            if(lookups != \"\" && lookups[0] == ',')                lookups = lookups.substring(1);            return lookups;                }                mygridtest-grid-id.getCheckedRowIds = function(){                var ids = \"\";                this.forEachRow(function (id) {\t\t\t        var c = this.cells(id, 0);\t\t\t        if (c.isCheckbox() && !c.cell.firstChild.disabled && c.cell.firstChild.checked)                    {                        ids += \",\" + id;                    }\t\t        });                if(ids != \"\" && ids[0] == ',')                    ids = ids.substring(1);                if(ids == \"\")                    ids = this.getSelectedRowId();                return ids;            };mygridtest-grid-id.getCheckedIds = function(){                var ids = \"\";                this.forEachRow(function (id) {\t\t\t        var c = this.cells(id, 0);\t\t\t        if (c.isCheckbox() && !c.cell.firstChild.disabled && c.cell.firstChild.checked)                    {                        var listid = this.getUserData(id,\"listid\");        \t            var itemid = this.getUserData(id,\"itemid\");        \t            var webid = this.getUserData(id,\"webid\");                        if (this._useparent) {                            var parentid = this.getUserData(id, \"parentitemid\");                            if (parentid && parentid != \"\") {                                var newids = parentid.toString().split(\".\");                                webid = newids[0];                                listid = newids[1];                                itemid = newids[2];                            }                        }                        if(itemid != \"\")                        {                            ids += \",\" + webid + \".\" + listid + \".\" + itemid;                        }                    }\t\t        });                if(ids == \"\")                {                    var rowId = this.getSelectedRowId();                    var listid = this.getUserData(rowId,\"listid\");        \t        var itemid = this.getUserData(rowId,\"itemid\");        \t        var webid = this.getUserData(rowId,\"webid\");                    if (this._useparent) {                        var parentid = this.getUserData(rowId, \"parentitemid\");                        if (parentid && parentid != \"\") {                            var newids = parentid.toString().split(\".\");                            webid = newids[0];                            listid = newids[1];                            itemid = newids[2];                        }                    }                    if(itemid != \"\")                    {                        ids = webid + \".\" + listid + \".\" + itemid;                    }                }                if(ids != \"\" && ids[0] == ',')                    ids = ids.substring(1);                return ids;            };mygridtest-grid-id.getCheckedItems = function(){                var ids = \"\";                this.forEachRow(function (id) {\t\t\t        var c = this.cells(id, 0);\t\t\t        if (c.isCheckbox() && !c.cell.firstChild.disabled && c.cell.firstChild.checked)                    {                        var listid = this.getUserData(id,\"listid\");        \t            var itemid = this.getUserData(id,\"itemid\");        \t            var webid = this.getUserData(id,\"webid\");                        if(itemid != \"\")                        {                            ids += \",\" + itemid;                        }                    }\t\t        });                if(ids == \"\")                {                    var rowId = this.getSelectedRowId();                    var listid = this.getUserData(rowId,\"listid\");        \t        var itemid = this.getUserData(rowId,\"itemid\");        \t        var webid = this.getUserData(rowId,\"webid\");                    if(itemid != \"\")                    {                        ids = itemid;                    }                }                if(ids != \"\" && ids[0] == ',')                    ids = ids.substring(1);                return ids;            };mygridtest-grid-id.toggleSearch = function(){var searchDiv = document.getElementById('search');if(searchDiv.style.display == 'none'){searchDiv.style.display = '';}else{searchDiv.style.display = 'none';}};mygridtest-grid-id.switchFilter = function(){try{var input1 = mygridtest-grid-id.hdr.rows[2];if(mygridtest-grid-idHidden == false){input1.style.display = \"none\";mygridtest-grid-idHidden = true;}else{input1.style.display = \"\";mygridtest-grid-idHidden = false;}mygridtest-grid-id.setSizes();}catch(e){}};mygridtest-grid-id._enableCMenus = true;mygridtest-grid-id.PageSize = '0';mygridtest-grid-id.UseReporting = false;curPagetest-grid-id = 0;mygridtest-grid-id._epkview = '';mygridtest-grid-id._useparent = false;mygridtest-grid-id._curPlanner = '';mygridtest-grid-id._epkurl = '';mygridtest-grid-id._epkcostview = '';mygridtest-grid-id.canribbon = true;mygridtest-grid-id.addFocusedCommands = function($arr){return $arr;}mygridtest-grid-id.getGlobalCommands = function($arr){return $arr;}mygridtest-grid-id.canHandleCommand = function($Grid, commandId){return false;}mygridtest-grid-id.handleCommand = function($Grid, commandId, properites){if(typeof(properties) != 'undefined')return properties;}mygridtest-grid-id._webpartid = '';mygridtest-grid-id._outlookexport = '';mygridtest-grid-id._gridMode = '';mygridtest-grid-id._hasTemplateList = false;mygridtest-grid-id._newmenumode = 0;mygridtest-grid-id._newitemurl = 'test-server-url';mygridtest-grid-id._newfolder = false;mygridtest-grid-id._newmenu = \"<Button Id=\\'Ribbon.ListItem.New.NewListItem\\' Command=\\'NewItem\\' CommandValueId=\\'NewListItem\\' LabelText=\\'New Item\\' Description=\\'Create a New Item\\' Image32by32=\\'/_layouts/0/images/formatmap32x32.png\\' CommandType=\\'OptionSelection\\' Image32by32Top=\\'-160\\' Image32by32Left=\\'-384\\'/>\"mygridtest-grid-id._modifylist = false;mygridtest-grid-id._listperms = false;mygridtest-grid-id._shownewmenu = true;mygridtest-grid-id._allowedit = false;mygridtest-grid-id._listid = '00000000-0000-0000-0000-000000000000';mygridtest-grid-id._webid = '00000000-0000-0000-0000-000000000000';mygridtest-grid-id._listname = '';mygridtest-grid-id._viewid = '00000000-0000-0000-0000-000000000000';mygridtest-grid-id._viewurl = 'http://fake.url/http://fake.url';mygridtest-grid-id._siteurl = '';mygridtest-grid-id._webrelurl = 'test-server-url';mygridtest-grid-id._viewname = 'dummy';mygridtest-grid-id._basetype = 'GenericList';mygridtest-grid-id._templatetype = '0';mygridtest-grid-id._newrow = false;mygridtest-grid-id._rolluplists = '';mygridtest-grid-id._brollups = false;mygridtest-grid-id._requestList = false;mygridtest-grid-id._usepopup = false;mygridtest-grid-id._lookupfield = '';mygridtest-grid-id._lookupfieldlist = '';mygridtest-grid-id._excell = 'test-server-url\\u002f_vti_bin\\u002fowssvr.dll?CS=65001\\u0026Using=_layouts\\u002fquery.iqy\\u0026List=\\u00257B00000000\\u00252D0000\\u00252D0000\\u00252D0000\\u00252D000000000000\\u00257D\\u0026View=\\u00257B00000000\\u00252D0000\\u00252D0000\\u00252D0000\\u00252D000000000000\\u00257D\\u0026RootFolder=http:\\u0026CacheControl=1';mygridtest-grid-id._gridid = 'test-grid-id';mygridtest-grid-id._formmenus = \"\";mygridtest-grid-id.setSkin(\"modern\");mygridtest-grid-id.enableAlterCss(\"ms-itmhover\", \"ms-itmhover\");mygridtest-grid-id.enableAutoHeight(true);mygridtest-grid-id.enableSmartRendering(true);mygridtest-grid-id.enableSmartXMLParsing(true);mygridtest-grid-id.setAwaitedRowHeight(30);mygridtest-grid-id.setImageSize(1,1);mygridtest-grid-id._editmode = false;mygridtest-grid-id.enableEditEvents(true,false,false);document.onclick=function(){mygridtest-grid-id._curHover=false;mygridtest-grid-id.clearmenus();};mygridtest-grid-id.setDateFormat(\"%m/%d/%Y\");mygridtest-grid-id.attachEvent(\"onXLE\",clearLoader);mygridtest-grid-id.attachEvent(\"onXLE\",switchFilterLoadtest-grid-id);mygridtest-grid-id.attachEvent(\"onXLE\",enablesearchertest-grid-id);mygridtest-grid-id.attachEvent(\"onXLE\",showrib());mygridtest-grid-id.attachEvent(\"onRowSelect\",selectRowtest-grid-id);mygridtest-grid-id._singleItemUrl = \"http://fake.url/_layouts/epmlive/getsingleitem.aspx?data=&edit=false\";mygridtest-grid-id.init();singleItemUrltest-grid-id = \"http://fake.url/_layouts/epmlive/getsingleitem.aspx?data=&edit=false\";singleEditItemUrltest-grid-id = \"test-server-url/_layouts/epmlive/getedititem.aspx?data=\";inEditModetest-grid-id = false;myDataProcessortest-grid-id = new dataProcessor(\"http://fake.url/_layouts/epmlive/savegrid.aspx?columns=dGVzdC1maWVsZC0x&data=&edit=false\");myDataProcessortest-grid-id.setUpdateMode(\"off\");myDataProcessortest-grid-id.defineAction(\"error100\", myErrorHandlertest-grid-id);myDataProcessortest-grid-id.defineAction(\"error500\", error500test-grid-id);myDataProcessortest-grid-id.defineAction(\"alldatareturned\", alldatareturnedtest-grid-id);myDataProcessortest-grid-id.setTransactionMode(\"POST\", true);myDataProcessortest-grid-id.init(mygridtest-grid-id);mygridtest-grid-id.enableTreeCellEdit(false);function viewErrortest-grid-id(id){document.getElementById('dlgErrorTexttest-grid-id').innerText=mygridtest-grid-id.getUserData(id,\"lastError\");sm('dlgErrortest-grid-id',250,130);}function myErrorHandlertest-grid-id(obj){      var id = obj.getAttribute(\"sid\");var EditCol = getEditColtest-grid-id();if(EditCol != null){      mygridtest-grid-id.cells(id,EditCol).setValue(\"<a href=\\\"javascript:viewErrortest-grid-id('\" + id + \"');\\\"><img src='/_layouts/images/EXCLAIM.GIF' border='0'></a> <a onclick=\\\"javascript:saveEdittest-grid-id('\" + id + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/saveitem.gif\\\" border=\\\"0\\\" alt=\\\"Save\\\"></a> <a onclick=\\\"javascript:cancelEditRowtest-grid-id('\" + id + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/close.gif\\\" border=\\\"0\\\" alt=\\\"Cancel\\\"></a>\");}      mygridtest-grid-id.setUserData(id,\"lastError\",obj.firstChild.data);      return true;}function alldatareturnedtest-grid-id(obj){      setRowValuestest-grid-id(obj.firstChild);}function error500test-grid-id(obj){      alert(obj.firstChild.data);      myDataProcessortest-grid-id.stopOnError = true;       hm('dlgSavingtest-grid-id');      return false;}myDataProcessortest-grid-id.setOnAfterUpdate(function(id,action,newid){if(action != \"error100\" && action != \"delete\"){mygridtest-grid-id.cells(id,0).setValue(\"\");mygridtest-grid-id.cells(id,0).setBgColor('#F0F0F0');}if(myDataProcessortest-grid-id.getSyncState()){    hm('dlgSavingtest-grid-id');    myDataProcessortest-grid-id.updatedRows = new Array(0);}});var singleItemUrltest-grid-id;var arrColumnLookupstest-grid-id;var defaultxmltest-grid-id;var minValuestest-grid-id;var maxValuestest-grid-id;var curPagetest-grid-id = 0;var firstItemtest-grid-id = 0;var lastItemtest-grid-id = 0;var fItemHidetest-grid-id = 0;var sftest-grid-id;var svtest-grid-id;var sttest-grid-id;var bPageSetuptest-grid-id = false;function selectRowtest-grid-id(id, ind){\t\tcurRowId = id;\tcurGrid = mygridtest-grid-id;\tvar c = curGrid.cells(id, 0);\tif (c.isCheckbox())\t{\t\tUnCheckAll(curGrid);\t\tc.cell.firstChild.checked = true;\t\tc.cell.firstChild.display = \"\";\t}\tRefreshCommandUI();\tif(curGrid.canribbon)\t{\t\tif(curGrid.getRowById(id)._locked)\t\t{\t\t\tSelectRibbonTab(\"Ribbon.ListItem\", true);\t\t\t//var wp2 = document.getElementById('Ribbon.ListItem-title');\t\t\t//if(wp2)\t\t\t//\tfireEvent(wp2.firstChild, 'click');\t\t}\t}}function UnCheckAll(grid){\tgrid.forEachRow(function (id) {\t\tvar c = this.cells(id, 0);\t\tif (c.isCheckbox())\t\t{\t\t\tc.cell.firstChild.checked = false;\t\t\tc.cell.firstChild.display = \"none\";\t\t}\t});}function viewItemtest-grid-id(link, action){    var rowIdFull = link.parentNode.parentNode.parentNode.parentNode.parentNode.idd;    var weburl = mygridtest-grid-id.getUserData(rowIdFull,\"SiteUrl\");    var listId = mygridtest-grid-id.getUserData(rowIdFull,\"listid\");    var webid = mygridtest-grid-id.getUserData(rowIdFull,\"webid\");    var siteid = mygridtest-grid-id.getUserData(rowIdFull,\"siteid\");    var editurl = mygridtest-grid-id.getUserData(rowIdFull,\"editurl\");    var viewurl = mygridtest-grid-id.getUserData(rowIdFull,\"viewurl\");    var itemId = mygridtest-grid-id.getUserData(rowIdFull,\"itemid\");    var FullURL = mygridtest-grid-id.getUserData(rowIdFull,\"FullURL\");    var wurl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=\" + action + \"&ListId=\" + listId + \"&ID=\" + itemId + \"&gridid=test-grid-id&siteid=\" + siteid + \"&webid=\" + webid + \"&rowid=\" + rowIdFull;        function myCallback(dialogResult, returnValue)\t{\t\tif(dialogResult == 1)\t\t{\t\t\tvar weburl = curGrid.getUserData(curRowId,\"SiteUrl\");\t\t\tvar listid = curGrid.getUserData(curRowId,\"listid\");\t\t\tvar itemid = curGrid.getUserData(curRowId,\"itemid\");\t\t\tvar webid = curGrid.getUserData(curRowId,\"webid\");\t\t\tvar siteid = curGrid.getUserData(curRowId,\"siteid\");\t\t\tgetSingleItemtest-grid-id(siteid,webid,listid,itemid,curRowId);\t\t}\t}\tvar options = { url: wurl, width: 600, dialogReturnValueCallback:myCallback };\tSP.UI.ModalDialog.showModalDialog(options);}function onKeyPresstest-grid-id(key, control, shift){\tif(!mygridtest-grid-id.editor)\t{\t\tif(key == 46)\t\t{\t\t\tvar rowId = mygridtest-grid-id.getSelectedRowId();\t\t\t\t\tvar isNew = mygridtest-grid-id.getUserData(rowId,\"isNewRow\");\t\t\tvar itemid = mygridtest-grid-id.getUserData(rowId,\"itemid\");\t\t\tif(isNew != \"1\" && itemid != \"\")\t\t\t{\t\t\t\tif(confirm('Are you sure you want to delete this item?')){\t\t\t\t\tmygridtest-grid-id.deleteRow(rowId);\t\t\t\t};            }\t\t}\t}\treturn true;}function newItemtest-grid-id(usepopup){\tvar wurl = mygridtest-grid-id._newitemurl;\tif(usepopup)\t{\t\tfunction NewItemCallback(dialogResult, returnValue){if(dialogResult){window.location.href=window.location.href;}}\t\tvar options = { url: wurl, width: 600, dialogReturnValueCallback:NewItemCallback };\t\tSP.UI.ModalDialog.showModalDialog(options);\t}\telse\t{\t\tlocation.href = wurl;\t}}function setDefaultstest-grid-id(id){\tvar dxml = id.xmlLoader;\t\tvar rows = dxml.doXPath(\"//rows/row[@id='_NEWROW_']\");\t\tvar ua = window.navigator.userAgent;    var msie = ua.indexOf(\"MSIE \");\tif (msie > 0)\t\tdefaultxmltest-grid-id = rows[0].xml;\telse\t\tdefaultxmltest-grid-id = rows[0].outerHTML;\tmygridtest-grid-id._defaults = defaultxmltest-grid-id;}function onEditCelltest-grid-id(stage, rowId, ind, nval, oval){\tif(stage != 2)        return true;        \tif(oval == null)\t\toval = \"\";\tif(!checkMintest-grid-id(rowId,ind,nval))    {        mygridtest-grid-id.cells(rowId,ind).setValue(oval);        return;    }        if(!checkMaxtest-grid-id(rowId,ind,nval))    {        mygridtest-grid-id.cells(rowId,ind).setValue(oval);        return;    }        //alert(\"OLD: \" + oval + \"\\r\\nNEW: \" + nval + \"\\r\\nTitle: \" + mygridtest-grid-id.cells(rowId,ind).getTitle());    \tif(stage == 2 && oval != nval)\t{\t\tvar isNew = mygridtest-grid-id.getUserData(rowId,\"isNewRow\");\t\tif(isNew != null && isNew == \"1\")\t\t{\t\t\tmygridtest-grid-id.setUserData(rowId,\"isNewRow\",\"\");\t\t\tmygridtest-grid-id.cells(rowId,0).setValue(\"\");\t\t\tinsertBlankRowtest-grid-id();\t\t}\t}\treturn true;}function insertBlankRowtest-grid-id(id){\tvar xmlDoc; \tvar moz = (typeof document.implementation != 'undefined') && (typeof \tdocument.implementation.createDocument != 'undefined'); \tvar ie = (typeof window.ActiveXObject != 'undefined'); \tif (window.DOMParser)\t{\t\tparser=new DOMParser();\t\txmlDoc=parser.parseFromString(defaultxmltest-grid-id,\"text/xml\");\t}\telse // code for IE\t{\t\txmlDoc=new ActiveXObject(\"Microsoft.XMLDOM\");\t\txmlDoc.async=false;\t\txmlDoc.loadXML(defaultxmltest-grid-id); \t}\tvar newId = \"_NEWROW_\" + mygridtest-grid-id.getUID();\tvar nRow = mygridtest-grid-id.addRow(newId,\"<img src=\\\"/_layouts/images/newitem.gif\\\">\");\txmlDoc.firstChild.setAttribute(\"id\",newId);\t\tsetRowValuetest-grid-id(xmlDoc.firstChild);\tmygridtest-grid-id.setUserData(newId,\"isNewRow\",\"1\");\tmyDataProcessortest-grid-id.setUpdated(newId,false);\t}dhtmlXGridObject.prototype.alerterror=function(msg){    document.getElementById(\"errordiv\" + this._gridid).innerHTML = \"Error: \" + msg;};dhtmlXGridObject.prototype.setuppaging=function(records){    \tvar pages = Math.ceil(records / this.PageSize);\tvar prev = document.getElementById(\"PagePrevious\"+ this._gridid);\tvar next = document.getElementById(\"PageNext\"+ this._gridid);\tvar pagediv = document.getElementById(\"pagediv\"+ this._gridid);\tvar pagetable = document.getElementById(\"pagetable\"+ this._gridid);\tif(this.UseReporting)\t{\t\tif(pages > 1)\t\t{\t\t\tif(!bPageSetuptest-grid-id)\t\t\t{\t\t\t\tbPageSetuptest-grid-id = true;\t\t\t\t$(\"#pagedivtest-grid-id\").paginate({\t\t\t\t\tcount \t\t: pages,\t\t\t\t\tstart \t\t: 1,\t\t\t\t\tdisplay     : 12,\t\t\t\t\tborder\t\t\t\t\t: true,\t\t\t\t\trotate      : false,\t\t\t\t\timages\t\t: false,\t\t\t\t\tmouse\t\t: 'press',\t\t\t\t\tonChange\t: ChangePagetest-grid-id\t\t\t\t});\t\t\t}\t\t}\t\telse\t\t{\t\t\tpagediv.style.display = \"none\";\t\t\tpagetable.style.display = \"none\";\t\t}\t}\telse\t{\t\tpagediv.style.display = \"inline-block\";\t\tpagetable.style.display = \"\";\t\tvar rec = records.split('|');\t\tfirstItemtest-grid-id = parseInt(rec[2]) * -1;\t\tlastItemtest-grid-id = rec[1];\t\tif(rec[0] == \"0\" || fItemHidetest-grid-id == firstItemtest-grid-id)\t\t{\t\t\tprev.style.background = \"#EFEFEF\";\t\t\tfItemHidetest-grid-id = firstItemtest-grid-id;\t\t}\t\telse\t\t{\t\t\tprev.style.background = \"#DDDDDD\";\t\t}\t\tif(rec[3] == \"true\")\t\t\tnext.style.background = \"#DDDDDD\";\t\telse\t\t{\t\t\tprev.style.background = \"#EFEFEF\";\t\t\tlastItemtest-grid-id = 0;\t\t}\t\tif(rec[3] != \"true\" && rec[0] == \"0\")\t\t{\t\t\tpagediv.style.display = \"none\";\t\t\tpagetable.style.display = \"none\";\t\t}\t}};dhtmlXGridObject.prototype.registerLookuptest-grid-id=function(col,vals){    if(arrColumnLookupstest-grid-id == null)        arrColumnLookupstest-grid-id = new Array(mygridtest-grid-id.getColumnsNum());\t\t    arrColumnLookupstest-grid-id[col] = vals;};//======================Multi User=====================function changeUsertest-grid-id(chkVal){\tdocument.getElementById(\"_downlevelTextBox\").value = \"\";\tdocument.getElementById(\"_upLevelDiv\").innerHTML = \"\";\t\t\tif(document.getElementById(\"_upLevelDiv\").firstChild == null)\t{\t\tvar oTN=document.createTextNode(\"\");\t\tdocument.getElementById(\"_upLevelDiv\").appendChild(oTN);\t}\tdocument.getElementById(\"_upLevelDiv\").firstChild.nodeValue = \"\";\t//chkVal.options[chkVal.selectedIndex].value;}function eXcell_usereditorm(cell){                                    //excell name is defined here    if (cell){                                                     //default pattern, just copy it        this.cell = cell;        this.grid = this.cell.parentNode.grid;        if(!this.grid._grid_pe)        {\t\t\tvar z=document.getElementById(\"people\" + cell.parentNode.grid.entBox.id);\t\t\tz.onclick=function(e){ (e||event).cancelBubble=true; }\t\t\t\t\t\tif (_isIE) { \t\t\t\tz.style.position=\"absolute\"\t\t\t\tz.style.top=\"0px\"\t\t\t}\t\t\tdocument.body.insertBefore(z,document.body.firstChild);\t\t\t \t\t\tthis.grid._grid_pe = z;\t\t}    }    this.setValue=function(val){\t\tvar strVal = \"&nbsp;\";\t\tvar strVals = val.split('\\t')[0].split('\\n');\t\tfor(var i = 1;i<strVals.length;i=i+2)\t\t{\t\t\tstrVal += \"; \" + strVals[i];\t\t}\t\tif(strVal != \"&nbsp;\")\t\t\tstrVal = strVal.substring(7);\t\t\t        this.setCValue(strVal);                   this.cell._displayValue = strVal;        this.cell._users = val.split('\\t')[0];                                           this.cell._Allusers = val === undefined ? [] : val.split('\\t')[1];                                       }    this.getValue=function(){       return this.cell._users; // get value    }    this.edit=function(){    \t\tthis.val=this.getValue();    \t\tdocument.getElementById(\"_downlevelTextBox\").value = \"\";\t\tdocument.getElementById(\"_upLevelDiv\").innerHTML = \"\";\t\tcopyUplevelToHidden('');\t\tupdateControlValue('');\t\tvar arg=getUplevel('');\t\tvar ctx='';\t\tEntityEditorSetWaitCursor(ctx);\t\tWebForm_DoCallback('',arg,EntityEditorHandleCheckNameResult,ctx,EntityEditorHandleCheckNameError,true);\t\t        var pp = document.getElementById(\"divPetest-grid-id\");        var ppi = document.getElementById(\"peoplecheckimgtest-grid-id\");        pp.style.display = \"none\";        ppi.src = \"_layouts/images/TPMAX1.GIF\";                    \t\tvar strVal = \"\";\t\tvar strAllUserChecks = \"\";\t\tvar strVals = this.cell._users.split('\\n');\t\tvar strAllUsers = this.cell._Allusers === undefined ? [] : this.cell._Allusers.split('\\n');\t\tvar strUserNames = '\\t';\t\t\t\tfor(var i = 0;i<strVals.length;i=i+2)\t\t{\t\t\tstrUserNames += strVals[i].toLowerCase() + '\\t';\t\t\tstrVal += \"; \" + strVals[i];\t\t}\t\tif(strVal.length > 1)\t\t\tstrVal = strVal.substring(1);\t\t\t\t\tfor(var i = 0;i<strAllUsers.length;i++)\t\t{\t\t\tvar isChecked = \"\";\t\t\tvar userInfo = strAllUsers[i].split(';#');\t\t\t\t\t\tif(strUserNames.indexOf('\\t' + userInfo[0].toLowerCase() + '\\t') > -1)\t\t\t\tisChecked = \"checked\";\t\t\t\t\t\t\tstrAllUserChecks += \"<br><input type=\\\"checkbox\\\" name=\\\"chkUserstest-grid-id\\\" value=\\\"\" + userInfo[0] + \"\\\" \" + isChecked + \">\" + userInfo[1];\t\t}\t\tif(strAllUserChecks.length > 1)\t\t\tstrAllUserChecks = strAllUserChecks.substring(4);\t\t\t\t\tdocument.getElementById(\"peoplechecktest-grid-id\").innerHTML = strAllUserChecks;\t\t\tvar arPos = this.grid.getPosition(this.cell);\t\tif(arPos[0] + 200 > document.body.clientWidth)\t\t\tthis.grid._grid_pe.style.left=document.body.clientWidth - 210;\t\telse\t\t\tthis.grid._grid_pe.style.left=arPos[0];\t\t\t\tif((arPos[1] + 100) > (document.body.clientHeight + document.body.scrollTop))\t\t\tthis.grid._grid_pe.style.top=document.body.clientHeight + document.body.scrollTop - 105;\t\telse\t\t\tthis.grid._grid_pe.style.top=arPos[1];\t\tthis.grid._grid_pe.style.display=\"\";\t\tthis.grid._grid_pe.style.position = \"absolute\";\t\tthis.grid._grid_pe.style.zIndex  = 99;    }    this.detach=function(){\t\tthis.grid._grid_pe.style.display=\"none\";\t\t\t\tvar strUsers = \"\";\t\tvar divChecks = document.getElementById(\"peoplechecktest-grid-id\");\t\tvar divChildChecks = divChecks.firstChild;\t\twhile(divChildChecks != null)\t\t{\t\t\tif(divChildChecks.nodeName == \"INPUT\")\t\t\t{\t\t\t\tif(divChildChecks.checked)\t\t\t\t{\t\t\t\t\tstrUsers += '\\n' + divChildChecks.value;\t\t\t\t\tstrUsers += '\\n' + divChildChecks.nextSibling.nodeValue;\t\t\t\t}\t\t\t}\t\t\tdivChildChecks = divChildChecks.nextSibling;\t\t}\t\tfor(var i = 0;i<document.getElementById(\"_upLevelDiv\").childNodes.length;i=i+2)\t\t{\t\t\tif(document.getElementById(\"_upLevelDiv\").childNodes[i].firstChild != null)\t\t\t{\t\t\t\tstrUsers += '\\n' + document.getElementById(\"_upLevelDiv\").childNodes[i].title;\t\t\t\tstrUsers += '\\n' + document.getElementById(\"_upLevelDiv\").childNodes[i].firstChild.nextSibling.innerText;\t\t\t}\t\t}\t\tif(strUsers.length > 1)\t\t\tstrUsers = strUsers.substring(1);\t\t\t\tvar oldValue = this.getValue();\t\t\t\t\tif(this.cell._Allusers !== undefined)\t\t\tthis.setValue(strUsers + '\\t' + this.cell._Allusers);         return oldValue != this.getValue();    }}eXcell_usereditorm.prototype = new eXcell;//================================User Single=================function eXcell_usereditor(cell){                                    //excell name is defined here    if (cell){        this.cell = cell;        this.grid = this.cell.parentNode.grid;        if(!this.grid._grid_pes)        {\t\t\tvar z=document.getElementById(\"peoplesingle\" + cell.parentNode.grid.entBox.id);\t\t\tz.onclick=function(e){ (e||event).cancelBubble=true; }\t\t\t\t\t\tif (_isIE) { \t\t\t\tz.style.position=\"absolute\"\t\t\t\tz.style.top=\"0px\"\t\t\t}\t\t\tdocument.body.insertBefore(z,document.body.firstChild);\t\t\t \t\t\tthis.grid._grid_pes = z;\t\t}    }    this.setValue=function(val){\t\tvar strVal = \"&nbsp;\";\t\tvar strVals = val.split('\\t')[0].split('\\n');\t\t\t\tfor(var i = 1;i<strVals.length;i=i+2)\t\t{\t\t\tstrVal += \"; \" + strVals[i];\t\t}\t\tif(strVal != \"&nbsp;\")\t\t\tstrVal = strVal.substring(7);\t\t\t        this.setCValue(strVal);                   this.cell._displayValue = strVal;        this.cell._users = val.split('\\t')[0];                                           this.cell._Allusers = val === undefined ? [] : val.split('\\t')[1];                                       }    this.getValue=function(){\t\t       return this.cell._users; // get value    }    this.edit=function(){\t\tthis.val=this.getValue();        var pp = document.getElementById(\"divPestest-grid-id\");        var ppi = document.getElementById(\"peoplechecksingleimgtest-grid-id\");        pp.style.display = \"none\";        ppi.src = \"_layouts/images/TPMAX1.GIF\";\t\tvar strVal = \"\";\t\tvar strAllUserChecks = \"\";\t\tvar strVals = this.cell._users.split('\\n');\t\tvar strAllUsers = this.cell._Allusers === undefined ? [] : this.cell._Allusers.split('\\n');\t\tvar strUserNames = '\\t';\t\tfor(var i = 0;i<strVals.length;i=i+2)\t\t{\t\t\tstrUserNames += strVals[i].toLowerCase() + '\\t';\t\t\tstrVal += \"; \" + strVals[i];\t\t}\t\tif(strVal.length > 1)\t\t\tstrVal = strVal.substring(1);\t\tvar slct = document.getElementById(\"peoplecheckselecttest-grid-id\");\t\tslct.options.length=0;\t\tvar oSelected = -1;\t\tvar oCounter = 0;\t\tfor(var i = 0;i<strAllUsers.length;i++)\t\t{\t\t\tvar isChecked = false;\t\t\tvar userInfo = strAllUsers[i].split(';#');\t\t\t\t\t\tif(strUserNames.indexOf('\\t' + userInfo[0].toLowerCase() + '\\t') > -1)\t\t\t\toSelected = oCounter;\t\t\t\t\t\t\tvar elOptNew = document.createElement('option');            elOptNew.text = userInfo[1];            elOptNew.value = userInfo[0];            try            {                slct.add(elOptNew, null);            }            catch(ex)            {                slct.add(elOptNew);            }\t\t\t\t\t\t\t\t\t\t//slct.add(new Option(userInfo[1], userInfo[0], false, isChecked));\t\t\toCounter++;\t\t}\t\t\t\tslct.selectedIndex = oSelected;\t\t\t\tdocument.getElementById(\"_downlevelTextBox\").value = \"\";\t\tdocument.getElementById(\"_upLevelDiv\").innerHTML = \"\";\t\t/*\t\tif(document.getElementById(\"_upLevelDiv\").firstChild == null)\t\t{\t\t\tvar oTN=document.createTextNode(\"\");\t\t\tdocument.getElementById(\"_upLevelDiv\").appendChild(oTN);\t\t}\t\tdocument.getElementById(\"_upLevelDiv\").firstChild.nodeValue = strVal;\t\t*/\t\tcopyUplevelToHidden('');\t\tupdateControlValue('');\t\tvar arg=getUplevel('');\t\tvar ctx='';\t\t\t\tEntityEditorSetWaitCursor(ctx);\t\tWebForm_DoCallback('',arg,EntityEditorHandleCheckNameResult,ctx,EntityEditorHandleCheckNameError,true);\t\t\t\t\t\tvar arPos = this.grid.getPosition(this.cell);\t\tif(arPos[0] + 200 > document.body.clientWidth)\t\t\tthis.grid._grid_pes.style.left=document.body.clientWidth - 210;\t\telse\t\t\tthis.grid._grid_pes.style.left=arPos[0];\t\t\t\tif((arPos[1] + 100) > (document.body.clientHeight + document.body.scrollTop))\t\t\tthis.grid._grid_pes.style.top=document.body.clientHeight + document.body.scrollTop - 105;\t\telse\t\t\tthis.grid._grid_pes.style.top=arPos[1];\t\tthis.grid._grid_pes.style.display=\"\";\t\tthis.grid._grid_pes.style.position = \"absolute\";\t\tthis.grid._grid_pes.style.zIndex  = 99;    }    this.detach=function(){\t\tthis.grid._grid_pes.style.display=\"none\";\t\t\t\tvar strUsers = \"\";\t\tfor(var i = 0;i<document.getElementById(\"_upLevelDiv\").childNodes.length;i=i+2)\t\t{\t\t\tif(document.getElementById(\"_upLevelDiv\").childNodes[i].firstChild != null)\t\t\t{\t\t\t\tstrUsers += '\\n' + document.getElementById(\"_upLevelDiv\").childNodes[i].title;\t\t\t\tstrUsers += '\\n' + document.getElementById(\"_upLevelDiv\").childNodes[i].firstChild.nextSibling.innerText;\t\t\t}\t\t}\t\tif(strUsers == \"\")\t\t{\t\t\tvar chkVal = document.getElementById(\"peoplecheckselecttest-grid-id\");\t\t\tif(chkVal.selectedIndex > -1)\t\t\t{\t\t\t\tstrUsers += '\\n' + chkVal.options[chkVal.selectedIndex].value;\t\t\t\tstrUsers += '\\n' + chkVal.options[chkVal.selectedIndex].text;\t\t\t}\t\t}\t\t\t\tif(strUsers.length > 1)\t\t\tstrUsers = strUsers.substring(1);\t\t\t\tvar oldValue = this.getValue();\t\t\t\t\tif(this.cell._Allusers !== undefined)\t\t\tthis.setValue(strUsers + '\\t' + this.cell._Allusers);         return oldValue != this.getValue();    }}eXcell_usereditor.prototype = new eXcell;//=========================choice========================function eXcell_choice(cell){                                    //excell name is defined here    if (cell){\t\t\t\t\t\t\t\t\t\t\t\t\t//default pattern, just copy it        this.cell = cell;        this.grid = this.cell.parentNode.grid;    }    this.setValue=function(val){\t\tvar strVal = \"\";\t\tvar dispVal = \"&nbsp;\";\t\tif(val == \";#\")\t\t\tval = \"\";\t\t\t\t\tval = val.replace(/&amp;/g,\"&\");\t\t\t\tif(val.split('\\t')[0] != \"\")\t\t{\t\t\tstrVal = val.split('\\t')[0];\t\t\tdispVal = strVal.split(';#')[1].replace(/&/g,\"&amp;\");\t\t}        this.setCValue(dispVal);        this.cell._value = strVal;        if(val.split('\\t').length > 1)\t\t\tthis.cell._allvalues = val.split('\\t')[1];    }    this.getValue=function(){\t\treturn this.cell._value;    }    this.edit=function(){\t\tthis.val=this.getValue();\t\tvar arPos = this.grid.getPosition(this.cell) //,this.grid.objBox)\t\tvar allvals = this.cell._allvalues;\t\tthis.obj=document.createElement(\"TEXTAREA\");\t\tthis.obj.className=\"dhx_combo_edit\";\t\tthis.obj.style.height=(this.cell.offsetHeight-4)+\"px\";\t\tthis.obj.wrap=\"soft\";\t\tthis.obj.style.textAlign=this.cell.align;\t\tthis.obj.onclick=function(e){\t\t\t(e||event).cancelBubble=true\t\t}\t\tthis.obj.value=this.text\t\tthis.obj.onselectstart=function(e){\t\t\tif (!e)\t\t\t\te=event;\t\t\te.cancelBubble=true;\t\t\treturn true;\t\t};\t\tvar editor_obj = this;\t\tthis.obj.onkeyup=function(e){\t\t\tvar val = this.readonly ? String.fromCharCode((e||event).keyCode) : this.value;\t\t\tvar c = editor_obj.list.options;\t\t\tfor (var i = 0; i < c.length; i++)\t\t\t\tif (c[i].text.indexOf(val) == 0)\t\t\t\t\treturn c[i].selected=true;\t\t}\t\tthis.list=document.createElement(\"SELECT\");\t\tthis.list.className='dhx_combo_select';\t\tthis.list.style.width=this.cell.offsetWidth+\"px\";\t\tthis.list.style.left=arPos[0]+\"px\";                       //arPos[0]\t\tthis.list.style.top=arPos[1]+this.cell.offsetHeight+\"px\"; //arPos[1]+this.cell.offsetHeight;\t\tthis.list.onclick=function(e){\t\t\tvar ev = e||window.event;\t\t\tev.cancelBubble=true;\t\t\tvar cell = ev.target||ev.srcElement\t\t\t//tbl.editor_obj.val=cell.combo_val;\t\t\tif (cell.tagName == \"OPTION\")\t\t\t\tcell=cell.parentNode;\t\t\teditor_obj.setValue(cell.value + \";#\" + cell.text);\t\t\teditor_obj.editable=false;\t\t\teditor_obj.grid.editStop();\t\t}\t\tvar comboKeys = this.cell._allvalues.split('\\n');\t\tvar fl = false;\t\tvar selOptId = 0;\t\tfor (var i = 0; i < comboKeys.length; i++){\t\t\tvar val = comboKeys[i].split(';#');\t\t\t\t\t\tvar elOptNew = document.createElement('option');            elOptNew.text = val[1];            elOptNew.value = val[0];            \t\t\tthis.list.options[this.list.options.length]=elOptNew\t\t\tif (comboKeys[i] == this.val){\t\t\t\tselOptId=this.list.options.length-1;\t\t\t\tfl=true;\t\t\t}\t\t}\t\tif (fl == false){ //if no such value in combo list\t\t\t\t\t\tvar elOptNew = document.createElement('option');            elOptNew.text = this.text;            elOptNew.value = this.val;            \t\t\t//this.list.options[this.list.options.length]=new Option(this.text, this.val === null ? \"\" : this.val);\t\t\t//this.list.options[this.list.options.length]=elOptNew;\t\t\t//selOptId=this.list.options.length-1;\t\t}\t\tdocument.body.appendChild(this.list) //nb:this.grid.objBox.appendChild(this.listBox);\t\tthis.list.size=\"6\";\t\tthis.cstate=1;\t\tif (this.editable){\t\t\tthis.cell.innerHTML=\"\";\t\t}\t\telse {\t\t\tthis.obj.style.width=\"1px\";\t\t\tthis.obj.style.height=\"1px\";\t\t}\t\tthis.cell.appendChild(this.obj);\t\tthis.list.options[selOptId].selected=true;\t\t\t\t    }    this.detach=function(){\t\t\t\tif (this.val != this.getValue())\t\t{\t\t\tthis.cell.wasChanged=true;\t\t}\t\tvar curVal = this.getValue();\t\tvar newVal = this.list.options[this.list.selectedIndex].value + \";#\" + this.list.options[this.list.selectedIndex].text;\t\tif(newVal == \";#\")\t\t\tnewVal = \"\";\t\t\t\tthis.setValue(newVal);\t\t\t\t\t\t/*if (this.list.parentNode != null)\t\t{\t\t\t\tif (this.obj.value._dhx_trim() != this.text){\t\t\t\t\tif (this.list.selectedIndex&&this.list.options[this.list.selectedIndex].text == this.obj.value)\t\t\t\t\t\tthis.setValue(this.list.value + '\\t' + this.cell._allvalues)\t\t\t\t\telse\t\t\t\t\t\tthis.setValue(this.obj.value + '\\t' + this.cell._allvalues)\t\t\t\t} else {\t\t\t\t\tthis.setValue(this.val + '\\t' + this.cell._allvalues)\t\t\t\t}\t\t}*/\t\tif (this.list.parentNode)\t\t\tthis.list.parentNode.removeChild(this.list);\t\tif (this.obj.parentNode)\t\t\tthis.obj.parentNode.removeChild(this.obj);\t\treturn newVal != curVal;\t\t    }}eXcell_choice.prototype = new eXcell;//=========================multichoice========================function eXcell_mchoice(cell){                                    //excell name is defined here    if (cell){                                                     //default pattern, just copy it        this.cell = cell;        this.grid = this.cell.parentNode.grid;        if(!this.grid._grid_mc)        {\t\t\tvar z=document.getElementById(\"multichoice\" + cell.parentNode.grid.entBox.id);\t\t\tz.onclick=function(e){ (e||event).cancelBubble=true; }\t\t\t\t\t\tif (_isIE) { \t\t\t\tz.style.position=\"absolute\"\t\t\t\tz.style.top=\"0px\"\t\t\t}\t\t\tdocument.body.insertBefore(z,document.body.firstChild); \t\t\tthis.grid._grid_mc = z;\t\t}    }    this.setValue=function(val){\t\tvar strVal = \"\";\t\t\t\tif(val.split('\\t')[0] != \"\")\t\t{\t\t\tvar strVals = val.split('\\t')[0].split('\\n');\t\t\tfor(var i = 0;i<strVals.length;i++)\t\t\t{\t\t\t\tvar valInfo = strVals[i].split(';#');\t\t\t\tstrVal += \", \" + valInfo[1];\t\t\t}\t\t\tif(strVal != \"\")\t\t\t\tstrVal = strVal.substring(2);\t\t}\t\tif(strVal != \"\")\t\t\tthis.setCValue(strVal.replace(\"&\",\"&amp;\"));\t\telse\t\t\tthis.setCValue(\"&nbsp;\");\t\t        this.cell._displayValue = strVal;        this.cell._values = val.split('\\t')[0];        this.cell._allvalues = val.split('\\t')[1];    }    this.getValue=function(){\t\treturn this.cell._values;    }    this.edit=function(){\t\tthis.val=this.getValue();\t\tvar strAllValueChecks = \"\";\t\tvar strVals = this.cell._values.split('\\n');\t\tvar strAllValues = this.cell._allvalues.split('\\n');\t\tvar strValues = '\\t';\t\t\t\tfor(var i = 0;i<strVals.length;i++)\t\t{\t\t\tvar valInfo = strVals[i].split(';#');\t\t\t\t\tstrValues += valInfo[0].toLowerCase() + '\\t';\t\t}\t\tfor(var i = 0;i<strAllValues.length;i++)\t\t{\t\t\tvar isChecked = \"\";\t\t\tvar valInfo = strAllValues[i].split(';#');\t\t\t\t\t\tif(strValues.indexOf('\\t' + valInfo[0].toLowerCase() + '\\t') > -1)\t\t\t\tisChecked = \"checked\";\t\t\tstrAllValueChecks += \"<br><input type=\\\"checkbox\\\" name=\\\"chkValuestest-grid-id\\\" value=\\\"\" + valInfo[0] + \"\\\" \" + isChecked + \">\" + valInfo[1];\t\t}\t\tif(strAllValueChecks.length > 1)\t\t\tstrAllValueChecks = strAllValueChecks.substring(4);\t\t\t\t\tdocument.getElementById(\"multichoiceinnertest-grid-id\").innerHTML = strAllValueChecks;\t\tvar arPos = this.grid.getPosition(this.cell);\t\tif(arPos[0] + 200 > document.body.clientWidth)\t\t\tthis.grid._grid_mc.style.left=document.body.clientWidth - 210;\t\telse\t\t\tthis.grid._grid_mc.style.left=arPos[0];\t\t\t\tif((arPos[1] + 100) > (document.body.clientHeight + document.body.scrollTop))\t\t\tthis.grid._grid_mc.style.top=document.body.clientHeight + document.body.scrollTop - 105;\t\telse\t\t\tthis.grid._grid_mc.style.top=arPos[1];\t\tthis.grid._grid_mc.style.display=\"\";\t\tthis.grid._grid_mc.style.position = \"absolute\";\t\tthis.grid._grid_mc.style.zIndex  = 99;    }    this.detach=function(){\t\t\t\tthis.grid._grid_mc.style.display=\"none\";\t\t\t\tvar child = document.getElementById(\"multichoiceinnertest-grid-id\").firstChild;\t\tvar val1 = \"\";\t\twhile(child != null)\t\t{\t\t\tif(child.nodeName == \"INPUT\")\t\t\t{\t\t\t\tif(child.checked)\t\t\t\t{\t\t\t\t\tval1 += '\\n' + child.value + \";#\" + child.nextSibling.nodeValue;\t\t\t\t}\t\t\t}\t\t\tchild = child.nextSibling;\t\t}\t\tif(val1.length > 1)\t\t\tval1 = val1.substring(1);\t\t\t\t\t\t\tvar oldValue = this.getValue();\t\t\t\tthis.cell._values = val1;\t\t\t        this.setValue(val1 + '\\t' + this.cell._allvalues);         return oldValue != this.getValue();\t\t    }}eXcell_mchoice.prototype = new eXcell;//=========================Calendar===========================eXcell_dhxCalendarA.prototype.edit = function(){\t                    var top;                    var left;                                        var arPos = this.grid.getPosition(this.cell);\t\t\t\t\tif(arPos[0] + this.cell.offsetWidth + 180 > document.body.clientWidth)\t\t\t\t\t\tleft = arPos[0] - 185;\t\t\t\t\telse\t\t\t\t\t\tleft=arPos[0] + this.cell.offsetWidth;\t\t\t\t\t\t\t\t\t\tif((arPos[1] + 170) > (document.body.clientHeight + document.body.scrollTop))\t\t\t\t\t\ttop=document.body.clientHeight + document.body.scrollTop - 180;\t\t\t\t\telse\t\t\t\t\t\ttop=arPos[1];                                        this.grid._grid_calendarA.setPosition(top,left);                    \t                    this.grid._grid_calendarA.show();\t                    this.grid._grid_calendarA._last_operation_calendar=false;\t\t\t\t\t//var arPos = this.grid.getPosition(this.cell);                    //var pval=this._date2str2(this.cell.val||new Date());                    //window._grid_calendar.render(arPos[0],arPos[1]+this.cell.offsetHeight,this,pval);                    this.cell._cediton=true;                    this.val=this.cell.val;                    //this.val=this.getValue();                    this._val=this.cell.innerHTML;                   // alert(this.cell.val);\t\t\t\t   \tthis.grid._grid_calendarA.setDateFormat((this.grid._dtmask||\"%d/%m/%Y\"));                    this.grid._grid_calendarA.setDate(this.val);                    this.grid._grid_calendarA.draw();                    \t\t\t\t\tthis.cell.atag=((!this.grid.multiLine)&&(_isKHTML||_isMacOS||_isFF))?\"INPUT\":\"TEXTAREA\";\t\t\t\t\t\t\t\t\t\tthis.obj = document.createElement(this.cell.atag);\t\t\t\t\tthis.obj.style.height = (this.cell.offsetHeight-(_isIE?4:2))+\"px\";                    this.obj.className=\"dhx_combo_edit\";\t\t\t\t   \tthis.obj.wrap = \"soft\";\t\t\t\t\tthis.obj.style.textAlign = this.cell.align;\t\t\t\t\tthis.obj.onclick = function(e){(e||event).cancelBubble = true}\t\t\t\t\tthis.obj.onmousedown = function(e){(e||event).cancelBubble = true}\t\t\t\t\tthis.obj.value = this.getValue();\t\t\t\t\tthis.cell.innerHTML = \"\";\t\t\t\t\tthis.cell.appendChild(this.obj);\t\t\t\t  \tif (_isFF) {\t\t\t\t\t\tthis.obj.style.overflow=\"visible\";\t\t\t\t\t\tif ((this.grid.multiLine)&&(this.obj.offsetHeight>=18)&&(this.obj.offsetHeight<40)){\t\t\t\t\t\t\tthis.obj.style.height=\"36px\";\t\t\t\t\t\t\tthis.obj.style.overflow=\"scroll\";\t\t\t\t\t\t}\t\t\t\t\t}                    this.obj.onselectstart=function(e){  if (!e) e=event; e.cancelBubble=true; return true;  };\t\t\t\t\tthis.obj.focus()  \t\t\t\t\tthis.obj.focus()\t\t\t\t                    \t\t\t\t}//============================================================function getSingleItemtest-grid-id(siteid,webid,listid,itemid,rowid){\tvar val = SP.UI.Notify.addNotification(\"Updating Saved Row...\", false,  \"\", null);\tdhtmlxAjax.post(singleItemUrltest-grid-id, \"siteid=\" + siteid + \"&webid=\" + webid + \"&listid=\" + listid + \"&itemid=\" + itemid + \"&rowid=\" + rowid,getSingleItemResponsetest-grid-id);}function getSingleItemResponsetest-grid-id(loader){\tif(loader.xmlDoc.responseText!=null)\t{\t\tvar xmlDoc = loader.xmlDoc.responseXML;\t\tfor(var i = 0;i<xmlDoc.childNodes.length;i++)\t\t{\t\t\tvar rowXml = xmlDoc.childNodes[i];\t\t\tsetRowValuestest-grid-id(rowXml);\t\t}\t}\telse\t\talert(\"Response contains no XML\");}function setRowValuestest-grid-id(rowsXml){\tfor(var i = 0;i<rowsXml.childNodes.length;i++)\t{\t\tsetRowValuetest-grid-id(rowsXml.childNodes[i])\t}}function setRowValuetest-grid-id(rowXml){\tvar rowId = rowXml.getAttribute(\"id\")\t\tvar cellCounter = 0;\tfor(var i = 0;i<rowXml.childNodes.length;i++)\t{\t\tif(rowXml.childNodes[i].nodeName == \"userdata\")\t\t{\t\t\tif(rowXml.childNodes[i].firstChild != null)\t\t\t\tmygridtest-grid-id.setUserData(rowId,rowXml.childNodes[i].getAttribute(\"name\"),rowXml.childNodes[i].firstChild.nodeValue);\t\t}\t\telse if(rowXml.childNodes[i].nodeName == \"cell\")\t\t{\t\t\tif(!inEditModetest-grid-id)\t\t\t{\t\t\t\tif(mygridtest-grid-id.getColType(cellCounter) != \"tree\")\t\t\t\t\tmygridtest-grid-id.setCellExcellType(rowId, cellCounter, \"ro\");\t\t\t\t\t\t\t\t\tmygridtest-grid-id.lockRow(rowId, true);\t\t\t}\t\t\t\t\t\tvar cellval = \"\";\t\t\tvar celltype = \"\";\t\t\ttry\t\t\t{\t\t\t\tcelltype = rowXml.childNodes[i].getAttribute(\"type\");\t\t\t}catch(e){}\t\t\t\t\t\t\t\t\tif(rowXml.childNodes[i].childNodes.length > 0)\t\t\t{\t\t\t\tcellval = rowXml.childNodes[i].firstChild.nodeValue;\t\t\t}\t\t\t\t\t\tif(celltype == \"combo\")\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(rowXml.childNodes[i]);\t\t\t\telse\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(cellval);\t\t\t\tcellCounter++;\t\t}\t}\t}function saveGridtest-grid-id(){\tmygridtest-grid-id.editStop();    sm('dlgSavingtest-grid-id',200,100);    if(myDataProcessortest-grid-id.updatedRows.length > 0)    {        myDataProcessortest-grid-id.sendData();    }    else        hm('dlgSavingtest-grid-id');}function onButtonClicktest-grid-id(menuitemId,grid_Id,grid){    var rowIdFull = grid_Id.split(\"_\")[0];    var weburl = context_grid.getUserData(rowIdFull,\"SiteUrl\");    var listId = context_grid.getUserData(rowIdFull,\"listid\");    var editurl = context_grid.getUserData(rowIdFull,\"editurl\");    var viewurl = context_grid.getUserData(rowIdFull,\"viewurl\");    var itemId = context_grid.getUserData(rowIdFull,\"itemid\");    var webId = context_grid.getUserData(rowIdFull,\"webid\");    var siteid = context_grid.getUserData(rowIdFull,\"siteid\");    var rowId = rowIdFull.split('.')[1];        var popup = context_grid.getUserData(rowIdFull,\"popup\");    var w = pageWidth() - 200;\tvar h = pageHeight() - 100;             switch(menuitemId)    {\t\tcase \"createworkspace\":\t\t\turl = weburl + \"/_layouts/epmlive/requestworkspace.aspx?list=\" + listidtest-grid-id + \"&ID=\" + itemId;\t\t\tdocument.location.href=url;\t\t\t\t\t\tbreak;\t\tcase \"workspace\":\t\t\tif(viewurl == null)                url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=workspace&webid=\" + webId ;            else                url = weburl;                \t\t\tdocument.location.href=url;\t\t\tbreak;\t\t\t\tcase \"workplan\":\t\t\tif(viewurl == null)\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=workplan&webid=\" + webId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\telse\t\t\t\turl = weburl + \"/_layouts/epmlive/tasks.aspx?ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t\t\t\t\tdocument.location.href=url;\t\t\tbreak;\t\t\t\t\tcase \"agile\":\t\t\tif(viewurl == null)\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=agile&webid=\" + webId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\telse\t\t\t\turl = weburl + \"/_layouts/epmlive/agile/tasks.aspx?ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t\t\t\t\tdocument.location.href=url;\t\t\tbreak;\t\t\t\tcase \"projectpro\":\t\t\tif(viewurl == null)\t\t\t{\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=getproject&webid=\" + webId + \"&ID=\" + itemId + \"&listID=\" + listId + \"&Source=\" + document.location.href;;\t\t\t\tdocument.location.href=url;\t\t\t}\t\t\telse\t\t\t{\t\t\t\tjavascript:window.open(weburl + '/_layouts/epmlive/getproject.aspx?listID=' + listId + '&ID=' + itemId,'', config='height=100,width=200, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, directories=no, status=no');\t\t\t}\t\t\tbreak;\t\t        case \"edit\":            var url = \"\";            if(popup==\"yes\")            {\t\t\t\t\t\t\t\tvar url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=viewedit2&ListId=\" + listId + \"&ID=\" + itemId + \"&Mode=2&gridid=test-grid-id&siteid=\" + siteid + \"&webid=\" + webId + \"&rowid=\" + rowIdFull;\t\t\t\tsm('editItemtest-grid-id',w,h);\t\t\t\tdocument.getElementById(\"frmEditFrametest-grid-id\").src = url;            }            else            {\t\t\t\tif(editurl == null)\t\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=edit&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t\telse\t\t\t\t\turl = editurl + \"?ListId=\" + listId + \"&ID=\" + itemId + \"&Mode=2&Source=\" + document.location.href;\t\t\t\tdocument.location.href=url;            }            break;        case \"perms\":\t\t\tvar url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=perms&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t            //var url = weburl + \"/_layouts/User.aspx?obj={\" + listId + \"},\" + itemId + \",LISTITEM&List={\" + listId + \"}&Source=\" + document.location.href;            document.location.href=url;            break;        case \"view\":\t\t\tif(popup==\"yes\")            {\t\t\t\tvar url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=viewedit2&ListId=\" + listId + \"&ID=\" + itemId + \"&Mode=1&gridid=test-grid-id&siteid=\" + siteid + \"&webid=\" + webId + \"&rowid=\" + rowIdFull;\t\t\t\tsm('editItemtest-grid-id',w,h);\t\t\t\tdocument.getElementById(\"frmEditFrametest-grid-id\").src=url;            }            else            {\t\t\t\tvar url;\t\t\t\tif(viewurl == null)\t\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=view&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t\telse\t\t\t\t\turl = viewurl + \"?ListId=\" + listId + \"&ID=\" + itemId + \"&Mode=1&Source=\" + document.location.href;\t\t\t\tdocument.location.href=url;            }            break;        case \"delete\":            if(confirm('Are you sure you want to send this item to the Recycle Bin?')){                var url;                if(viewurl == null)                {                    url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=delete&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&NextUsing=\" + document.location.href;                    document.location.href=url;                }                else                {                                            postDelete(weburl + '/_vti_bin/owssvr.dll?CS=65001&Cmd=Delete&List={' + listId + '}&ID=' + itemId + '&NextUsing=' + document.location.href);                                     }            };            break;        case \"alerts\":            var url;            if(viewurl == null)                url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=alerts&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;            else                url = weburl + \"/_layouts/SubNew.aspx?List={\" + listId + \"}&ID=\" + itemId + \"&Source=\" + document.location.href;                            document.location.href=url;            break;        case \"versions\":            var url = weburl + \"/_layouts/Versions.aspx?list={\" + listId + \"}&ID=\" + itemId + \"&Source=\" + document.location.href;            document.location.href=url;            break;        case \"approve\":            var url = weburl + \"/_layouts/approve.aspx?list={\" + listId + \"}&ID=\" + itemId + \"&Source=\" + document.location.href;            document.location.href=url;            break;        case \"workflows\":            var url = weburl + \"/_layouts/Workflow.aspx?list={\" + listId + \"}&ID=\" + itemId + \"&Source=\" + document.location.href;            document.location.href=url;            break;    };}function redoCss(rowindex){\tvar j = rowindex;\tfor (var i = rowindex; i < mygridtest-grid-id.rowsCol.length; i++){\t\t\tif (!mygridtest-grid-id.rowsCol[i])\t\t\t\tcontinue;\t\t\tif (mygridtest-grid-id.rowsCol[i].style.display != \"none\"){\t\t\t\tif (mygridtest-grid-id.rowsCol[i].className.indexOf(\"rowselected\") != -1){\t\t\t\t\tif (j%2 == 1)\t\t\t\t\t\tmygridtest-grid-id.rowsCol[i].className=mygridtest-grid-id._cssUnEven+\" rowselected \"+(mygridtest-grid-id.rowsCol[i]._css||\"\");\t\t\t\t\telse\t\t\t\t\t\tmygridtest-grid-id.rowsCol[i].className=mygridtest-grid-id._cssEven+\" rowselected \"+(mygridtest-grid-id.rowsCol[i]._css||\"\");\t\t\t\t} else {\t\t\t\t\tif (j%2 == 1)\t\t\t\t\t\tmygridtest-grid-id.rowsCol[i].className=mygridtest-grid-id._cssUnEven+(mygridtest-grid-id.rowsCol[i]._css||\"\");\t\t\t\t\telse\t\t\t\t\t\tmygridtest-grid-id.rowsCol[i].className=mygridtest-grid-id._cssEven+(mygridtest-grid-id.rowsCol[i]._css||\"\");\t\t\t\t}\t\t\t\tj++;\t\t\t}\t\t}}function leavePagetest-grid-id(e){\tvar hasupdates = false;\t\tfor(var i = 0;i < myDataProcessortest-grid-id.updatedRows.length;i++)\t{\t\tif(myDataProcessortest-grid-id.updatedRows[i] != null)\t\t{\t\t\thasupdates = true;\t\t}\t}    if(hasupdates )    {        if(!e) e = window.event;\t    //e.cancelBubble is supported by IE - this will kill the bubbling process.\t    //e.cancelBubble = true;\t    e.returnValue = 'You have unsaved changes.'; //This is displayed on the dialog\t    if (e.stopPropagation) {\t\t    e.stopPropagation();\t\t    e.preventDefault();\t    }    }}function URLEncode( plaintext ){\t// The Javascript escape and unescape functions do not correspond\t// with what browsers actually do...\tvar SAFECHARS = \"0123456789\" +\t\t\t\t\t// Numeric\t\t\t\t\t\"ABCDEFGHIJKLMNOPQRSTUVWXYZ\" +\t// Alphabetic\t\t\t\t\t\"abcdefghijklmnopqrstuvwxyz\" +\t\t\t\t\t\"-_.!~*'()\";\t\t\t\t\t// RFC2396 Mark characters\tvar HEX = \"0123456789ABCDEF\";\tvar encoded = \"\";\tfor (var i = 0; i < plaintext.length; i++ ) {\t\tvar ch = plaintext.charAt(i);\t    if (ch == \" \") {\t\t    encoded += \"+\";\t\t\t\t// x-www-urlencoded, rather than %20\t\t} else if (SAFECHARS.indexOf(ch) != -1) {\t\t    encoded += ch;\t\t} else {\t\t    var charCode = ch.charCodeAt(0);\t\t\tif (charCode > 255) {\t\t\t    alert( \"Unicode Character '\"                         + ch                         + \"' cannot be encoded using standard URL encoding.\\n\" +\t\t\t\t          \"(URL encoding only supports 8-bit characters.)\\n\" +\t\t\t\t\t\t  \"A space (+) will be substituted.\" );\t\t\t\tencoded += \"+\";\t\t\t} else {\t\t\t\tencoded += \"%\";\t\t\t\tencoded += HEX.charAt((charCode >> 4) & 0xF);\t\t\t\tencoded += HEX.charAt(charCode & 0xF);\t\t\t}\t\t}\t}\treturn encoded;};function checkMintest-grid-id(rowId,cellIndex,value){    if(minValuestest-grid-id[cellIndex] != \"\")    {        var val = parseFloat(value);        var min = parseFloat(minValuestest-grid-id[cellIndex]);        if(val < min)        {            alert('You must enter a value greater than ' + min);            return false;        }    }    return true;}function checkMaxtest-grid-id(rowId,cellIndex,value){    if(maxValuestest-grid-id[cellIndex] != \"\")    {        var val = parseFloat(value);        var max = parseFloat(maxValuestest-grid-id[cellIndex]);        if(val > max)        {            alert('You must enter a value less than ' + max);                        return false;        }    }    return true;}dhtmlXGridObject.prototype._in_header_master_checkbox2 = function (t, i, c) { \tt.innerHTML = c[0] + \"<input type='checkbox' />\" + c[1]; \tvar self = this; \tt.firstChild.onclick = function (e) \t{ \t\tself._build_m_order(); \t\tvar j = self._m_order ? self._m_order[i] : i;\t\tvar val = this.checked;// ? true : false;\t\tself.forEachRow(function (id) {\t\t\tvar c = this.cells(id, j);\t\t\tif (c.isCheckbox() && !c.cell.firstChild.disabled)\t\t\t{\t\t\t\tc.cell.firstChild.checked = val;\t\t\t\tif(val)\t\t\t\t\tc.cell.firstChild.style.display = \"\";\t\t\t\telse\t\t\t\t\tc.cell.firstChild.style.display = \"none\";\t\t\t}\t\t});\t\t(e || event).cancelBubble = true;\t} };dhtmlXGridObject.prototype.checksubs = function(row){\tvar rowid = row.parentNode.parentNode.idd;\tif(this.hasChildren(rowid) > 0)\t{\t\tvar rowids = this.getAllSubItems(rowid).split(',');\t\tfor(var i = 0;i<rowids.length;i++)\t\t{\t\t\tvar curRow = rowids[i];\t\t\tthis.cells(curRow, 0).cell.firstChild.checked = row.checked;\t\t\tif(row.checked)\t\t\t\tthis.cells(curRow, 0).cell.firstChild.style.display = \"\";\t\t\telse\t\t\t\tthis.cells(curRow, 0).cell.firstChild.style.display = \"none\";\t\t}\t\t\t}};window.onbeforeunload=leavePagetest-grid-id;minValuestest-grid-id = [\"\",\"1\"];maxValuestest-grid-id = [\"\",\"1\"];var singleEditItemUrltest-grid-id;var inEditModetest-grid-id;function fireEvent(element,event){    if (document.createEventObject){        // dispatch for IE        var evt = document.createEventObject();        return element.fireEvent('on'+event,evt)    }    else{        // dispatch for firefox + others        var evt = document.createEvent(\"HTMLEvents\");        evt.initEvent(event, true, true ); // event type,bubbling,cancelable        return !element.dispatchEvent(evt);    }}function editRowtest-grid-id(rowid){\tvar EditCol = getEditColtest-grid-id();        if(EditCol != null)    {    \t\tvar listId = mygridtest-grid-id.getUserData(rowid,\"listid\");\t\tvar itemId = mygridtest-grid-id.getUserData(rowid,\"itemid\");\t\tvar webId = mygridtest-grid-id.getUserData(rowid,\"webid\");\t\tvar siteId = mygridtest-grid-id.getUserData(rowid,\"siteid\");    \t\tmygridtest-grid-id.cells(rowid, EditCol).setValue(\"<img src='/_layouts/epmlive/images/loader1.gif'>\");\t\tdhtmlxAjax.post(singleEditItemUrltest-grid-id, \"siteid=\" + siteId + \"&webid=\" + webId + \"&listid=\" + listId + \"&itemid=\" + itemId + \"&rowid=\" + rowid,editRowResponsetest-grid-id);    }}function getEditColtest-grid-id(){\tvar EditCol;\tfor(var i = 0;i<mygridtest-grid-id.getColumnsNum();i++)    {        if(mygridtest-grid-id.getColumnId(i) == \"<![CDATA[Edit]]>\")        {            EditCol = i;\t\t\tbreak;        }    }    return EditCol;}function editRowResponsetest-grid-id(loader){\tif(loader.xmlDoc.responseText!=null)\t{\t\t\tvar xmlDoc = loader.xmlDoc.responseXML;\t\tfor(var i = 0;i<xmlDoc.childNodes.length;i++)\t\t{\t\t\tvar rowXml = xmlDoc.childNodes[i];\t\t\tsetEditRowstest-grid-id(rowXml);\t\t\t}\t}\telse\t\talert(\"Response contains no XML\");}function setEditRowstest-grid-id(rowsXml){\tfor(var i = 0;i<rowsXml.childNodes.length;i++)\t{\t\tsetEditRowtest-grid-id(rowsXml.childNodes[i])\t}}function setEditRowtest-grid-id(rowXml){\tvar rowId = rowXml.getAttribute(\"id\")\t\tvar cellCounter = 0;\tmygridtest-grid-id.lockRow(rowId, false);\tfor(var i = 0;i<rowXml.childNodes.length;i++)\t{\t\tif(rowXml.childNodes[i].nodeName == \"userdata\")\t\t{\t\t\t//mygridtest-grid-id.setUserData(rowId,rowXml.childNodes[i].getAttribute(\"name\"),rowXml.childNodes[i].firstChild.nodeValue);\t\t}\t\telse if(rowXml.childNodes[i].nodeName == \"cell\")\t\t{\t\t\tvar cellval = \"\";\t\t\tvar celltype = \"\";\t\t\ttry\t\t\t{\t\t\t\tcelltype = rowXml.childNodes[i].getAttribute(\"type\");\t\t\t}catch(e){}\t\t\tif(rowXml.childNodes[i].childNodes.length > 0)\t\t\t{\t\t\t\tcellval = rowXml.childNodes[i].firstChild.nodeValue;\t\t\t}\t\t\tif(celltype == \"combo\")\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(rowXml.childNodes[i]);\t\t\t\telse\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(cellval);\t\t\t\t\t\t\tif(celltype != null)\t\t\t{\t\t\t\tmygridtest-grid-id.setCellExcellType(rowId, i, celltype);\t\t\t}\t\t\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(cellval);\t\t\t\tcellCounter++;\t\t}\t}\tvar EditCol = getEditColtest-grid-id();    \tif(EditCol != null)\t{\t\tmygridtest-grid-id.cells(rowId, EditCol).setValue(\"<a onclick=\\\"javascript:saveEdittest-grid-id('\" + rowId + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/saveitem.gif\\\" border=\\\"0\\\" alt=\\\"Save\\\"></a> <a onclick=\\\"javascript:cancelEditRowtest-grid-id('\" + rowId + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/close.gif\\\" border=\\\"0\\\" alt=\\\"Cancel\\\"></a>\");\t}}function saveEdit2test-grid-id(rowid){\tmygridtest-grid-id.editStop();\t\trow = mygridtest-grid-id.getRowById(rowid);\t\tvar cols = row.childNodes.length;\tvar changed = false;\tfor (var j = 0; j < cols; j++)\t\tif (row.childNodes[j].wasChanged){\t\t\tchanged = true;\t\t\tbreak;\t\t}\t\tvar EditCol = getEditColtest-grid-id();\t    if(EditCol != null)\t\tmygridtest-grid-id.cells(rowid, EditCol).setValue(\"<img src='/_layouts/epmlive/images/loader1.gif'>\");\t\t\t\tif(changed)\t\tmyDataProcessortest-grid-id.sendData(rowid);\telse\t\tcancelEditRowtest-grid-id(rowid);}function saveEdittest-grid-id(rowid){\tsetTimeout(\"saveEdit2test-grid-id('\" + rowid + \"')\", 100);}function cancelEditRowtest-grid-id(rowid){\tvar EditCol = getEditColtest-grid-id();\t    mygridtest-grid-id.lockRow(rowid, true);    myDataProcessortest-grid-id.setUpdated(rowid, false, null);        if(EditCol != null)    {\t\tvar listid = mygridtest-grid-id.getUserData(rowid,\"listid\");\t\tvar itemid = mygridtest-grid-id.getUserData(rowid,\"itemid\");\t\tvar webid = mygridtest-grid-id.getUserData(rowid,\"webid\");\t\tvar siteid = mygridtest-grid-id.getUserData(rowid,\"siteid\");\t\tmygridtest-grid-id.cells(rowid, EditCol).setValue(\"<img src='/_layouts/epmlive/images/loader1.gif'>\");\t\tdhtmlxAjax.post(singleItemUrltest-grid-id, \"edit=false&siteid=\" + siteid + \"&webid=\" + webid + \"&listid=\" + listid + \"&itemid=\" + itemid + \"&rowid=\" + rowid,cancelEditRowResponsetest-grid-id);\t}\t}function cancelEditRowResponsetest-grid-id(loader){\tif(loader.xmlDoc.responseText!=null)\t{\t\tvar xmlDoc = loader.xmlDoc.responseXML;\t\t\t\tfor(var i = 0;i<xmlDoc.childNodes.length;i++)\t\t{\t\t\tvar rowXml = xmlDoc.childNodes[i];\t\t\tsetCRowValuestest-grid-id(rowXml);\t\t}\t}\telse\t\talert(\"Response contains no XML\");}function setCRowValuestest-grid-id(rowsXml){\tfor(var i = 0;i<rowsXml.childNodes.length;i++)\t{\t\tsetCRowValuetest-grid-id(rowsXml.childNodes[i])\t}}function setCRowValuetest-grid-id(rowXml){\tvar rowId = rowXml.getAttribute(\"id\");\tvar cellCounter = 0;\t\tfor(var i = 0;i<rowXml.childNodes.length;i++)\t{\t\tif(rowXml.childNodes[i].nodeName == \"userdata\")\t\t{\t\t\t//mygridtest-grid-id.setUserData(rowId,rowXml.childNodes[i].getAttribute(\"name\"),rowXml.childNodes[i].text);\t\t}\t\telse if(rowXml.childNodes[i].nodeName == \"cell\")\t\t{\t\t\tvar cellval = \"\";\t\t\t\t\t\tif(rowXml.childNodes[i].childNodes.length > 0)\t\t\t{\t\t\t\tcellval = rowXml.childNodes[i].firstChild.nodeValue;\t\t\t}\t\t\tif(mygridtest-grid-id.getColType(cellCounter) != \"tree\")\t\t\t\tmygridtest-grid-id.setCellExcellType(rowId, cellCounter, \"ro\");\t\t\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(cellval);\t\t\t\t\t\t\tcellCounter++;\t\t}\t}\t\tvar EditCol;\tfor(var i = 0;i<mygridtest-grid-id.getColumnsNum();i++)\t{\t\tif(mygridtest-grid-id.getColumnId(i) == \"<![CDATA[Edit]]>\")\t\t{\t\t\tEditCol = i;\t\t\tbreak;\t\t}\t}    \tif(EditCol != null)\t{\t\tmygridtest-grid-id.cells(rowId, i).setValue(\"<a onclick=\\\"javascript:editRowtest-grid-id('\" + rowId + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/edit.gif\\\" border=\\\"0\\\"></a>\");\t}}function ChangePagetest-grid-id(pg){curPagetest-grid-id = pg;loadXtest-grid-id(sftest-grid-id, svtest-grid-id, sttest-grid-id);}function NextPagetest-grid-id(){if(lastItemtest-grid-id != 0){curPagetest-grid-id = lastItemtest-grid-id;loadXtest-grid-id(sftest-grid-id, svtest-grid-id, sttest-grid-id);}}function PreviousPagetest-grid-id(){if(fItemHidetest-grid-id != firstItemtest-grid-id){curPagetest-grid-id = firstItemtest-grid-id;loadXtest-grid-id(sftest-grid-id, svtest-grid-id, sttest-grid-id);}}function loadXtest-grid-id(searchfield, searchvalue, searchtype){var ribbontestintervall = null; mygridwidthtest-grid-id = document.getElementById('WebPartdummy').offsetWidth - 25;if(searchfield){searchvalue = escape(searchvalue);mygridtest-grid-id.post(\"http://fake.url/_layouts/epmlive/getgriditems.aspx\",\"data=&edit=false&insertrow=False&width=\" + mygridwidthtest-grid-id + \"&searchfield=\" + searchfield + \"&searchvalue=\" + searchvalue + \"&searchtype=\" + searchtype + \"&page=\" + curPagetest-grid-id + \"&source=http%3a%2f%2ffake.url%2f\");}else{mygridtest-grid-id.post(\"http://fake.url/_layouts/epmlive/getgriditems.aspx\",\"data=&edit=false&insertrow=False&width=\" + mygridwidthtest-grid-id + \"&page=\" + curPagetest-grid-id + \"&source=http%3a%2f%2ffake.url%2f\");}}function showrib(){setTimeout(\"clickTab()\", 1);}function clickTab(){try{var wp = document.getElementById('MSOZoneCell_WebPartdummy');WpClick({target: wp});}catch(e){}}function clickbrowse(){try{var wp2 = document.getElementById('Ribbon.Read-title').firstChild;fireEvent(wp2, 'click');}catch(e){}}setTimeout(\"clickTab()\", 1000);_spBodyOnLoadFunctionNames.push(\"loadXtest-grid-id('test-search-field','test-search-string','1')\");</script><div id=\"dlgSavingtest-grid-id\" class=\"dialog\">    <table width=\"100%\">        <tr>            <td align=\"center\" class=\"ms-sectionheader\">                <img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/><br />                <H3 class=\"ms-standardheader\">Saving Items...</h3>            </td>        </tr>    </table></div> <div id=\"dlgRefreshtest-grid-id\" class=\"dialog\">    <table width=\"100%\">        <tr>            <td align=\"center\" class=\"ms-sectionheader\">                <img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/><br />                <H3 class=\"ms-standardheader\">Refreshing Data...</h3>            </td>        </tr>    </table></div> <div id=\"dlgErrortest-grid-id\" class=\"dialog\">    <table width=\"100%\" height=\"100%\" cellpadding=\"0\" cellspacing=\"3\">\t\t<tr>\t\t\t<td class=\"ms-sectionheader\"><H3 class=\"ms-standardheader\">Error: </h3></td>\t\t</tr>        <tr height=\"100%\">            <td align=\"left\"valign=\"top\">                <div id=\"dlgErrorTexttest-grid-id\" style=\"overflow: auto;height=90%;width=100%\" class=\"ms-descriptiontext\"></div><br>            </td>        </tr>        <tr>\t\t\t<td align=\"right\">\t\t\t\t<input type=\"button\" class=\"ms-input\" value=\"Close\" onClick=\"hm('dlgErrortest-grid-id');\">\t\t\t</td>\t\t</tr>    </table></div><div id=\"editItemtest-grid-id\" class=\"dialog\">    <table width=\"100%\" height=\"100%\" id=\"tblEditItem\" cellpadding=\"0\" cellspacing=\"0\">        <tr height=\"100%\">            <td align=\"center\" bgcolor=\"FFFFFF\">                <div id=\"editItemLoadtest-grid-id\">                    <img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/>                </div>                <iframe id=\"frmEditFrametest-grid-id\" width=\"100%\" height=\"100%\" frameborder=\"0\" src=\"http://fake.url/_layouts/epmlive/blank.gif\">                                    </iframe>            </td>        </tr>    </table></div><div id=\"dlgPosting\" class=\"dialog\">    <table width=\"100%\">        <tr>            <td align=\"center\" class=\"ms-sectionheader\">                <img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/><br />                <H3 class=\"ms-standardheader\">Posting Data...</h3>            </td>        </tr>    </table></div> <script>var bPageSetuptest-grid-id;var firstItemtest-grid-id;var lastItemtest-grid-id;var fItemHidetest-grid-id;function setupPagetest-grid-id(records, UseReporting, PageSize){\tvar pages = Math.ceil(records / PageSize);\tvar prev = document.getElementById(\"PagePrevioustest-grid-id\");\tvar next = document.getElementById(\"PageNexttest-grid-id\");\tvar pagediv = document.getElementById(\"pagedivtest-grid-id\");\tif(UseReporting)\t{\t\tif(pages > 1)\t\t{\t\t\tif(!bPageSetuptest-grid-id)\t\t\t{\t\t\t\tbPageSetuptest-grid-id = true;\t\t\t\t$(\"#pagedivtest-grid-id\").paginate({\t\t\t\t\tcount \t\t: pages,\t\t\t\t\tstart \t\t: 1,\t\t\t\t\tdisplay     : 12,\t\t\t\t\tborder\t\t\t\t\t: true,\t\t\t\t\tborder_color\t\t\t: '#CCCCCC',\t\t\t\t\ttext_color  \t\t\t: '#666666',\t\t\t\t\tbackground_color    \t: '#DDDDDD',\t\t\t\t\t\tborder_hover_color\t\t: '#878787',\t\t\t\t\ttext_hover_color  \t\t: '#ffffff',\t\t\t\t\tbackground_hover_color\t: '#9B9B9B', \t\t\t\t\trotate      : false,\t\t\t\t\timages\t\t: false,\t\t\t\t\tmouse\t\t: 'press',\t\t\t\t\tonChange\t: ChangePagetest-grid-id\t\t\t\t});\t\t\t}\t\t}\t\telse\t\t{\t\t\tpagediv.style.display = \"none\";\t\t}\t}\telse\t{\t\tpagediv.style.display = \"inline-block\";\t\tvar rec = records.split('|');\t\tfirstItemtest-grid-id = parseInt(rec[2]) * -1;\t\tlastItemtest-grid-id = rec[1];\t\tif(rec[0] == \"0\" || fItemHidetest-grid-id == firstItemtest-grid-id)\t\t{\t\t\tprev.style.background = \"#EFEFEF\";\t\t\tfItemHidetest-grid-id = firstItemtest-grid-id;\t\t}\t\telse\t\t{\t\t\tprev.style.background = \"#DDDDDD\";\t\t}\t\tif(rec[3] == \"true\")\t\t\tnext.style.background = \"#DDDDDD\";\t\telse\t\t{\t\t\tprev.style.background = \"#EFEFEF\";\t\t\tlastItemtest-grid-id = 0;\t\t}\t\tif(rec[3] != \"true\" && rec[0] == \"0\")\t\t{\t\t\tpagediv.style.display = \"none\";\t\t}\t}}</script><script>initmb();</script>"));
        }

        [TestMethod]
        public void GridListView_renderGrid_GivenArguments_BlockSearch_ConfirmOutput()
        {
            // Arrange
            SetupShims();
            _testablePrivate.SetFieldOrProperty("bLockSearch", true);
            ShimHttpRequest.AllInstances.QueryStringGet = (_) => new NameValueCollection()
            {
                { DummyString, DummyString }
            };

            // Act
            _testablePrivate.Invoke("renderGrid",
                new object[] { writer, web });

            // Assert
            _testablePrivate.ShouldSatisfyAllConditions(
                () => writeCount.ShouldBe(334),
                () => writerContent.ToString().Length.ShouldBe(74999),
                () => writerContent.ToString().ShouldBe("<style>.ms-usereditor { width:200px; }.grid_hover { border: 10px solid #91CDF2; background-color: #F2FAFF } </style><div id=\"peoplegrid\" style=\"display:none; border: 1px solid #808080; padding: 3px; background-color: #F9F9F9; width=200px;\"><div id=\"peoplechecktest-grid-id\" style=\"overflow: auto; width: 200px; height: 100px;  background-color: #FFFFFF; border: 1px solid #808080; margin-top:2px; padding:3px;\" class=\"ms-descriptiontext\"></div><table border=\"0\" width=\"100%\"><tr><td><a onclick=\"javascript:viewCheckstest-grid-id('test-grid-id');\"><img id=\"peoplecheckimgtest-grid-id\" src=\"_layouts/images/TPMAX1.GIF\" border=\"0\"></a><br></td><td align=\"right\"><font class=\"ms-descriptiontext\"><a onclick=\"javascript:mygridtest-grid-id.editStop();\">Close</a></font></td></tr></table><div id=\"divPetest-grid-id\" style=\"display:none;\"></div></div><div id=\"peoplesinglegrid\" style=\"display:none; border: 1px solid #808080; padding: 3px; background-color: #F9F9F9; width=200px;\"><div id=\"peoplechecksingletest-grid-id\" style=\"width: 200px; height: 100px;  background-color: #FFFFFF; border: 1px solid #808080; margin-top:2px; padding:0px;\" class=\"ms-descriptiontext\"><select size=\"6\" onclick=\"changeUsertest-grid-id(this);\" id=\"peoplecheckselecttest-grid-id\"  style=\"width:100%;height:100%\"><option>test</option></select></div><table border=\"0\" width=\"200\"><tr><td><a onclick=\"javascript:viewDropDowntest-grid-id('test-grid-id');\"><img id=\"peoplechecksingleimgtest-grid-id\" src=\"_layouts/images/TPMAX1.GIF\" border=\"0\"></a><br></td><td align=\"right\"><font class=\"ms-descriptiontext\"><a onclick=\"javascript:mygridtest-grid-id.editStop();\">Close</a></font></td></tr></table><div id=\"divPestest-grid-id\" style=\"display:none;\"></div></div><div id=\"multichoicegrid\" style=\"display:none; border: 1px solid #808080; padding: 3px; background-color: #F9F9F9; width:200px;height:180px\"><div id=\"multichoiceinnertest-grid-id\" style=\"width: 195px; height: 160px;  background-color: #FFFFFF; border: 1px solid #808080; margin-top:2px; padding:0px;overflow:auto\" class=\"ms-descriptiontext\">test</div><table border=\"0\" width=\"200\"><tr><td align=\"right\"><font class=\"ms-descriptiontext\"><a onclick=\"javascript:mygridtest-grid-id.editStop();\">Close</a></font></td></tr></table></div><div id=\"gridmenutest-grid-id\" style=\"position:absolute;left:0px;display:none;\" class=\"js-callout-mainElement ms-core-defaultFont  ms-alignLeft ms-shadow\"><ul class=\"ms-core-menu-list\" style=\"width: 173px;\"></ul></div><script>_css_prefix=\"/_layouts/epmlive/DHTML/xgrid/\"; _js_prefix=\"/_layouts/epmlive/DHTML/xgrid/\"; </script><script src=\"_layouts/epmlive/DHTML/xgrid/dhtmlxcommon.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/dhtmlxgrid.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/dhtmlxgridcell.js\"></script><script src=\"_layouts/epmlive/DHTML/xtreegrid/dhtmlxtreegrid.js\"></script><script src=\"_layouts/epmlive/DHTML/xtreegrid/ext/dhtmlxtreegrid_filter.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_post.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_nxml.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_filter.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_math.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_srnd.js\"></script><script src=\"/_layouts/epmlive/DHTML/xgrid/excells/dhtmlxgrid_excell_calendar.js\"></script><script src=\"/_layouts/epmlive/DHTML/xgrid/excells/dhtmlxgrid_excell_combo.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/excells/dhtmlxgrid_excell_dhxcalendar.js\"></script><script src=\"_layouts/epmlive/DHTML/xcombo/dhtmlxcombo.js\"></script><script src=\"_layouts/epmlive/DHTML/calendar/dhtmlxcalendar.js\"></script><script src=\"_layouts/epmlive/DHTML/xdataproc/dhtmlxdataprocessor.js\"></script><script type=\"text/javascript\" src=\"_layouts/epmlive/modal/modal.js\"></script> <script language=\"JavaScript\" src=\"_layouts/epmlive/dhtml/xmenu/dhtmlxmenu.js\"></script><script language=\"JavaScript\" src=\"_layouts/epmlive/dhtml/xmenu/ext/dhtmlxmenu_ext.js\"></script><style>.menuTable{background-color:#ffffff;}.secondMenuTable{background-color:#ffffff;}.contextMenuover, .contextMenudown{background-color:#9ac2e5;}.contextMenuover td{color:#000000;} </style><script src=\"_layouts/epmlive/epmlivegrid.js\"></script><script language=\"javascript\">var searchfieldstest-grid-id = {test-field: [ \"Yes\", \"No\" ]};function switchsearchtest-grid-id()            {                var searcher = document.getElementById('searchtest-grid-id');                var searchtext = document.getElementById('searchtexttest-grid-id');                var searchchoice = document.getElementById('searchchoicetest-grid-id');                var searchtypechoice = document.getElementById('searchtypetest-grid-id');                var searchfield = searcher.options[searcher.selectedIndex].value;                var sList = searchfieldstest-grid-id[searchfield];                if(sList) {                    searchtext.style.display='none';                    searchchoice.style.display='';                    searchchoice.options.length = 0;                    searchtypechoice.options[2].selected = true;                    searchtypechoice.disabled = true;                    for(var i=0; i < sList.length; i++) {                        var d = sList[i];                        searchchoice.options.add(new Option(d, d));                        if(d=='test-search-string') {                            searchchoice.options[searchchoice.options.length-1].selected = true;                        }                     }                 } else {                    searchtext.style.display='';                    searchchoice.style.display='none';                    searchtypechoice.disabled = false;                }            }function unSearchtest-grid-id(){var gri = document.getElementById('grid');gri.style.display = 'none';var loader = document.getElementById('loadinggrid');loader.style.display = '';var unsearch = document.getElementById('unsearchtest-grid-id');unsearch.style.display=\"none\";var searchtext = document.getElementById('searchtexttest-grid-id');searchtext.value = '';curPagetest-grid-id = 0;sftest-grid-id = null;svtest-grid-id = null;sttest-grid-id = null;loadXtest-grid-id();}function doSearchtest-grid-id(){var gri = document.getElementById('grid');                     gri.style.display = 'none';                     var loader = document.getElementById('loadinggrid');                     loader.style.display = '';                var searcher = document.getElementById('searchtest-grid-id');                var unsearch = document.getElementById('unsearchtest-grid-id');                unsearch.style.display=\"table-cell\";                var searchchoice = document.getElementById('searchchoicetest-grid-id');                var searchtext = document.getElementById('searchtexttest-grid-id');                var searchtypechoice = document.getElementById('searchtypetest-grid-id');                var searchfield = searcher.options[searcher.selectedIndex].value;                var searchtype = searchtypechoice.options[searchtypechoice.selectedIndex].value;                var sList = searchfieldstest-grid-id[searchfield];                var searchvalue = \"\";                if(sList){                    searchvalue = searchchoice.options[searchchoice.selectedIndex].value;                } else {                     searchvalue = searchtext.value;                }curPagetest-grid-id = 0;                         sftest-grid-id = searchfield;                         svtest-grid-id = searchvalue;                         sttest-grid-id = searchtype;                                var url = 'http://fake.url/?dummy=dummy';                        if(url.indexOf('?') > 0) {                            url = url + '&';                        } else {                            url = url + '?';                        }                        url = url + '00000000000000000000000000000000_searchfield=' + searchfield + '&00000000000000000000000000000000_searchvalue=' + searchvalue + '&00000000000000000000000000000000_searchtype=' + searchtype;                        location.href= url;                            }function enablesearchertest-grid-id(){}</script><div id=\"search\" style=\"width:100%; height:25px; padding:10px\" class=\"ms-listviewtable\"><table><tr><td>Search: <select id=\"searchtest-grid-id\" onChange=\"switchsearchtest-grid-id();\" style=\"border: 1px solid #ABABAB; height:20px\"><option value=\"test-field\">test-field</option></select>&nbsp;&nbsp;<select id=\"searchtypetest-grid-id\" style=\"border: 1px solid #ABABAB; height:20px\"><option value=\"1\" selected>Contains</option><option value=\"8\" >Begins With</option><option value=\"2\" >Equals</option><option value=\"3\" >Does Not Equal</option><option value=\"4\" >Greater Than</option><option value=\"5\" >Greater Than or Equal</option><option value=\"6\" >Less Than</option><option value=\"7\" >Less Than or Equal</option></select>&nbsp;&nbsp;</td><td><div style=\"border: 1px solid #ABABAB;width: 150px;height: 20px;\">                    <div id=\"unsearchtest-grid-id\" class=\"\" style=\"padding-left:4px;display: none;min-width: 12px;align:top\">                        <img alt=\"Clear Search\" src=\"/_layouts/epmlive/images/unsearch.png\" style=\"padding-bottom:2px\" onclick=\"unSearchtest-grid-id()\"/>                    </div>                    <div style=\"display: table-cell\">                        <input type=\"text\" id=\"searchtexttest-grid-id\" value=\"test-search-string\" class=\"\" style=\"border: 0px; width:100%; margin-top:-5px; height:14px; font-family: 'Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size:13px\"/>                        <select id=\"searchchoicetest-grid-id\" style=\"border: 0px; width:100%\">                        </select>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    </div>                    <div class=\"\" style=\"padding-right:2px; padding-left:5px;padding-top:2px;display: table-cell;min-width: 10px;cursor:pointer\">                        <img onclick=\"GridSearch('test-grid-id')\" src=\"/_layouts/epmlive/images/find_icon.png\"/>                    </div>                </div></td></tr></table></div><script language=\"javascript\">switchsearchtest-grid-id();</script><div id=\"grid\" style=\"width:100%;display:none;\" class=\"ms-listviewtable\"></div><div id=\"errordivtest-grid-id\" style=\"font-color:red;font-size:11px;\"></div><div  width=\"100%\" id=\"loadinggrid\" align=\"center\"><img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/> Loading Items...</div><script language=\"javascript\">function viewCheckstest-grid-id(btn){var pp = document.getElementById('divPe' + btn);var ppi = document.getElementById('peoplecheckimg' + btn);if(pp.style.display == \"none\"){pp.style.display = \"\";ppi.src = \"_layouts/images/TPMIN1.GIF\";}else{pp.style.display = \"none\";ppi.src = \"_layouts/images/TPMAX1.GIF\";}}function viewDropDowntest-grid-id(btn){var pp = document.getElementById('divPes' + btn);var ppi = document.getElementById('peoplechecksingleimg' + btn);if(pp.style.display == \"none\"){pp.style.display = \"\";ppi.src = \"_layouts/images/TPMIN1.GIF\";}else{pp.style.display = \"none\";ppi.src = \"_layouts/images/TPMAX1.GIF\";}}function gridfiltertest-grid-id(value){var vals = value.split('|');mygridtest-grid-id.filterBy(vals[0],vals[1]);}function setSizetest-grid-id(){mygridtest-grid-id._askRealRows();}function printgridtest-grid-id() {var temp = mygridtest-grid-id.hdr.rows[2];var parent = temp.parentNode;parent.removeChild(temp,true);mygridtest-grid-id.printView();parent.appendChild(temp);}function switchFilterLoadtest-grid-id(){mygridtest-grid-id.switchFilter();mygridtest-grid-id.setSizes();}</script><script>var mygridtest-grid-idHidden = false;var listidtest-grid-id = '00000000-0000-0000-0000-000000000000';mygridtest-grid-id = new dhtmlXGridObject('grid');mygridtest-grid-id.setImagePath(\"_layouts/epmlive/dhtml/xgrid/imgs/\");mygridtest-grid-id.getTitles = function(){                            var lookups = \"\";            mygridtest-grid-id.forEachRow(function (id) {\t\t\t    var c = this.cells(id, 0);\t\t\t    if (c.isCheckbox() && !c.cell.firstChild.disabled && c.cell.firstChild.checked)                {                    var title = this.getUserData(id,\"title\");        \t        var itemid = this.getUserData(id,\"itemid\");                    if(itemid != \"\")                    {                        lookups += \",\" + title;                    }                }\t\t    });            if(lookups == \"\")            {                var rowId = mygridtest-grid-id.getSelectedRowId();                lookups = \",\" + mygridtest-grid-id.getUserData(rowId,\"title\");            }            if(lookups != \"\" && lookups[0] == ',')                lookups = lookups.substring(1);            return lookups;                }                mygridtest-grid-id.getCheckedRowIds = function(){                var ids = \"\";                this.forEachRow(function (id) {\t\t\t        var c = this.cells(id, 0);\t\t\t        if (c.isCheckbox() && !c.cell.firstChild.disabled && c.cell.firstChild.checked)                    {                        ids += \",\" + id;                    }\t\t        });                if(ids != \"\" && ids[0] == ',')                    ids = ids.substring(1);                if(ids == \"\")                    ids = this.getSelectedRowId();                return ids;            };mygridtest-grid-id.getCheckedIds = function(){                var ids = \"\";                this.forEachRow(function (id) {\t\t\t        var c = this.cells(id, 0);\t\t\t        if (c.isCheckbox() && !c.cell.firstChild.disabled && c.cell.firstChild.checked)                    {                        var listid = this.getUserData(id,\"listid\");        \t            var itemid = this.getUserData(id,\"itemid\");        \t            var webid = this.getUserData(id,\"webid\");                        if (this._useparent) {                            var parentid = this.getUserData(id, \"parentitemid\");                            if (parentid && parentid != \"\") {                                var newids = parentid.toString().split(\".\");                                webid = newids[0];                                listid = newids[1];                                itemid = newids[2];                            }                        }                        if(itemid != \"\")                        {                            ids += \",\" + webid + \".\" + listid + \".\" + itemid;                        }                    }\t\t        });                if(ids == \"\")                {                    var rowId = this.getSelectedRowId();                    var listid = this.getUserData(rowId,\"listid\");        \t        var itemid = this.getUserData(rowId,\"itemid\");        \t        var webid = this.getUserData(rowId,\"webid\");                    if (this._useparent) {                        var parentid = this.getUserData(rowId, \"parentitemid\");                        if (parentid && parentid != \"\") {                            var newids = parentid.toString().split(\".\");                            webid = newids[0];                            listid = newids[1];                            itemid = newids[2];                        }                    }                    if(itemid != \"\")                    {                        ids = webid + \".\" + listid + \".\" + itemid;                    }                }                if(ids != \"\" && ids[0] == ',')                    ids = ids.substring(1);                return ids;            };mygridtest-grid-id.getCheckedItems = function(){                var ids = \"\";                this.forEachRow(function (id) {\t\t\t        var c = this.cells(id, 0);\t\t\t        if (c.isCheckbox() && !c.cell.firstChild.disabled && c.cell.firstChild.checked)                    {                        var listid = this.getUserData(id,\"listid\");        \t            var itemid = this.getUserData(id,\"itemid\");        \t            var webid = this.getUserData(id,\"webid\");                        if(itemid != \"\")                        {                            ids += \",\" + itemid;                        }                    }\t\t        });                if(ids == \"\")                {                    var rowId = this.getSelectedRowId();                    var listid = this.getUserData(rowId,\"listid\");        \t        var itemid = this.getUserData(rowId,\"itemid\");        \t        var webid = this.getUserData(rowId,\"webid\");                    if(itemid != \"\")                    {                        ids = itemid;                    }                }                if(ids != \"\" && ids[0] == ',')                    ids = ids.substring(1);                return ids;            };mygridtest-grid-id.toggleSearch = function(){var searchDiv = document.getElementById('search');if(searchDiv.style.display == 'none'){searchDiv.style.display = '';}else{searchDiv.style.display = 'none';}};mygridtest-grid-id.switchFilter = function(){try{var input1 = mygridtest-grid-id.hdr.rows[2];if(mygridtest-grid-idHidden == false){input1.style.display = \"none\";mygridtest-grid-idHidden = true;}else{input1.style.display = \"\";mygridtest-grid-idHidden = false;}mygridtest-grid-id.setSizes();}catch(e){}};mygridtest-grid-id._enableCMenus = true;mygridtest-grid-id.PageSize = '0';mygridtest-grid-id.UseReporting = false;curPagetest-grid-id = 0;mygridtest-grid-id._epkview = '';mygridtest-grid-id._useparent = false;mygridtest-grid-id._curPlanner = '';mygridtest-grid-id._epkurl = '';mygridtest-grid-id._epkcostview = '';mygridtest-grid-id.canribbon = true;mygridtest-grid-id.addFocusedCommands = function($arr){return $arr;}mygridtest-grid-id.getGlobalCommands = function($arr){return $arr;}mygridtest-grid-id.canHandleCommand = function($Grid, commandId){return false;}mygridtest-grid-id.handleCommand = function($Grid, commandId, properites){if(typeof(properties) != 'undefined')return properties;}mygridtest-grid-id._webpartid = '';mygridtest-grid-id._outlookexport = '';mygridtest-grid-id._gridMode = '';mygridtest-grid-id._hasTemplateList = false;mygridtest-grid-id._newmenumode = 0;mygridtest-grid-id._newitemurl = 'test-server-url';mygridtest-grid-id._newfolder = false;mygridtest-grid-id._newmenu = \"<Button Id=\\'Ribbon.ListItem.New.NewListItem\\' Command=\\'NewItem\\' CommandValueId=\\'NewListItem\\' LabelText=\\'New Item\\' Description=\\'Create a New Item\\' Image32by32=\\'/_layouts/0/images/formatmap32x32.png\\' CommandType=\\'OptionSelection\\' Image32by32Top=\\'-160\\' Image32by32Left=\\'-384\\'/>\"mygridtest-grid-id._modifylist = false;mygridtest-grid-id._listperms = false;mygridtest-grid-id._shownewmenu = true;mygridtest-grid-id._allowedit = false;mygridtest-grid-id._listid = '00000000-0000-0000-0000-000000000000';mygridtest-grid-id._webid = '00000000-0000-0000-0000-000000000000';mygridtest-grid-id._listname = '';mygridtest-grid-id._viewid = '00000000-0000-0000-0000-000000000000';mygridtest-grid-id._viewurl = 'http://fake.url/http://fake.url';mygridtest-grid-id._siteurl = '';mygridtest-grid-id._webrelurl = 'test-server-url';mygridtest-grid-id._viewname = 'dummy';mygridtest-grid-id._basetype = 'GenericList';mygridtest-grid-id._templatetype = '0';mygridtest-grid-id._newrow = false;mygridtest-grid-id._rolluplists = '';mygridtest-grid-id._brollups = false;mygridtest-grid-id._requestList = false;mygridtest-grid-id._usepopup = false;mygridtest-grid-id._lookupfield = '';mygridtest-grid-id._lookupfieldlist = '';mygridtest-grid-id._excell = 'test-server-url\\u002f_vti_bin\\u002fowssvr.dll?CS=65001\\u0026Using=_layouts\\u002fquery.iqy\\u0026List=\\u00257B00000000\\u00252D0000\\u00252D0000\\u00252D0000\\u00252D000000000000\\u00257D\\u0026View=\\u00257B00000000\\u00252D0000\\u00252D0000\\u00252D0000\\u00252D000000000000\\u00257D\\u0026RootFolder=http:\\u0026CacheControl=1';mygridtest-grid-id._gridid = 'test-grid-id';mygridtest-grid-id._formmenus = \"\";mygridtest-grid-id.setSkin(\"modern\");mygridtest-grid-id.enableAlterCss(\"ms-itmhover\", \"ms-itmhover\");mygridtest-grid-id.enableAutoHeight(true);mygridtest-grid-id.enableSmartRendering(true);mygridtest-grid-id.enableSmartXMLParsing(true);mygridtest-grid-id.setAwaitedRowHeight(30);mygridtest-grid-id.setImageSize(1,1);mygridtest-grid-id._editmode = false;mygridtest-grid-id.enableEditEvents(true,false,false);document.onclick=function(){mygridtest-grid-id._curHover=false;mygridtest-grid-id.clearmenus();};mygridtest-grid-id.setDateFormat(\"%m/%d/%Y\");mygridtest-grid-id.attachEvent(\"onXLE\",clearLoader);mygridtest-grid-id.attachEvent(\"onXLE\",switchFilterLoadtest-grid-id);mygridtest-grid-id.attachEvent(\"onXLE\",enablesearchertest-grid-id);mygridtest-grid-id.attachEvent(\"onXLE\",showrib());mygridtest-grid-id.attachEvent(\"onRowSelect\",selectRowtest-grid-id);mygridtest-grid-id._singleItemUrl = \"http://fake.url/_layouts/epmlive/getsingleitem.aspx?data=&edit=false\";mygridtest-grid-id.init();singleItemUrltest-grid-id = \"http://fake.url/_layouts/epmlive/getsingleitem.aspx?data=&edit=false\";singleEditItemUrltest-grid-id = \"test-server-url/_layouts/epmlive/getedititem.aspx?data=\";inEditModetest-grid-id = false;myDataProcessortest-grid-id = new dataProcessor(\"http://fake.url/_layouts/epmlive/savegrid.aspx?columns=dGVzdC1maWVsZC0x&data=&edit=false\");myDataProcessortest-grid-id.setUpdateMode(\"off\");myDataProcessortest-grid-id.defineAction(\"error100\", myErrorHandlertest-grid-id);myDataProcessortest-grid-id.defineAction(\"error500\", error500test-grid-id);myDataProcessortest-grid-id.defineAction(\"alldatareturned\", alldatareturnedtest-grid-id);myDataProcessortest-grid-id.setTransactionMode(\"POST\", true);myDataProcessortest-grid-id.init(mygridtest-grid-id);mygridtest-grid-id.enableTreeCellEdit(false);function viewErrortest-grid-id(id){document.getElementById('dlgErrorTexttest-grid-id').innerText=mygridtest-grid-id.getUserData(id,\"lastError\");sm('dlgErrortest-grid-id',250,130);}function myErrorHandlertest-grid-id(obj){      var id = obj.getAttribute(\"sid\");var EditCol = getEditColtest-grid-id();if(EditCol != null){      mygridtest-grid-id.cells(id,EditCol).setValue(\"<a href=\\\"javascript:viewErrortest-grid-id('\" + id + \"');\\\"><img src='/_layouts/images/EXCLAIM.GIF' border='0'></a> <a onclick=\\\"javascript:saveEdittest-grid-id('\" + id + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/saveitem.gif\\\" border=\\\"0\\\" alt=\\\"Save\\\"></a> <a onclick=\\\"javascript:cancelEditRowtest-grid-id('\" + id + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/close.gif\\\" border=\\\"0\\\" alt=\\\"Cancel\\\"></a>\");}      mygridtest-grid-id.setUserData(id,\"lastError\",obj.firstChild.data);      return true;}function alldatareturnedtest-grid-id(obj){      setRowValuestest-grid-id(obj.firstChild);}function error500test-grid-id(obj){      alert(obj.firstChild.data);      myDataProcessortest-grid-id.stopOnError = true;       hm('dlgSavingtest-grid-id');      return false;}myDataProcessortest-grid-id.setOnAfterUpdate(function(id,action,newid){if(action != \"error100\" && action != \"delete\"){mygridtest-grid-id.cells(id,0).setValue(\"\");mygridtest-grid-id.cells(id,0).setBgColor('#F0F0F0');}if(myDataProcessortest-grid-id.getSyncState()){    hm('dlgSavingtest-grid-id');    myDataProcessortest-grid-id.updatedRows = new Array(0);}});var singleItemUrltest-grid-id;var arrColumnLookupstest-grid-id;var defaultxmltest-grid-id;var minValuestest-grid-id;var maxValuestest-grid-id;var curPagetest-grid-id = 0;var firstItemtest-grid-id = 0;var lastItemtest-grid-id = 0;var fItemHidetest-grid-id = 0;var sftest-grid-id;var svtest-grid-id;var sttest-grid-id;var bPageSetuptest-grid-id = false;function selectRowtest-grid-id(id, ind){\t\tcurRowId = id;\tcurGrid = mygridtest-grid-id;\tvar c = curGrid.cells(id, 0);\tif (c.isCheckbox())\t{\t\tUnCheckAll(curGrid);\t\tc.cell.firstChild.checked = true;\t\tc.cell.firstChild.display = \"\";\t}\tRefreshCommandUI();\tif(curGrid.canribbon)\t{\t\tif(curGrid.getRowById(id)._locked)\t\t{\t\t\tSelectRibbonTab(\"Ribbon.ListItem\", true);\t\t\t//var wp2 = document.getElementById('Ribbon.ListItem-title');\t\t\t//if(wp2)\t\t\t//\tfireEvent(wp2.firstChild, 'click');\t\t}\t}}function UnCheckAll(grid){\tgrid.forEachRow(function (id) {\t\tvar c = this.cells(id, 0);\t\tif (c.isCheckbox())\t\t{\t\t\tc.cell.firstChild.checked = false;\t\t\tc.cell.firstChild.display = \"none\";\t\t}\t});}function viewItemtest-grid-id(link, action){    var rowIdFull = link.parentNode.parentNode.parentNode.parentNode.parentNode.idd;    var weburl = mygridtest-grid-id.getUserData(rowIdFull,\"SiteUrl\");    var listId = mygridtest-grid-id.getUserData(rowIdFull,\"listid\");    var webid = mygridtest-grid-id.getUserData(rowIdFull,\"webid\");    var siteid = mygridtest-grid-id.getUserData(rowIdFull,\"siteid\");    var editurl = mygridtest-grid-id.getUserData(rowIdFull,\"editurl\");    var viewurl = mygridtest-grid-id.getUserData(rowIdFull,\"viewurl\");    var itemId = mygridtest-grid-id.getUserData(rowIdFull,\"itemid\");    var FullURL = mygridtest-grid-id.getUserData(rowIdFull,\"FullURL\");    var wurl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=\" + action + \"&ListId=\" + listId + \"&ID=\" + itemId + \"&gridid=test-grid-id&siteid=\" + siteid + \"&webid=\" + webid + \"&rowid=\" + rowIdFull;        function myCallback(dialogResult, returnValue)\t{\t\tif(dialogResult == 1)\t\t{\t\t\tvar weburl = curGrid.getUserData(curRowId,\"SiteUrl\");\t\t\tvar listid = curGrid.getUserData(curRowId,\"listid\");\t\t\tvar itemid = curGrid.getUserData(curRowId,\"itemid\");\t\t\tvar webid = curGrid.getUserData(curRowId,\"webid\");\t\t\tvar siteid = curGrid.getUserData(curRowId,\"siteid\");\t\t\tgetSingleItemtest-grid-id(siteid,webid,listid,itemid,curRowId);\t\t}\t}\tvar options = { url: wurl, width: 600, dialogReturnValueCallback:myCallback };\tSP.UI.ModalDialog.showModalDialog(options);}function onKeyPresstest-grid-id(key, control, shift){\tif(!mygridtest-grid-id.editor)\t{\t\tif(key == 46)\t\t{\t\t\tvar rowId = mygridtest-grid-id.getSelectedRowId();\t\t\t\t\tvar isNew = mygridtest-grid-id.getUserData(rowId,\"isNewRow\");\t\t\tvar itemid = mygridtest-grid-id.getUserData(rowId,\"itemid\");\t\t\tif(isNew != \"1\" && itemid != \"\")\t\t\t{\t\t\t\tif(confirm('Are you sure you want to delete this item?')){\t\t\t\t\tmygridtest-grid-id.deleteRow(rowId);\t\t\t\t};            }\t\t}\t}\treturn true;}function newItemtest-grid-id(usepopup){\tvar wurl = mygridtest-grid-id._newitemurl;\tif(usepopup)\t{\t\tfunction NewItemCallback(dialogResult, returnValue){if(dialogResult){window.location.href=window.location.href;}}\t\tvar options = { url: wurl, width: 600, dialogReturnValueCallback:NewItemCallback };\t\tSP.UI.ModalDialog.showModalDialog(options);\t}\telse\t{\t\tlocation.href = wurl;\t}}function setDefaultstest-grid-id(id){\tvar dxml = id.xmlLoader;\t\tvar rows = dxml.doXPath(\"//rows/row[@id='_NEWROW_']\");\t\tvar ua = window.navigator.userAgent;    var msie = ua.indexOf(\"MSIE \");\tif (msie > 0)\t\tdefaultxmltest-grid-id = rows[0].xml;\telse\t\tdefaultxmltest-grid-id = rows[0].outerHTML;\tmygridtest-grid-id._defaults = defaultxmltest-grid-id;}function onEditCelltest-grid-id(stage, rowId, ind, nval, oval){\tif(stage != 2)        return true;        \tif(oval == null)\t\toval = \"\";\tif(!checkMintest-grid-id(rowId,ind,nval))    {        mygridtest-grid-id.cells(rowId,ind).setValue(oval);        return;    }        if(!checkMaxtest-grid-id(rowId,ind,nval))    {        mygridtest-grid-id.cells(rowId,ind).setValue(oval);        return;    }        //alert(\"OLD: \" + oval + \"\\r\\nNEW: \" + nval + \"\\r\\nTitle: \" + mygridtest-grid-id.cells(rowId,ind).getTitle());    \tif(stage == 2 && oval != nval)\t{\t\tvar isNew = mygridtest-grid-id.getUserData(rowId,\"isNewRow\");\t\tif(isNew != null && isNew == \"1\")\t\t{\t\t\tmygridtest-grid-id.setUserData(rowId,\"isNewRow\",\"\");\t\t\tmygridtest-grid-id.cells(rowId,0).setValue(\"\");\t\t\tinsertBlankRowtest-grid-id();\t\t}\t}\treturn true;}function insertBlankRowtest-grid-id(id){\tvar xmlDoc; \tvar moz = (typeof document.implementation != 'undefined') && (typeof \tdocument.implementation.createDocument != 'undefined'); \tvar ie = (typeof window.ActiveXObject != 'undefined'); \tif (window.DOMParser)\t{\t\tparser=new DOMParser();\t\txmlDoc=parser.parseFromString(defaultxmltest-grid-id,\"text/xml\");\t}\telse // code for IE\t{\t\txmlDoc=new ActiveXObject(\"Microsoft.XMLDOM\");\t\txmlDoc.async=false;\t\txmlDoc.loadXML(defaultxmltest-grid-id); \t}\tvar newId = \"_NEWROW_\" + mygridtest-grid-id.getUID();\tvar nRow = mygridtest-grid-id.addRow(newId,\"<img src=\\\"/_layouts/images/newitem.gif\\\">\");\txmlDoc.firstChild.setAttribute(\"id\",newId);\t\tsetRowValuetest-grid-id(xmlDoc.firstChild);\tmygridtest-grid-id.setUserData(newId,\"isNewRow\",\"1\");\tmyDataProcessortest-grid-id.setUpdated(newId,false);\t}dhtmlXGridObject.prototype.alerterror=function(msg){    document.getElementById(\"errordiv\" + this._gridid).innerHTML = \"Error: \" + msg;};dhtmlXGridObject.prototype.setuppaging=function(records){    \tvar pages = Math.ceil(records / this.PageSize);\tvar prev = document.getElementById(\"PagePrevious\"+ this._gridid);\tvar next = document.getElementById(\"PageNext\"+ this._gridid);\tvar pagediv = document.getElementById(\"pagediv\"+ this._gridid);\tvar pagetable = document.getElementById(\"pagetable\"+ this._gridid);\tif(this.UseReporting)\t{\t\tif(pages > 1)\t\t{\t\t\tif(!bPageSetuptest-grid-id)\t\t\t{\t\t\t\tbPageSetuptest-grid-id = true;\t\t\t\t$(\"#pagedivtest-grid-id\").paginate({\t\t\t\t\tcount \t\t: pages,\t\t\t\t\tstart \t\t: 1,\t\t\t\t\tdisplay     : 12,\t\t\t\t\tborder\t\t\t\t\t: true,\t\t\t\t\trotate      : false,\t\t\t\t\timages\t\t: false,\t\t\t\t\tmouse\t\t: 'press',\t\t\t\t\tonChange\t: ChangePagetest-grid-id\t\t\t\t});\t\t\t}\t\t}\t\telse\t\t{\t\t\tpagediv.style.display = \"none\";\t\t\tpagetable.style.display = \"none\";\t\t}\t}\telse\t{\t\tpagediv.style.display = \"inline-block\";\t\tpagetable.style.display = \"\";\t\tvar rec = records.split('|');\t\tfirstItemtest-grid-id = parseInt(rec[2]) * -1;\t\tlastItemtest-grid-id = rec[1];\t\tif(rec[0] == \"0\" || fItemHidetest-grid-id == firstItemtest-grid-id)\t\t{\t\t\tprev.style.background = \"#EFEFEF\";\t\t\tfItemHidetest-grid-id = firstItemtest-grid-id;\t\t}\t\telse\t\t{\t\t\tprev.style.background = \"#DDDDDD\";\t\t}\t\tif(rec[3] == \"true\")\t\t\tnext.style.background = \"#DDDDDD\";\t\telse\t\t{\t\t\tprev.style.background = \"#EFEFEF\";\t\t\tlastItemtest-grid-id = 0;\t\t}\t\tif(rec[3] != \"true\" && rec[0] == \"0\")\t\t{\t\t\tpagediv.style.display = \"none\";\t\t\tpagetable.style.display = \"none\";\t\t}\t}};dhtmlXGridObject.prototype.registerLookuptest-grid-id=function(col,vals){    if(arrColumnLookupstest-grid-id == null)        arrColumnLookupstest-grid-id = new Array(mygridtest-grid-id.getColumnsNum());\t\t    arrColumnLookupstest-grid-id[col] = vals;};//======================Multi User=====================function changeUsertest-grid-id(chkVal){\tdocument.getElementById(\"_downlevelTextBox\").value = \"\";\tdocument.getElementById(\"_upLevelDiv\").innerHTML = \"\";\t\t\tif(document.getElementById(\"_upLevelDiv\").firstChild == null)\t{\t\tvar oTN=document.createTextNode(\"\");\t\tdocument.getElementById(\"_upLevelDiv\").appendChild(oTN);\t}\tdocument.getElementById(\"_upLevelDiv\").firstChild.nodeValue = \"\";\t//chkVal.options[chkVal.selectedIndex].value;}function eXcell_usereditorm(cell){                                    //excell name is defined here    if (cell){                                                     //default pattern, just copy it        this.cell = cell;        this.grid = this.cell.parentNode.grid;        if(!this.grid._grid_pe)        {\t\t\tvar z=document.getElementById(\"people\" + cell.parentNode.grid.entBox.id);\t\t\tz.onclick=function(e){ (e||event).cancelBubble=true; }\t\t\t\t\t\tif (_isIE) { \t\t\t\tz.style.position=\"absolute\"\t\t\t\tz.style.top=\"0px\"\t\t\t}\t\t\tdocument.body.insertBefore(z,document.body.firstChild);\t\t\t \t\t\tthis.grid._grid_pe = z;\t\t}    }    this.setValue=function(val){\t\tvar strVal = \"&nbsp;\";\t\tvar strVals = val.split('\\t')[0].split('\\n');\t\tfor(var i = 1;i<strVals.length;i=i+2)\t\t{\t\t\tstrVal += \"; \" + strVals[i];\t\t}\t\tif(strVal != \"&nbsp;\")\t\t\tstrVal = strVal.substring(7);\t\t\t        this.setCValue(strVal);                   this.cell._displayValue = strVal;        this.cell._users = val.split('\\t')[0];                                           this.cell._Allusers = val === undefined ? [] : val.split('\\t')[1];                                       }    this.getValue=function(){       return this.cell._users; // get value    }    this.edit=function(){    \t\tthis.val=this.getValue();    \t\tdocument.getElementById(\"_downlevelTextBox\").value = \"\";\t\tdocument.getElementById(\"_upLevelDiv\").innerHTML = \"\";\t\tcopyUplevelToHidden('');\t\tupdateControlValue('');\t\tvar arg=getUplevel('');\t\tvar ctx='';\t\tEntityEditorSetWaitCursor(ctx);\t\tWebForm_DoCallback('',arg,EntityEditorHandleCheckNameResult,ctx,EntityEditorHandleCheckNameError,true);\t\t        var pp = document.getElementById(\"divPetest-grid-id\");        var ppi = document.getElementById(\"peoplecheckimgtest-grid-id\");        pp.style.display = \"none\";        ppi.src = \"_layouts/images/TPMAX1.GIF\";                    \t\tvar strVal = \"\";\t\tvar strAllUserChecks = \"\";\t\tvar strVals = this.cell._users.split('\\n');\t\tvar strAllUsers = this.cell._Allusers === undefined ? [] : this.cell._Allusers.split('\\n');\t\tvar strUserNames = '\\t';\t\t\t\tfor(var i = 0;i<strVals.length;i=i+2)\t\t{\t\t\tstrUserNames += strVals[i].toLowerCase() + '\\t';\t\t\tstrVal += \"; \" + strVals[i];\t\t}\t\tif(strVal.length > 1)\t\t\tstrVal = strVal.substring(1);\t\t\t\t\tfor(var i = 0;i<strAllUsers.length;i++)\t\t{\t\t\tvar isChecked = \"\";\t\t\tvar userInfo = strAllUsers[i].split(';#');\t\t\t\t\t\tif(strUserNames.indexOf('\\t' + userInfo[0].toLowerCase() + '\\t') > -1)\t\t\t\tisChecked = \"checked\";\t\t\t\t\t\t\tstrAllUserChecks += \"<br><input type=\\\"checkbox\\\" name=\\\"chkUserstest-grid-id\\\" value=\\\"\" + userInfo[0] + \"\\\" \" + isChecked + \">\" + userInfo[1];\t\t}\t\tif(strAllUserChecks.length > 1)\t\t\tstrAllUserChecks = strAllUserChecks.substring(4);\t\t\t\t\tdocument.getElementById(\"peoplechecktest-grid-id\").innerHTML = strAllUserChecks;\t\t\tvar arPos = this.grid.getPosition(this.cell);\t\tif(arPos[0] + 200 > document.body.clientWidth)\t\t\tthis.grid._grid_pe.style.left=document.body.clientWidth - 210;\t\telse\t\t\tthis.grid._grid_pe.style.left=arPos[0];\t\t\t\tif((arPos[1] + 100) > (document.body.clientHeight + document.body.scrollTop))\t\t\tthis.grid._grid_pe.style.top=document.body.clientHeight + document.body.scrollTop - 105;\t\telse\t\t\tthis.grid._grid_pe.style.top=arPos[1];\t\tthis.grid._grid_pe.style.display=\"\";\t\tthis.grid._grid_pe.style.position = \"absolute\";\t\tthis.grid._grid_pe.style.zIndex  = 99;    }    this.detach=function(){\t\tthis.grid._grid_pe.style.display=\"none\";\t\t\t\tvar strUsers = \"\";\t\tvar divChecks = document.getElementById(\"peoplechecktest-grid-id\");\t\tvar divChildChecks = divChecks.firstChild;\t\twhile(divChildChecks != null)\t\t{\t\t\tif(divChildChecks.nodeName == \"INPUT\")\t\t\t{\t\t\t\tif(divChildChecks.checked)\t\t\t\t{\t\t\t\t\tstrUsers += '\\n' + divChildChecks.value;\t\t\t\t\tstrUsers += '\\n' + divChildChecks.nextSibling.nodeValue;\t\t\t\t}\t\t\t}\t\t\tdivChildChecks = divChildChecks.nextSibling;\t\t}\t\tfor(var i = 0;i<document.getElementById(\"_upLevelDiv\").childNodes.length;i=i+2)\t\t{\t\t\tif(document.getElementById(\"_upLevelDiv\").childNodes[i].firstChild != null)\t\t\t{\t\t\t\tstrUsers += '\\n' + document.getElementById(\"_upLevelDiv\").childNodes[i].title;\t\t\t\tstrUsers += '\\n' + document.getElementById(\"_upLevelDiv\").childNodes[i].firstChild.nextSibling.innerText;\t\t\t}\t\t}\t\tif(strUsers.length > 1)\t\t\tstrUsers = strUsers.substring(1);\t\t\t\tvar oldValue = this.getValue();\t\t\t\t\tif(this.cell._Allusers !== undefined)\t\t\tthis.setValue(strUsers + '\\t' + this.cell._Allusers);         return oldValue != this.getValue();    }}eXcell_usereditorm.prototype = new eXcell;//================================User Single=================function eXcell_usereditor(cell){                                    //excell name is defined here    if (cell){        this.cell = cell;        this.grid = this.cell.parentNode.grid;        if(!this.grid._grid_pes)        {\t\t\tvar z=document.getElementById(\"peoplesingle\" + cell.parentNode.grid.entBox.id);\t\t\tz.onclick=function(e){ (e||event).cancelBubble=true; }\t\t\t\t\t\tif (_isIE) { \t\t\t\tz.style.position=\"absolute\"\t\t\t\tz.style.top=\"0px\"\t\t\t}\t\t\tdocument.body.insertBefore(z,document.body.firstChild);\t\t\t \t\t\tthis.grid._grid_pes = z;\t\t}    }    this.setValue=function(val){\t\tvar strVal = \"&nbsp;\";\t\tvar strVals = val.split('\\t')[0].split('\\n');\t\t\t\tfor(var i = 1;i<strVals.length;i=i+2)\t\t{\t\t\tstrVal += \"; \" + strVals[i];\t\t}\t\tif(strVal != \"&nbsp;\")\t\t\tstrVal = strVal.substring(7);\t\t\t        this.setCValue(strVal);                   this.cell._displayValue = strVal;        this.cell._users = val.split('\\t')[0];                                           this.cell._Allusers = val === undefined ? [] : val.split('\\t')[1];                                       }    this.getValue=function(){\t\t       return this.cell._users; // get value    }    this.edit=function(){\t\tthis.val=this.getValue();        var pp = document.getElementById(\"divPestest-grid-id\");        var ppi = document.getElementById(\"peoplechecksingleimgtest-grid-id\");        pp.style.display = \"none\";        ppi.src = \"_layouts/images/TPMAX1.GIF\";\t\tvar strVal = \"\";\t\tvar strAllUserChecks = \"\";\t\tvar strVals = this.cell._users.split('\\n');\t\tvar strAllUsers = this.cell._Allusers === undefined ? [] : this.cell._Allusers.split('\\n');\t\tvar strUserNames = '\\t';\t\tfor(var i = 0;i<strVals.length;i=i+2)\t\t{\t\t\tstrUserNames += strVals[i].toLowerCase() + '\\t';\t\t\tstrVal += \"; \" + strVals[i];\t\t}\t\tif(strVal.length > 1)\t\t\tstrVal = strVal.substring(1);\t\tvar slct = document.getElementById(\"peoplecheckselecttest-grid-id\");\t\tslct.options.length=0;\t\tvar oSelected = -1;\t\tvar oCounter = 0;\t\tfor(var i = 0;i<strAllUsers.length;i++)\t\t{\t\t\tvar isChecked = false;\t\t\tvar userInfo = strAllUsers[i].split(';#');\t\t\t\t\t\tif(strUserNames.indexOf('\\t' + userInfo[0].toLowerCase() + '\\t') > -1)\t\t\t\toSelected = oCounter;\t\t\t\t\t\t\tvar elOptNew = document.createElement('option');            elOptNew.text = userInfo[1];            elOptNew.value = userInfo[0];            try            {                slct.add(elOptNew, null);            }            catch(ex)            {                slct.add(elOptNew);            }\t\t\t\t\t\t\t\t\t\t//slct.add(new Option(userInfo[1], userInfo[0], false, isChecked));\t\t\toCounter++;\t\t}\t\t\t\tslct.selectedIndex = oSelected;\t\t\t\tdocument.getElementById(\"_downlevelTextBox\").value = \"\";\t\tdocument.getElementById(\"_upLevelDiv\").innerHTML = \"\";\t\t/*\t\tif(document.getElementById(\"_upLevelDiv\").firstChild == null)\t\t{\t\t\tvar oTN=document.createTextNode(\"\");\t\t\tdocument.getElementById(\"_upLevelDiv\").appendChild(oTN);\t\t}\t\tdocument.getElementById(\"_upLevelDiv\").firstChild.nodeValue = strVal;\t\t*/\t\tcopyUplevelToHidden('');\t\tupdateControlValue('');\t\tvar arg=getUplevel('');\t\tvar ctx='';\t\t\t\tEntityEditorSetWaitCursor(ctx);\t\tWebForm_DoCallback('',arg,EntityEditorHandleCheckNameResult,ctx,EntityEditorHandleCheckNameError,true);\t\t\t\t\t\tvar arPos = this.grid.getPosition(this.cell);\t\tif(arPos[0] + 200 > document.body.clientWidth)\t\t\tthis.grid._grid_pes.style.left=document.body.clientWidth - 210;\t\telse\t\t\tthis.grid._grid_pes.style.left=arPos[0];\t\t\t\tif((arPos[1] + 100) > (document.body.clientHeight + document.body.scrollTop))\t\t\tthis.grid._grid_pes.style.top=document.body.clientHeight + document.body.scrollTop - 105;\t\telse\t\t\tthis.grid._grid_pes.style.top=arPos[1];\t\tthis.grid._grid_pes.style.display=\"\";\t\tthis.grid._grid_pes.style.position = \"absolute\";\t\tthis.grid._grid_pes.style.zIndex  = 99;    }    this.detach=function(){\t\tthis.grid._grid_pes.style.display=\"none\";\t\t\t\tvar strUsers = \"\";\t\tfor(var i = 0;i<document.getElementById(\"_upLevelDiv\").childNodes.length;i=i+2)\t\t{\t\t\tif(document.getElementById(\"_upLevelDiv\").childNodes[i].firstChild != null)\t\t\t{\t\t\t\tstrUsers += '\\n' + document.getElementById(\"_upLevelDiv\").childNodes[i].title;\t\t\t\tstrUsers += '\\n' + document.getElementById(\"_upLevelDiv\").childNodes[i].firstChild.nextSibling.innerText;\t\t\t}\t\t}\t\tif(strUsers == \"\")\t\t{\t\t\tvar chkVal = document.getElementById(\"peoplecheckselecttest-grid-id\");\t\t\tif(chkVal.selectedIndex > -1)\t\t\t{\t\t\t\tstrUsers += '\\n' + chkVal.options[chkVal.selectedIndex].value;\t\t\t\tstrUsers += '\\n' + chkVal.options[chkVal.selectedIndex].text;\t\t\t}\t\t}\t\t\t\tif(strUsers.length > 1)\t\t\tstrUsers = strUsers.substring(1);\t\t\t\tvar oldValue = this.getValue();\t\t\t\t\tif(this.cell._Allusers !== undefined)\t\t\tthis.setValue(strUsers + '\\t' + this.cell._Allusers);         return oldValue != this.getValue();    }}eXcell_usereditor.prototype = new eXcell;//=========================choice========================function eXcell_choice(cell){                                    //excell name is defined here    if (cell){\t\t\t\t\t\t\t\t\t\t\t\t\t//default pattern, just copy it        this.cell = cell;        this.grid = this.cell.parentNode.grid;    }    this.setValue=function(val){\t\tvar strVal = \"\";\t\tvar dispVal = \"&nbsp;\";\t\tif(val == \";#\")\t\t\tval = \"\";\t\t\t\t\tval = val.replace(/&amp;/g,\"&\");\t\t\t\tif(val.split('\\t')[0] != \"\")\t\t{\t\t\tstrVal = val.split('\\t')[0];\t\t\tdispVal = strVal.split(';#')[1].replace(/&/g,\"&amp;\");\t\t}        this.setCValue(dispVal);        this.cell._value = strVal;        if(val.split('\\t').length > 1)\t\t\tthis.cell._allvalues = val.split('\\t')[1];    }    this.getValue=function(){\t\treturn this.cell._value;    }    this.edit=function(){\t\tthis.val=this.getValue();\t\tvar arPos = this.grid.getPosition(this.cell) //,this.grid.objBox)\t\tvar allvals = this.cell._allvalues;\t\tthis.obj=document.createElement(\"TEXTAREA\");\t\tthis.obj.className=\"dhx_combo_edit\";\t\tthis.obj.style.height=(this.cell.offsetHeight-4)+\"px\";\t\tthis.obj.wrap=\"soft\";\t\tthis.obj.style.textAlign=this.cell.align;\t\tthis.obj.onclick=function(e){\t\t\t(e||event).cancelBubble=true\t\t}\t\tthis.obj.value=this.text\t\tthis.obj.onselectstart=function(e){\t\t\tif (!e)\t\t\t\te=event;\t\t\te.cancelBubble=true;\t\t\treturn true;\t\t};\t\tvar editor_obj = this;\t\tthis.obj.onkeyup=function(e){\t\t\tvar val = this.readonly ? String.fromCharCode((e||event).keyCode) : this.value;\t\t\tvar c = editor_obj.list.options;\t\t\tfor (var i = 0; i < c.length; i++)\t\t\t\tif (c[i].text.indexOf(val) == 0)\t\t\t\t\treturn c[i].selected=true;\t\t}\t\tthis.list=document.createElement(\"SELECT\");\t\tthis.list.className='dhx_combo_select';\t\tthis.list.style.width=this.cell.offsetWidth+\"px\";\t\tthis.list.style.left=arPos[0]+\"px\";                       //arPos[0]\t\tthis.list.style.top=arPos[1]+this.cell.offsetHeight+\"px\"; //arPos[1]+this.cell.offsetHeight;\t\tthis.list.onclick=function(e){\t\t\tvar ev = e||window.event;\t\t\tev.cancelBubble=true;\t\t\tvar cell = ev.target||ev.srcElement\t\t\t//tbl.editor_obj.val=cell.combo_val;\t\t\tif (cell.tagName == \"OPTION\")\t\t\t\tcell=cell.parentNode;\t\t\teditor_obj.setValue(cell.value + \";#\" + cell.text);\t\t\teditor_obj.editable=false;\t\t\teditor_obj.grid.editStop();\t\t}\t\tvar comboKeys = this.cell._allvalues.split('\\n');\t\tvar fl = false;\t\tvar selOptId = 0;\t\tfor (var i = 0; i < comboKeys.length; i++){\t\t\tvar val = comboKeys[i].split(';#');\t\t\t\t\t\tvar elOptNew = document.createElement('option');            elOptNew.text = val[1];            elOptNew.value = val[0];            \t\t\tthis.list.options[this.list.options.length]=elOptNew\t\t\tif (comboKeys[i] == this.val){\t\t\t\tselOptId=this.list.options.length-1;\t\t\t\tfl=true;\t\t\t}\t\t}\t\tif (fl == false){ //if no such value in combo list\t\t\t\t\t\tvar elOptNew = document.createElement('option');            elOptNew.text = this.text;            elOptNew.value = this.val;            \t\t\t//this.list.options[this.list.options.length]=new Option(this.text, this.val === null ? \"\" : this.val);\t\t\t//this.list.options[this.list.options.length]=elOptNew;\t\t\t//selOptId=this.list.options.length-1;\t\t}\t\tdocument.body.appendChild(this.list) //nb:this.grid.objBox.appendChild(this.listBox);\t\tthis.list.size=\"6\";\t\tthis.cstate=1;\t\tif (this.editable){\t\t\tthis.cell.innerHTML=\"\";\t\t}\t\telse {\t\t\tthis.obj.style.width=\"1px\";\t\t\tthis.obj.style.height=\"1px\";\t\t}\t\tthis.cell.appendChild(this.obj);\t\tthis.list.options[selOptId].selected=true;\t\t\t\t    }    this.detach=function(){\t\t\t\tif (this.val != this.getValue())\t\t{\t\t\tthis.cell.wasChanged=true;\t\t}\t\tvar curVal = this.getValue();\t\tvar newVal = this.list.options[this.list.selectedIndex].value + \";#\" + this.list.options[this.list.selectedIndex].text;\t\tif(newVal == \";#\")\t\t\tnewVal = \"\";\t\t\t\tthis.setValue(newVal);\t\t\t\t\t\t/*if (this.list.parentNode != null)\t\t{\t\t\t\tif (this.obj.value._dhx_trim() != this.text){\t\t\t\t\tif (this.list.selectedIndex&&this.list.options[this.list.selectedIndex].text == this.obj.value)\t\t\t\t\t\tthis.setValue(this.list.value + '\\t' + this.cell._allvalues)\t\t\t\t\telse\t\t\t\t\t\tthis.setValue(this.obj.value + '\\t' + this.cell._allvalues)\t\t\t\t} else {\t\t\t\t\tthis.setValue(this.val + '\\t' + this.cell._allvalues)\t\t\t\t}\t\t}*/\t\tif (this.list.parentNode)\t\t\tthis.list.parentNode.removeChild(this.list);\t\tif (this.obj.parentNode)\t\t\tthis.obj.parentNode.removeChild(this.obj);\t\treturn newVal != curVal;\t\t    }}eXcell_choice.prototype = new eXcell;//=========================multichoice========================function eXcell_mchoice(cell){                                    //excell name is defined here    if (cell){                                                     //default pattern, just copy it        this.cell = cell;        this.grid = this.cell.parentNode.grid;        if(!this.grid._grid_mc)        {\t\t\tvar z=document.getElementById(\"multichoice\" + cell.parentNode.grid.entBox.id);\t\t\tz.onclick=function(e){ (e||event).cancelBubble=true; }\t\t\t\t\t\tif (_isIE) { \t\t\t\tz.style.position=\"absolute\"\t\t\t\tz.style.top=\"0px\"\t\t\t}\t\t\tdocument.body.insertBefore(z,document.body.firstChild); \t\t\tthis.grid._grid_mc = z;\t\t}    }    this.setValue=function(val){\t\tvar strVal = \"\";\t\t\t\tif(val.split('\\t')[0] != \"\")\t\t{\t\t\tvar strVals = val.split('\\t')[0].split('\\n');\t\t\tfor(var i = 0;i<strVals.length;i++)\t\t\t{\t\t\t\tvar valInfo = strVals[i].split(';#');\t\t\t\tstrVal += \", \" + valInfo[1];\t\t\t}\t\t\tif(strVal != \"\")\t\t\t\tstrVal = strVal.substring(2);\t\t}\t\tif(strVal != \"\")\t\t\tthis.setCValue(strVal.replace(\"&\",\"&amp;\"));\t\telse\t\t\tthis.setCValue(\"&nbsp;\");\t\t        this.cell._displayValue = strVal;        this.cell._values = val.split('\\t')[0];        this.cell._allvalues = val.split('\\t')[1];    }    this.getValue=function(){\t\treturn this.cell._values;    }    this.edit=function(){\t\tthis.val=this.getValue();\t\tvar strAllValueChecks = \"\";\t\tvar strVals = this.cell._values.split('\\n');\t\tvar strAllValues = this.cell._allvalues.split('\\n');\t\tvar strValues = '\\t';\t\t\t\tfor(var i = 0;i<strVals.length;i++)\t\t{\t\t\tvar valInfo = strVals[i].split(';#');\t\t\t\t\tstrValues += valInfo[0].toLowerCase() + '\\t';\t\t}\t\tfor(var i = 0;i<strAllValues.length;i++)\t\t{\t\t\tvar isChecked = \"\";\t\t\tvar valInfo = strAllValues[i].split(';#');\t\t\t\t\t\tif(strValues.indexOf('\\t' + valInfo[0].toLowerCase() + '\\t') > -1)\t\t\t\tisChecked = \"checked\";\t\t\tstrAllValueChecks += \"<br><input type=\\\"checkbox\\\" name=\\\"chkValuestest-grid-id\\\" value=\\\"\" + valInfo[0] + \"\\\" \" + isChecked + \">\" + valInfo[1];\t\t}\t\tif(strAllValueChecks.length > 1)\t\t\tstrAllValueChecks = strAllValueChecks.substring(4);\t\t\t\t\tdocument.getElementById(\"multichoiceinnertest-grid-id\").innerHTML = strAllValueChecks;\t\tvar arPos = this.grid.getPosition(this.cell);\t\tif(arPos[0] + 200 > document.body.clientWidth)\t\t\tthis.grid._grid_mc.style.left=document.body.clientWidth - 210;\t\telse\t\t\tthis.grid._grid_mc.style.left=arPos[0];\t\t\t\tif((arPos[1] + 100) > (document.body.clientHeight + document.body.scrollTop))\t\t\tthis.grid._grid_mc.style.top=document.body.clientHeight + document.body.scrollTop - 105;\t\telse\t\t\tthis.grid._grid_mc.style.top=arPos[1];\t\tthis.grid._grid_mc.style.display=\"\";\t\tthis.grid._grid_mc.style.position = \"absolute\";\t\tthis.grid._grid_mc.style.zIndex  = 99;    }    this.detach=function(){\t\t\t\tthis.grid._grid_mc.style.display=\"none\";\t\t\t\tvar child = document.getElementById(\"multichoiceinnertest-grid-id\").firstChild;\t\tvar val1 = \"\";\t\twhile(child != null)\t\t{\t\t\tif(child.nodeName == \"INPUT\")\t\t\t{\t\t\t\tif(child.checked)\t\t\t\t{\t\t\t\t\tval1 += '\\n' + child.value + \";#\" + child.nextSibling.nodeValue;\t\t\t\t}\t\t\t}\t\t\tchild = child.nextSibling;\t\t}\t\tif(val1.length > 1)\t\t\tval1 = val1.substring(1);\t\t\t\t\t\t\tvar oldValue = this.getValue();\t\t\t\tthis.cell._values = val1;\t\t\t        this.setValue(val1 + '\\t' + this.cell._allvalues);         return oldValue != this.getValue();\t\t    }}eXcell_mchoice.prototype = new eXcell;//=========================Calendar===========================eXcell_dhxCalendarA.prototype.edit = function(){\t                    var top;                    var left;                                        var arPos = this.grid.getPosition(this.cell);\t\t\t\t\tif(arPos[0] + this.cell.offsetWidth + 180 > document.body.clientWidth)\t\t\t\t\t\tleft = arPos[0] - 185;\t\t\t\t\telse\t\t\t\t\t\tleft=arPos[0] + this.cell.offsetWidth;\t\t\t\t\t\t\t\t\t\tif((arPos[1] + 170) > (document.body.clientHeight + document.body.scrollTop))\t\t\t\t\t\ttop=document.body.clientHeight + document.body.scrollTop - 180;\t\t\t\t\telse\t\t\t\t\t\ttop=arPos[1];                                        this.grid._grid_calendarA.setPosition(top,left);                    \t                    this.grid._grid_calendarA.show();\t                    this.grid._grid_calendarA._last_operation_calendar=false;\t\t\t\t\t//var arPos = this.grid.getPosition(this.cell);                    //var pval=this._date2str2(this.cell.val||new Date());                    //window._grid_calendar.render(arPos[0],arPos[1]+this.cell.offsetHeight,this,pval);                    this.cell._cediton=true;                    this.val=this.cell.val;                    //this.val=this.getValue();                    this._val=this.cell.innerHTML;                   // alert(this.cell.val);\t\t\t\t   \tthis.grid._grid_calendarA.setDateFormat((this.grid._dtmask||\"%d/%m/%Y\"));                    this.grid._grid_calendarA.setDate(this.val);                    this.grid._grid_calendarA.draw();                    \t\t\t\t\tthis.cell.atag=((!this.grid.multiLine)&&(_isKHTML||_isMacOS||_isFF))?\"INPUT\":\"TEXTAREA\";\t\t\t\t\t\t\t\t\t\tthis.obj = document.createElement(this.cell.atag);\t\t\t\t\tthis.obj.style.height = (this.cell.offsetHeight-(_isIE?4:2))+\"px\";                    this.obj.className=\"dhx_combo_edit\";\t\t\t\t   \tthis.obj.wrap = \"soft\";\t\t\t\t\tthis.obj.style.textAlign = this.cell.align;\t\t\t\t\tthis.obj.onclick = function(e){(e||event).cancelBubble = true}\t\t\t\t\tthis.obj.onmousedown = function(e){(e||event).cancelBubble = true}\t\t\t\t\tthis.obj.value = this.getValue();\t\t\t\t\tthis.cell.innerHTML = \"\";\t\t\t\t\tthis.cell.appendChild(this.obj);\t\t\t\t  \tif (_isFF) {\t\t\t\t\t\tthis.obj.style.overflow=\"visible\";\t\t\t\t\t\tif ((this.grid.multiLine)&&(this.obj.offsetHeight>=18)&&(this.obj.offsetHeight<40)){\t\t\t\t\t\t\tthis.obj.style.height=\"36px\";\t\t\t\t\t\t\tthis.obj.style.overflow=\"scroll\";\t\t\t\t\t\t}\t\t\t\t\t}                    this.obj.onselectstart=function(e){  if (!e) e=event; e.cancelBubble=true; return true;  };\t\t\t\t\tthis.obj.focus()  \t\t\t\t\tthis.obj.focus()\t\t\t\t                    \t\t\t\t}//============================================================function getSingleItemtest-grid-id(siteid,webid,listid,itemid,rowid){\tvar val = SP.UI.Notify.addNotification(\"Updating Saved Row...\", false,  \"\", null);\tdhtmlxAjax.post(singleItemUrltest-grid-id, \"siteid=\" + siteid + \"&webid=\" + webid + \"&listid=\" + listid + \"&itemid=\" + itemid + \"&rowid=\" + rowid,getSingleItemResponsetest-grid-id);}function getSingleItemResponsetest-grid-id(loader){\tif(loader.xmlDoc.responseText!=null)\t{\t\tvar xmlDoc = loader.xmlDoc.responseXML;\t\tfor(var i = 0;i<xmlDoc.childNodes.length;i++)\t\t{\t\t\tvar rowXml = xmlDoc.childNodes[i];\t\t\tsetRowValuestest-grid-id(rowXml);\t\t}\t}\telse\t\talert(\"Response contains no XML\");}function setRowValuestest-grid-id(rowsXml){\tfor(var i = 0;i<rowsXml.childNodes.length;i++)\t{\t\tsetRowValuetest-grid-id(rowsXml.childNodes[i])\t}}function setRowValuetest-grid-id(rowXml){\tvar rowId = rowXml.getAttribute(\"id\")\t\tvar cellCounter = 0;\tfor(var i = 0;i<rowXml.childNodes.length;i++)\t{\t\tif(rowXml.childNodes[i].nodeName == \"userdata\")\t\t{\t\t\tif(rowXml.childNodes[i].firstChild != null)\t\t\t\tmygridtest-grid-id.setUserData(rowId,rowXml.childNodes[i].getAttribute(\"name\"),rowXml.childNodes[i].firstChild.nodeValue);\t\t}\t\telse if(rowXml.childNodes[i].nodeName == \"cell\")\t\t{\t\t\tif(!inEditModetest-grid-id)\t\t\t{\t\t\t\tif(mygridtest-grid-id.getColType(cellCounter) != \"tree\")\t\t\t\t\tmygridtest-grid-id.setCellExcellType(rowId, cellCounter, \"ro\");\t\t\t\t\t\t\t\t\tmygridtest-grid-id.lockRow(rowId, true);\t\t\t}\t\t\t\t\t\tvar cellval = \"\";\t\t\tvar celltype = \"\";\t\t\ttry\t\t\t{\t\t\t\tcelltype = rowXml.childNodes[i].getAttribute(\"type\");\t\t\t}catch(e){}\t\t\t\t\t\t\t\t\tif(rowXml.childNodes[i].childNodes.length > 0)\t\t\t{\t\t\t\tcellval = rowXml.childNodes[i].firstChild.nodeValue;\t\t\t}\t\t\t\t\t\tif(celltype == \"combo\")\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(rowXml.childNodes[i]);\t\t\t\telse\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(cellval);\t\t\t\tcellCounter++;\t\t}\t}\t}function saveGridtest-grid-id(){\tmygridtest-grid-id.editStop();    sm('dlgSavingtest-grid-id',200,100);    if(myDataProcessortest-grid-id.updatedRows.length > 0)    {        myDataProcessortest-grid-id.sendData();    }    else        hm('dlgSavingtest-grid-id');}function onButtonClicktest-grid-id(menuitemId,grid_Id,grid){    var rowIdFull = grid_Id.split(\"_\")[0];    var weburl = context_grid.getUserData(rowIdFull,\"SiteUrl\");    var listId = context_grid.getUserData(rowIdFull,\"listid\");    var editurl = context_grid.getUserData(rowIdFull,\"editurl\");    var viewurl = context_grid.getUserData(rowIdFull,\"viewurl\");    var itemId = context_grid.getUserData(rowIdFull,\"itemid\");    var webId = context_grid.getUserData(rowIdFull,\"webid\");    var siteid = context_grid.getUserData(rowIdFull,\"siteid\");    var rowId = rowIdFull.split('.')[1];        var popup = context_grid.getUserData(rowIdFull,\"popup\");    var w = pageWidth() - 200;\tvar h = pageHeight() - 100;             switch(menuitemId)    {\t\tcase \"createworkspace\":\t\t\turl = weburl + \"/_layouts/epmlive/requestworkspace.aspx?list=\" + listidtest-grid-id + \"&ID=\" + itemId;\t\t\tdocument.location.href=url;\t\t\t\t\t\tbreak;\t\tcase \"workspace\":\t\t\tif(viewurl == null)                url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=workspace&webid=\" + webId ;            else                url = weburl;                \t\t\tdocument.location.href=url;\t\t\tbreak;\t\t\t\tcase \"workplan\":\t\t\tif(viewurl == null)\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=workplan&webid=\" + webId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\telse\t\t\t\turl = weburl + \"/_layouts/epmlive/tasks.aspx?ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t\t\t\t\tdocument.location.href=url;\t\t\tbreak;\t\t\t\t\tcase \"agile\":\t\t\tif(viewurl == null)\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=agile&webid=\" + webId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\telse\t\t\t\turl = weburl + \"/_layouts/epmlive/agile/tasks.aspx?ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t\t\t\t\tdocument.location.href=url;\t\t\tbreak;\t\t\t\tcase \"projectpro\":\t\t\tif(viewurl == null)\t\t\t{\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=getproject&webid=\" + webId + \"&ID=\" + itemId + \"&listID=\" + listId + \"&Source=\" + document.location.href;;\t\t\t\tdocument.location.href=url;\t\t\t}\t\t\telse\t\t\t{\t\t\t\tjavascript:window.open(weburl + '/_layouts/epmlive/getproject.aspx?listID=' + listId + '&ID=' + itemId,'', config='height=100,width=200, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, directories=no, status=no');\t\t\t}\t\t\tbreak;\t\t        case \"edit\":            var url = \"\";            if(popup==\"yes\")            {\t\t\t\t\t\t\t\tvar url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=viewedit2&ListId=\" + listId + \"&ID=\" + itemId + \"&Mode=2&gridid=test-grid-id&siteid=\" + siteid + \"&webid=\" + webId + \"&rowid=\" + rowIdFull;\t\t\t\tsm('editItemtest-grid-id',w,h);\t\t\t\tdocument.getElementById(\"frmEditFrametest-grid-id\").src = url;            }            else            {\t\t\t\tif(editurl == null)\t\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=edit&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t\telse\t\t\t\t\turl = editurl + \"?ListId=\" + listId + \"&ID=\" + itemId + \"&Mode=2&Source=\" + document.location.href;\t\t\t\tdocument.location.href=url;            }            break;        case \"perms\":\t\t\tvar url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=perms&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t            //var url = weburl + \"/_layouts/User.aspx?obj={\" + listId + \"},\" + itemId + \",LISTITEM&List={\" + listId + \"}&Source=\" + document.location.href;            document.location.href=url;            break;        case \"view\":\t\t\tif(popup==\"yes\")            {\t\t\t\tvar url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=viewedit2&ListId=\" + listId + \"&ID=\" + itemId + \"&Mode=1&gridid=test-grid-id&siteid=\" + siteid + \"&webid=\" + webId + \"&rowid=\" + rowIdFull;\t\t\t\tsm('editItemtest-grid-id',w,h);\t\t\t\tdocument.getElementById(\"frmEditFrametest-grid-id\").src=url;            }            else            {\t\t\t\tvar url;\t\t\t\tif(viewurl == null)\t\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=view&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t\telse\t\t\t\t\turl = viewurl + \"?ListId=\" + listId + \"&ID=\" + itemId + \"&Mode=1&Source=\" + document.location.href;\t\t\t\tdocument.location.href=url;            }            break;        case \"delete\":            if(confirm('Are you sure you want to send this item to the Recycle Bin?')){                var url;                if(viewurl == null)                {                    url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=delete&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&NextUsing=\" + document.location.href;                    document.location.href=url;                }                else                {                                            postDelete(weburl + '/_vti_bin/owssvr.dll?CS=65001&Cmd=Delete&List={' + listId + '}&ID=' + itemId + '&NextUsing=' + document.location.href);                                     }            };            break;        case \"alerts\":            var url;            if(viewurl == null)                url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=alerts&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;            else                url = weburl + \"/_layouts/SubNew.aspx?List={\" + listId + \"}&ID=\" + itemId + \"&Source=\" + document.location.href;                            document.location.href=url;            break;        case \"versions\":            var url = weburl + \"/_layouts/Versions.aspx?list={\" + listId + \"}&ID=\" + itemId + \"&Source=\" + document.location.href;            document.location.href=url;            break;        case \"approve\":            var url = weburl + \"/_layouts/approve.aspx?list={\" + listId + \"}&ID=\" + itemId + \"&Source=\" + document.location.href;            document.location.href=url;            break;        case \"workflows\":            var url = weburl + \"/_layouts/Workflow.aspx?list={\" + listId + \"}&ID=\" + itemId + \"&Source=\" + document.location.href;            document.location.href=url;            break;    };}function redoCss(rowindex){\tvar j = rowindex;\tfor (var i = rowindex; i < mygridtest-grid-id.rowsCol.length; i++){\t\t\tif (!mygridtest-grid-id.rowsCol[i])\t\t\t\tcontinue;\t\t\tif (mygridtest-grid-id.rowsCol[i].style.display != \"none\"){\t\t\t\tif (mygridtest-grid-id.rowsCol[i].className.indexOf(\"rowselected\") != -1){\t\t\t\t\tif (j%2 == 1)\t\t\t\t\t\tmygridtest-grid-id.rowsCol[i].className=mygridtest-grid-id._cssUnEven+\" rowselected \"+(mygridtest-grid-id.rowsCol[i]._css||\"\");\t\t\t\t\telse\t\t\t\t\t\tmygridtest-grid-id.rowsCol[i].className=mygridtest-grid-id._cssEven+\" rowselected \"+(mygridtest-grid-id.rowsCol[i]._css||\"\");\t\t\t\t} else {\t\t\t\t\tif (j%2 == 1)\t\t\t\t\t\tmygridtest-grid-id.rowsCol[i].className=mygridtest-grid-id._cssUnEven+(mygridtest-grid-id.rowsCol[i]._css||\"\");\t\t\t\t\telse\t\t\t\t\t\tmygridtest-grid-id.rowsCol[i].className=mygridtest-grid-id._cssEven+(mygridtest-grid-id.rowsCol[i]._css||\"\");\t\t\t\t}\t\t\t\tj++;\t\t\t}\t\t}}function leavePagetest-grid-id(e){\tvar hasupdates = false;\t\tfor(var i = 0;i < myDataProcessortest-grid-id.updatedRows.length;i++)\t{\t\tif(myDataProcessortest-grid-id.updatedRows[i] != null)\t\t{\t\t\thasupdates = true;\t\t}\t}    if(hasupdates )    {        if(!e) e = window.event;\t    //e.cancelBubble is supported by IE - this will kill the bubbling process.\t    //e.cancelBubble = true;\t    e.returnValue = 'You have unsaved changes.'; //This is displayed on the dialog\t    if (e.stopPropagation) {\t\t    e.stopPropagation();\t\t    e.preventDefault();\t    }    }}function URLEncode( plaintext ){\t// The Javascript escape and unescape functions do not correspond\t// with what browsers actually do...\tvar SAFECHARS = \"0123456789\" +\t\t\t\t\t// Numeric\t\t\t\t\t\"ABCDEFGHIJKLMNOPQRSTUVWXYZ\" +\t// Alphabetic\t\t\t\t\t\"abcdefghijklmnopqrstuvwxyz\" +\t\t\t\t\t\"-_.!~*'()\";\t\t\t\t\t// RFC2396 Mark characters\tvar HEX = \"0123456789ABCDEF\";\tvar encoded = \"\";\tfor (var i = 0; i < plaintext.length; i++ ) {\t\tvar ch = plaintext.charAt(i);\t    if (ch == \" \") {\t\t    encoded += \"+\";\t\t\t\t// x-www-urlencoded, rather than %20\t\t} else if (SAFECHARS.indexOf(ch) != -1) {\t\t    encoded += ch;\t\t} else {\t\t    var charCode = ch.charCodeAt(0);\t\t\tif (charCode > 255) {\t\t\t    alert( \"Unicode Character '\"                         + ch                         + \"' cannot be encoded using standard URL encoding.\\n\" +\t\t\t\t          \"(URL encoding only supports 8-bit characters.)\\n\" +\t\t\t\t\t\t  \"A space (+) will be substituted.\" );\t\t\t\tencoded += \"+\";\t\t\t} else {\t\t\t\tencoded += \"%\";\t\t\t\tencoded += HEX.charAt((charCode >> 4) & 0xF);\t\t\t\tencoded += HEX.charAt(charCode & 0xF);\t\t\t}\t\t}\t}\treturn encoded;};function checkMintest-grid-id(rowId,cellIndex,value){    if(minValuestest-grid-id[cellIndex] != \"\")    {        var val = parseFloat(value);        var min = parseFloat(minValuestest-grid-id[cellIndex]);        if(val < min)        {            alert('You must enter a value greater than ' + min);            return false;        }    }    return true;}function checkMaxtest-grid-id(rowId,cellIndex,value){    if(maxValuestest-grid-id[cellIndex] != \"\")    {        var val = parseFloat(value);        var max = parseFloat(maxValuestest-grid-id[cellIndex]);        if(val > max)        {            alert('You must enter a value less than ' + max);                        return false;        }    }    return true;}dhtmlXGridObject.prototype._in_header_master_checkbox2 = function (t, i, c) { \tt.innerHTML = c[0] + \"<input type='checkbox' />\" + c[1]; \tvar self = this; \tt.firstChild.onclick = function (e) \t{ \t\tself._build_m_order(); \t\tvar j = self._m_order ? self._m_order[i] : i;\t\tvar val = this.checked;// ? true : false;\t\tself.forEachRow(function (id) {\t\t\tvar c = this.cells(id, j);\t\t\tif (c.isCheckbox() && !c.cell.firstChild.disabled)\t\t\t{\t\t\t\tc.cell.firstChild.checked = val;\t\t\t\tif(val)\t\t\t\t\tc.cell.firstChild.style.display = \"\";\t\t\t\telse\t\t\t\t\tc.cell.firstChild.style.display = \"none\";\t\t\t}\t\t});\t\t(e || event).cancelBubble = true;\t} };dhtmlXGridObject.prototype.checksubs = function(row){\tvar rowid = row.parentNode.parentNode.idd;\tif(this.hasChildren(rowid) > 0)\t{\t\tvar rowids = this.getAllSubItems(rowid).split(',');\t\tfor(var i = 0;i<rowids.length;i++)\t\t{\t\t\tvar curRow = rowids[i];\t\t\tthis.cells(curRow, 0).cell.firstChild.checked = row.checked;\t\t\tif(row.checked)\t\t\t\tthis.cells(curRow, 0).cell.firstChild.style.display = \"\";\t\t\telse\t\t\t\tthis.cells(curRow, 0).cell.firstChild.style.display = \"none\";\t\t}\t\t\t}};window.onbeforeunload=leavePagetest-grid-id;minValuestest-grid-id = [\"\",\"1\"];maxValuestest-grid-id = [\"\",\"1\"];var singleEditItemUrltest-grid-id;var inEditModetest-grid-id;function fireEvent(element,event){    if (document.createEventObject){        // dispatch for IE        var evt = document.createEventObject();        return element.fireEvent('on'+event,evt)    }    else{        // dispatch for firefox + others        var evt = document.createEvent(\"HTMLEvents\");        evt.initEvent(event, true, true ); // event type,bubbling,cancelable        return !element.dispatchEvent(evt);    }}function editRowtest-grid-id(rowid){\tvar EditCol = getEditColtest-grid-id();        if(EditCol != null)    {    \t\tvar listId = mygridtest-grid-id.getUserData(rowid,\"listid\");\t\tvar itemId = mygridtest-grid-id.getUserData(rowid,\"itemid\");\t\tvar webId = mygridtest-grid-id.getUserData(rowid,\"webid\");\t\tvar siteId = mygridtest-grid-id.getUserData(rowid,\"siteid\");    \t\tmygridtest-grid-id.cells(rowid, EditCol).setValue(\"<img src='/_layouts/epmlive/images/loader1.gif'>\");\t\tdhtmlxAjax.post(singleEditItemUrltest-grid-id, \"siteid=\" + siteId + \"&webid=\" + webId + \"&listid=\" + listId + \"&itemid=\" + itemId + \"&rowid=\" + rowid,editRowResponsetest-grid-id);    }}function getEditColtest-grid-id(){\tvar EditCol;\tfor(var i = 0;i<mygridtest-grid-id.getColumnsNum();i++)    {        if(mygridtest-grid-id.getColumnId(i) == \"<![CDATA[Edit]]>\")        {            EditCol = i;\t\t\tbreak;        }    }    return EditCol;}function editRowResponsetest-grid-id(loader){\tif(loader.xmlDoc.responseText!=null)\t{\t\t\tvar xmlDoc = loader.xmlDoc.responseXML;\t\tfor(var i = 0;i<xmlDoc.childNodes.length;i++)\t\t{\t\t\tvar rowXml = xmlDoc.childNodes[i];\t\t\tsetEditRowstest-grid-id(rowXml);\t\t\t}\t}\telse\t\talert(\"Response contains no XML\");}function setEditRowstest-grid-id(rowsXml){\tfor(var i = 0;i<rowsXml.childNodes.length;i++)\t{\t\tsetEditRowtest-grid-id(rowsXml.childNodes[i])\t}}function setEditRowtest-grid-id(rowXml){\tvar rowId = rowXml.getAttribute(\"id\")\t\tvar cellCounter = 0;\tmygridtest-grid-id.lockRow(rowId, false);\tfor(var i = 0;i<rowXml.childNodes.length;i++)\t{\t\tif(rowXml.childNodes[i].nodeName == \"userdata\")\t\t{\t\t\t//mygridtest-grid-id.setUserData(rowId,rowXml.childNodes[i].getAttribute(\"name\"),rowXml.childNodes[i].firstChild.nodeValue);\t\t}\t\telse if(rowXml.childNodes[i].nodeName == \"cell\")\t\t{\t\t\tvar cellval = \"\";\t\t\tvar celltype = \"\";\t\t\ttry\t\t\t{\t\t\t\tcelltype = rowXml.childNodes[i].getAttribute(\"type\");\t\t\t}catch(e){}\t\t\tif(rowXml.childNodes[i].childNodes.length > 0)\t\t\t{\t\t\t\tcellval = rowXml.childNodes[i].firstChild.nodeValue;\t\t\t}\t\t\tif(celltype == \"combo\")\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(rowXml.childNodes[i]);\t\t\t\telse\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(cellval);\t\t\t\t\t\t\tif(celltype != null)\t\t\t{\t\t\t\tmygridtest-grid-id.setCellExcellType(rowId, i, celltype);\t\t\t}\t\t\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(cellval);\t\t\t\tcellCounter++;\t\t}\t}\tvar EditCol = getEditColtest-grid-id();    \tif(EditCol != null)\t{\t\tmygridtest-grid-id.cells(rowId, EditCol).setValue(\"<a onclick=\\\"javascript:saveEdittest-grid-id('\" + rowId + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/saveitem.gif\\\" border=\\\"0\\\" alt=\\\"Save\\\"></a> <a onclick=\\\"javascript:cancelEditRowtest-grid-id('\" + rowId + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/close.gif\\\" border=\\\"0\\\" alt=\\\"Cancel\\\"></a>\");\t}}function saveEdit2test-grid-id(rowid){\tmygridtest-grid-id.editStop();\t\trow = mygridtest-grid-id.getRowById(rowid);\t\tvar cols = row.childNodes.length;\tvar changed = false;\tfor (var j = 0; j < cols; j++)\t\tif (row.childNodes[j].wasChanged){\t\t\tchanged = true;\t\t\tbreak;\t\t}\t\tvar EditCol = getEditColtest-grid-id();\t    if(EditCol != null)\t\tmygridtest-grid-id.cells(rowid, EditCol).setValue(\"<img src='/_layouts/epmlive/images/loader1.gif'>\");\t\t\t\tif(changed)\t\tmyDataProcessortest-grid-id.sendData(rowid);\telse\t\tcancelEditRowtest-grid-id(rowid);}function saveEdittest-grid-id(rowid){\tsetTimeout(\"saveEdit2test-grid-id('\" + rowid + \"')\", 100);}function cancelEditRowtest-grid-id(rowid){\tvar EditCol = getEditColtest-grid-id();\t    mygridtest-grid-id.lockRow(rowid, true);    myDataProcessortest-grid-id.setUpdated(rowid, false, null);        if(EditCol != null)    {\t\tvar listid = mygridtest-grid-id.getUserData(rowid,\"listid\");\t\tvar itemid = mygridtest-grid-id.getUserData(rowid,\"itemid\");\t\tvar webid = mygridtest-grid-id.getUserData(rowid,\"webid\");\t\tvar siteid = mygridtest-grid-id.getUserData(rowid,\"siteid\");\t\tmygridtest-grid-id.cells(rowid, EditCol).setValue(\"<img src='/_layouts/epmlive/images/loader1.gif'>\");\t\tdhtmlxAjax.post(singleItemUrltest-grid-id, \"edit=false&siteid=\" + siteid + \"&webid=\" + webid + \"&listid=\" + listid + \"&itemid=\" + itemid + \"&rowid=\" + rowid,cancelEditRowResponsetest-grid-id);\t}\t}function cancelEditRowResponsetest-grid-id(loader){\tif(loader.xmlDoc.responseText!=null)\t{\t\tvar xmlDoc = loader.xmlDoc.responseXML;\t\t\t\tfor(var i = 0;i<xmlDoc.childNodes.length;i++)\t\t{\t\t\tvar rowXml = xmlDoc.childNodes[i];\t\t\tsetCRowValuestest-grid-id(rowXml);\t\t}\t}\telse\t\talert(\"Response contains no XML\");}function setCRowValuestest-grid-id(rowsXml){\tfor(var i = 0;i<rowsXml.childNodes.length;i++)\t{\t\tsetCRowValuetest-grid-id(rowsXml.childNodes[i])\t}}function setCRowValuetest-grid-id(rowXml){\tvar rowId = rowXml.getAttribute(\"id\");\tvar cellCounter = 0;\t\tfor(var i = 0;i<rowXml.childNodes.length;i++)\t{\t\tif(rowXml.childNodes[i].nodeName == \"userdata\")\t\t{\t\t\t//mygridtest-grid-id.setUserData(rowId,rowXml.childNodes[i].getAttribute(\"name\"),rowXml.childNodes[i].text);\t\t}\t\telse if(rowXml.childNodes[i].nodeName == \"cell\")\t\t{\t\t\tvar cellval = \"\";\t\t\t\t\t\tif(rowXml.childNodes[i].childNodes.length > 0)\t\t\t{\t\t\t\tcellval = rowXml.childNodes[i].firstChild.nodeValue;\t\t\t}\t\t\tif(mygridtest-grid-id.getColType(cellCounter) != \"tree\")\t\t\t\tmygridtest-grid-id.setCellExcellType(rowId, cellCounter, \"ro\");\t\t\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(cellval);\t\t\t\t\t\t\tcellCounter++;\t\t}\t}\t\tvar EditCol;\tfor(var i = 0;i<mygridtest-grid-id.getColumnsNum();i++)\t{\t\tif(mygridtest-grid-id.getColumnId(i) == \"<![CDATA[Edit]]>\")\t\t{\t\t\tEditCol = i;\t\t\tbreak;\t\t}\t}    \tif(EditCol != null)\t{\t\tmygridtest-grid-id.cells(rowId, i).setValue(\"<a onclick=\\\"javascript:editRowtest-grid-id('\" + rowId + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/edit.gif\\\" border=\\\"0\\\"></a>\");\t}}function ChangePagetest-grid-id(pg){curPagetest-grid-id = pg;loadXtest-grid-id(sftest-grid-id, svtest-grid-id, sttest-grid-id);}function NextPagetest-grid-id(){if(lastItemtest-grid-id != 0){curPagetest-grid-id = lastItemtest-grid-id;loadXtest-grid-id(sftest-grid-id, svtest-grid-id, sttest-grid-id);}}function PreviousPagetest-grid-id(){if(fItemHidetest-grid-id != firstItemtest-grid-id){curPagetest-grid-id = firstItemtest-grid-id;loadXtest-grid-id(sftest-grid-id, svtest-grid-id, sttest-grid-id);}}function loadXtest-grid-id(searchfield, searchvalue, searchtype){var ribbontestintervall = null; mygridwidthtest-grid-id = document.getElementById('WebPartdummy').offsetWidth - 25;if(searchfield){searchvalue = escape(searchvalue);mygridtest-grid-id.post(\"http://fake.url/_layouts/epmlive/getgriditems.aspx\",\"data=&edit=false&insertrow=False&width=\" + mygridwidthtest-grid-id + \"&searchfield=\" + searchfield + \"&searchvalue=\" + searchvalue + \"&searchtype=\" + searchtype + \"&page=\" + curPagetest-grid-id + \"&source=http%3a%2f%2ffake.url%2f\");}else{mygridtest-grid-id.post(\"http://fake.url/_layouts/epmlive/getgriditems.aspx\",\"data=&edit=false&insertrow=False&width=\" + mygridwidthtest-grid-id + \"&page=\" + curPagetest-grid-id + \"&source=http%3a%2f%2ffake.url%2f\");}}function showrib(){setTimeout(\"clickTab()\", 1);}function clickTab(){try{var wp = document.getElementById('MSOZoneCell_WebPartdummy');WpClick({target: wp});}catch(e){}}function clickbrowse(){try{var wp2 = document.getElementById('Ribbon.Read-title').firstChild;fireEvent(wp2, 'click');}catch(e){}}setTimeout(\"clickTab()\", 1000);_spBodyOnLoadFunctionNames.push(\"loadXtest-grid-id('test-search-field','test-search-string','1')\");</script><div id=\"dlgSavingtest-grid-id\" class=\"dialog\">    <table width=\"100%\">        <tr>            <td align=\"center\" class=\"ms-sectionheader\">                <img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/><br />                <H3 class=\"ms-standardheader\">Saving Items...</h3>            </td>        </tr>    </table></div> <div id=\"dlgRefreshtest-grid-id\" class=\"dialog\">    <table width=\"100%\">        <tr>            <td align=\"center\" class=\"ms-sectionheader\">                <img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/><br />                <H3 class=\"ms-standardheader\">Refreshing Data...</h3>            </td>        </tr>    </table></div> <div id=\"dlgErrortest-grid-id\" class=\"dialog\">    <table width=\"100%\" height=\"100%\" cellpadding=\"0\" cellspacing=\"3\">\t\t<tr>\t\t\t<td class=\"ms-sectionheader\"><H3 class=\"ms-standardheader\">Error: </h3></td>\t\t</tr>        <tr height=\"100%\">            <td align=\"left\"valign=\"top\">                <div id=\"dlgErrorTexttest-grid-id\" style=\"overflow: auto;height=90%;width=100%\" class=\"ms-descriptiontext\"></div><br>            </td>        </tr>        <tr>\t\t\t<td align=\"right\">\t\t\t\t<input type=\"button\" class=\"ms-input\" value=\"Close\" onClick=\"hm('dlgErrortest-grid-id');\">\t\t\t</td>\t\t</tr>    </table></div><div id=\"editItemtest-grid-id\" class=\"dialog\">    <table width=\"100%\" height=\"100%\" id=\"tblEditItem\" cellpadding=\"0\" cellspacing=\"0\">        <tr height=\"100%\">            <td align=\"center\" bgcolor=\"FFFFFF\">                <div id=\"editItemLoadtest-grid-id\">                    <img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/>                </div>                <iframe id=\"frmEditFrametest-grid-id\" width=\"100%\" height=\"100%\" frameborder=\"0\" src=\"http://fake.url/_layouts/epmlive/blank.gif\">                                    </iframe>            </td>        </tr>    </table></div><div id=\"dlgPosting\" class=\"dialog\">    <table width=\"100%\">        <tr>            <td align=\"center\" class=\"ms-sectionheader\">                <img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/><br />                <H3 class=\"ms-standardheader\">Posting Data...</h3>            </td>        </tr>    </table></div> <script>var bPageSetuptest-grid-id;var firstItemtest-grid-id;var lastItemtest-grid-id;var fItemHidetest-grid-id;function setupPagetest-grid-id(records, UseReporting, PageSize){\tvar pages = Math.ceil(records / PageSize);\tvar prev = document.getElementById(\"PagePrevioustest-grid-id\");\tvar next = document.getElementById(\"PageNexttest-grid-id\");\tvar pagediv = document.getElementById(\"pagedivtest-grid-id\");\tif(UseReporting)\t{\t\tif(pages > 1)\t\t{\t\t\tif(!bPageSetuptest-grid-id)\t\t\t{\t\t\t\tbPageSetuptest-grid-id = true;\t\t\t\t$(\"#pagedivtest-grid-id\").paginate({\t\t\t\t\tcount \t\t: pages,\t\t\t\t\tstart \t\t: 1,\t\t\t\t\tdisplay     : 12,\t\t\t\t\tborder\t\t\t\t\t: true,\t\t\t\t\tborder_color\t\t\t: '#CCCCCC',\t\t\t\t\ttext_color  \t\t\t: '#666666',\t\t\t\t\tbackground_color    \t: '#DDDDDD',\t\t\t\t\t\tborder_hover_color\t\t: '#878787',\t\t\t\t\ttext_hover_color  \t\t: '#ffffff',\t\t\t\t\tbackground_hover_color\t: '#9B9B9B', \t\t\t\t\trotate      : false,\t\t\t\t\timages\t\t: false,\t\t\t\t\tmouse\t\t: 'press',\t\t\t\t\tonChange\t: ChangePagetest-grid-id\t\t\t\t});\t\t\t}\t\t}\t\telse\t\t{\t\t\tpagediv.style.display = \"none\";\t\t}\t}\telse\t{\t\tpagediv.style.display = \"inline-block\";\t\tvar rec = records.split('|');\t\tfirstItemtest-grid-id = parseInt(rec[2]) * -1;\t\tlastItemtest-grid-id = rec[1];\t\tif(rec[0] == \"0\" || fItemHidetest-grid-id == firstItemtest-grid-id)\t\t{\t\t\tprev.style.background = \"#EFEFEF\";\t\t\tfItemHidetest-grid-id = firstItemtest-grid-id;\t\t}\t\telse\t\t{\t\t\tprev.style.background = \"#DDDDDD\";\t\t}\t\tif(rec[3] == \"true\")\t\t\tnext.style.background = \"#DDDDDD\";\t\telse\t\t{\t\t\tprev.style.background = \"#EFEFEF\";\t\t\tlastItemtest-grid-id = 0;\t\t}\t\tif(rec[3] != \"true\" && rec[0] == \"0\")\t\t{\t\t\tpagediv.style.display = \"none\";\t\t}\t}}</script><script>initmb();</script>"));
        }

        [TestMethod]
        public void GridListView_renderGrid_GivenArguments_RowLimitGreaterThanZero_ConfirmOutput()
        {
            // Arrange
            SetupShims();
            ShimSPView.AllInstances.RowLimitGet = (_) => 1;

            // Act
            _testablePrivate.Invoke("renderGrid",
                new object[] { writer, web });

            // Assert
            _testablePrivate.ShouldSatisfyAllConditions(
                () => writeCount.ShouldBe(335),
                () => writerContent.ToString().Length.ShouldBe(75221),
                () => writerContent.ToString().ShouldBe("<style>.ms-usereditor { width:200px; }.grid_hover { border: 10px solid #91CDF2; background-color: #F2FAFF } </style><div id=\"peoplegrid\" style=\"display:none; border: 1px solid #808080; padding: 3px; background-color: #F9F9F9; width=200px;\"><div id=\"peoplechecktest-grid-id\" style=\"overflow: auto; width: 200px; height: 100px;  background-color: #FFFFFF; border: 1px solid #808080; margin-top:2px; padding:3px;\" class=\"ms-descriptiontext\"></div><table border=\"0\" width=\"100%\"><tr><td><a onclick=\"javascript:viewCheckstest-grid-id('test-grid-id');\"><img id=\"peoplecheckimgtest-grid-id\" src=\"_layouts/images/TPMAX1.GIF\" border=\"0\"></a><br></td><td align=\"right\"><font class=\"ms-descriptiontext\"><a onclick=\"javascript:mygridtest-grid-id.editStop();\">Close</a></font></td></tr></table><div id=\"divPetest-grid-id\" style=\"display:none;\"></div></div><div id=\"peoplesinglegrid\" style=\"display:none; border: 1px solid #808080; padding: 3px; background-color: #F9F9F9; width=200px;\"><div id=\"peoplechecksingletest-grid-id\" style=\"width: 200px; height: 100px;  background-color: #FFFFFF; border: 1px solid #808080; margin-top:2px; padding:0px;\" class=\"ms-descriptiontext\"><select size=\"6\" onclick=\"changeUsertest-grid-id(this);\" id=\"peoplecheckselecttest-grid-id\"  style=\"width:100%;height:100%\"><option>test</option></select></div><table border=\"0\" width=\"200\"><tr><td><a onclick=\"javascript:viewDropDowntest-grid-id('test-grid-id');\"><img id=\"peoplechecksingleimgtest-grid-id\" src=\"_layouts/images/TPMAX1.GIF\" border=\"0\"></a><br></td><td align=\"right\"><font class=\"ms-descriptiontext\"><a onclick=\"javascript:mygridtest-grid-id.editStop();\">Close</a></font></td></tr></table><div id=\"divPestest-grid-id\" style=\"display:none;\"></div></div><div id=\"multichoicegrid\" style=\"display:none; border: 1px solid #808080; padding: 3px; background-color: #F9F9F9; width:200px;height:180px\"><div id=\"multichoiceinnertest-grid-id\" style=\"width: 195px; height: 160px;  background-color: #FFFFFF; border: 1px solid #808080; margin-top:2px; padding:0px;overflow:auto\" class=\"ms-descriptiontext\">test</div><table border=\"0\" width=\"200\"><tr><td align=\"right\"><font class=\"ms-descriptiontext\"><a onclick=\"javascript:mygridtest-grid-id.editStop();\">Close</a></font></td></tr></table></div><div id=\"gridmenutest-grid-id\" style=\"position:absolute;left:0px;display:none;\" class=\"js-callout-mainElement ms-core-defaultFont  ms-alignLeft ms-shadow\"><ul class=\"ms-core-menu-list\" style=\"width: 173px;\"></ul></div><script>_css_prefix=\"/_layouts/epmlive/DHTML/xgrid/\"; _js_prefix=\"/_layouts/epmlive/DHTML/xgrid/\"; </script><script src=\"_layouts/epmlive/DHTML/xgrid/dhtmlxcommon.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/dhtmlxgrid.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/dhtmlxgridcell.js\"></script><script src=\"_layouts/epmlive/DHTML/xtreegrid/dhtmlxtreegrid.js\"></script><script src=\"_layouts/epmlive/DHTML/xtreegrid/ext/dhtmlxtreegrid_filter.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_post.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_nxml.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_filter.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_math.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_srnd.js\"></script><script src=\"/_layouts/epmlive/DHTML/xgrid/excells/dhtmlxgrid_excell_calendar.js\"></script><script src=\"/_layouts/epmlive/DHTML/xgrid/excells/dhtmlxgrid_excell_combo.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/excells/dhtmlxgrid_excell_dhxcalendar.js\"></script><script src=\"_layouts/epmlive/DHTML/xcombo/dhtmlxcombo.js\"></script><script src=\"_layouts/epmlive/DHTML/calendar/dhtmlxcalendar.js\"></script><script src=\"_layouts/epmlive/DHTML/xdataproc/dhtmlxdataprocessor.js\"></script><script type=\"text/javascript\" src=\"_layouts/epmlive/modal/modal.js\"></script> <script language=\"JavaScript\" src=\"_layouts/epmlive/dhtml/xmenu/dhtmlxmenu.js\"></script><script language=\"JavaScript\" src=\"_layouts/epmlive/dhtml/xmenu/ext/dhtmlxmenu_ext.js\"></script><style>.menuTable{background-color:#ffffff;}.secondMenuTable{background-color:#ffffff;}.contextMenuover, .contextMenudown{background-color:#9ac2e5;}.contextMenuover td{color:#000000;} </style><script src=\"_layouts/epmlive/epmlivegrid.js\"></script><script language=\"javascript\">var searchfieldstest-grid-id = {test-field: [ \"Yes\", \"No\" ]};function switchsearchtest-grid-id()            {                var searcher = document.getElementById('searchtest-grid-id');                var searchtext = document.getElementById('searchtexttest-grid-id');                var searchchoice = document.getElementById('searchchoicetest-grid-id');                var searchtypechoice = document.getElementById('searchtypetest-grid-id');                var searchfield = searcher.options[searcher.selectedIndex].value;                var sList = searchfieldstest-grid-id[searchfield];                if(sList) {                    searchtext.style.display='none';                    searchchoice.style.display='';                    searchchoice.options.length = 0;                    searchtypechoice.options[2].selected = true;                    searchtypechoice.disabled = true;                    for(var i=0; i < sList.length; i++) {                        var d = sList[i];                        searchchoice.options.add(new Option(d, d));                        if(d=='test-search-string') {                            searchchoice.options[searchchoice.options.length-1].selected = true;                        }                     }                 } else {                    searchtext.style.display='';                    searchchoice.style.display='none';                    searchtypechoice.disabled = false;                }            }function unSearchtest-grid-id(){var gri = document.getElementById('grid');gri.style.display = 'none';var loader = document.getElementById('loadinggrid');loader.style.display = '';var unsearch = document.getElementById('unsearchtest-grid-id');unsearch.style.display=\"none\";var searchtext = document.getElementById('searchtexttest-grid-id');searchtext.value = '';curPagetest-grid-id = 0;sftest-grid-id = null;svtest-grid-id = null;sttest-grid-id = null;loadXtest-grid-id();}function doSearchtest-grid-id(){var gri = document.getElementById('grid');                     gri.style.display = 'none';                     var loader = document.getElementById('loadinggrid');                     loader.style.display = '';                var searcher = document.getElementById('searchtest-grid-id');                var unsearch = document.getElementById('unsearchtest-grid-id');                unsearch.style.display=\"table-cell\";                var searchchoice = document.getElementById('searchchoicetest-grid-id');                var searchtext = document.getElementById('searchtexttest-grid-id');                var searchtypechoice = document.getElementById('searchtypetest-grid-id');                var searchfield = searcher.options[searcher.selectedIndex].value;                var searchtype = searchtypechoice.options[searchtypechoice.selectedIndex].value;                var sList = searchfieldstest-grid-id[searchfield];                var searchvalue = \"\";                if(sList){                    searchvalue = searchchoice.options[searchchoice.selectedIndex].value;                } else {                     searchvalue = searchtext.value;                }curPagetest-grid-id = 0;                         sftest-grid-id = searchfield;                         svtest-grid-id = searchvalue;                         sttest-grid-id = searchtype;                                loadXtest-grid-id(searcher.options[searcher.selectedIndex].value, searchvalue, searchtype);                            }function enablesearchertest-grid-id(){}</script><div id=\"search\" style=\"width:100%; height:25px; padding:10px\" class=\"ms-listviewtable\"><table><tr><td>Search: <select id=\"searchtest-grid-id\" onChange=\"switchsearchtest-grid-id();\" style=\"border: 1px solid #ABABAB; height:20px\"><option value=\"test-field\">test-field</option></select>&nbsp;&nbsp;<select id=\"searchtypetest-grid-id\" style=\"border: 1px solid #ABABAB; height:20px\"><option value=\"1\" selected>Contains</option><option value=\"8\" >Begins With</option><option value=\"2\" >Equals</option><option value=\"3\" >Does Not Equal</option><option value=\"4\" >Greater Than</option><option value=\"5\" >Greater Than or Equal</option><option value=\"6\" >Less Than</option><option value=\"7\" >Less Than or Equal</option></select>&nbsp;&nbsp;</td><td><div style=\"border: 1px solid #ABABAB;width: 150px;height: 20px;\">                    <div id=\"unsearchtest-grid-id\" class=\"\" style=\"padding-left:4px;display: none;min-width: 12px;align:top\">                        <img alt=\"Clear Search\" src=\"/_layouts/epmlive/images/unsearch.png\" style=\"padding-bottom:2px\" onclick=\"unSearchtest-grid-id()\"/>                    </div>                    <div style=\"display: table-cell\">                        <input type=\"text\" id=\"searchtexttest-grid-id\" value=\"test-search-string\" class=\"\" style=\"border: 0px; width:100%; margin-top:-5px; height:14px; font-family: 'Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size:13px\"/>                        <select id=\"searchchoicetest-grid-id\" style=\"border: 0px; width:100%\">                        </select>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    </div>                    <div class=\"\" style=\"padding-right:2px; padding-left:5px;padding-top:2px;display: table-cell;min-width: 10px;cursor:pointer\">                        <img onclick=\"GridSearch('test-grid-id')\" src=\"/_layouts/epmlive/images/find_icon.png\"/>                    </div>                </div></td></tr></table></div><script language=\"javascript\">switchsearchtest-grid-id();</script><table id=pagetabletest-grid-id><tr><td><div id=\"pagedivtest-grid-id\" style=\"display:none;margin:5px 0 5px 0;\"><div id=\"PagePrevioustest-grid-id\" style=\"height:18px;width:70px;border:1px solid #CACACA;float:left;padding-left:5px;background-color:#EFEFEF\" onClick=\"javascript:PreviousPagetest-grid-id()\"><a href=\"javascript:void(0);\" style=\"text-decoration:none;color:#666\">&lt; Previous</a></div> <div id=\"PageNexttest-grid-id\" style=\"height:18px;width:70px;border:1px solid #CACACA;float:left;margin-left:10px;padding-right:5px;text-align:right;background-color:#EFEFEF\" onClick=\"javascript:NextPagetest-grid-id()\"><a style=\"text-decoration:none;color:#666\" href=\"javascript:void(0);\">Next &gt;</a></div></div></td></tr></table><div id=\"grid\" style=\"width:100%;display:none;\" class=\"ms-listviewtable\"></div><div id=\"errordivtest-grid-id\" style=\"font-color:red;font-size:11px;\"></div><div  width=\"100%\" id=\"loadinggrid\" align=\"center\"><img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/> Loading Items...</div><script language=\"javascript\">function viewCheckstest-grid-id(btn){var pp = document.getElementById('divPe' + btn);var ppi = document.getElementById('peoplecheckimg' + btn);if(pp.style.display == \"none\"){pp.style.display = \"\";ppi.src = \"_layouts/images/TPMIN1.GIF\";}else{pp.style.display = \"none\";ppi.src = \"_layouts/images/TPMAX1.GIF\";}}function viewDropDowntest-grid-id(btn){var pp = document.getElementById('divPes' + btn);var ppi = document.getElementById('peoplechecksingleimg' + btn);if(pp.style.display == \"none\"){pp.style.display = \"\";ppi.src = \"_layouts/images/TPMIN1.GIF\";}else{pp.style.display = \"none\";ppi.src = \"_layouts/images/TPMAX1.GIF\";}}function gridfiltertest-grid-id(value){var vals = value.split('|');mygridtest-grid-id.filterBy(vals[0],vals[1]);}function setSizetest-grid-id(){mygridtest-grid-id._askRealRows();}function printgridtest-grid-id() {var temp = mygridtest-grid-id.hdr.rows[2];var parent = temp.parentNode;parent.removeChild(temp,true);mygridtest-grid-id.printView();parent.appendChild(temp);}function switchFilterLoadtest-grid-id(){mygridtest-grid-id.switchFilter();mygridtest-grid-id.setSizes();}</script><script>var mygridtest-grid-idHidden = false;var listidtest-grid-id = '00000000-0000-0000-0000-000000000000';mygridtest-grid-id = new dhtmlXGridObject('grid');mygridtest-grid-id.setImagePath(\"_layouts/epmlive/dhtml/xgrid/imgs/\");mygridtest-grid-id.getTitles = function(){                            var lookups = \"\";            mygridtest-grid-id.forEachRow(function (id) {\t\t\t    var c = this.cells(id, 0);\t\t\t    if (c.isCheckbox() && !c.cell.firstChild.disabled && c.cell.firstChild.checked)                {                    var title = this.getUserData(id,\"title\");        \t        var itemid = this.getUserData(id,\"itemid\");                    if(itemid != \"\")                    {                        lookups += \",\" + title;                    }                }\t\t    });            if(lookups == \"\")            {                var rowId = mygridtest-grid-id.getSelectedRowId();                lookups = \",\" + mygridtest-grid-id.getUserData(rowId,\"title\");            }            if(lookups != \"\" && lookups[0] == ',')                lookups = lookups.substring(1);            return lookups;                }                mygridtest-grid-id.getCheckedRowIds = function(){                var ids = \"\";                this.forEachRow(function (id) {\t\t\t        var c = this.cells(id, 0);\t\t\t        if (c.isCheckbox() && !c.cell.firstChild.disabled && c.cell.firstChild.checked)                    {                        ids += \",\" + id;                    }\t\t        });                if(ids != \"\" && ids[0] == ',')                    ids = ids.substring(1);                if(ids == \"\")                    ids = this.getSelectedRowId();                return ids;            };mygridtest-grid-id.getCheckedIds = function(){                var ids = \"\";                this.forEachRow(function (id) {\t\t\t        var c = this.cells(id, 0);\t\t\t        if (c.isCheckbox() && !c.cell.firstChild.disabled && c.cell.firstChild.checked)                    {                        var listid = this.getUserData(id,\"listid\");        \t            var itemid = this.getUserData(id,\"itemid\");        \t            var webid = this.getUserData(id,\"webid\");                        if (this._useparent) {                            var parentid = this.getUserData(id, \"parentitemid\");                            if (parentid && parentid != \"\") {                                var newids = parentid.toString().split(\".\");                                webid = newids[0];                                listid = newids[1];                                itemid = newids[2];                            }                        }                        if(itemid != \"\")                        {                            ids += \",\" + webid + \".\" + listid + \".\" + itemid;                        }                    }\t\t        });                if(ids == \"\")                {                    var rowId = this.getSelectedRowId();                    var listid = this.getUserData(rowId,\"listid\");        \t        var itemid = this.getUserData(rowId,\"itemid\");        \t        var webid = this.getUserData(rowId,\"webid\");                    if (this._useparent) {                        var parentid = this.getUserData(rowId, \"parentitemid\");                        if (parentid && parentid != \"\") {                            var newids = parentid.toString().split(\".\");                            webid = newids[0];                            listid = newids[1];                            itemid = newids[2];                        }                    }                    if(itemid != \"\")                    {                        ids = webid + \".\" + listid + \".\" + itemid;                    }                }                if(ids != \"\" && ids[0] == ',')                    ids = ids.substring(1);                return ids;            };mygridtest-grid-id.getCheckedItems = function(){                var ids = \"\";                this.forEachRow(function (id) {\t\t\t        var c = this.cells(id, 0);\t\t\t        if (c.isCheckbox() && !c.cell.firstChild.disabled && c.cell.firstChild.checked)                    {                        var listid = this.getUserData(id,\"listid\");        \t            var itemid = this.getUserData(id,\"itemid\");        \t            var webid = this.getUserData(id,\"webid\");                        if(itemid != \"\")                        {                            ids += \",\" + itemid;                        }                    }\t\t        });                if(ids == \"\")                {                    var rowId = this.getSelectedRowId();                    var listid = this.getUserData(rowId,\"listid\");        \t        var itemid = this.getUserData(rowId,\"itemid\");        \t        var webid = this.getUserData(rowId,\"webid\");                    if(itemid != \"\")                    {                        ids = itemid;                    }                }                if(ids != \"\" && ids[0] == ',')                    ids = ids.substring(1);                return ids;            };mygridtest-grid-id.toggleSearch = function(){var searchDiv = document.getElementById('search');if(searchDiv.style.display == 'none'){searchDiv.style.display = '';}else{searchDiv.style.display = 'none';}};mygridtest-grid-id.switchFilter = function(){try{var input1 = mygridtest-grid-id.hdr.rows[2];if(mygridtest-grid-idHidden == false){input1.style.display = \"none\";mygridtest-grid-idHidden = true;}else{input1.style.display = \"\";mygridtest-grid-idHidden = false;}mygridtest-grid-id.setSizes();}catch(e){}};mygridtest-grid-id._enableCMenus = true;mygridtest-grid-id.PageSize = '1';mygridtest-grid-id.UseReporting = false;curPagetest-grid-id = 0;mygridtest-grid-id._epkview = '';mygridtest-grid-id._useparent = false;mygridtest-grid-id._curPlanner = '';mygridtest-grid-id._epkurl = '';mygridtest-grid-id._epkcostview = '';mygridtest-grid-id.canribbon = true;mygridtest-grid-id.addFocusedCommands = function($arr){return $arr;}mygridtest-grid-id.getGlobalCommands = function($arr){return $arr;}mygridtest-grid-id.canHandleCommand = function($Grid, commandId){return false;}mygridtest-grid-id.handleCommand = function($Grid, commandId, properites){if(typeof(properties) != 'undefined')return properties;}mygridtest-grid-id._webpartid = '';mygridtest-grid-id._outlookexport = '';mygridtest-grid-id._gridMode = '';mygridtest-grid-id._hasTemplateList = false;mygridtest-grid-id._newmenumode = 0;mygridtest-grid-id._newitemurl = 'test-server-url';mygridtest-grid-id._newfolder = false;mygridtest-grid-id._newmenu = \"<Button Id=\\'Ribbon.ListItem.New.NewListItem\\' Command=\\'NewItem\\' CommandValueId=\\'NewListItem\\' LabelText=\\'New Item\\' Description=\\'Create a New Item\\' Image32by32=\\'/_layouts/0/images/formatmap32x32.png\\' CommandType=\\'OptionSelection\\' Image32by32Top=\\'-160\\' Image32by32Left=\\'-384\\'/>\"mygridtest-grid-id._modifylist = false;mygridtest-grid-id._listperms = false;mygridtest-grid-id._shownewmenu = true;mygridtest-grid-id._allowedit = false;mygridtest-grid-id._listid = '00000000-0000-0000-0000-000000000000';mygridtest-grid-id._webid = '00000000-0000-0000-0000-000000000000';mygridtest-grid-id._listname = '';mygridtest-grid-id._viewid = '00000000-0000-0000-0000-000000000000';mygridtest-grid-id._viewurl = 'http://fake.url/http://fake.url';mygridtest-grid-id._siteurl = '';mygridtest-grid-id._webrelurl = 'test-server-url';mygridtest-grid-id._viewname = 'dummy';mygridtest-grid-id._basetype = 'GenericList';mygridtest-grid-id._templatetype = '0';mygridtest-grid-id._newrow = false;mygridtest-grid-id._rolluplists = '';mygridtest-grid-id._brollups = false;mygridtest-grid-id._requestList = false;mygridtest-grid-id._usepopup = false;mygridtest-grid-id._lookupfield = '';mygridtest-grid-id._lookupfieldlist = '';mygridtest-grid-id._excell = 'test-server-url\\u002f_vti_bin\\u002fowssvr.dll?CS=65001\\u0026Using=_layouts\\u002fquery.iqy\\u0026List=\\u00257B00000000\\u00252D0000\\u00252D0000\\u00252D0000\\u00252D000000000000\\u00257D\\u0026View=\\u00257B00000000\\u00252D0000\\u00252D0000\\u00252D0000\\u00252D000000000000\\u00257D\\u0026RootFolder=http:\\u0026CacheControl=1';mygridtest-grid-id._gridid = 'test-grid-id';mygridtest-grid-id._formmenus = \"\";mygridtest-grid-id.setSkin(\"modern\");mygridtest-grid-id.enableAlterCss(\"ms-itmhover\", \"ms-itmhover\");mygridtest-grid-id.enableAutoHeight(true);mygridtest-grid-id.setAwaitedRowHeight(30);mygridtest-grid-id.setImageSize(1,1);mygridtest-grid-id._editmode = false;mygridtest-grid-id.enableEditEvents(true,false,false);document.onclick=function(){mygridtest-grid-id._curHover=false;mygridtest-grid-id.clearmenus();};mygridtest-grid-id.setDateFormat(\"%m/%d/%Y\");mygridtest-grid-id.attachEvent(\"onXLE\",clearLoader);mygridtest-grid-id.attachEvent(\"onXLE\",switchFilterLoadtest-grid-id);mygridtest-grid-id.attachEvent(\"onXLE\",enablesearchertest-grid-id);mygridtest-grid-id.attachEvent(\"onXLE\",showrib());mygridtest-grid-id.attachEvent(\"onRowSelect\",selectRowtest-grid-id);mygridtest-grid-id._singleItemUrl = \"http://fake.url/_layouts/epmlive/getsingleitem.aspx?data=&edit=false\";mygridtest-grid-id.init();singleItemUrltest-grid-id = \"http://fake.url/_layouts/epmlive/getsingleitem.aspx?data=&edit=false\";singleEditItemUrltest-grid-id = \"test-server-url/_layouts/epmlive/getedititem.aspx?data=\";inEditModetest-grid-id = false;myDataProcessortest-grid-id = new dataProcessor(\"http://fake.url/_layouts/epmlive/savegrid.aspx?columns=dGVzdC1maWVsZC0x&data=&edit=false\");myDataProcessortest-grid-id.setUpdateMode(\"off\");myDataProcessortest-grid-id.defineAction(\"error100\", myErrorHandlertest-grid-id);myDataProcessortest-grid-id.defineAction(\"error500\", error500test-grid-id);myDataProcessortest-grid-id.defineAction(\"alldatareturned\", alldatareturnedtest-grid-id);myDataProcessortest-grid-id.setTransactionMode(\"POST\", true);myDataProcessortest-grid-id.init(mygridtest-grid-id);mygridtest-grid-id.enableTreeCellEdit(false);function viewErrortest-grid-id(id){document.getElementById('dlgErrorTexttest-grid-id').innerText=mygridtest-grid-id.getUserData(id,\"lastError\");sm('dlgErrortest-grid-id',250,130);}function myErrorHandlertest-grid-id(obj){      var id = obj.getAttribute(\"sid\");var EditCol = getEditColtest-grid-id();if(EditCol != null){      mygridtest-grid-id.cells(id,EditCol).setValue(\"<a href=\\\"javascript:viewErrortest-grid-id('\" + id + \"');\\\"><img src='/_layouts/images/EXCLAIM.GIF' border='0'></a> <a onclick=\\\"javascript:saveEdittest-grid-id('\" + id + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/saveitem.gif\\\" border=\\\"0\\\" alt=\\\"Save\\\"></a> <a onclick=\\\"javascript:cancelEditRowtest-grid-id('\" + id + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/close.gif\\\" border=\\\"0\\\" alt=\\\"Cancel\\\"></a>\");}      mygridtest-grid-id.setUserData(id,\"lastError\",obj.firstChild.data);      return true;}function alldatareturnedtest-grid-id(obj){      setRowValuestest-grid-id(obj.firstChild);}function error500test-grid-id(obj){      alert(obj.firstChild.data);      myDataProcessortest-grid-id.stopOnError = true;       hm('dlgSavingtest-grid-id');      return false;}myDataProcessortest-grid-id.setOnAfterUpdate(function(id,action,newid){if(action != \"error100\" && action != \"delete\"){mygridtest-grid-id.cells(id,0).setValue(\"\");mygridtest-grid-id.cells(id,0).setBgColor('#F0F0F0');}if(myDataProcessortest-grid-id.getSyncState()){    hm('dlgSavingtest-grid-id');    myDataProcessortest-grid-id.updatedRows = new Array(0);}});var singleItemUrltest-grid-id;var arrColumnLookupstest-grid-id;var defaultxmltest-grid-id;var minValuestest-grid-id;var maxValuestest-grid-id;var curPagetest-grid-id = 0;var firstItemtest-grid-id = 0;var lastItemtest-grid-id = 0;var fItemHidetest-grid-id = 0;var sftest-grid-id;var svtest-grid-id;var sttest-grid-id;var bPageSetuptest-grid-id = false;function selectRowtest-grid-id(id, ind){\t\tcurRowId = id;\tcurGrid = mygridtest-grid-id;\tvar c = curGrid.cells(id, 0);\tif (c.isCheckbox())\t{\t\tUnCheckAll(curGrid);\t\tc.cell.firstChild.checked = true;\t\tc.cell.firstChild.display = \"\";\t}\tRefreshCommandUI();\tif(curGrid.canribbon)\t{\t\tif(curGrid.getRowById(id)._locked)\t\t{\t\t\tSelectRibbonTab(\"Ribbon.ListItem\", true);\t\t\t//var wp2 = document.getElementById('Ribbon.ListItem-title');\t\t\t//if(wp2)\t\t\t//\tfireEvent(wp2.firstChild, 'click');\t\t}\t}}function UnCheckAll(grid){\tgrid.forEachRow(function (id) {\t\tvar c = this.cells(id, 0);\t\tif (c.isCheckbox())\t\t{\t\t\tc.cell.firstChild.checked = false;\t\t\tc.cell.firstChild.display = \"none\";\t\t}\t});}function viewItemtest-grid-id(link, action){    var rowIdFull = link.parentNode.parentNode.parentNode.parentNode.parentNode.idd;    var weburl = mygridtest-grid-id.getUserData(rowIdFull,\"SiteUrl\");    var listId = mygridtest-grid-id.getUserData(rowIdFull,\"listid\");    var webid = mygridtest-grid-id.getUserData(rowIdFull,\"webid\");    var siteid = mygridtest-grid-id.getUserData(rowIdFull,\"siteid\");    var editurl = mygridtest-grid-id.getUserData(rowIdFull,\"editurl\");    var viewurl = mygridtest-grid-id.getUserData(rowIdFull,\"viewurl\");    var itemId = mygridtest-grid-id.getUserData(rowIdFull,\"itemid\");    var FullURL = mygridtest-grid-id.getUserData(rowIdFull,\"FullURL\");    var wurl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=\" + action + \"&ListId=\" + listId + \"&ID=\" + itemId + \"&gridid=test-grid-id&siteid=\" + siteid + \"&webid=\" + webid + \"&rowid=\" + rowIdFull;        function myCallback(dialogResult, returnValue)\t{\t\tif(dialogResult == 1)\t\t{\t\t\tvar weburl = curGrid.getUserData(curRowId,\"SiteUrl\");\t\t\tvar listid = curGrid.getUserData(curRowId,\"listid\");\t\t\tvar itemid = curGrid.getUserData(curRowId,\"itemid\");\t\t\tvar webid = curGrid.getUserData(curRowId,\"webid\");\t\t\tvar siteid = curGrid.getUserData(curRowId,\"siteid\");\t\t\tgetSingleItemtest-grid-id(siteid,webid,listid,itemid,curRowId);\t\t}\t}\tvar options = { url: wurl, width: 600, dialogReturnValueCallback:myCallback };\tSP.UI.ModalDialog.showModalDialog(options);}function onKeyPresstest-grid-id(key, control, shift){\tif(!mygridtest-grid-id.editor)\t{\t\tif(key == 46)\t\t{\t\t\tvar rowId = mygridtest-grid-id.getSelectedRowId();\t\t\t\t\tvar isNew = mygridtest-grid-id.getUserData(rowId,\"isNewRow\");\t\t\tvar itemid = mygridtest-grid-id.getUserData(rowId,\"itemid\");\t\t\tif(isNew != \"1\" && itemid != \"\")\t\t\t{\t\t\t\tif(confirm('Are you sure you want to delete this item?')){\t\t\t\t\tmygridtest-grid-id.deleteRow(rowId);\t\t\t\t};            }\t\t}\t}\treturn true;}function newItemtest-grid-id(usepopup){\tvar wurl = mygridtest-grid-id._newitemurl;\tif(usepopup)\t{\t\tfunction NewItemCallback(dialogResult, returnValue){if(dialogResult){window.location.href=window.location.href;}}\t\tvar options = { url: wurl, width: 600, dialogReturnValueCallback:NewItemCallback };\t\tSP.UI.ModalDialog.showModalDialog(options);\t}\telse\t{\t\tlocation.href = wurl;\t}}function setDefaultstest-grid-id(id){\tvar dxml = id.xmlLoader;\t\tvar rows = dxml.doXPath(\"//rows/row[@id='_NEWROW_']\");\t\tvar ua = window.navigator.userAgent;    var msie = ua.indexOf(\"MSIE \");\tif (msie > 0)\t\tdefaultxmltest-grid-id = rows[0].xml;\telse\t\tdefaultxmltest-grid-id = rows[0].outerHTML;\tmygridtest-grid-id._defaults = defaultxmltest-grid-id;}function onEditCelltest-grid-id(stage, rowId, ind, nval, oval){\tif(stage != 2)        return true;        \tif(oval == null)\t\toval = \"\";\tif(!checkMintest-grid-id(rowId,ind,nval))    {        mygridtest-grid-id.cells(rowId,ind).setValue(oval);        return;    }        if(!checkMaxtest-grid-id(rowId,ind,nval))    {        mygridtest-grid-id.cells(rowId,ind).setValue(oval);        return;    }        //alert(\"OLD: \" + oval + \"\\r\\nNEW: \" + nval + \"\\r\\nTitle: \" + mygridtest-grid-id.cells(rowId,ind).getTitle());    \tif(stage == 2 && oval != nval)\t{\t\tvar isNew = mygridtest-grid-id.getUserData(rowId,\"isNewRow\");\t\tif(isNew != null && isNew == \"1\")\t\t{\t\t\tmygridtest-grid-id.setUserData(rowId,\"isNewRow\",\"\");\t\t\tmygridtest-grid-id.cells(rowId,0).setValue(\"\");\t\t\tinsertBlankRowtest-grid-id();\t\t}\t}\treturn true;}function insertBlankRowtest-grid-id(id){\tvar xmlDoc; \tvar moz = (typeof document.implementation != 'undefined') && (typeof \tdocument.implementation.createDocument != 'undefined'); \tvar ie = (typeof window.ActiveXObject != 'undefined'); \tif (window.DOMParser)\t{\t\tparser=new DOMParser();\t\txmlDoc=parser.parseFromString(defaultxmltest-grid-id,\"text/xml\");\t}\telse // code for IE\t{\t\txmlDoc=new ActiveXObject(\"Microsoft.XMLDOM\");\t\txmlDoc.async=false;\t\txmlDoc.loadXML(defaultxmltest-grid-id); \t}\tvar newId = \"_NEWROW_\" + mygridtest-grid-id.getUID();\tvar nRow = mygridtest-grid-id.addRow(newId,\"<img src=\\\"/_layouts/images/newitem.gif\\\">\");\txmlDoc.firstChild.setAttribute(\"id\",newId);\t\tsetRowValuetest-grid-id(xmlDoc.firstChild);\tmygridtest-grid-id.setUserData(newId,\"isNewRow\",\"1\");\tmyDataProcessortest-grid-id.setUpdated(newId,false);\t}dhtmlXGridObject.prototype.alerterror=function(msg){    document.getElementById(\"errordiv\" + this._gridid).innerHTML = \"Error: \" + msg;};dhtmlXGridObject.prototype.setuppaging=function(records){    \tvar pages = Math.ceil(records / this.PageSize);\tvar prev = document.getElementById(\"PagePrevious\"+ this._gridid);\tvar next = document.getElementById(\"PageNext\"+ this._gridid);\tvar pagediv = document.getElementById(\"pagediv\"+ this._gridid);\tvar pagetable = document.getElementById(\"pagetable\"+ this._gridid);\tif(this.UseReporting)\t{\t\tif(pages > 1)\t\t{\t\t\tif(!bPageSetuptest-grid-id)\t\t\t{\t\t\t\tbPageSetuptest-grid-id = true;\t\t\t\t$(\"#pagedivtest-grid-id\").paginate({\t\t\t\t\tcount \t\t: pages,\t\t\t\t\tstart \t\t: 1,\t\t\t\t\tdisplay     : 12,\t\t\t\t\tborder\t\t\t\t\t: true,\t\t\t\t\trotate      : false,\t\t\t\t\timages\t\t: false,\t\t\t\t\tmouse\t\t: 'press',\t\t\t\t\tonChange\t: ChangePagetest-grid-id\t\t\t\t});\t\t\t}\t\t}\t\telse\t\t{\t\t\tpagediv.style.display = \"none\";\t\t\tpagetable.style.display = \"none\";\t\t}\t}\telse\t{\t\tpagediv.style.display = \"inline-block\";\t\tpagetable.style.display = \"\";\t\tvar rec = records.split('|');\t\tfirstItemtest-grid-id = parseInt(rec[2]) * -1;\t\tlastItemtest-grid-id = rec[1];\t\tif(rec[0] == \"0\" || fItemHidetest-grid-id == firstItemtest-grid-id)\t\t{\t\t\tprev.style.background = \"#EFEFEF\";\t\t\tfItemHidetest-grid-id = firstItemtest-grid-id;\t\t}\t\telse\t\t{\t\t\tprev.style.background = \"#DDDDDD\";\t\t}\t\tif(rec[3] == \"true\")\t\t\tnext.style.background = \"#DDDDDD\";\t\telse\t\t{\t\t\tprev.style.background = \"#EFEFEF\";\t\t\tlastItemtest-grid-id = 0;\t\t}\t\tif(rec[3] != \"true\" && rec[0] == \"0\")\t\t{\t\t\tpagediv.style.display = \"none\";\t\t\tpagetable.style.display = \"none\";\t\t}\t}};dhtmlXGridObject.prototype.registerLookuptest-grid-id=function(col,vals){    if(arrColumnLookupstest-grid-id == null)        arrColumnLookupstest-grid-id = new Array(mygridtest-grid-id.getColumnsNum());\t\t    arrColumnLookupstest-grid-id[col] = vals;};//======================Multi User=====================function changeUsertest-grid-id(chkVal){\tdocument.getElementById(\"_downlevelTextBox\").value = \"\";\tdocument.getElementById(\"_upLevelDiv\").innerHTML = \"\";\t\t\tif(document.getElementById(\"_upLevelDiv\").firstChild == null)\t{\t\tvar oTN=document.createTextNode(\"\");\t\tdocument.getElementById(\"_upLevelDiv\").appendChild(oTN);\t}\tdocument.getElementById(\"_upLevelDiv\").firstChild.nodeValue = \"\";\t//chkVal.options[chkVal.selectedIndex].value;}function eXcell_usereditorm(cell){                                    //excell name is defined here    if (cell){                                                     //default pattern, just copy it        this.cell = cell;        this.grid = this.cell.parentNode.grid;        if(!this.grid._grid_pe)        {\t\t\tvar z=document.getElementById(\"people\" + cell.parentNode.grid.entBox.id);\t\t\tz.onclick=function(e){ (e||event).cancelBubble=true; }\t\t\t\t\t\tif (_isIE) { \t\t\t\tz.style.position=\"absolute\"\t\t\t\tz.style.top=\"0px\"\t\t\t}\t\t\tdocument.body.insertBefore(z,document.body.firstChild);\t\t\t \t\t\tthis.grid._grid_pe = z;\t\t}    }    this.setValue=function(val){\t\tvar strVal = \"&nbsp;\";\t\tvar strVals = val.split('\\t')[0].split('\\n');\t\tfor(var i = 1;i<strVals.length;i=i+2)\t\t{\t\t\tstrVal += \"; \" + strVals[i];\t\t}\t\tif(strVal != \"&nbsp;\")\t\t\tstrVal = strVal.substring(7);\t\t\t        this.setCValue(strVal);                   this.cell._displayValue = strVal;        this.cell._users = val.split('\\t')[0];                                           this.cell._Allusers = val === undefined ? [] : val.split('\\t')[1];                                       }    this.getValue=function(){       return this.cell._users; // get value    }    this.edit=function(){    \t\tthis.val=this.getValue();    \t\tdocument.getElementById(\"_downlevelTextBox\").value = \"\";\t\tdocument.getElementById(\"_upLevelDiv\").innerHTML = \"\";\t\tcopyUplevelToHidden('');\t\tupdateControlValue('');\t\tvar arg=getUplevel('');\t\tvar ctx='';\t\tEntityEditorSetWaitCursor(ctx);\t\tWebForm_DoCallback('',arg,EntityEditorHandleCheckNameResult,ctx,EntityEditorHandleCheckNameError,true);\t\t        var pp = document.getElementById(\"divPetest-grid-id\");        var ppi = document.getElementById(\"peoplecheckimgtest-grid-id\");        pp.style.display = \"none\";        ppi.src = \"_layouts/images/TPMAX1.GIF\";                    \t\tvar strVal = \"\";\t\tvar strAllUserChecks = \"\";\t\tvar strVals = this.cell._users.split('\\n');\t\tvar strAllUsers = this.cell._Allusers === undefined ? [] : this.cell._Allusers.split('\\n');\t\tvar strUserNames = '\\t';\t\t\t\tfor(var i = 0;i<strVals.length;i=i+2)\t\t{\t\t\tstrUserNames += strVals[i].toLowerCase() + '\\t';\t\t\tstrVal += \"; \" + strVals[i];\t\t}\t\tif(strVal.length > 1)\t\t\tstrVal = strVal.substring(1);\t\t\t\t\tfor(var i = 0;i<strAllUsers.length;i++)\t\t{\t\t\tvar isChecked = \"\";\t\t\tvar userInfo = strAllUsers[i].split(';#');\t\t\t\t\t\tif(strUserNames.indexOf('\\t' + userInfo[0].toLowerCase() + '\\t') > -1)\t\t\t\tisChecked = \"checked\";\t\t\t\t\t\t\tstrAllUserChecks += \"<br><input type=\\\"checkbox\\\" name=\\\"chkUserstest-grid-id\\\" value=\\\"\" + userInfo[0] + \"\\\" \" + isChecked + \">\" + userInfo[1];\t\t}\t\tif(strAllUserChecks.length > 1)\t\t\tstrAllUserChecks = strAllUserChecks.substring(4);\t\t\t\t\tdocument.getElementById(\"peoplechecktest-grid-id\").innerHTML = strAllUserChecks;\t\t\tvar arPos = this.grid.getPosition(this.cell);\t\tif(arPos[0] + 200 > document.body.clientWidth)\t\t\tthis.grid._grid_pe.style.left=document.body.clientWidth - 210;\t\telse\t\t\tthis.grid._grid_pe.style.left=arPos[0];\t\t\t\tif((arPos[1] + 100) > (document.body.clientHeight + document.body.scrollTop))\t\t\tthis.grid._grid_pe.style.top=document.body.clientHeight + document.body.scrollTop - 105;\t\telse\t\t\tthis.grid._grid_pe.style.top=arPos[1];\t\tthis.grid._grid_pe.style.display=\"\";\t\tthis.grid._grid_pe.style.position = \"absolute\";\t\tthis.grid._grid_pe.style.zIndex  = 99;    }    this.detach=function(){\t\tthis.grid._grid_pe.style.display=\"none\";\t\t\t\tvar strUsers = \"\";\t\tvar divChecks = document.getElementById(\"peoplechecktest-grid-id\");\t\tvar divChildChecks = divChecks.firstChild;\t\twhile(divChildChecks != null)\t\t{\t\t\tif(divChildChecks.nodeName == \"INPUT\")\t\t\t{\t\t\t\tif(divChildChecks.checked)\t\t\t\t{\t\t\t\t\tstrUsers += '\\n' + divChildChecks.value;\t\t\t\t\tstrUsers += '\\n' + divChildChecks.nextSibling.nodeValue;\t\t\t\t}\t\t\t}\t\t\tdivChildChecks = divChildChecks.nextSibling;\t\t}\t\tfor(var i = 0;i<document.getElementById(\"_upLevelDiv\").childNodes.length;i=i+2)\t\t{\t\t\tif(document.getElementById(\"_upLevelDiv\").childNodes[i].firstChild != null)\t\t\t{\t\t\t\tstrUsers += '\\n' + document.getElementById(\"_upLevelDiv\").childNodes[i].title;\t\t\t\tstrUsers += '\\n' + document.getElementById(\"_upLevelDiv\").childNodes[i].firstChild.nextSibling.innerText;\t\t\t}\t\t}\t\tif(strUsers.length > 1)\t\t\tstrUsers = strUsers.substring(1);\t\t\t\tvar oldValue = this.getValue();\t\t\t\t\tif(this.cell._Allusers !== undefined)\t\t\tthis.setValue(strUsers + '\\t' + this.cell._Allusers);         return oldValue != this.getValue();    }}eXcell_usereditorm.prototype = new eXcell;//================================User Single=================function eXcell_usereditor(cell){                                    //excell name is defined here    if (cell){        this.cell = cell;        this.grid = this.cell.parentNode.grid;        if(!this.grid._grid_pes)        {\t\t\tvar z=document.getElementById(\"peoplesingle\" + cell.parentNode.grid.entBox.id);\t\t\tz.onclick=function(e){ (e||event).cancelBubble=true; }\t\t\t\t\t\tif (_isIE) { \t\t\t\tz.style.position=\"absolute\"\t\t\t\tz.style.top=\"0px\"\t\t\t}\t\t\tdocument.body.insertBefore(z,document.body.firstChild);\t\t\t \t\t\tthis.grid._grid_pes = z;\t\t}    }    this.setValue=function(val){\t\tvar strVal = \"&nbsp;\";\t\tvar strVals = val.split('\\t')[0].split('\\n');\t\t\t\tfor(var i = 1;i<strVals.length;i=i+2)\t\t{\t\t\tstrVal += \"; \" + strVals[i];\t\t}\t\tif(strVal != \"&nbsp;\")\t\t\tstrVal = strVal.substring(7);\t\t\t        this.setCValue(strVal);                   this.cell._displayValue = strVal;        this.cell._users = val.split('\\t')[0];                                           this.cell._Allusers = val === undefined ? [] : val.split('\\t')[1];                                       }    this.getValue=function(){\t\t       return this.cell._users; // get value    }    this.edit=function(){\t\tthis.val=this.getValue();        var pp = document.getElementById(\"divPestest-grid-id\");        var ppi = document.getElementById(\"peoplechecksingleimgtest-grid-id\");        pp.style.display = \"none\";        ppi.src = \"_layouts/images/TPMAX1.GIF\";\t\tvar strVal = \"\";\t\tvar strAllUserChecks = \"\";\t\tvar strVals = this.cell._users.split('\\n');\t\tvar strAllUsers = this.cell._Allusers === undefined ? [] : this.cell._Allusers.split('\\n');\t\tvar strUserNames = '\\t';\t\tfor(var i = 0;i<strVals.length;i=i+2)\t\t{\t\t\tstrUserNames += strVals[i].toLowerCase() + '\\t';\t\t\tstrVal += \"; \" + strVals[i];\t\t}\t\tif(strVal.length > 1)\t\t\tstrVal = strVal.substring(1);\t\tvar slct = document.getElementById(\"peoplecheckselecttest-grid-id\");\t\tslct.options.length=0;\t\tvar oSelected = -1;\t\tvar oCounter = 0;\t\tfor(var i = 0;i<strAllUsers.length;i++)\t\t{\t\t\tvar isChecked = false;\t\t\tvar userInfo = strAllUsers[i].split(';#');\t\t\t\t\t\tif(strUserNames.indexOf('\\t' + userInfo[0].toLowerCase() + '\\t') > -1)\t\t\t\toSelected = oCounter;\t\t\t\t\t\t\tvar elOptNew = document.createElement('option');            elOptNew.text = userInfo[1];            elOptNew.value = userInfo[0];            try            {                slct.add(elOptNew, null);            }            catch(ex)            {                slct.add(elOptNew);            }\t\t\t\t\t\t\t\t\t\t//slct.add(new Option(userInfo[1], userInfo[0], false, isChecked));\t\t\toCounter++;\t\t}\t\t\t\tslct.selectedIndex = oSelected;\t\t\t\tdocument.getElementById(\"_downlevelTextBox\").value = \"\";\t\tdocument.getElementById(\"_upLevelDiv\").innerHTML = \"\";\t\t/*\t\tif(document.getElementById(\"_upLevelDiv\").firstChild == null)\t\t{\t\t\tvar oTN=document.createTextNode(\"\");\t\t\tdocument.getElementById(\"_upLevelDiv\").appendChild(oTN);\t\t}\t\tdocument.getElementById(\"_upLevelDiv\").firstChild.nodeValue = strVal;\t\t*/\t\tcopyUplevelToHidden('');\t\tupdateControlValue('');\t\tvar arg=getUplevel('');\t\tvar ctx='';\t\t\t\tEntityEditorSetWaitCursor(ctx);\t\tWebForm_DoCallback('',arg,EntityEditorHandleCheckNameResult,ctx,EntityEditorHandleCheckNameError,true);\t\t\t\t\t\tvar arPos = this.grid.getPosition(this.cell);\t\tif(arPos[0] + 200 > document.body.clientWidth)\t\t\tthis.grid._grid_pes.style.left=document.body.clientWidth - 210;\t\telse\t\t\tthis.grid._grid_pes.style.left=arPos[0];\t\t\t\tif((arPos[1] + 100) > (document.body.clientHeight + document.body.scrollTop))\t\t\tthis.grid._grid_pes.style.top=document.body.clientHeight + document.body.scrollTop - 105;\t\telse\t\t\tthis.grid._grid_pes.style.top=arPos[1];\t\tthis.grid._grid_pes.style.display=\"\";\t\tthis.grid._grid_pes.style.position = \"absolute\";\t\tthis.grid._grid_pes.style.zIndex  = 99;    }    this.detach=function(){\t\tthis.grid._grid_pes.style.display=\"none\";\t\t\t\tvar strUsers = \"\";\t\tfor(var i = 0;i<document.getElementById(\"_upLevelDiv\").childNodes.length;i=i+2)\t\t{\t\t\tif(document.getElementById(\"_upLevelDiv\").childNodes[i].firstChild != null)\t\t\t{\t\t\t\tstrUsers += '\\n' + document.getElementById(\"_upLevelDiv\").childNodes[i].title;\t\t\t\tstrUsers += '\\n' + document.getElementById(\"_upLevelDiv\").childNodes[i].firstChild.nextSibling.innerText;\t\t\t}\t\t}\t\tif(strUsers == \"\")\t\t{\t\t\tvar chkVal = document.getElementById(\"peoplecheckselecttest-grid-id\");\t\t\tif(chkVal.selectedIndex > -1)\t\t\t{\t\t\t\tstrUsers += '\\n' + chkVal.options[chkVal.selectedIndex].value;\t\t\t\tstrUsers += '\\n' + chkVal.options[chkVal.selectedIndex].text;\t\t\t}\t\t}\t\t\t\tif(strUsers.length > 1)\t\t\tstrUsers = strUsers.substring(1);\t\t\t\tvar oldValue = this.getValue();\t\t\t\t\tif(this.cell._Allusers !== undefined)\t\t\tthis.setValue(strUsers + '\\t' + this.cell._Allusers);         return oldValue != this.getValue();    }}eXcell_usereditor.prototype = new eXcell;//=========================choice========================function eXcell_choice(cell){                                    //excell name is defined here    if (cell){\t\t\t\t\t\t\t\t\t\t\t\t\t//default pattern, just copy it        this.cell = cell;        this.grid = this.cell.parentNode.grid;    }    this.setValue=function(val){\t\tvar strVal = \"\";\t\tvar dispVal = \"&nbsp;\";\t\tif(val == \";#\")\t\t\tval = \"\";\t\t\t\t\tval = val.replace(/&amp;/g,\"&\");\t\t\t\tif(val.split('\\t')[0] != \"\")\t\t{\t\t\tstrVal = val.split('\\t')[0];\t\t\tdispVal = strVal.split(';#')[1].replace(/&/g,\"&amp;\");\t\t}        this.setCValue(dispVal);        this.cell._value = strVal;        if(val.split('\\t').length > 1)\t\t\tthis.cell._allvalues = val.split('\\t')[1];    }    this.getValue=function(){\t\treturn this.cell._value;    }    this.edit=function(){\t\tthis.val=this.getValue();\t\tvar arPos = this.grid.getPosition(this.cell) //,this.grid.objBox)\t\tvar allvals = this.cell._allvalues;\t\tthis.obj=document.createElement(\"TEXTAREA\");\t\tthis.obj.className=\"dhx_combo_edit\";\t\tthis.obj.style.height=(this.cell.offsetHeight-4)+\"px\";\t\tthis.obj.wrap=\"soft\";\t\tthis.obj.style.textAlign=this.cell.align;\t\tthis.obj.onclick=function(e){\t\t\t(e||event).cancelBubble=true\t\t}\t\tthis.obj.value=this.text\t\tthis.obj.onselectstart=function(e){\t\t\tif (!e)\t\t\t\te=event;\t\t\te.cancelBubble=true;\t\t\treturn true;\t\t};\t\tvar editor_obj = this;\t\tthis.obj.onkeyup=function(e){\t\t\tvar val = this.readonly ? String.fromCharCode((e||event).keyCode) : this.value;\t\t\tvar c = editor_obj.list.options;\t\t\tfor (var i = 0; i < c.length; i++)\t\t\t\tif (c[i].text.indexOf(val) == 0)\t\t\t\t\treturn c[i].selected=true;\t\t}\t\tthis.list=document.createElement(\"SELECT\");\t\tthis.list.className='dhx_combo_select';\t\tthis.list.style.width=this.cell.offsetWidth+\"px\";\t\tthis.list.style.left=arPos[0]+\"px\";                       //arPos[0]\t\tthis.list.style.top=arPos[1]+this.cell.offsetHeight+\"px\"; //arPos[1]+this.cell.offsetHeight;\t\tthis.list.onclick=function(e){\t\t\tvar ev = e||window.event;\t\t\tev.cancelBubble=true;\t\t\tvar cell = ev.target||ev.srcElement\t\t\t//tbl.editor_obj.val=cell.combo_val;\t\t\tif (cell.tagName == \"OPTION\")\t\t\t\tcell=cell.parentNode;\t\t\teditor_obj.setValue(cell.value + \";#\" + cell.text);\t\t\teditor_obj.editable=false;\t\t\teditor_obj.grid.editStop();\t\t}\t\tvar comboKeys = this.cell._allvalues.split('\\n');\t\tvar fl = false;\t\tvar selOptId = 0;\t\tfor (var i = 0; i < comboKeys.length; i++){\t\t\tvar val = comboKeys[i].split(';#');\t\t\t\t\t\tvar elOptNew = document.createElement('option');            elOptNew.text = val[1];            elOptNew.value = val[0];            \t\t\tthis.list.options[this.list.options.length]=elOptNew\t\t\tif (comboKeys[i] == this.val){\t\t\t\tselOptId=this.list.options.length-1;\t\t\t\tfl=true;\t\t\t}\t\t}\t\tif (fl == false){ //if no such value in combo list\t\t\t\t\t\tvar elOptNew = document.createElement('option');            elOptNew.text = this.text;            elOptNew.value = this.val;            \t\t\t//this.list.options[this.list.options.length]=new Option(this.text, this.val === null ? \"\" : this.val);\t\t\t//this.list.options[this.list.options.length]=elOptNew;\t\t\t//selOptId=this.list.options.length-1;\t\t}\t\tdocument.body.appendChild(this.list) //nb:this.grid.objBox.appendChild(this.listBox);\t\tthis.list.size=\"6\";\t\tthis.cstate=1;\t\tif (this.editable){\t\t\tthis.cell.innerHTML=\"\";\t\t}\t\telse {\t\t\tthis.obj.style.width=\"1px\";\t\t\tthis.obj.style.height=\"1px\";\t\t}\t\tthis.cell.appendChild(this.obj);\t\tthis.list.options[selOptId].selected=true;\t\t\t\t    }    this.detach=function(){\t\t\t\tif (this.val != this.getValue())\t\t{\t\t\tthis.cell.wasChanged=true;\t\t}\t\tvar curVal = this.getValue();\t\tvar newVal = this.list.options[this.list.selectedIndex].value + \";#\" + this.list.options[this.list.selectedIndex].text;\t\tif(newVal == \";#\")\t\t\tnewVal = \"\";\t\t\t\tthis.setValue(newVal);\t\t\t\t\t\t/*if (this.list.parentNode != null)\t\t{\t\t\t\tif (this.obj.value._dhx_trim() != this.text){\t\t\t\t\tif (this.list.selectedIndex&&this.list.options[this.list.selectedIndex].text == this.obj.value)\t\t\t\t\t\tthis.setValue(this.list.value + '\\t' + this.cell._allvalues)\t\t\t\t\telse\t\t\t\t\t\tthis.setValue(this.obj.value + '\\t' + this.cell._allvalues)\t\t\t\t} else {\t\t\t\t\tthis.setValue(this.val + '\\t' + this.cell._allvalues)\t\t\t\t}\t\t}*/\t\tif (this.list.parentNode)\t\t\tthis.list.parentNode.removeChild(this.list);\t\tif (this.obj.parentNode)\t\t\tthis.obj.parentNode.removeChild(this.obj);\t\treturn newVal != curVal;\t\t    }}eXcell_choice.prototype = new eXcell;//=========================multichoice========================function eXcell_mchoice(cell){                                    //excell name is defined here    if (cell){                                                     //default pattern, just copy it        this.cell = cell;        this.grid = this.cell.parentNode.grid;        if(!this.grid._grid_mc)        {\t\t\tvar z=document.getElementById(\"multichoice\" + cell.parentNode.grid.entBox.id);\t\t\tz.onclick=function(e){ (e||event).cancelBubble=true; }\t\t\t\t\t\tif (_isIE) { \t\t\t\tz.style.position=\"absolute\"\t\t\t\tz.style.top=\"0px\"\t\t\t}\t\t\tdocument.body.insertBefore(z,document.body.firstChild); \t\t\tthis.grid._grid_mc = z;\t\t}    }    this.setValue=function(val){\t\tvar strVal = \"\";\t\t\t\tif(val.split('\\t')[0] != \"\")\t\t{\t\t\tvar strVals = val.split('\\t')[0].split('\\n');\t\t\tfor(var i = 0;i<strVals.length;i++)\t\t\t{\t\t\t\tvar valInfo = strVals[i].split(';#');\t\t\t\tstrVal += \", \" + valInfo[1];\t\t\t}\t\t\tif(strVal != \"\")\t\t\t\tstrVal = strVal.substring(2);\t\t}\t\tif(strVal != \"\")\t\t\tthis.setCValue(strVal.replace(\"&\",\"&amp;\"));\t\telse\t\t\tthis.setCValue(\"&nbsp;\");\t\t        this.cell._displayValue = strVal;        this.cell._values = val.split('\\t')[0];        this.cell._allvalues = val.split('\\t')[1];    }    this.getValue=function(){\t\treturn this.cell._values;    }    this.edit=function(){\t\tthis.val=this.getValue();\t\tvar strAllValueChecks = \"\";\t\tvar strVals = this.cell._values.split('\\n');\t\tvar strAllValues = this.cell._allvalues.split('\\n');\t\tvar strValues = '\\t';\t\t\t\tfor(var i = 0;i<strVals.length;i++)\t\t{\t\t\tvar valInfo = strVals[i].split(';#');\t\t\t\t\tstrValues += valInfo[0].toLowerCase() + '\\t';\t\t}\t\tfor(var i = 0;i<strAllValues.length;i++)\t\t{\t\t\tvar isChecked = \"\";\t\t\tvar valInfo = strAllValues[i].split(';#');\t\t\t\t\t\tif(strValues.indexOf('\\t' + valInfo[0].toLowerCase() + '\\t') > -1)\t\t\t\tisChecked = \"checked\";\t\t\tstrAllValueChecks += \"<br><input type=\\\"checkbox\\\" name=\\\"chkValuestest-grid-id\\\" value=\\\"\" + valInfo[0] + \"\\\" \" + isChecked + \">\" + valInfo[1];\t\t}\t\tif(strAllValueChecks.length > 1)\t\t\tstrAllValueChecks = strAllValueChecks.substring(4);\t\t\t\t\tdocument.getElementById(\"multichoiceinnertest-grid-id\").innerHTML = strAllValueChecks;\t\tvar arPos = this.grid.getPosition(this.cell);\t\tif(arPos[0] + 200 > document.body.clientWidth)\t\t\tthis.grid._grid_mc.style.left=document.body.clientWidth - 210;\t\telse\t\t\tthis.grid._grid_mc.style.left=arPos[0];\t\t\t\tif((arPos[1] + 100) > (document.body.clientHeight + document.body.scrollTop))\t\t\tthis.grid._grid_mc.style.top=document.body.clientHeight + document.body.scrollTop - 105;\t\telse\t\t\tthis.grid._grid_mc.style.top=arPos[1];\t\tthis.grid._grid_mc.style.display=\"\";\t\tthis.grid._grid_mc.style.position = \"absolute\";\t\tthis.grid._grid_mc.style.zIndex  = 99;    }    this.detach=function(){\t\t\t\tthis.grid._grid_mc.style.display=\"none\";\t\t\t\tvar child = document.getElementById(\"multichoiceinnertest-grid-id\").firstChild;\t\tvar val1 = \"\";\t\twhile(child != null)\t\t{\t\t\tif(child.nodeName == \"INPUT\")\t\t\t{\t\t\t\tif(child.checked)\t\t\t\t{\t\t\t\t\tval1 += '\\n' + child.value + \";#\" + child.nextSibling.nodeValue;\t\t\t\t}\t\t\t}\t\t\tchild = child.nextSibling;\t\t}\t\tif(val1.length > 1)\t\t\tval1 = val1.substring(1);\t\t\t\t\t\t\tvar oldValue = this.getValue();\t\t\t\tthis.cell._values = val1;\t\t\t        this.setValue(val1 + '\\t' + this.cell._allvalues);         return oldValue != this.getValue();\t\t    }}eXcell_mchoice.prototype = new eXcell;//=========================Calendar===========================eXcell_dhxCalendarA.prototype.edit = function(){\t                    var top;                    var left;                                        var arPos = this.grid.getPosition(this.cell);\t\t\t\t\tif(arPos[0] + this.cell.offsetWidth + 180 > document.body.clientWidth)\t\t\t\t\t\tleft = arPos[0] - 185;\t\t\t\t\telse\t\t\t\t\t\tleft=arPos[0] + this.cell.offsetWidth;\t\t\t\t\t\t\t\t\t\tif((arPos[1] + 170) > (document.body.clientHeight + document.body.scrollTop))\t\t\t\t\t\ttop=document.body.clientHeight + document.body.scrollTop - 180;\t\t\t\t\telse\t\t\t\t\t\ttop=arPos[1];                                        this.grid._grid_calendarA.setPosition(top,left);                    \t                    this.grid._grid_calendarA.show();\t                    this.grid._grid_calendarA._last_operation_calendar=false;\t\t\t\t\t//var arPos = this.grid.getPosition(this.cell);                    //var pval=this._date2str2(this.cell.val||new Date());                    //window._grid_calendar.render(arPos[0],arPos[1]+this.cell.offsetHeight,this,pval);                    this.cell._cediton=true;                    this.val=this.cell.val;                    //this.val=this.getValue();                    this._val=this.cell.innerHTML;                   // alert(this.cell.val);\t\t\t\t   \tthis.grid._grid_calendarA.setDateFormat((this.grid._dtmask||\"%d/%m/%Y\"));                    this.grid._grid_calendarA.setDate(this.val);                    this.grid._grid_calendarA.draw();                    \t\t\t\t\tthis.cell.atag=((!this.grid.multiLine)&&(_isKHTML||_isMacOS||_isFF))?\"INPUT\":\"TEXTAREA\";\t\t\t\t\t\t\t\t\t\tthis.obj = document.createElement(this.cell.atag);\t\t\t\t\tthis.obj.style.height = (this.cell.offsetHeight-(_isIE?4:2))+\"px\";                    this.obj.className=\"dhx_combo_edit\";\t\t\t\t   \tthis.obj.wrap = \"soft\";\t\t\t\t\tthis.obj.style.textAlign = this.cell.align;\t\t\t\t\tthis.obj.onclick = function(e){(e||event).cancelBubble = true}\t\t\t\t\tthis.obj.onmousedown = function(e){(e||event).cancelBubble = true}\t\t\t\t\tthis.obj.value = this.getValue();\t\t\t\t\tthis.cell.innerHTML = \"\";\t\t\t\t\tthis.cell.appendChild(this.obj);\t\t\t\t  \tif (_isFF) {\t\t\t\t\t\tthis.obj.style.overflow=\"visible\";\t\t\t\t\t\tif ((this.grid.multiLine)&&(this.obj.offsetHeight>=18)&&(this.obj.offsetHeight<40)){\t\t\t\t\t\t\tthis.obj.style.height=\"36px\";\t\t\t\t\t\t\tthis.obj.style.overflow=\"scroll\";\t\t\t\t\t\t}\t\t\t\t\t}                    this.obj.onselectstart=function(e){  if (!e) e=event; e.cancelBubble=true; return true;  };\t\t\t\t\tthis.obj.focus()  \t\t\t\t\tthis.obj.focus()\t\t\t\t                    \t\t\t\t}//============================================================function getSingleItemtest-grid-id(siteid,webid,listid,itemid,rowid){\tvar val = SP.UI.Notify.addNotification(\"Updating Saved Row...\", false,  \"\", null);\tdhtmlxAjax.post(singleItemUrltest-grid-id, \"siteid=\" + siteid + \"&webid=\" + webid + \"&listid=\" + listid + \"&itemid=\" + itemid + \"&rowid=\" + rowid,getSingleItemResponsetest-grid-id);}function getSingleItemResponsetest-grid-id(loader){\tif(loader.xmlDoc.responseText!=null)\t{\t\tvar xmlDoc = loader.xmlDoc.responseXML;\t\tfor(var i = 0;i<xmlDoc.childNodes.length;i++)\t\t{\t\t\tvar rowXml = xmlDoc.childNodes[i];\t\t\tsetRowValuestest-grid-id(rowXml);\t\t}\t}\telse\t\talert(\"Response contains no XML\");}function setRowValuestest-grid-id(rowsXml){\tfor(var i = 0;i<rowsXml.childNodes.length;i++)\t{\t\tsetRowValuetest-grid-id(rowsXml.childNodes[i])\t}}function setRowValuetest-grid-id(rowXml){\tvar rowId = rowXml.getAttribute(\"id\")\t\tvar cellCounter = 0;\tfor(var i = 0;i<rowXml.childNodes.length;i++)\t{\t\tif(rowXml.childNodes[i].nodeName == \"userdata\")\t\t{\t\t\tif(rowXml.childNodes[i].firstChild != null)\t\t\t\tmygridtest-grid-id.setUserData(rowId,rowXml.childNodes[i].getAttribute(\"name\"),rowXml.childNodes[i].firstChild.nodeValue);\t\t}\t\telse if(rowXml.childNodes[i].nodeName == \"cell\")\t\t{\t\t\tif(!inEditModetest-grid-id)\t\t\t{\t\t\t\tif(mygridtest-grid-id.getColType(cellCounter) != \"tree\")\t\t\t\t\tmygridtest-grid-id.setCellExcellType(rowId, cellCounter, \"ro\");\t\t\t\t\t\t\t\t\tmygridtest-grid-id.lockRow(rowId, true);\t\t\t}\t\t\t\t\t\tvar cellval = \"\";\t\t\tvar celltype = \"\";\t\t\ttry\t\t\t{\t\t\t\tcelltype = rowXml.childNodes[i].getAttribute(\"type\");\t\t\t}catch(e){}\t\t\t\t\t\t\t\t\tif(rowXml.childNodes[i].childNodes.length > 0)\t\t\t{\t\t\t\tcellval = rowXml.childNodes[i].firstChild.nodeValue;\t\t\t}\t\t\t\t\t\tif(celltype == \"combo\")\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(rowXml.childNodes[i]);\t\t\t\telse\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(cellval);\t\t\t\tcellCounter++;\t\t}\t}\t}function saveGridtest-grid-id(){\tmygridtest-grid-id.editStop();    sm('dlgSavingtest-grid-id',200,100);    if(myDataProcessortest-grid-id.updatedRows.length > 0)    {        myDataProcessortest-grid-id.sendData();    }    else        hm('dlgSavingtest-grid-id');}function onButtonClicktest-grid-id(menuitemId,grid_Id,grid){    var rowIdFull = grid_Id.split(\"_\")[0];    var weburl = context_grid.getUserData(rowIdFull,\"SiteUrl\");    var listId = context_grid.getUserData(rowIdFull,\"listid\");    var editurl = context_grid.getUserData(rowIdFull,\"editurl\");    var viewurl = context_grid.getUserData(rowIdFull,\"viewurl\");    var itemId = context_grid.getUserData(rowIdFull,\"itemid\");    var webId = context_grid.getUserData(rowIdFull,\"webid\");    var siteid = context_grid.getUserData(rowIdFull,\"siteid\");    var rowId = rowIdFull.split('.')[1];        var popup = context_grid.getUserData(rowIdFull,\"popup\");    var w = pageWidth() - 200;\tvar h = pageHeight() - 100;             switch(menuitemId)    {\t\tcase \"createworkspace\":\t\t\turl = weburl + \"/_layouts/epmlive/requestworkspace.aspx?list=\" + listidtest-grid-id + \"&ID=\" + itemId;\t\t\tdocument.location.href=url;\t\t\t\t\t\tbreak;\t\tcase \"workspace\":\t\t\tif(viewurl == null)                url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=workspace&webid=\" + webId ;            else                url = weburl;                \t\t\tdocument.location.href=url;\t\t\tbreak;\t\t\t\tcase \"workplan\":\t\t\tif(viewurl == null)\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=workplan&webid=\" + webId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\telse\t\t\t\turl = weburl + \"/_layouts/epmlive/tasks.aspx?ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t\t\t\t\tdocument.location.href=url;\t\t\tbreak;\t\t\t\t\tcase \"agile\":\t\t\tif(viewurl == null)\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=agile&webid=\" + webId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\telse\t\t\t\turl = weburl + \"/_layouts/epmlive/agile/tasks.aspx?ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t\t\t\t\tdocument.location.href=url;\t\t\tbreak;\t\t\t\tcase \"projectpro\":\t\t\tif(viewurl == null)\t\t\t{\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=getproject&webid=\" + webId + \"&ID=\" + itemId + \"&listID=\" + listId + \"&Source=\" + document.location.href;;\t\t\t\tdocument.location.href=url;\t\t\t}\t\t\telse\t\t\t{\t\t\t\tjavascript:window.open(weburl + '/_layouts/epmlive/getproject.aspx?listID=' + listId + '&ID=' + itemId,'', config='height=100,width=200, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, directories=no, status=no');\t\t\t}\t\t\tbreak;\t\t        case \"edit\":            var url = \"\";            if(popup==\"yes\")            {\t\t\t\t\t\t\t\tvar url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=viewedit2&ListId=\" + listId + \"&ID=\" + itemId + \"&Mode=2&gridid=test-grid-id&siteid=\" + siteid + \"&webid=\" + webId + \"&rowid=\" + rowIdFull;\t\t\t\tsm('editItemtest-grid-id',w,h);\t\t\t\tdocument.getElementById(\"frmEditFrametest-grid-id\").src = url;            }            else            {\t\t\t\tif(editurl == null)\t\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=edit&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t\telse\t\t\t\t\turl = editurl + \"?ListId=\" + listId + \"&ID=\" + itemId + \"&Mode=2&Source=\" + document.location.href;\t\t\t\tdocument.location.href=url;            }            break;        case \"perms\":\t\t\tvar url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=perms&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t            //var url = weburl + \"/_layouts/User.aspx?obj={\" + listId + \"},\" + itemId + \",LISTITEM&List={\" + listId + \"}&Source=\" + document.location.href;            document.location.href=url;            break;        case \"view\":\t\t\tif(popup==\"yes\")            {\t\t\t\tvar url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=viewedit2&ListId=\" + listId + \"&ID=\" + itemId + \"&Mode=1&gridid=test-grid-id&siteid=\" + siteid + \"&webid=\" + webId + \"&rowid=\" + rowIdFull;\t\t\t\tsm('editItemtest-grid-id',w,h);\t\t\t\tdocument.getElementById(\"frmEditFrametest-grid-id\").src=url;            }            else            {\t\t\t\tvar url;\t\t\t\tif(viewurl == null)\t\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=view&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t\telse\t\t\t\t\turl = viewurl + \"?ListId=\" + listId + \"&ID=\" + itemId + \"&Mode=1&Source=\" + document.location.href;\t\t\t\tdocument.location.href=url;            }            break;        case \"delete\":            if(confirm('Are you sure you want to send this item to the Recycle Bin?')){                var url;                if(viewurl == null)                {                    url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=delete&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&NextUsing=\" + document.location.href;                    document.location.href=url;                }                else                {                                            postDelete(weburl + '/_vti_bin/owssvr.dll?CS=65001&Cmd=Delete&List={' + listId + '}&ID=' + itemId + '&NextUsing=' + document.location.href);                                     }            };            break;        case \"alerts\":            var url;            if(viewurl == null)                url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=alerts&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;            else                url = weburl + \"/_layouts/SubNew.aspx?List={\" + listId + \"}&ID=\" + itemId + \"&Source=\" + document.location.href;                            document.location.href=url;            break;        case \"versions\":            var url = weburl + \"/_layouts/Versions.aspx?list={\" + listId + \"}&ID=\" + itemId + \"&Source=\" + document.location.href;            document.location.href=url;            break;        case \"approve\":            var url = weburl + \"/_layouts/approve.aspx?list={\" + listId + \"}&ID=\" + itemId + \"&Source=\" + document.location.href;            document.location.href=url;            break;        case \"workflows\":            var url = weburl + \"/_layouts/Workflow.aspx?list={\" + listId + \"}&ID=\" + itemId + \"&Source=\" + document.location.href;            document.location.href=url;            break;    };}function redoCss(rowindex){\tvar j = rowindex;\tfor (var i = rowindex; i < mygridtest-grid-id.rowsCol.length; i++){\t\t\tif (!mygridtest-grid-id.rowsCol[i])\t\t\t\tcontinue;\t\t\tif (mygridtest-grid-id.rowsCol[i].style.display != \"none\"){\t\t\t\tif (mygridtest-grid-id.rowsCol[i].className.indexOf(\"rowselected\") != -1){\t\t\t\t\tif (j%2 == 1)\t\t\t\t\t\tmygridtest-grid-id.rowsCol[i].className=mygridtest-grid-id._cssUnEven+\" rowselected \"+(mygridtest-grid-id.rowsCol[i]._css||\"\");\t\t\t\t\telse\t\t\t\t\t\tmygridtest-grid-id.rowsCol[i].className=mygridtest-grid-id._cssEven+\" rowselected \"+(mygridtest-grid-id.rowsCol[i]._css||\"\");\t\t\t\t} else {\t\t\t\t\tif (j%2 == 1)\t\t\t\t\t\tmygridtest-grid-id.rowsCol[i].className=mygridtest-grid-id._cssUnEven+(mygridtest-grid-id.rowsCol[i]._css||\"\");\t\t\t\t\telse\t\t\t\t\t\tmygridtest-grid-id.rowsCol[i].className=mygridtest-grid-id._cssEven+(mygridtest-grid-id.rowsCol[i]._css||\"\");\t\t\t\t}\t\t\t\tj++;\t\t\t}\t\t}}function leavePagetest-grid-id(e){\tvar hasupdates = false;\t\tfor(var i = 0;i < myDataProcessortest-grid-id.updatedRows.length;i++)\t{\t\tif(myDataProcessortest-grid-id.updatedRows[i] != null)\t\t{\t\t\thasupdates = true;\t\t}\t}    if(hasupdates )    {        if(!e) e = window.event;\t    //e.cancelBubble is supported by IE - this will kill the bubbling process.\t    //e.cancelBubble = true;\t    e.returnValue = 'You have unsaved changes.'; //This is displayed on the dialog\t    if (e.stopPropagation) {\t\t    e.stopPropagation();\t\t    e.preventDefault();\t    }    }}function URLEncode( plaintext ){\t// The Javascript escape and unescape functions do not correspond\t// with what browsers actually do...\tvar SAFECHARS = \"0123456789\" +\t\t\t\t\t// Numeric\t\t\t\t\t\"ABCDEFGHIJKLMNOPQRSTUVWXYZ\" +\t// Alphabetic\t\t\t\t\t\"abcdefghijklmnopqrstuvwxyz\" +\t\t\t\t\t\"-_.!~*'()\";\t\t\t\t\t// RFC2396 Mark characters\tvar HEX = \"0123456789ABCDEF\";\tvar encoded = \"\";\tfor (var i = 0; i < plaintext.length; i++ ) {\t\tvar ch = plaintext.charAt(i);\t    if (ch == \" \") {\t\t    encoded += \"+\";\t\t\t\t// x-www-urlencoded, rather than %20\t\t} else if (SAFECHARS.indexOf(ch) != -1) {\t\t    encoded += ch;\t\t} else {\t\t    var charCode = ch.charCodeAt(0);\t\t\tif (charCode > 255) {\t\t\t    alert( \"Unicode Character '\"                         + ch                         + \"' cannot be encoded using standard URL encoding.\\n\" +\t\t\t\t          \"(URL encoding only supports 8-bit characters.)\\n\" +\t\t\t\t\t\t  \"A space (+) will be substituted.\" );\t\t\t\tencoded += \"+\";\t\t\t} else {\t\t\t\tencoded += \"%\";\t\t\t\tencoded += HEX.charAt((charCode >> 4) & 0xF);\t\t\t\tencoded += HEX.charAt(charCode & 0xF);\t\t\t}\t\t}\t}\treturn encoded;};function checkMintest-grid-id(rowId,cellIndex,value){    if(minValuestest-grid-id[cellIndex] != \"\")    {        var val = parseFloat(value);        var min = parseFloat(minValuestest-grid-id[cellIndex]);        if(val < min)        {            alert('You must enter a value greater than ' + min);            return false;        }    }    return true;}function checkMaxtest-grid-id(rowId,cellIndex,value){    if(maxValuestest-grid-id[cellIndex] != \"\")    {        var val = parseFloat(value);        var max = parseFloat(maxValuestest-grid-id[cellIndex]);        if(val > max)        {            alert('You must enter a value less than ' + max);                        return false;        }    }    return true;}dhtmlXGridObject.prototype._in_header_master_checkbox2 = function (t, i, c) { \tt.innerHTML = c[0] + \"<input type='checkbox' />\" + c[1]; \tvar self = this; \tt.firstChild.onclick = function (e) \t{ \t\tself._build_m_order(); \t\tvar j = self._m_order ? self._m_order[i] : i;\t\tvar val = this.checked;// ? true : false;\t\tself.forEachRow(function (id) {\t\t\tvar c = this.cells(id, j);\t\t\tif (c.isCheckbox() && !c.cell.firstChild.disabled)\t\t\t{\t\t\t\tc.cell.firstChild.checked = val;\t\t\t\tif(val)\t\t\t\t\tc.cell.firstChild.style.display = \"\";\t\t\t\telse\t\t\t\t\tc.cell.firstChild.style.display = \"none\";\t\t\t}\t\t});\t\t(e || event).cancelBubble = true;\t} };dhtmlXGridObject.prototype.checksubs = function(row){\tvar rowid = row.parentNode.parentNode.idd;\tif(this.hasChildren(rowid) > 0)\t{\t\tvar rowids = this.getAllSubItems(rowid).split(',');\t\tfor(var i = 0;i<rowids.length;i++)\t\t{\t\t\tvar curRow = rowids[i];\t\t\tthis.cells(curRow, 0).cell.firstChild.checked = row.checked;\t\t\tif(row.checked)\t\t\t\tthis.cells(curRow, 0).cell.firstChild.style.display = \"\";\t\t\telse\t\t\t\tthis.cells(curRow, 0).cell.firstChild.style.display = \"none\";\t\t}\t\t\t}};window.onbeforeunload=leavePagetest-grid-id;minValuestest-grid-id = [\"\",\"1\"];maxValuestest-grid-id = [\"\",\"1\"];var singleEditItemUrltest-grid-id;var inEditModetest-grid-id;function fireEvent(element,event){    if (document.createEventObject){        // dispatch for IE        var evt = document.createEventObject();        return element.fireEvent('on'+event,evt)    }    else{        // dispatch for firefox + others        var evt = document.createEvent(\"HTMLEvents\");        evt.initEvent(event, true, true ); // event type,bubbling,cancelable        return !element.dispatchEvent(evt);    }}function editRowtest-grid-id(rowid){\tvar EditCol = getEditColtest-grid-id();        if(EditCol != null)    {    \t\tvar listId = mygridtest-grid-id.getUserData(rowid,\"listid\");\t\tvar itemId = mygridtest-grid-id.getUserData(rowid,\"itemid\");\t\tvar webId = mygridtest-grid-id.getUserData(rowid,\"webid\");\t\tvar siteId = mygridtest-grid-id.getUserData(rowid,\"siteid\");    \t\tmygridtest-grid-id.cells(rowid, EditCol).setValue(\"<img src='/_layouts/epmlive/images/loader1.gif'>\");\t\tdhtmlxAjax.post(singleEditItemUrltest-grid-id, \"siteid=\" + siteId + \"&webid=\" + webId + \"&listid=\" + listId + \"&itemid=\" + itemId + \"&rowid=\" + rowid,editRowResponsetest-grid-id);    }}function getEditColtest-grid-id(){\tvar EditCol;\tfor(var i = 0;i<mygridtest-grid-id.getColumnsNum();i++)    {        if(mygridtest-grid-id.getColumnId(i) == \"<![CDATA[Edit]]>\")        {            EditCol = i;\t\t\tbreak;        }    }    return EditCol;}function editRowResponsetest-grid-id(loader){\tif(loader.xmlDoc.responseText!=null)\t{\t\t\tvar xmlDoc = loader.xmlDoc.responseXML;\t\tfor(var i = 0;i<xmlDoc.childNodes.length;i++)\t\t{\t\t\tvar rowXml = xmlDoc.childNodes[i];\t\t\tsetEditRowstest-grid-id(rowXml);\t\t\t}\t}\telse\t\talert(\"Response contains no XML\");}function setEditRowstest-grid-id(rowsXml){\tfor(var i = 0;i<rowsXml.childNodes.length;i++)\t{\t\tsetEditRowtest-grid-id(rowsXml.childNodes[i])\t}}function setEditRowtest-grid-id(rowXml){\tvar rowId = rowXml.getAttribute(\"id\")\t\tvar cellCounter = 0;\tmygridtest-grid-id.lockRow(rowId, false);\tfor(var i = 0;i<rowXml.childNodes.length;i++)\t{\t\tif(rowXml.childNodes[i].nodeName == \"userdata\")\t\t{\t\t\t//mygridtest-grid-id.setUserData(rowId,rowXml.childNodes[i].getAttribute(\"name\"),rowXml.childNodes[i].firstChild.nodeValue);\t\t}\t\telse if(rowXml.childNodes[i].nodeName == \"cell\")\t\t{\t\t\tvar cellval = \"\";\t\t\tvar celltype = \"\";\t\t\ttry\t\t\t{\t\t\t\tcelltype = rowXml.childNodes[i].getAttribute(\"type\");\t\t\t}catch(e){}\t\t\tif(rowXml.childNodes[i].childNodes.length > 0)\t\t\t{\t\t\t\tcellval = rowXml.childNodes[i].firstChild.nodeValue;\t\t\t}\t\t\tif(celltype == \"combo\")\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(rowXml.childNodes[i]);\t\t\t\telse\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(cellval);\t\t\t\t\t\t\tif(celltype != null)\t\t\t{\t\t\t\tmygridtest-grid-id.setCellExcellType(rowId, i, celltype);\t\t\t}\t\t\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(cellval);\t\t\t\tcellCounter++;\t\t}\t}\tvar EditCol = getEditColtest-grid-id();    \tif(EditCol != null)\t{\t\tmygridtest-grid-id.cells(rowId, EditCol).setValue(\"<a onclick=\\\"javascript:saveEdittest-grid-id('\" + rowId + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/saveitem.gif\\\" border=\\\"0\\\" alt=\\\"Save\\\"></a> <a onclick=\\\"javascript:cancelEditRowtest-grid-id('\" + rowId + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/close.gif\\\" border=\\\"0\\\" alt=\\\"Cancel\\\"></a>\");\t}}function saveEdit2test-grid-id(rowid){\tmygridtest-grid-id.editStop();\t\trow = mygridtest-grid-id.getRowById(rowid);\t\tvar cols = row.childNodes.length;\tvar changed = false;\tfor (var j = 0; j < cols; j++)\t\tif (row.childNodes[j].wasChanged){\t\t\tchanged = true;\t\t\tbreak;\t\t}\t\tvar EditCol = getEditColtest-grid-id();\t    if(EditCol != null)\t\tmygridtest-grid-id.cells(rowid, EditCol).setValue(\"<img src='/_layouts/epmlive/images/loader1.gif'>\");\t\t\t\tif(changed)\t\tmyDataProcessortest-grid-id.sendData(rowid);\telse\t\tcancelEditRowtest-grid-id(rowid);}function saveEdittest-grid-id(rowid){\tsetTimeout(\"saveEdit2test-grid-id('\" + rowid + \"')\", 100);}function cancelEditRowtest-grid-id(rowid){\tvar EditCol = getEditColtest-grid-id();\t    mygridtest-grid-id.lockRow(rowid, true);    myDataProcessortest-grid-id.setUpdated(rowid, false, null);        if(EditCol != null)    {\t\tvar listid = mygridtest-grid-id.getUserData(rowid,\"listid\");\t\tvar itemid = mygridtest-grid-id.getUserData(rowid,\"itemid\");\t\tvar webid = mygridtest-grid-id.getUserData(rowid,\"webid\");\t\tvar siteid = mygridtest-grid-id.getUserData(rowid,\"siteid\");\t\tmygridtest-grid-id.cells(rowid, EditCol).setValue(\"<img src='/_layouts/epmlive/images/loader1.gif'>\");\t\tdhtmlxAjax.post(singleItemUrltest-grid-id, \"edit=false&siteid=\" + siteid + \"&webid=\" + webid + \"&listid=\" + listid + \"&itemid=\" + itemid + \"&rowid=\" + rowid,cancelEditRowResponsetest-grid-id);\t}\t}function cancelEditRowResponsetest-grid-id(loader){\tif(loader.xmlDoc.responseText!=null)\t{\t\tvar xmlDoc = loader.xmlDoc.responseXML;\t\t\t\tfor(var i = 0;i<xmlDoc.childNodes.length;i++)\t\t{\t\t\tvar rowXml = xmlDoc.childNodes[i];\t\t\tsetCRowValuestest-grid-id(rowXml);\t\t}\t}\telse\t\talert(\"Response contains no XML\");}function setCRowValuestest-grid-id(rowsXml){\tfor(var i = 0;i<rowsXml.childNodes.length;i++)\t{\t\tsetCRowValuetest-grid-id(rowsXml.childNodes[i])\t}}function setCRowValuetest-grid-id(rowXml){\tvar rowId = rowXml.getAttribute(\"id\");\tvar cellCounter = 0;\t\tfor(var i = 0;i<rowXml.childNodes.length;i++)\t{\t\tif(rowXml.childNodes[i].nodeName == \"userdata\")\t\t{\t\t\t//mygridtest-grid-id.setUserData(rowId,rowXml.childNodes[i].getAttribute(\"name\"),rowXml.childNodes[i].text);\t\t}\t\telse if(rowXml.childNodes[i].nodeName == \"cell\")\t\t{\t\t\tvar cellval = \"\";\t\t\t\t\t\tif(rowXml.childNodes[i].childNodes.length > 0)\t\t\t{\t\t\t\tcellval = rowXml.childNodes[i].firstChild.nodeValue;\t\t\t}\t\t\tif(mygridtest-grid-id.getColType(cellCounter) != \"tree\")\t\t\t\tmygridtest-grid-id.setCellExcellType(rowId, cellCounter, \"ro\");\t\t\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(cellval);\t\t\t\t\t\t\tcellCounter++;\t\t}\t}\t\tvar EditCol;\tfor(var i = 0;i<mygridtest-grid-id.getColumnsNum();i++)\t{\t\tif(mygridtest-grid-id.getColumnId(i) == \"<![CDATA[Edit]]>\")\t\t{\t\t\tEditCol = i;\t\t\tbreak;\t\t}\t}    \tif(EditCol != null)\t{\t\tmygridtest-grid-id.cells(rowId, i).setValue(\"<a onclick=\\\"javascript:editRowtest-grid-id('\" + rowId + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/edit.gif\\\" border=\\\"0\\\"></a>\");\t}}function ChangePagetest-grid-id(pg){curPagetest-grid-id = pg;loadXtest-grid-id(sftest-grid-id, svtest-grid-id, sttest-grid-id);}function NextPagetest-grid-id(){if(lastItemtest-grid-id != 0){curPagetest-grid-id = lastItemtest-grid-id;loadXtest-grid-id(sftest-grid-id, svtest-grid-id, sttest-grid-id);}}function PreviousPagetest-grid-id(){if(fItemHidetest-grid-id != firstItemtest-grid-id){curPagetest-grid-id = firstItemtest-grid-id;loadXtest-grid-id(sftest-grid-id, svtest-grid-id, sttest-grid-id);}}function loadXtest-grid-id(searchfield, searchvalue, searchtype){var ribbontestintervall = null; mygridwidthtest-grid-id = document.getElementById('WebPartdummy').offsetWidth - 25;if(searchfield){searchvalue = escape(searchvalue);mygridtest-grid-id.post(\"http://fake.url/_layouts/epmlive/getgriditems.aspx\",\"data=&edit=false&insertrow=False&width=\" + mygridwidthtest-grid-id + \"&searchfield=\" + searchfield + \"&searchvalue=\" + searchvalue + \"&searchtype=\" + searchtype + \"&page=\" + curPagetest-grid-id + \"&source=http%3a%2f%2ffake.url%2f\");}else{mygridtest-grid-id.post(\"http://fake.url/_layouts/epmlive/getgriditems.aspx\",\"data=&edit=false&insertrow=False&width=\" + mygridwidthtest-grid-id + \"&page=\" + curPagetest-grid-id + \"&source=http%3a%2f%2ffake.url%2f\");}}function showrib(){setTimeout(\"clickTab()\", 1);}function clickTab(){try{var wp = document.getElementById('MSOZoneCell_WebPartdummy');WpClick({target: wp});}catch(e){}}function clickbrowse(){try{var wp2 = document.getElementById('Ribbon.Read-title').firstChild;fireEvent(wp2, 'click');}catch(e){}}setTimeout(\"clickTab()\", 1000);_spBodyOnLoadFunctionNames.push(\"loadXtest-grid-id('test-search-field','test-search-string','1')\");</script><div id=\"dlgSavingtest-grid-id\" class=\"dialog\">    <table width=\"100%\">        <tr>            <td align=\"center\" class=\"ms-sectionheader\">                <img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/><br />                <H3 class=\"ms-standardheader\">Saving Items...</h3>            </td>        </tr>    </table></div> <div id=\"dlgRefreshtest-grid-id\" class=\"dialog\">    <table width=\"100%\">        <tr>            <td align=\"center\" class=\"ms-sectionheader\">                <img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/><br />                <H3 class=\"ms-standardheader\">Refreshing Data...</h3>            </td>        </tr>    </table></div> <div id=\"dlgErrortest-grid-id\" class=\"dialog\">    <table width=\"100%\" height=\"100%\" cellpadding=\"0\" cellspacing=\"3\">\t\t<tr>\t\t\t<td class=\"ms-sectionheader\"><H3 class=\"ms-standardheader\">Error: </h3></td>\t\t</tr>        <tr height=\"100%\">            <td align=\"left\"valign=\"top\">                <div id=\"dlgErrorTexttest-grid-id\" style=\"overflow: auto;height=90%;width=100%\" class=\"ms-descriptiontext\"></div><br>            </td>        </tr>        <tr>\t\t\t<td align=\"right\">\t\t\t\t<input type=\"button\" class=\"ms-input\" value=\"Close\" onClick=\"hm('dlgErrortest-grid-id');\">\t\t\t</td>\t\t</tr>    </table></div><div id=\"editItemtest-grid-id\" class=\"dialog\">    <table width=\"100%\" height=\"100%\" id=\"tblEditItem\" cellpadding=\"0\" cellspacing=\"0\">        <tr height=\"100%\">            <td align=\"center\" bgcolor=\"FFFFFF\">                <div id=\"editItemLoadtest-grid-id\">                    <img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/>                </div>                <iframe id=\"frmEditFrametest-grid-id\" width=\"100%\" height=\"100%\" frameborder=\"0\" src=\"http://fake.url/_layouts/epmlive/blank.gif\">                                    </iframe>            </td>        </tr>    </table></div><div id=\"dlgPosting\" class=\"dialog\">    <table width=\"100%\">        <tr>            <td align=\"center\" class=\"ms-sectionheader\">                <img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/><br />                <H3 class=\"ms-standardheader\">Posting Data...</h3>            </td>        </tr>    </table></div> <script>var bPageSetuptest-grid-id;var firstItemtest-grid-id;var lastItemtest-grid-id;var fItemHidetest-grid-id;function setupPagetest-grid-id(records, UseReporting, PageSize){\tvar pages = Math.ceil(records / PageSize);\tvar prev = document.getElementById(\"PagePrevioustest-grid-id\");\tvar next = document.getElementById(\"PageNexttest-grid-id\");\tvar pagediv = document.getElementById(\"pagedivtest-grid-id\");\tif(UseReporting)\t{\t\tif(pages > 1)\t\t{\t\t\tif(!bPageSetuptest-grid-id)\t\t\t{\t\t\t\tbPageSetuptest-grid-id = true;\t\t\t\t$(\"#pagedivtest-grid-id\").paginate({\t\t\t\t\tcount \t\t: pages,\t\t\t\t\tstart \t\t: 1,\t\t\t\t\tdisplay     : 12,\t\t\t\t\tborder\t\t\t\t\t: true,\t\t\t\t\tborder_color\t\t\t: '#CCCCCC',\t\t\t\t\ttext_color  \t\t\t: '#666666',\t\t\t\t\tbackground_color    \t: '#DDDDDD',\t\t\t\t\t\tborder_hover_color\t\t: '#878787',\t\t\t\t\ttext_hover_color  \t\t: '#ffffff',\t\t\t\t\tbackground_hover_color\t: '#9B9B9B', \t\t\t\t\trotate      : false,\t\t\t\t\timages\t\t: false,\t\t\t\t\tmouse\t\t: 'press',\t\t\t\t\tonChange\t: ChangePagetest-grid-id\t\t\t\t});\t\t\t}\t\t}\t\telse\t\t{\t\t\tpagediv.style.display = \"none\";\t\t}\t}\telse\t{\t\tpagediv.style.display = \"inline-block\";\t\tvar rec = records.split('|');\t\tfirstItemtest-grid-id = parseInt(rec[2]) * -1;\t\tlastItemtest-grid-id = rec[1];\t\tif(rec[0] == \"0\" || fItemHidetest-grid-id == firstItemtest-grid-id)\t\t{\t\t\tprev.style.background = \"#EFEFEF\";\t\t\tfItemHidetest-grid-id = firstItemtest-grid-id;\t\t}\t\telse\t\t{\t\t\tprev.style.background = \"#DDDDDD\";\t\t}\t\tif(rec[3] == \"true\")\t\t\tnext.style.background = \"#DDDDDD\";\t\telse\t\t{\t\t\tprev.style.background = \"#EFEFEF\";\t\t\tlastItemtest-grid-id = 0;\t\t}\t\tif(rec[3] != \"true\" && rec[0] == \"0\")\t\t{\t\t\tpagediv.style.display = \"none\";\t\t}\t}}</script><script>initmb();</script>"));
        }

        [TestMethod]
        public void GridListView_renderGrid_GivenArguments_HeightNotEmpty_ConfirmOutput()
        {
            // Arrange
            SetupShims();
            _testablePrivate.SetFieldOrProperty("Height", "100");

            // Act
            _testablePrivate.Invoke("renderGrid",
                new object[] { writer, web });

            // Assert
            _testablePrivate.ShouldSatisfyAllConditions(
                () => writeCount.ShouldBe(334),
                () => writerContent.ToString().Length.ShouldBe(74593),
                () => writerContent.ToString().ShouldBe("<style>.ms-usereditor { width:200px; }.grid_hover { border: 10px solid #91CDF2; background-color: #F2FAFF } </style><div id=\"peoplegrid\" style=\"display:none; border: 1px solid #808080; padding: 3px; background-color: #F9F9F9; width=200px;\"><div id=\"peoplechecktest-grid-id\" style=\"overflow: auto; width: 200px; height: 100px;  background-color: #FFFFFF; border: 1px solid #808080; margin-top:2px; padding:3px;\" class=\"ms-descriptiontext\"></div><table border=\"0\" width=\"100%\"><tr><td><a onclick=\"javascript:viewCheckstest-grid-id('test-grid-id');\"><img id=\"peoplecheckimgtest-grid-id\" src=\"_layouts/images/TPMAX1.GIF\" border=\"0\"></a><br></td><td align=\"right\"><font class=\"ms-descriptiontext\"><a onclick=\"javascript:mygridtest-grid-id.editStop();\">Close</a></font></td></tr></table><div id=\"divPetest-grid-id\" style=\"display:none;\"></div></div><div id=\"peoplesinglegrid\" style=\"display:none; border: 1px solid #808080; padding: 3px; background-color: #F9F9F9; width=200px;\"><div id=\"peoplechecksingletest-grid-id\" style=\"width: 200px; height: 100px;  background-color: #FFFFFF; border: 1px solid #808080; margin-top:2px; padding:0px;\" class=\"ms-descriptiontext\"><select size=\"6\" onclick=\"changeUsertest-grid-id(this);\" id=\"peoplecheckselecttest-grid-id\"  style=\"width:100%;height:100%\"><option>test</option></select></div><table border=\"0\" width=\"200\"><tr><td><a onclick=\"javascript:viewDropDowntest-grid-id('test-grid-id');\"><img id=\"peoplechecksingleimgtest-grid-id\" src=\"_layouts/images/TPMAX1.GIF\" border=\"0\"></a><br></td><td align=\"right\"><font class=\"ms-descriptiontext\"><a onclick=\"javascript:mygridtest-grid-id.editStop();\">Close</a></font></td></tr></table><div id=\"divPestest-grid-id\" style=\"display:none;\"></div></div><div id=\"multichoicegrid\" style=\"display:none; border: 1px solid #808080; padding: 3px; background-color: #F9F9F9; width:200px;height:180px\"><div id=\"multichoiceinnertest-grid-id\" style=\"width: 195px; height: 160px;  background-color: #FFFFFF; border: 1px solid #808080; margin-top:2px; padding:0px;overflow:auto\" class=\"ms-descriptiontext\">test</div><table border=\"0\" width=\"200\"><tr><td align=\"right\"><font class=\"ms-descriptiontext\"><a onclick=\"javascript:mygridtest-grid-id.editStop();\">Close</a></font></td></tr></table></div><div id=\"gridmenutest-grid-id\" style=\"position:absolute;left:0px;display:none;\" class=\"js-callout-mainElement ms-core-defaultFont  ms-alignLeft ms-shadow\"><ul class=\"ms-core-menu-list\" style=\"width: 173px;\"></ul></div><script>_css_prefix=\"/_layouts/epmlive/DHTML/xgrid/\"; _js_prefix=\"/_layouts/epmlive/DHTML/xgrid/\"; </script><script src=\"_layouts/epmlive/DHTML/xgrid/dhtmlxcommon.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/dhtmlxgrid.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/dhtmlxgridcell.js\"></script><script src=\"_layouts/epmlive/DHTML/xtreegrid/dhtmlxtreegrid.js\"></script><script src=\"_layouts/epmlive/DHTML/xtreegrid/ext/dhtmlxtreegrid_filter.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_post.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_nxml.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_filter.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_math.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_srnd.js\"></script><script src=\"/_layouts/epmlive/DHTML/xgrid/excells/dhtmlxgrid_excell_calendar.js\"></script><script src=\"/_layouts/epmlive/DHTML/xgrid/excells/dhtmlxgrid_excell_combo.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/excells/dhtmlxgrid_excell_dhxcalendar.js\"></script><script src=\"_layouts/epmlive/DHTML/xcombo/dhtmlxcombo.js\"></script><script src=\"_layouts/epmlive/DHTML/calendar/dhtmlxcalendar.js\"></script><script src=\"_layouts/epmlive/DHTML/xdataproc/dhtmlxdataprocessor.js\"></script><script type=\"text/javascript\" src=\"_layouts/epmlive/modal/modal.js\"></script> <script language=\"JavaScript\" src=\"_layouts/epmlive/dhtml/xmenu/dhtmlxmenu.js\"></script><script language=\"JavaScript\" src=\"_layouts/epmlive/dhtml/xmenu/ext/dhtmlxmenu_ext.js\"></script><style>.menuTable{background-color:#ffffff;}.secondMenuTable{background-color:#ffffff;}.contextMenuover, .contextMenudown{background-color:#9ac2e5;}.contextMenuover td{color:#000000;} </style><script src=\"_layouts/epmlive/epmlivegrid.js\"></script><script language=\"javascript\">var searchfieldstest-grid-id = {test-field: [ \"Yes\", \"No\" ]};function switchsearchtest-grid-id()            {                var searcher = document.getElementById('searchtest-grid-id');                var searchtext = document.getElementById('searchtexttest-grid-id');                var searchchoice = document.getElementById('searchchoicetest-grid-id');                var searchtypechoice = document.getElementById('searchtypetest-grid-id');                var searchfield = searcher.options[searcher.selectedIndex].value;                var sList = searchfieldstest-grid-id[searchfield];                if(sList) {                    searchtext.style.display='none';                    searchchoice.style.display='';                    searchchoice.options.length = 0;                    searchtypechoice.options[2].selected = true;                    searchtypechoice.disabled = true;                    for(var i=0; i < sList.length; i++) {                        var d = sList[i];                        searchchoice.options.add(new Option(d, d));                        if(d=='test-search-string') {                            searchchoice.options[searchchoice.options.length-1].selected = true;                        }                     }                 } else {                    searchtext.style.display='';                    searchchoice.style.display='none';                    searchtypechoice.disabled = false;                }            }function unSearchtest-grid-id(){var gri = document.getElementById('grid');gri.style.display = 'none';var loader = document.getElementById('loadinggrid');loader.style.display = '';var unsearch = document.getElementById('unsearchtest-grid-id');unsearch.style.display=\"none\";var searchtext = document.getElementById('searchtexttest-grid-id');searchtext.value = '';curPagetest-grid-id = 0;sftest-grid-id = null;svtest-grid-id = null;sttest-grid-id = null;loadXtest-grid-id();}function doSearchtest-grid-id(){var gri = document.getElementById('grid');                     gri.style.display = 'none';                     var loader = document.getElementById('loadinggrid');                     loader.style.display = '';                var searcher = document.getElementById('searchtest-grid-id');                var unsearch = document.getElementById('unsearchtest-grid-id');                unsearch.style.display=\"table-cell\";                var searchchoice = document.getElementById('searchchoicetest-grid-id');                var searchtext = document.getElementById('searchtexttest-grid-id');                var searchtypechoice = document.getElementById('searchtypetest-grid-id');                var searchfield = searcher.options[searcher.selectedIndex].value;                var searchtype = searchtypechoice.options[searchtypechoice.selectedIndex].value;                var sList = searchfieldstest-grid-id[searchfield];                var searchvalue = \"\";                if(sList){                    searchvalue = searchchoice.options[searchchoice.selectedIndex].value;                } else {                     searchvalue = searchtext.value;                }curPagetest-grid-id = 0;                         sftest-grid-id = searchfield;                         svtest-grid-id = searchvalue;                         sttest-grid-id = searchtype;                                loadXtest-grid-id(searcher.options[searcher.selectedIndex].value, searchvalue, searchtype);                            }function enablesearchertest-grid-id(){}</script><div id=\"search\" style=\"width:100%; height:25px; padding:10px\" class=\"ms-listviewtable\"><table><tr><td>Search: <select id=\"searchtest-grid-id\" onChange=\"switchsearchtest-grid-id();\" style=\"border: 1px solid #ABABAB; height:20px\"><option value=\"test-field\">test-field</option></select>&nbsp;&nbsp;<select id=\"searchtypetest-grid-id\" style=\"border: 1px solid #ABABAB; height:20px\"><option value=\"1\" selected>Contains</option><option value=\"8\" >Begins With</option><option value=\"2\" >Equals</option><option value=\"3\" >Does Not Equal</option><option value=\"4\" >Greater Than</option><option value=\"5\" >Greater Than or Equal</option><option value=\"6\" >Less Than</option><option value=\"7\" >Less Than or Equal</option></select>&nbsp;&nbsp;</td><td><div style=\"border: 1px solid #ABABAB;width: 150px;height: 20px;\">                    <div id=\"unsearchtest-grid-id\" class=\"\" style=\"padding-left:4px;display: none;min-width: 12px;align:top\">                        <img alt=\"Clear Search\" src=\"/_layouts/epmlive/images/unsearch.png\" style=\"padding-bottom:2px\" onclick=\"unSearchtest-grid-id()\"/>                    </div>                    <div style=\"display: table-cell\">                        <input type=\"text\" id=\"searchtexttest-grid-id\" value=\"test-search-string\" class=\"\" style=\"border: 0px; width:100%; margin-top:-5px; height:14px; font-family: 'Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size:13px\"/>                        <select id=\"searchchoicetest-grid-id\" style=\"border: 0px; width:100%\">                        </select>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    </div>                    <div class=\"\" style=\"padding-right:2px; padding-left:5px;padding-top:2px;display: table-cell;min-width: 10px;cursor:pointer\">                        <img onclick=\"GridSearch('test-grid-id')\" src=\"/_layouts/epmlive/images/find_icon.png\"/>                    </div>                </div></td></tr></table></div><script language=\"javascript\">switchsearchtest-grid-id();</script><div id=\"grid\" style=\"width:100%;display:none;\" class=\"ms-listviewtable\"></div><div id=\"errordivtest-grid-id\" style=\"font-color:red;font-size:11px;\"></div><div  width=\"100%\" id=\"loadinggrid\" align=\"center\"><img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/> Loading Items...</div><script language=\"javascript\">function viewCheckstest-grid-id(btn){var pp = document.getElementById('divPe' + btn);var ppi = document.getElementById('peoplecheckimg' + btn);if(pp.style.display == \"none\"){pp.style.display = \"\";ppi.src = \"_layouts/images/TPMIN1.GIF\";}else{pp.style.display = \"none\";ppi.src = \"_layouts/images/TPMAX1.GIF\";}}function viewDropDowntest-grid-id(btn){var pp = document.getElementById('divPes' + btn);var ppi = document.getElementById('peoplechecksingleimg' + btn);if(pp.style.display == \"none\"){pp.style.display = \"\";ppi.src = \"_layouts/images/TPMIN1.GIF\";}else{pp.style.display = \"none\";ppi.src = \"_layouts/images/TPMAX1.GIF\";}}function gridfiltertest-grid-id(value){var vals = value.split('|');mygridtest-grid-id.filterBy(vals[0],vals[1]);}function setSizetest-grid-id(){mygridtest-grid-id._askRealRows();}function printgridtest-grid-id() {var temp = mygridtest-grid-id.hdr.rows[2];var parent = temp.parentNode;parent.removeChild(temp,true);mygridtest-grid-id.printView();parent.appendChild(temp);}function switchFilterLoadtest-grid-id(){mygridtest-grid-id.switchFilter();mygridtest-grid-id.setSizes();}</script><script>var mygridtest-grid-idHidden = false;var listidtest-grid-id = '00000000-0000-0000-0000-000000000000';mygridtest-grid-id = new dhtmlXGridObject('grid');mygridtest-grid-id.setImagePath(\"_layouts/epmlive/dhtml/xgrid/imgs/\");mygridtest-grid-id.getTitles = function(){                            var lookups = \"\";            mygridtest-grid-id.forEachRow(function (id) {\t\t\t    var c = this.cells(id, 0);\t\t\t    if (c.isCheckbox() && !c.cell.firstChild.disabled && c.cell.firstChild.checked)                {                    var title = this.getUserData(id,\"title\");        \t        var itemid = this.getUserData(id,\"itemid\");                    if(itemid != \"\")                    {                        lookups += \",\" + title;                    }                }\t\t    });            if(lookups == \"\")            {                var rowId = mygridtest-grid-id.getSelectedRowId();                lookups = \",\" + mygridtest-grid-id.getUserData(rowId,\"title\");            }            if(lookups != \"\" && lookups[0] == ',')                lookups = lookups.substring(1);            return lookups;                }                mygridtest-grid-id.getCheckedRowIds = function(){                var ids = \"\";                this.forEachRow(function (id) {\t\t\t        var c = this.cells(id, 0);\t\t\t        if (c.isCheckbox() && !c.cell.firstChild.disabled && c.cell.firstChild.checked)                    {                        ids += \",\" + id;                    }\t\t        });                if(ids != \"\" && ids[0] == ',')                    ids = ids.substring(1);                if(ids == \"\")                    ids = this.getSelectedRowId();                return ids;            };mygridtest-grid-id.getCheckedIds = function(){                var ids = \"\";                this.forEachRow(function (id) {\t\t\t        var c = this.cells(id, 0);\t\t\t        if (c.isCheckbox() && !c.cell.firstChild.disabled && c.cell.firstChild.checked)                    {                        var listid = this.getUserData(id,\"listid\");        \t            var itemid = this.getUserData(id,\"itemid\");        \t            var webid = this.getUserData(id,\"webid\");                        if (this._useparent) {                            var parentid = this.getUserData(id, \"parentitemid\");                            if (parentid && parentid != \"\") {                                var newids = parentid.toString().split(\".\");                                webid = newids[0];                                listid = newids[1];                                itemid = newids[2];                            }                        }                        if(itemid != \"\")                        {                            ids += \",\" + webid + \".\" + listid + \".\" + itemid;                        }                    }\t\t        });                if(ids == \"\")                {                    var rowId = this.getSelectedRowId();                    var listid = this.getUserData(rowId,\"listid\");        \t        var itemid = this.getUserData(rowId,\"itemid\");        \t        var webid = this.getUserData(rowId,\"webid\");                    if (this._useparent) {                        var parentid = this.getUserData(rowId, \"parentitemid\");                        if (parentid && parentid != \"\") {                            var newids = parentid.toString().split(\".\");                            webid = newids[0];                            listid = newids[1];                            itemid = newids[2];                        }                    }                    if(itemid != \"\")                    {                        ids = webid + \".\" + listid + \".\" + itemid;                    }                }                if(ids != \"\" && ids[0] == ',')                    ids = ids.substring(1);                return ids;            };mygridtest-grid-id.getCheckedItems = function(){                var ids = \"\";                this.forEachRow(function (id) {\t\t\t        var c = this.cells(id, 0);\t\t\t        if (c.isCheckbox() && !c.cell.firstChild.disabled && c.cell.firstChild.checked)                    {                        var listid = this.getUserData(id,\"listid\");        \t            var itemid = this.getUserData(id,\"itemid\");        \t            var webid = this.getUserData(id,\"webid\");                        if(itemid != \"\")                        {                            ids += \",\" + itemid;                        }                    }\t\t        });                if(ids == \"\")                {                    var rowId = this.getSelectedRowId();                    var listid = this.getUserData(rowId,\"listid\");        \t        var itemid = this.getUserData(rowId,\"itemid\");        \t        var webid = this.getUserData(rowId,\"webid\");                    if(itemid != \"\")                    {                        ids = itemid;                    }                }                if(ids != \"\" && ids[0] == ',')                    ids = ids.substring(1);                return ids;            };mygridtest-grid-id.toggleSearch = function(){var searchDiv = document.getElementById('search');if(searchDiv.style.display == 'none'){searchDiv.style.display = '';}else{searchDiv.style.display = 'none';}};mygridtest-grid-id.switchFilter = function(){try{var input1 = mygridtest-grid-id.hdr.rows[2];if(mygridtest-grid-idHidden == false){input1.style.display = \"none\";mygridtest-grid-idHidden = true;}else{input1.style.display = \"\";mygridtest-grid-idHidden = false;}mygridtest-grid-id.setSizes();}catch(e){}};mygridtest-grid-id._enableCMenus = true;mygridtest-grid-id.PageSize = '0';mygridtest-grid-id.UseReporting = false;curPagetest-grid-id = 0;mygridtest-grid-id._epkview = '';mygridtest-grid-id._useparent = false;mygridtest-grid-id._curPlanner = '';mygridtest-grid-id._epkurl = '';mygridtest-grid-id._epkcostview = '';mygridtest-grid-id.canribbon = true;mygridtest-grid-id.addFocusedCommands = function($arr){return $arr;}mygridtest-grid-id.getGlobalCommands = function($arr){return $arr;}mygridtest-grid-id.canHandleCommand = function($Grid, commandId){return false;}mygridtest-grid-id.handleCommand = function($Grid, commandId, properites){if(typeof(properties) != 'undefined')return properties;}mygridtest-grid-id._webpartid = '';mygridtest-grid-id._outlookexport = '';mygridtest-grid-id._gridMode = '';mygridtest-grid-id._hasTemplateList = false;mygridtest-grid-id._newmenumode = 0;mygridtest-grid-id._newitemurl = 'test-server-url';mygridtest-grid-id._newfolder = false;mygridtest-grid-id._newmenu = \"<Button Id=\\'Ribbon.ListItem.New.NewListItem\\' Command=\\'NewItem\\' CommandValueId=\\'NewListItem\\' LabelText=\\'New Item\\' Description=\\'Create a New Item\\' Image32by32=\\'/_layouts/0/images/formatmap32x32.png\\' CommandType=\\'OptionSelection\\' Image32by32Top=\\'-160\\' Image32by32Left=\\'-384\\'/>\"mygridtest-grid-id._modifylist = false;mygridtest-grid-id._listperms = false;mygridtest-grid-id._shownewmenu = true;mygridtest-grid-id._allowedit = false;mygridtest-grid-id._listid = '00000000-0000-0000-0000-000000000000';mygridtest-grid-id._webid = '00000000-0000-0000-0000-000000000000';mygridtest-grid-id._listname = '';mygridtest-grid-id._viewid = '00000000-0000-0000-0000-000000000000';mygridtest-grid-id._viewurl = 'http://fake.url/http://fake.url';mygridtest-grid-id._siteurl = '';mygridtest-grid-id._webrelurl = 'test-server-url';mygridtest-grid-id._viewname = 'dummy';mygridtest-grid-id._basetype = 'GenericList';mygridtest-grid-id._templatetype = '0';mygridtest-grid-id._newrow = false;mygridtest-grid-id._rolluplists = '';mygridtest-grid-id._brollups = false;mygridtest-grid-id._requestList = false;mygridtest-grid-id._usepopup = false;mygridtest-grid-id._lookupfield = '';mygridtest-grid-id._lookupfieldlist = '';mygridtest-grid-id._excell = 'test-server-url\\u002f_vti_bin\\u002fowssvr.dll?CS=65001\\u0026Using=_layouts\\u002fquery.iqy\\u0026List=\\u00257B00000000\\u00252D0000\\u00252D0000\\u00252D0000\\u00252D000000000000\\u00257D\\u0026View=\\u00257B00000000\\u00252D0000\\u00252D0000\\u00252D0000\\u00252D000000000000\\u00257D\\u0026RootFolder=http:\\u0026CacheControl=1';mygridtest-grid-id._gridid = 'test-grid-id';mygridtest-grid-id._formmenus = \"\";mygridtest-grid-id.setSkin(\"modern\");mygridtest-grid-id.enableAlterCss(\"ms-itmhover\", \"ms-itmhover\");mygridtest-grid-id.enableAutoHeight(true,70,true);mygridtest-grid-id.enableSmartRendering(true);mygridtest-grid-id.enableSmartXMLParsing(true);mygridtest-grid-id.setAwaitedRowHeight(30);mygridtest-grid-id.setImageSize(1,1);mygridtest-grid-id._editmode = false;mygridtest-grid-id.enableEditEvents(true,false,false);document.onclick=function(){mygridtest-grid-id._curHover=false;mygridtest-grid-id.clearmenus();};mygridtest-grid-id.setDateFormat(\"%m/%d/%Y\");mygridtest-grid-id.attachEvent(\"onXLE\",clearLoader);mygridtest-grid-id.attachEvent(\"onXLE\",switchFilterLoadtest-grid-id);mygridtest-grid-id.attachEvent(\"onXLE\",enablesearchertest-grid-id);mygridtest-grid-id.attachEvent(\"onXLE\",showrib());mygridtest-grid-id.attachEvent(\"onRowSelect\",selectRowtest-grid-id);mygridtest-grid-id._singleItemUrl = \"http://fake.url/_layouts/epmlive/getsingleitem.aspx?data=&edit=false\";mygridtest-grid-id.init();singleItemUrltest-grid-id = \"http://fake.url/_layouts/epmlive/getsingleitem.aspx?data=&edit=false\";singleEditItemUrltest-grid-id = \"test-server-url/_layouts/epmlive/getedititem.aspx?data=\";inEditModetest-grid-id = false;myDataProcessortest-grid-id = new dataProcessor(\"http://fake.url/_layouts/epmlive/savegrid.aspx?columns=dGVzdC1maWVsZC0x&data=&edit=false\");myDataProcessortest-grid-id.setUpdateMode(\"off\");myDataProcessortest-grid-id.defineAction(\"error100\", myErrorHandlertest-grid-id);myDataProcessortest-grid-id.defineAction(\"error500\", error500test-grid-id);myDataProcessortest-grid-id.defineAction(\"alldatareturned\", alldatareturnedtest-grid-id);myDataProcessortest-grid-id.setTransactionMode(\"POST\", true);myDataProcessortest-grid-id.init(mygridtest-grid-id);mygridtest-grid-id.enableTreeCellEdit(false);function viewErrortest-grid-id(id){document.getElementById('dlgErrorTexttest-grid-id').innerText=mygridtest-grid-id.getUserData(id,\"lastError\");sm('dlgErrortest-grid-id',250,130);}function myErrorHandlertest-grid-id(obj){      var id = obj.getAttribute(\"sid\");var EditCol = getEditColtest-grid-id();if(EditCol != null){      mygridtest-grid-id.cells(id,EditCol).setValue(\"<a href=\\\"javascript:viewErrortest-grid-id('\" + id + \"');\\\"><img src='/_layouts/images/EXCLAIM.GIF' border='0'></a> <a onclick=\\\"javascript:saveEdittest-grid-id('\" + id + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/saveitem.gif\\\" border=\\\"0\\\" alt=\\\"Save\\\"></a> <a onclick=\\\"javascript:cancelEditRowtest-grid-id('\" + id + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/close.gif\\\" border=\\\"0\\\" alt=\\\"Cancel\\\"></a>\");}      mygridtest-grid-id.setUserData(id,\"lastError\",obj.firstChild.data);      return true;}function alldatareturnedtest-grid-id(obj){      setRowValuestest-grid-id(obj.firstChild);}function error500test-grid-id(obj){      alert(obj.firstChild.data);      myDataProcessortest-grid-id.stopOnError = true;       hm('dlgSavingtest-grid-id');      return false;}myDataProcessortest-grid-id.setOnAfterUpdate(function(id,action,newid){if(action != \"error100\" && action != \"delete\"){mygridtest-grid-id.cells(id,0).setValue(\"\");mygridtest-grid-id.cells(id,0).setBgColor('#F0F0F0');}if(myDataProcessortest-grid-id.getSyncState()){    hm('dlgSavingtest-grid-id');    myDataProcessortest-grid-id.updatedRows = new Array(0);}});var singleItemUrltest-grid-id;var arrColumnLookupstest-grid-id;var defaultxmltest-grid-id;var minValuestest-grid-id;var maxValuestest-grid-id;var curPagetest-grid-id = 0;var firstItemtest-grid-id = 0;var lastItemtest-grid-id = 0;var fItemHidetest-grid-id = 0;var sftest-grid-id;var svtest-grid-id;var sttest-grid-id;var bPageSetuptest-grid-id = false;function selectRowtest-grid-id(id, ind){\t\tcurRowId = id;\tcurGrid = mygridtest-grid-id;\tvar c = curGrid.cells(id, 0);\tif (c.isCheckbox())\t{\t\tUnCheckAll(curGrid);\t\tc.cell.firstChild.checked = true;\t\tc.cell.firstChild.display = \"\";\t}\tRefreshCommandUI();\tif(curGrid.canribbon)\t{\t\tif(curGrid.getRowById(id)._locked)\t\t{\t\t\tSelectRibbonTab(\"Ribbon.ListItem\", true);\t\t\t//var wp2 = document.getElementById('Ribbon.ListItem-title');\t\t\t//if(wp2)\t\t\t//\tfireEvent(wp2.firstChild, 'click');\t\t}\t}}function UnCheckAll(grid){\tgrid.forEachRow(function (id) {\t\tvar c = this.cells(id, 0);\t\tif (c.isCheckbox())\t\t{\t\t\tc.cell.firstChild.checked = false;\t\t\tc.cell.firstChild.display = \"none\";\t\t}\t});}function viewItemtest-grid-id(link, action){    var rowIdFull = link.parentNode.parentNode.parentNode.parentNode.parentNode.idd;    var weburl = mygridtest-grid-id.getUserData(rowIdFull,\"SiteUrl\");    var listId = mygridtest-grid-id.getUserData(rowIdFull,\"listid\");    var webid = mygridtest-grid-id.getUserData(rowIdFull,\"webid\");    var siteid = mygridtest-grid-id.getUserData(rowIdFull,\"siteid\");    var editurl = mygridtest-grid-id.getUserData(rowIdFull,\"editurl\");    var viewurl = mygridtest-grid-id.getUserData(rowIdFull,\"viewurl\");    var itemId = mygridtest-grid-id.getUserData(rowIdFull,\"itemid\");    var FullURL = mygridtest-grid-id.getUserData(rowIdFull,\"FullURL\");    var wurl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=\" + action + \"&ListId=\" + listId + \"&ID=\" + itemId + \"&gridid=test-grid-id&siteid=\" + siteid + \"&webid=\" + webid + \"&rowid=\" + rowIdFull;        function myCallback(dialogResult, returnValue)\t{\t\tif(dialogResult == 1)\t\t{\t\t\tvar weburl = curGrid.getUserData(curRowId,\"SiteUrl\");\t\t\tvar listid = curGrid.getUserData(curRowId,\"listid\");\t\t\tvar itemid = curGrid.getUserData(curRowId,\"itemid\");\t\t\tvar webid = curGrid.getUserData(curRowId,\"webid\");\t\t\tvar siteid = curGrid.getUserData(curRowId,\"siteid\");\t\t\tgetSingleItemtest-grid-id(siteid,webid,listid,itemid,curRowId);\t\t}\t}\tvar options = { url: wurl, width: 600, dialogReturnValueCallback:myCallback };\tSP.UI.ModalDialog.showModalDialog(options);}function onKeyPresstest-grid-id(key, control, shift){\tif(!mygridtest-grid-id.editor)\t{\t\tif(key == 46)\t\t{\t\t\tvar rowId = mygridtest-grid-id.getSelectedRowId();\t\t\t\t\tvar isNew = mygridtest-grid-id.getUserData(rowId,\"isNewRow\");\t\t\tvar itemid = mygridtest-grid-id.getUserData(rowId,\"itemid\");\t\t\tif(isNew != \"1\" && itemid != \"\")\t\t\t{\t\t\t\tif(confirm('Are you sure you want to delete this item?')){\t\t\t\t\tmygridtest-grid-id.deleteRow(rowId);\t\t\t\t};            }\t\t}\t}\treturn true;}function newItemtest-grid-id(usepopup){\tvar wurl = mygridtest-grid-id._newitemurl;\tif(usepopup)\t{\t\tfunction NewItemCallback(dialogResult, returnValue){if(dialogResult){window.location.href=window.location.href;}}\t\tvar options = { url: wurl, width: 600, dialogReturnValueCallback:NewItemCallback };\t\tSP.UI.ModalDialog.showModalDialog(options);\t}\telse\t{\t\tlocation.href = wurl;\t}}function setDefaultstest-grid-id(id){\tvar dxml = id.xmlLoader;\t\tvar rows = dxml.doXPath(\"//rows/row[@id='_NEWROW_']\");\t\tvar ua = window.navigator.userAgent;    var msie = ua.indexOf(\"MSIE \");\tif (msie > 0)\t\tdefaultxmltest-grid-id = rows[0].xml;\telse\t\tdefaultxmltest-grid-id = rows[0].outerHTML;\tmygridtest-grid-id._defaults = defaultxmltest-grid-id;}function onEditCelltest-grid-id(stage, rowId, ind, nval, oval){\tif(stage != 2)        return true;        \tif(oval == null)\t\toval = \"\";\tif(!checkMintest-grid-id(rowId,ind,nval))    {        mygridtest-grid-id.cells(rowId,ind).setValue(oval);        return;    }        if(!checkMaxtest-grid-id(rowId,ind,nval))    {        mygridtest-grid-id.cells(rowId,ind).setValue(oval);        return;    }        //alert(\"OLD: \" + oval + \"\\r\\nNEW: \" + nval + \"\\r\\nTitle: \" + mygridtest-grid-id.cells(rowId,ind).getTitle());    \tif(stage == 2 && oval != nval)\t{\t\tvar isNew = mygridtest-grid-id.getUserData(rowId,\"isNewRow\");\t\tif(isNew != null && isNew == \"1\")\t\t{\t\t\tmygridtest-grid-id.setUserData(rowId,\"isNewRow\",\"\");\t\t\tmygridtest-grid-id.cells(rowId,0).setValue(\"\");\t\t\tinsertBlankRowtest-grid-id();\t\t}\t}\treturn true;}function insertBlankRowtest-grid-id(id){\tvar xmlDoc; \tvar moz = (typeof document.implementation != 'undefined') && (typeof \tdocument.implementation.createDocument != 'undefined'); \tvar ie = (typeof window.ActiveXObject != 'undefined'); \tif (window.DOMParser)\t{\t\tparser=new DOMParser();\t\txmlDoc=parser.parseFromString(defaultxmltest-grid-id,\"text/xml\");\t}\telse // code for IE\t{\t\txmlDoc=new ActiveXObject(\"Microsoft.XMLDOM\");\t\txmlDoc.async=false;\t\txmlDoc.loadXML(defaultxmltest-grid-id); \t}\tvar newId = \"_NEWROW_\" + mygridtest-grid-id.getUID();\tvar nRow = mygridtest-grid-id.addRow(newId,\"<img src=\\\"/_layouts/images/newitem.gif\\\">\");\txmlDoc.firstChild.setAttribute(\"id\",newId);\t\tsetRowValuetest-grid-id(xmlDoc.firstChild);\tmygridtest-grid-id.setUserData(newId,\"isNewRow\",\"1\");\tmyDataProcessortest-grid-id.setUpdated(newId,false);\t}dhtmlXGridObject.prototype.alerterror=function(msg){    document.getElementById(\"errordiv\" + this._gridid).innerHTML = \"Error: \" + msg;};dhtmlXGridObject.prototype.setuppaging=function(records){    \tvar pages = Math.ceil(records / this.PageSize);\tvar prev = document.getElementById(\"PagePrevious\"+ this._gridid);\tvar next = document.getElementById(\"PageNext\"+ this._gridid);\tvar pagediv = document.getElementById(\"pagediv\"+ this._gridid);\tvar pagetable = document.getElementById(\"pagetable\"+ this._gridid);\tif(this.UseReporting)\t{\t\tif(pages > 1)\t\t{\t\t\tif(!bPageSetuptest-grid-id)\t\t\t{\t\t\t\tbPageSetuptest-grid-id = true;\t\t\t\t$(\"#pagedivtest-grid-id\").paginate({\t\t\t\t\tcount \t\t: pages,\t\t\t\t\tstart \t\t: 1,\t\t\t\t\tdisplay     : 12,\t\t\t\t\tborder\t\t\t\t\t: true,\t\t\t\t\trotate      : false,\t\t\t\t\timages\t\t: false,\t\t\t\t\tmouse\t\t: 'press',\t\t\t\t\tonChange\t: ChangePagetest-grid-id\t\t\t\t});\t\t\t}\t\t}\t\telse\t\t{\t\t\tpagediv.style.display = \"none\";\t\t\tpagetable.style.display = \"none\";\t\t}\t}\telse\t{\t\tpagediv.style.display = \"inline-block\";\t\tpagetable.style.display = \"\";\t\tvar rec = records.split('|');\t\tfirstItemtest-grid-id = parseInt(rec[2]) * -1;\t\tlastItemtest-grid-id = rec[1];\t\tif(rec[0] == \"0\" || fItemHidetest-grid-id == firstItemtest-grid-id)\t\t{\t\t\tprev.style.background = \"#EFEFEF\";\t\t\tfItemHidetest-grid-id = firstItemtest-grid-id;\t\t}\t\telse\t\t{\t\t\tprev.style.background = \"#DDDDDD\";\t\t}\t\tif(rec[3] == \"true\")\t\t\tnext.style.background = \"#DDDDDD\";\t\telse\t\t{\t\t\tprev.style.background = \"#EFEFEF\";\t\t\tlastItemtest-grid-id = 0;\t\t}\t\tif(rec[3] != \"true\" && rec[0] == \"0\")\t\t{\t\t\tpagediv.style.display = \"none\";\t\t\tpagetable.style.display = \"none\";\t\t}\t}};dhtmlXGridObject.prototype.registerLookuptest-grid-id=function(col,vals){    if(arrColumnLookupstest-grid-id == null)        arrColumnLookupstest-grid-id = new Array(mygridtest-grid-id.getColumnsNum());\t\t    arrColumnLookupstest-grid-id[col] = vals;};//======================Multi User=====================function changeUsertest-grid-id(chkVal){\tdocument.getElementById(\"_downlevelTextBox\").value = \"\";\tdocument.getElementById(\"_upLevelDiv\").innerHTML = \"\";\t\t\tif(document.getElementById(\"_upLevelDiv\").firstChild == null)\t{\t\tvar oTN=document.createTextNode(\"\");\t\tdocument.getElementById(\"_upLevelDiv\").appendChild(oTN);\t}\tdocument.getElementById(\"_upLevelDiv\").firstChild.nodeValue = \"\";\t//chkVal.options[chkVal.selectedIndex].value;}function eXcell_usereditorm(cell){                                    //excell name is defined here    if (cell){                                                     //default pattern, just copy it        this.cell = cell;        this.grid = this.cell.parentNode.grid;        if(!this.grid._grid_pe)        {\t\t\tvar z=document.getElementById(\"people\" + cell.parentNode.grid.entBox.id);\t\t\tz.onclick=function(e){ (e||event).cancelBubble=true; }\t\t\t\t\t\tif (_isIE) { \t\t\t\tz.style.position=\"absolute\"\t\t\t\tz.style.top=\"0px\"\t\t\t}\t\t\tdocument.body.insertBefore(z,document.body.firstChild);\t\t\t \t\t\tthis.grid._grid_pe = z;\t\t}    }    this.setValue=function(val){\t\tvar strVal = \"&nbsp;\";\t\tvar strVals = val.split('\\t')[0].split('\\n');\t\tfor(var i = 1;i<strVals.length;i=i+2)\t\t{\t\t\tstrVal += \"; \" + strVals[i];\t\t}\t\tif(strVal != \"&nbsp;\")\t\t\tstrVal = strVal.substring(7);\t\t\t        this.setCValue(strVal);                   this.cell._displayValue = strVal;        this.cell._users = val.split('\\t')[0];                                           this.cell._Allusers = val === undefined ? [] : val.split('\\t')[1];                                       }    this.getValue=function(){       return this.cell._users; // get value    }    this.edit=function(){    \t\tthis.val=this.getValue();    \t\tdocument.getElementById(\"_downlevelTextBox\").value = \"\";\t\tdocument.getElementById(\"_upLevelDiv\").innerHTML = \"\";\t\tcopyUplevelToHidden('');\t\tupdateControlValue('');\t\tvar arg=getUplevel('');\t\tvar ctx='';\t\tEntityEditorSetWaitCursor(ctx);\t\tWebForm_DoCallback('',arg,EntityEditorHandleCheckNameResult,ctx,EntityEditorHandleCheckNameError,true);\t\t        var pp = document.getElementById(\"divPetest-grid-id\");        var ppi = document.getElementById(\"peoplecheckimgtest-grid-id\");        pp.style.display = \"none\";        ppi.src = \"_layouts/images/TPMAX1.GIF\";                    \t\tvar strVal = \"\";\t\tvar strAllUserChecks = \"\";\t\tvar strVals = this.cell._users.split('\\n');\t\tvar strAllUsers = this.cell._Allusers === undefined ? [] : this.cell._Allusers.split('\\n');\t\tvar strUserNames = '\\t';\t\t\t\tfor(var i = 0;i<strVals.length;i=i+2)\t\t{\t\t\tstrUserNames += strVals[i].toLowerCase() + '\\t';\t\t\tstrVal += \"; \" + strVals[i];\t\t}\t\tif(strVal.length > 1)\t\t\tstrVal = strVal.substring(1);\t\t\t\t\tfor(var i = 0;i<strAllUsers.length;i++)\t\t{\t\t\tvar isChecked = \"\";\t\t\tvar userInfo = strAllUsers[i].split(';#');\t\t\t\t\t\tif(strUserNames.indexOf('\\t' + userInfo[0].toLowerCase() + '\\t') > -1)\t\t\t\tisChecked = \"checked\";\t\t\t\t\t\t\tstrAllUserChecks += \"<br><input type=\\\"checkbox\\\" name=\\\"chkUserstest-grid-id\\\" value=\\\"\" + userInfo[0] + \"\\\" \" + isChecked + \">\" + userInfo[1];\t\t}\t\tif(strAllUserChecks.length > 1)\t\t\tstrAllUserChecks = strAllUserChecks.substring(4);\t\t\t\t\tdocument.getElementById(\"peoplechecktest-grid-id\").innerHTML = strAllUserChecks;\t\t\tvar arPos = this.grid.getPosition(this.cell);\t\tif(arPos[0] + 200 > document.body.clientWidth)\t\t\tthis.grid._grid_pe.style.left=document.body.clientWidth - 210;\t\telse\t\t\tthis.grid._grid_pe.style.left=arPos[0];\t\t\t\tif((arPos[1] + 100) > (document.body.clientHeight + document.body.scrollTop))\t\t\tthis.grid._grid_pe.style.top=document.body.clientHeight + document.body.scrollTop - 105;\t\telse\t\t\tthis.grid._grid_pe.style.top=arPos[1];\t\tthis.grid._grid_pe.style.display=\"\";\t\tthis.grid._grid_pe.style.position = \"absolute\";\t\tthis.grid._grid_pe.style.zIndex  = 99;    }    this.detach=function(){\t\tthis.grid._grid_pe.style.display=\"none\";\t\t\t\tvar strUsers = \"\";\t\tvar divChecks = document.getElementById(\"peoplechecktest-grid-id\");\t\tvar divChildChecks = divChecks.firstChild;\t\twhile(divChildChecks != null)\t\t{\t\t\tif(divChildChecks.nodeName == \"INPUT\")\t\t\t{\t\t\t\tif(divChildChecks.checked)\t\t\t\t{\t\t\t\t\tstrUsers += '\\n' + divChildChecks.value;\t\t\t\t\tstrUsers += '\\n' + divChildChecks.nextSibling.nodeValue;\t\t\t\t}\t\t\t}\t\t\tdivChildChecks = divChildChecks.nextSibling;\t\t}\t\tfor(var i = 0;i<document.getElementById(\"_upLevelDiv\").childNodes.length;i=i+2)\t\t{\t\t\tif(document.getElementById(\"_upLevelDiv\").childNodes[i].firstChild != null)\t\t\t{\t\t\t\tstrUsers += '\\n' + document.getElementById(\"_upLevelDiv\").childNodes[i].title;\t\t\t\tstrUsers += '\\n' + document.getElementById(\"_upLevelDiv\").childNodes[i].firstChild.nextSibling.innerText;\t\t\t}\t\t}\t\tif(strUsers.length > 1)\t\t\tstrUsers = strUsers.substring(1);\t\t\t\tvar oldValue = this.getValue();\t\t\t\t\tif(this.cell._Allusers !== undefined)\t\t\tthis.setValue(strUsers + '\\t' + this.cell._Allusers);         return oldValue != this.getValue();    }}eXcell_usereditorm.prototype = new eXcell;//================================User Single=================function eXcell_usereditor(cell){                                    //excell name is defined here    if (cell){        this.cell = cell;        this.grid = this.cell.parentNode.grid;        if(!this.grid._grid_pes)        {\t\t\tvar z=document.getElementById(\"peoplesingle\" + cell.parentNode.grid.entBox.id);\t\t\tz.onclick=function(e){ (e||event).cancelBubble=true; }\t\t\t\t\t\tif (_isIE) { \t\t\t\tz.style.position=\"absolute\"\t\t\t\tz.style.top=\"0px\"\t\t\t}\t\t\tdocument.body.insertBefore(z,document.body.firstChild);\t\t\t \t\t\tthis.grid._grid_pes = z;\t\t}    }    this.setValue=function(val){\t\tvar strVal = \"&nbsp;\";\t\tvar strVals = val.split('\\t')[0].split('\\n');\t\t\t\tfor(var i = 1;i<strVals.length;i=i+2)\t\t{\t\t\tstrVal += \"; \" + strVals[i];\t\t}\t\tif(strVal != \"&nbsp;\")\t\t\tstrVal = strVal.substring(7);\t\t\t        this.setCValue(strVal);                   this.cell._displayValue = strVal;        this.cell._users = val.split('\\t')[0];                                           this.cell._Allusers = val === undefined ? [] : val.split('\\t')[1];                                       }    this.getValue=function(){\t\t       return this.cell._users; // get value    }    this.edit=function(){\t\tthis.val=this.getValue();        var pp = document.getElementById(\"divPestest-grid-id\");        var ppi = document.getElementById(\"peoplechecksingleimgtest-grid-id\");        pp.style.display = \"none\";        ppi.src = \"_layouts/images/TPMAX1.GIF\";\t\tvar strVal = \"\";\t\tvar strAllUserChecks = \"\";\t\tvar strVals = this.cell._users.split('\\n');\t\tvar strAllUsers = this.cell._Allusers === undefined ? [] : this.cell._Allusers.split('\\n');\t\tvar strUserNames = '\\t';\t\tfor(var i = 0;i<strVals.length;i=i+2)\t\t{\t\t\tstrUserNames += strVals[i].toLowerCase() + '\\t';\t\t\tstrVal += \"; \" + strVals[i];\t\t}\t\tif(strVal.length > 1)\t\t\tstrVal = strVal.substring(1);\t\tvar slct = document.getElementById(\"peoplecheckselecttest-grid-id\");\t\tslct.options.length=0;\t\tvar oSelected = -1;\t\tvar oCounter = 0;\t\tfor(var i = 0;i<strAllUsers.length;i++)\t\t{\t\t\tvar isChecked = false;\t\t\tvar userInfo = strAllUsers[i].split(';#');\t\t\t\t\t\tif(strUserNames.indexOf('\\t' + userInfo[0].toLowerCase() + '\\t') > -1)\t\t\t\toSelected = oCounter;\t\t\t\t\t\t\tvar elOptNew = document.createElement('option');            elOptNew.text = userInfo[1];            elOptNew.value = userInfo[0];            try            {                slct.add(elOptNew, null);            }            catch(ex)            {                slct.add(elOptNew);            }\t\t\t\t\t\t\t\t\t\t//slct.add(new Option(userInfo[1], userInfo[0], false, isChecked));\t\t\toCounter++;\t\t}\t\t\t\tslct.selectedIndex = oSelected;\t\t\t\tdocument.getElementById(\"_downlevelTextBox\").value = \"\";\t\tdocument.getElementById(\"_upLevelDiv\").innerHTML = \"\";\t\t/*\t\tif(document.getElementById(\"_upLevelDiv\").firstChild == null)\t\t{\t\t\tvar oTN=document.createTextNode(\"\");\t\t\tdocument.getElementById(\"_upLevelDiv\").appendChild(oTN);\t\t}\t\tdocument.getElementById(\"_upLevelDiv\").firstChild.nodeValue = strVal;\t\t*/\t\tcopyUplevelToHidden('');\t\tupdateControlValue('');\t\tvar arg=getUplevel('');\t\tvar ctx='';\t\t\t\tEntityEditorSetWaitCursor(ctx);\t\tWebForm_DoCallback('',arg,EntityEditorHandleCheckNameResult,ctx,EntityEditorHandleCheckNameError,true);\t\t\t\t\t\tvar arPos = this.grid.getPosition(this.cell);\t\tif(arPos[0] + 200 > document.body.clientWidth)\t\t\tthis.grid._grid_pes.style.left=document.body.clientWidth - 210;\t\telse\t\t\tthis.grid._grid_pes.style.left=arPos[0];\t\t\t\tif((arPos[1] + 100) > (document.body.clientHeight + document.body.scrollTop))\t\t\tthis.grid._grid_pes.style.top=document.body.clientHeight + document.body.scrollTop - 105;\t\telse\t\t\tthis.grid._grid_pes.style.top=arPos[1];\t\tthis.grid._grid_pes.style.display=\"\";\t\tthis.grid._grid_pes.style.position = \"absolute\";\t\tthis.grid._grid_pes.style.zIndex  = 99;    }    this.detach=function(){\t\tthis.grid._grid_pes.style.display=\"none\";\t\t\t\tvar strUsers = \"\";\t\tfor(var i = 0;i<document.getElementById(\"_upLevelDiv\").childNodes.length;i=i+2)\t\t{\t\t\tif(document.getElementById(\"_upLevelDiv\").childNodes[i].firstChild != null)\t\t\t{\t\t\t\tstrUsers += '\\n' + document.getElementById(\"_upLevelDiv\").childNodes[i].title;\t\t\t\tstrUsers += '\\n' + document.getElementById(\"_upLevelDiv\").childNodes[i].firstChild.nextSibling.innerText;\t\t\t}\t\t}\t\tif(strUsers == \"\")\t\t{\t\t\tvar chkVal = document.getElementById(\"peoplecheckselecttest-grid-id\");\t\t\tif(chkVal.selectedIndex > -1)\t\t\t{\t\t\t\tstrUsers += '\\n' + chkVal.options[chkVal.selectedIndex].value;\t\t\t\tstrUsers += '\\n' + chkVal.options[chkVal.selectedIndex].text;\t\t\t}\t\t}\t\t\t\tif(strUsers.length > 1)\t\t\tstrUsers = strUsers.substring(1);\t\t\t\tvar oldValue = this.getValue();\t\t\t\t\tif(this.cell._Allusers !== undefined)\t\t\tthis.setValue(strUsers + '\\t' + this.cell._Allusers);         return oldValue != this.getValue();    }}eXcell_usereditor.prototype = new eXcell;//=========================choice========================function eXcell_choice(cell){                                    //excell name is defined here    if (cell){\t\t\t\t\t\t\t\t\t\t\t\t\t//default pattern, just copy it        this.cell = cell;        this.grid = this.cell.parentNode.grid;    }    this.setValue=function(val){\t\tvar strVal = \"\";\t\tvar dispVal = \"&nbsp;\";\t\tif(val == \";#\")\t\t\tval = \"\";\t\t\t\t\tval = val.replace(/&amp;/g,\"&\");\t\t\t\tif(val.split('\\t')[0] != \"\")\t\t{\t\t\tstrVal = val.split('\\t')[0];\t\t\tdispVal = strVal.split(';#')[1].replace(/&/g,\"&amp;\");\t\t}        this.setCValue(dispVal);        this.cell._value = strVal;        if(val.split('\\t').length > 1)\t\t\tthis.cell._allvalues = val.split('\\t')[1];    }    this.getValue=function(){\t\treturn this.cell._value;    }    this.edit=function(){\t\tthis.val=this.getValue();\t\tvar arPos = this.grid.getPosition(this.cell) //,this.grid.objBox)\t\tvar allvals = this.cell._allvalues;\t\tthis.obj=document.createElement(\"TEXTAREA\");\t\tthis.obj.className=\"dhx_combo_edit\";\t\tthis.obj.style.height=(this.cell.offsetHeight-4)+\"px\";\t\tthis.obj.wrap=\"soft\";\t\tthis.obj.style.textAlign=this.cell.align;\t\tthis.obj.onclick=function(e){\t\t\t(e||event).cancelBubble=true\t\t}\t\tthis.obj.value=this.text\t\tthis.obj.onselectstart=function(e){\t\t\tif (!e)\t\t\t\te=event;\t\t\te.cancelBubble=true;\t\t\treturn true;\t\t};\t\tvar editor_obj = this;\t\tthis.obj.onkeyup=function(e){\t\t\tvar val = this.readonly ? String.fromCharCode((e||event).keyCode) : this.value;\t\t\tvar c = editor_obj.list.options;\t\t\tfor (var i = 0; i < c.length; i++)\t\t\t\tif (c[i].text.indexOf(val) == 0)\t\t\t\t\treturn c[i].selected=true;\t\t}\t\tthis.list=document.createElement(\"SELECT\");\t\tthis.list.className='dhx_combo_select';\t\tthis.list.style.width=this.cell.offsetWidth+\"px\";\t\tthis.list.style.left=arPos[0]+\"px\";                       //arPos[0]\t\tthis.list.style.top=arPos[1]+this.cell.offsetHeight+\"px\"; //arPos[1]+this.cell.offsetHeight;\t\tthis.list.onclick=function(e){\t\t\tvar ev = e||window.event;\t\t\tev.cancelBubble=true;\t\t\tvar cell = ev.target||ev.srcElement\t\t\t//tbl.editor_obj.val=cell.combo_val;\t\t\tif (cell.tagName == \"OPTION\")\t\t\t\tcell=cell.parentNode;\t\t\teditor_obj.setValue(cell.value + \";#\" + cell.text);\t\t\teditor_obj.editable=false;\t\t\teditor_obj.grid.editStop();\t\t}\t\tvar comboKeys = this.cell._allvalues.split('\\n');\t\tvar fl = false;\t\tvar selOptId = 0;\t\tfor (var i = 0; i < comboKeys.length; i++){\t\t\tvar val = comboKeys[i].split(';#');\t\t\t\t\t\tvar elOptNew = document.createElement('option');            elOptNew.text = val[1];            elOptNew.value = val[0];            \t\t\tthis.list.options[this.list.options.length]=elOptNew\t\t\tif (comboKeys[i] == this.val){\t\t\t\tselOptId=this.list.options.length-1;\t\t\t\tfl=true;\t\t\t}\t\t}\t\tif (fl == false){ //if no such value in combo list\t\t\t\t\t\tvar elOptNew = document.createElement('option');            elOptNew.text = this.text;            elOptNew.value = this.val;            \t\t\t//this.list.options[this.list.options.length]=new Option(this.text, this.val === null ? \"\" : this.val);\t\t\t//this.list.options[this.list.options.length]=elOptNew;\t\t\t//selOptId=this.list.options.length-1;\t\t}\t\tdocument.body.appendChild(this.list) //nb:this.grid.objBox.appendChild(this.listBox);\t\tthis.list.size=\"6\";\t\tthis.cstate=1;\t\tif (this.editable){\t\t\tthis.cell.innerHTML=\"\";\t\t}\t\telse {\t\t\tthis.obj.style.width=\"1px\";\t\t\tthis.obj.style.height=\"1px\";\t\t}\t\tthis.cell.appendChild(this.obj);\t\tthis.list.options[selOptId].selected=true;\t\t\t\t    }    this.detach=function(){\t\t\t\tif (this.val != this.getValue())\t\t{\t\t\tthis.cell.wasChanged=true;\t\t}\t\tvar curVal = this.getValue();\t\tvar newVal = this.list.options[this.list.selectedIndex].value + \";#\" + this.list.options[this.list.selectedIndex].text;\t\tif(newVal == \";#\")\t\t\tnewVal = \"\";\t\t\t\tthis.setValue(newVal);\t\t\t\t\t\t/*if (this.list.parentNode != null)\t\t{\t\t\t\tif (this.obj.value._dhx_trim() != this.text){\t\t\t\t\tif (this.list.selectedIndex&&this.list.options[this.list.selectedIndex].text == this.obj.value)\t\t\t\t\t\tthis.setValue(this.list.value + '\\t' + this.cell._allvalues)\t\t\t\t\telse\t\t\t\t\t\tthis.setValue(this.obj.value + '\\t' + this.cell._allvalues)\t\t\t\t} else {\t\t\t\t\tthis.setValue(this.val + '\\t' + this.cell._allvalues)\t\t\t\t}\t\t}*/\t\tif (this.list.parentNode)\t\t\tthis.list.parentNode.removeChild(this.list);\t\tif (this.obj.parentNode)\t\t\tthis.obj.parentNode.removeChild(this.obj);\t\treturn newVal != curVal;\t\t    }}eXcell_choice.prototype = new eXcell;//=========================multichoice========================function eXcell_mchoice(cell){                                    //excell name is defined here    if (cell){                                                     //default pattern, just copy it        this.cell = cell;        this.grid = this.cell.parentNode.grid;        if(!this.grid._grid_mc)        {\t\t\tvar z=document.getElementById(\"multichoice\" + cell.parentNode.grid.entBox.id);\t\t\tz.onclick=function(e){ (e||event).cancelBubble=true; }\t\t\t\t\t\tif (_isIE) { \t\t\t\tz.style.position=\"absolute\"\t\t\t\tz.style.top=\"0px\"\t\t\t}\t\t\tdocument.body.insertBefore(z,document.body.firstChild); \t\t\tthis.grid._grid_mc = z;\t\t}    }    this.setValue=function(val){\t\tvar strVal = \"\";\t\t\t\tif(val.split('\\t')[0] != \"\")\t\t{\t\t\tvar strVals = val.split('\\t')[0].split('\\n');\t\t\tfor(var i = 0;i<strVals.length;i++)\t\t\t{\t\t\t\tvar valInfo = strVals[i].split(';#');\t\t\t\tstrVal += \", \" + valInfo[1];\t\t\t}\t\t\tif(strVal != \"\")\t\t\t\tstrVal = strVal.substring(2);\t\t}\t\tif(strVal != \"\")\t\t\tthis.setCValue(strVal.replace(\"&\",\"&amp;\"));\t\telse\t\t\tthis.setCValue(\"&nbsp;\");\t\t        this.cell._displayValue = strVal;        this.cell._values = val.split('\\t')[0];        this.cell._allvalues = val.split('\\t')[1];    }    this.getValue=function(){\t\treturn this.cell._values;    }    this.edit=function(){\t\tthis.val=this.getValue();\t\tvar strAllValueChecks = \"\";\t\tvar strVals = this.cell._values.split('\\n');\t\tvar strAllValues = this.cell._allvalues.split('\\n');\t\tvar strValues = '\\t';\t\t\t\tfor(var i = 0;i<strVals.length;i++)\t\t{\t\t\tvar valInfo = strVals[i].split(';#');\t\t\t\t\tstrValues += valInfo[0].toLowerCase() + '\\t';\t\t}\t\tfor(var i = 0;i<strAllValues.length;i++)\t\t{\t\t\tvar isChecked = \"\";\t\t\tvar valInfo = strAllValues[i].split(';#');\t\t\t\t\t\tif(strValues.indexOf('\\t' + valInfo[0].toLowerCase() + '\\t') > -1)\t\t\t\tisChecked = \"checked\";\t\t\tstrAllValueChecks += \"<br><input type=\\\"checkbox\\\" name=\\\"chkValuestest-grid-id\\\" value=\\\"\" + valInfo[0] + \"\\\" \" + isChecked + \">\" + valInfo[1];\t\t}\t\tif(strAllValueChecks.length > 1)\t\t\tstrAllValueChecks = strAllValueChecks.substring(4);\t\t\t\t\tdocument.getElementById(\"multichoiceinnertest-grid-id\").innerHTML = strAllValueChecks;\t\tvar arPos = this.grid.getPosition(this.cell);\t\tif(arPos[0] + 200 > document.body.clientWidth)\t\t\tthis.grid._grid_mc.style.left=document.body.clientWidth - 210;\t\telse\t\t\tthis.grid._grid_mc.style.left=arPos[0];\t\t\t\tif((arPos[1] + 100) > (document.body.clientHeight + document.body.scrollTop))\t\t\tthis.grid._grid_mc.style.top=document.body.clientHeight + document.body.scrollTop - 105;\t\telse\t\t\tthis.grid._grid_mc.style.top=arPos[1];\t\tthis.grid._grid_mc.style.display=\"\";\t\tthis.grid._grid_mc.style.position = \"absolute\";\t\tthis.grid._grid_mc.style.zIndex  = 99;    }    this.detach=function(){\t\t\t\tthis.grid._grid_mc.style.display=\"none\";\t\t\t\tvar child = document.getElementById(\"multichoiceinnertest-grid-id\").firstChild;\t\tvar val1 = \"\";\t\twhile(child != null)\t\t{\t\t\tif(child.nodeName == \"INPUT\")\t\t\t{\t\t\t\tif(child.checked)\t\t\t\t{\t\t\t\t\tval1 += '\\n' + child.value + \";#\" + child.nextSibling.nodeValue;\t\t\t\t}\t\t\t}\t\t\tchild = child.nextSibling;\t\t}\t\tif(val1.length > 1)\t\t\tval1 = val1.substring(1);\t\t\t\t\t\t\tvar oldValue = this.getValue();\t\t\t\tthis.cell._values = val1;\t\t\t        this.setValue(val1 + '\\t' + this.cell._allvalues);         return oldValue != this.getValue();\t\t    }}eXcell_mchoice.prototype = new eXcell;//=========================Calendar===========================eXcell_dhxCalendarA.prototype.edit = function(){\t                    var top;                    var left;                                        var arPos = this.grid.getPosition(this.cell);\t\t\t\t\tif(arPos[0] + this.cell.offsetWidth + 180 > document.body.clientWidth)\t\t\t\t\t\tleft = arPos[0] - 185;\t\t\t\t\telse\t\t\t\t\t\tleft=arPos[0] + this.cell.offsetWidth;\t\t\t\t\t\t\t\t\t\tif((arPos[1] + 170) > (document.body.clientHeight + document.body.scrollTop))\t\t\t\t\t\ttop=document.body.clientHeight + document.body.scrollTop - 180;\t\t\t\t\telse\t\t\t\t\t\ttop=arPos[1];                                        this.grid._grid_calendarA.setPosition(top,left);                    \t                    this.grid._grid_calendarA.show();\t                    this.grid._grid_calendarA._last_operation_calendar=false;\t\t\t\t\t//var arPos = this.grid.getPosition(this.cell);                    //var pval=this._date2str2(this.cell.val||new Date());                    //window._grid_calendar.render(arPos[0],arPos[1]+this.cell.offsetHeight,this,pval);                    this.cell._cediton=true;                    this.val=this.cell.val;                    //this.val=this.getValue();                    this._val=this.cell.innerHTML;                   // alert(this.cell.val);\t\t\t\t   \tthis.grid._grid_calendarA.setDateFormat((this.grid._dtmask||\"%d/%m/%Y\"));                    this.grid._grid_calendarA.setDate(this.val);                    this.grid._grid_calendarA.draw();                    \t\t\t\t\tthis.cell.atag=((!this.grid.multiLine)&&(_isKHTML||_isMacOS||_isFF))?\"INPUT\":\"TEXTAREA\";\t\t\t\t\t\t\t\t\t\tthis.obj = document.createElement(this.cell.atag);\t\t\t\t\tthis.obj.style.height = (this.cell.offsetHeight-(_isIE?4:2))+\"px\";                    this.obj.className=\"dhx_combo_edit\";\t\t\t\t   \tthis.obj.wrap = \"soft\";\t\t\t\t\tthis.obj.style.textAlign = this.cell.align;\t\t\t\t\tthis.obj.onclick = function(e){(e||event).cancelBubble = true}\t\t\t\t\tthis.obj.onmousedown = function(e){(e||event).cancelBubble = true}\t\t\t\t\tthis.obj.value = this.getValue();\t\t\t\t\tthis.cell.innerHTML = \"\";\t\t\t\t\tthis.cell.appendChild(this.obj);\t\t\t\t  \tif (_isFF) {\t\t\t\t\t\tthis.obj.style.overflow=\"visible\";\t\t\t\t\t\tif ((this.grid.multiLine)&&(this.obj.offsetHeight>=18)&&(this.obj.offsetHeight<40)){\t\t\t\t\t\t\tthis.obj.style.height=\"36px\";\t\t\t\t\t\t\tthis.obj.style.overflow=\"scroll\";\t\t\t\t\t\t}\t\t\t\t\t}                    this.obj.onselectstart=function(e){  if (!e) e=event; e.cancelBubble=true; return true;  };\t\t\t\t\tthis.obj.focus()  \t\t\t\t\tthis.obj.focus()\t\t\t\t                    \t\t\t\t}//============================================================function getSingleItemtest-grid-id(siteid,webid,listid,itemid,rowid){\tvar val = SP.UI.Notify.addNotification(\"Updating Saved Row...\", false,  \"\", null);\tdhtmlxAjax.post(singleItemUrltest-grid-id, \"siteid=\" + siteid + \"&webid=\" + webid + \"&listid=\" + listid + \"&itemid=\" + itemid + \"&rowid=\" + rowid,getSingleItemResponsetest-grid-id);}function getSingleItemResponsetest-grid-id(loader){\tif(loader.xmlDoc.responseText!=null)\t{\t\tvar xmlDoc = loader.xmlDoc.responseXML;\t\tfor(var i = 0;i<xmlDoc.childNodes.length;i++)\t\t{\t\t\tvar rowXml = xmlDoc.childNodes[i];\t\t\tsetRowValuestest-grid-id(rowXml);\t\t}\t}\telse\t\talert(\"Response contains no XML\");}function setRowValuestest-grid-id(rowsXml){\tfor(var i = 0;i<rowsXml.childNodes.length;i++)\t{\t\tsetRowValuetest-grid-id(rowsXml.childNodes[i])\t}}function setRowValuetest-grid-id(rowXml){\tvar rowId = rowXml.getAttribute(\"id\")\t\tvar cellCounter = 0;\tfor(var i = 0;i<rowXml.childNodes.length;i++)\t{\t\tif(rowXml.childNodes[i].nodeName == \"userdata\")\t\t{\t\t\tif(rowXml.childNodes[i].firstChild != null)\t\t\t\tmygridtest-grid-id.setUserData(rowId,rowXml.childNodes[i].getAttribute(\"name\"),rowXml.childNodes[i].firstChild.nodeValue);\t\t}\t\telse if(rowXml.childNodes[i].nodeName == \"cell\")\t\t{\t\t\tif(!inEditModetest-grid-id)\t\t\t{\t\t\t\tif(mygridtest-grid-id.getColType(cellCounter) != \"tree\")\t\t\t\t\tmygridtest-grid-id.setCellExcellType(rowId, cellCounter, \"ro\");\t\t\t\t\t\t\t\t\tmygridtest-grid-id.lockRow(rowId, true);\t\t\t}\t\t\t\t\t\tvar cellval = \"\";\t\t\tvar celltype = \"\";\t\t\ttry\t\t\t{\t\t\t\tcelltype = rowXml.childNodes[i].getAttribute(\"type\");\t\t\t}catch(e){}\t\t\t\t\t\t\t\t\tif(rowXml.childNodes[i].childNodes.length > 0)\t\t\t{\t\t\t\tcellval = rowXml.childNodes[i].firstChild.nodeValue;\t\t\t}\t\t\t\t\t\tif(celltype == \"combo\")\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(rowXml.childNodes[i]);\t\t\t\telse\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(cellval);\t\t\t\tcellCounter++;\t\t}\t}\t}function saveGridtest-grid-id(){\tmygridtest-grid-id.editStop();    sm('dlgSavingtest-grid-id',200,100);    if(myDataProcessortest-grid-id.updatedRows.length > 0)    {        myDataProcessortest-grid-id.sendData();    }    else        hm('dlgSavingtest-grid-id');}function onButtonClicktest-grid-id(menuitemId,grid_Id,grid){    var rowIdFull = grid_Id.split(\"_\")[0];    var weburl = context_grid.getUserData(rowIdFull,\"SiteUrl\");    var listId = context_grid.getUserData(rowIdFull,\"listid\");    var editurl = context_grid.getUserData(rowIdFull,\"editurl\");    var viewurl = context_grid.getUserData(rowIdFull,\"viewurl\");    var itemId = context_grid.getUserData(rowIdFull,\"itemid\");    var webId = context_grid.getUserData(rowIdFull,\"webid\");    var siteid = context_grid.getUserData(rowIdFull,\"siteid\");    var rowId = rowIdFull.split('.')[1];        var popup = context_grid.getUserData(rowIdFull,\"popup\");    var w = pageWidth() - 200;\tvar h = pageHeight() - 100;             switch(menuitemId)    {\t\tcase \"createworkspace\":\t\t\turl = weburl + \"/_layouts/epmlive/requestworkspace.aspx?list=\" + listidtest-grid-id + \"&ID=\" + itemId;\t\t\tdocument.location.href=url;\t\t\t\t\t\tbreak;\t\tcase \"workspace\":\t\t\tif(viewurl == null)                url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=workspace&webid=\" + webId ;            else                url = weburl;                \t\t\tdocument.location.href=url;\t\t\tbreak;\t\t\t\tcase \"workplan\":\t\t\tif(viewurl == null)\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=workplan&webid=\" + webId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\telse\t\t\t\turl = weburl + \"/_layouts/epmlive/tasks.aspx?ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t\t\t\t\tdocument.location.href=url;\t\t\tbreak;\t\t\t\t\tcase \"agile\":\t\t\tif(viewurl == null)\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=agile&webid=\" + webId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\telse\t\t\t\turl = weburl + \"/_layouts/epmlive/agile/tasks.aspx?ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t\t\t\t\tdocument.location.href=url;\t\t\tbreak;\t\t\t\tcase \"projectpro\":\t\t\tif(viewurl == null)\t\t\t{\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=getproject&webid=\" + webId + \"&ID=\" + itemId + \"&listID=\" + listId + \"&Source=\" + document.location.href;;\t\t\t\tdocument.location.href=url;\t\t\t}\t\t\telse\t\t\t{\t\t\t\tjavascript:window.open(weburl + '/_layouts/epmlive/getproject.aspx?listID=' + listId + '&ID=' + itemId,'', config='height=100,width=200, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, directories=no, status=no');\t\t\t}\t\t\tbreak;\t\t        case \"edit\":            var url = \"\";            if(popup==\"yes\")            {\t\t\t\t\t\t\t\tvar url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=viewedit2&ListId=\" + listId + \"&ID=\" + itemId + \"&Mode=2&gridid=test-grid-id&siteid=\" + siteid + \"&webid=\" + webId + \"&rowid=\" + rowIdFull;\t\t\t\tsm('editItemtest-grid-id',w,h);\t\t\t\tdocument.getElementById(\"frmEditFrametest-grid-id\").src = url;            }            else            {\t\t\t\tif(editurl == null)\t\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=edit&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t\telse\t\t\t\t\turl = editurl + \"?ListId=\" + listId + \"&ID=\" + itemId + \"&Mode=2&Source=\" + document.location.href;\t\t\t\tdocument.location.href=url;            }            break;        case \"perms\":\t\t\tvar url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=perms&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t            //var url = weburl + \"/_layouts/User.aspx?obj={\" + listId + \"},\" + itemId + \",LISTITEM&List={\" + listId + \"}&Source=\" + document.location.href;            document.location.href=url;            break;        case \"view\":\t\t\tif(popup==\"yes\")            {\t\t\t\tvar url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=viewedit2&ListId=\" + listId + \"&ID=\" + itemId + \"&Mode=1&gridid=test-grid-id&siteid=\" + siteid + \"&webid=\" + webId + \"&rowid=\" + rowIdFull;\t\t\t\tsm('editItemtest-grid-id',w,h);\t\t\t\tdocument.getElementById(\"frmEditFrametest-grid-id\").src=url;            }            else            {\t\t\t\tvar url;\t\t\t\tif(viewurl == null)\t\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=view&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t\telse\t\t\t\t\turl = viewurl + \"?ListId=\" + listId + \"&ID=\" + itemId + \"&Mode=1&Source=\" + document.location.href;\t\t\t\tdocument.location.href=url;            }            break;        case \"delete\":            if(confirm('Are you sure you want to send this item to the Recycle Bin?')){                var url;                if(viewurl == null)                {                    url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=delete&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&NextUsing=\" + document.location.href;                    document.location.href=url;                }                else                {                                            postDelete(weburl + '/_vti_bin/owssvr.dll?CS=65001&Cmd=Delete&List={' + listId + '}&ID=' + itemId + '&NextUsing=' + document.location.href);                                     }            };            break;        case \"alerts\":            var url;            if(viewurl == null)                url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=alerts&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;            else                url = weburl + \"/_layouts/SubNew.aspx?List={\" + listId + \"}&ID=\" + itemId + \"&Source=\" + document.location.href;                            document.location.href=url;            break;        case \"versions\":            var url = weburl + \"/_layouts/Versions.aspx?list={\" + listId + \"}&ID=\" + itemId + \"&Source=\" + document.location.href;            document.location.href=url;            break;        case \"approve\":            var url = weburl + \"/_layouts/approve.aspx?list={\" + listId + \"}&ID=\" + itemId + \"&Source=\" + document.location.href;            document.location.href=url;            break;        case \"workflows\":            var url = weburl + \"/_layouts/Workflow.aspx?list={\" + listId + \"}&ID=\" + itemId + \"&Source=\" + document.location.href;            document.location.href=url;            break;    };}function redoCss(rowindex){\tvar j = rowindex;\tfor (var i = rowindex; i < mygridtest-grid-id.rowsCol.length; i++){\t\t\tif (!mygridtest-grid-id.rowsCol[i])\t\t\t\tcontinue;\t\t\tif (mygridtest-grid-id.rowsCol[i].style.display != \"none\"){\t\t\t\tif (mygridtest-grid-id.rowsCol[i].className.indexOf(\"rowselected\") != -1){\t\t\t\t\tif (j%2 == 1)\t\t\t\t\t\tmygridtest-grid-id.rowsCol[i].className=mygridtest-grid-id._cssUnEven+\" rowselected \"+(mygridtest-grid-id.rowsCol[i]._css||\"\");\t\t\t\t\telse\t\t\t\t\t\tmygridtest-grid-id.rowsCol[i].className=mygridtest-grid-id._cssEven+\" rowselected \"+(mygridtest-grid-id.rowsCol[i]._css||\"\");\t\t\t\t} else {\t\t\t\t\tif (j%2 == 1)\t\t\t\t\t\tmygridtest-grid-id.rowsCol[i].className=mygridtest-grid-id._cssUnEven+(mygridtest-grid-id.rowsCol[i]._css||\"\");\t\t\t\t\telse\t\t\t\t\t\tmygridtest-grid-id.rowsCol[i].className=mygridtest-grid-id._cssEven+(mygridtest-grid-id.rowsCol[i]._css||\"\");\t\t\t\t}\t\t\t\tj++;\t\t\t}\t\t}}function leavePagetest-grid-id(e){\tvar hasupdates = false;\t\tfor(var i = 0;i < myDataProcessortest-grid-id.updatedRows.length;i++)\t{\t\tif(myDataProcessortest-grid-id.updatedRows[i] != null)\t\t{\t\t\thasupdates = true;\t\t}\t}    if(hasupdates )    {        if(!e) e = window.event;\t    //e.cancelBubble is supported by IE - this will kill the bubbling process.\t    //e.cancelBubble = true;\t    e.returnValue = 'You have unsaved changes.'; //This is displayed on the dialog\t    if (e.stopPropagation) {\t\t    e.stopPropagation();\t\t    e.preventDefault();\t    }    }}function URLEncode( plaintext ){\t// The Javascript escape and unescape functions do not correspond\t// with what browsers actually do...\tvar SAFECHARS = \"0123456789\" +\t\t\t\t\t// Numeric\t\t\t\t\t\"ABCDEFGHIJKLMNOPQRSTUVWXYZ\" +\t// Alphabetic\t\t\t\t\t\"abcdefghijklmnopqrstuvwxyz\" +\t\t\t\t\t\"-_.!~*'()\";\t\t\t\t\t// RFC2396 Mark characters\tvar HEX = \"0123456789ABCDEF\";\tvar encoded = \"\";\tfor (var i = 0; i < plaintext.length; i++ ) {\t\tvar ch = plaintext.charAt(i);\t    if (ch == \" \") {\t\t    encoded += \"+\";\t\t\t\t// x-www-urlencoded, rather than %20\t\t} else if (SAFECHARS.indexOf(ch) != -1) {\t\t    encoded += ch;\t\t} else {\t\t    var charCode = ch.charCodeAt(0);\t\t\tif (charCode > 255) {\t\t\t    alert( \"Unicode Character '\"                         + ch                         + \"' cannot be encoded using standard URL encoding.\\n\" +\t\t\t\t          \"(URL encoding only supports 8-bit characters.)\\n\" +\t\t\t\t\t\t  \"A space (+) will be substituted.\" );\t\t\t\tencoded += \"+\";\t\t\t} else {\t\t\t\tencoded += \"%\";\t\t\t\tencoded += HEX.charAt((charCode >> 4) & 0xF);\t\t\t\tencoded += HEX.charAt(charCode & 0xF);\t\t\t}\t\t}\t}\treturn encoded;};function checkMintest-grid-id(rowId,cellIndex,value){    if(minValuestest-grid-id[cellIndex] != \"\")    {        var val = parseFloat(value);        var min = parseFloat(minValuestest-grid-id[cellIndex]);        if(val < min)        {            alert('You must enter a value greater than ' + min);            return false;        }    }    return true;}function checkMaxtest-grid-id(rowId,cellIndex,value){    if(maxValuestest-grid-id[cellIndex] != \"\")    {        var val = parseFloat(value);        var max = parseFloat(maxValuestest-grid-id[cellIndex]);        if(val > max)        {            alert('You must enter a value less than ' + max);                        return false;        }    }    return true;}dhtmlXGridObject.prototype._in_header_master_checkbox2 = function (t, i, c) { \tt.innerHTML = c[0] + \"<input type='checkbox' />\" + c[1]; \tvar self = this; \tt.firstChild.onclick = function (e) \t{ \t\tself._build_m_order(); \t\tvar j = self._m_order ? self._m_order[i] : i;\t\tvar val = this.checked;// ? true : false;\t\tself.forEachRow(function (id) {\t\t\tvar c = this.cells(id, j);\t\t\tif (c.isCheckbox() && !c.cell.firstChild.disabled)\t\t\t{\t\t\t\tc.cell.firstChild.checked = val;\t\t\t\tif(val)\t\t\t\t\tc.cell.firstChild.style.display = \"\";\t\t\t\telse\t\t\t\t\tc.cell.firstChild.style.display = \"none\";\t\t\t}\t\t});\t\t(e || event).cancelBubble = true;\t} };dhtmlXGridObject.prototype.checksubs = function(row){\tvar rowid = row.parentNode.parentNode.idd;\tif(this.hasChildren(rowid) > 0)\t{\t\tvar rowids = this.getAllSubItems(rowid).split(',');\t\tfor(var i = 0;i<rowids.length;i++)\t\t{\t\t\tvar curRow = rowids[i];\t\t\tthis.cells(curRow, 0).cell.firstChild.checked = row.checked;\t\t\tif(row.checked)\t\t\t\tthis.cells(curRow, 0).cell.firstChild.style.display = \"\";\t\t\telse\t\t\t\tthis.cells(curRow, 0).cell.firstChild.style.display = \"none\";\t\t}\t\t\t}};window.onbeforeunload=leavePagetest-grid-id;minValuestest-grid-id = [\"\",\"1\"];maxValuestest-grid-id = [\"\",\"1\"];var singleEditItemUrltest-grid-id;var inEditModetest-grid-id;function fireEvent(element,event){    if (document.createEventObject){        // dispatch for IE        var evt = document.createEventObject();        return element.fireEvent('on'+event,evt)    }    else{        // dispatch for firefox + others        var evt = document.createEvent(\"HTMLEvents\");        evt.initEvent(event, true, true ); // event type,bubbling,cancelable        return !element.dispatchEvent(evt);    }}function editRowtest-grid-id(rowid){\tvar EditCol = getEditColtest-grid-id();        if(EditCol != null)    {    \t\tvar listId = mygridtest-grid-id.getUserData(rowid,\"listid\");\t\tvar itemId = mygridtest-grid-id.getUserData(rowid,\"itemid\");\t\tvar webId = mygridtest-grid-id.getUserData(rowid,\"webid\");\t\tvar siteId = mygridtest-grid-id.getUserData(rowid,\"siteid\");    \t\tmygridtest-grid-id.cells(rowid, EditCol).setValue(\"<img src='/_layouts/epmlive/images/loader1.gif'>\");\t\tdhtmlxAjax.post(singleEditItemUrltest-grid-id, \"siteid=\" + siteId + \"&webid=\" + webId + \"&listid=\" + listId + \"&itemid=\" + itemId + \"&rowid=\" + rowid,editRowResponsetest-grid-id);    }}function getEditColtest-grid-id(){\tvar EditCol;\tfor(var i = 0;i<mygridtest-grid-id.getColumnsNum();i++)    {        if(mygridtest-grid-id.getColumnId(i) == \"<![CDATA[Edit]]>\")        {            EditCol = i;\t\t\tbreak;        }    }    return EditCol;}function editRowResponsetest-grid-id(loader){\tif(loader.xmlDoc.responseText!=null)\t{\t\t\tvar xmlDoc = loader.xmlDoc.responseXML;\t\tfor(var i = 0;i<xmlDoc.childNodes.length;i++)\t\t{\t\t\tvar rowXml = xmlDoc.childNodes[i];\t\t\tsetEditRowstest-grid-id(rowXml);\t\t\t}\t}\telse\t\talert(\"Response contains no XML\");}function setEditRowstest-grid-id(rowsXml){\tfor(var i = 0;i<rowsXml.childNodes.length;i++)\t{\t\tsetEditRowtest-grid-id(rowsXml.childNodes[i])\t}}function setEditRowtest-grid-id(rowXml){\tvar rowId = rowXml.getAttribute(\"id\")\t\tvar cellCounter = 0;\tmygridtest-grid-id.lockRow(rowId, false);\tfor(var i = 0;i<rowXml.childNodes.length;i++)\t{\t\tif(rowXml.childNodes[i].nodeName == \"userdata\")\t\t{\t\t\t//mygridtest-grid-id.setUserData(rowId,rowXml.childNodes[i].getAttribute(\"name\"),rowXml.childNodes[i].firstChild.nodeValue);\t\t}\t\telse if(rowXml.childNodes[i].nodeName == \"cell\")\t\t{\t\t\tvar cellval = \"\";\t\t\tvar celltype = \"\";\t\t\ttry\t\t\t{\t\t\t\tcelltype = rowXml.childNodes[i].getAttribute(\"type\");\t\t\t}catch(e){}\t\t\tif(rowXml.childNodes[i].childNodes.length > 0)\t\t\t{\t\t\t\tcellval = rowXml.childNodes[i].firstChild.nodeValue;\t\t\t}\t\t\tif(celltype == \"combo\")\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(rowXml.childNodes[i]);\t\t\t\telse\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(cellval);\t\t\t\t\t\t\tif(celltype != null)\t\t\t{\t\t\t\tmygridtest-grid-id.setCellExcellType(rowId, i, celltype);\t\t\t}\t\t\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(cellval);\t\t\t\tcellCounter++;\t\t}\t}\tvar EditCol = getEditColtest-grid-id();    \tif(EditCol != null)\t{\t\tmygridtest-grid-id.cells(rowId, EditCol).setValue(\"<a onclick=\\\"javascript:saveEdittest-grid-id('\" + rowId + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/saveitem.gif\\\" border=\\\"0\\\" alt=\\\"Save\\\"></a> <a onclick=\\\"javascript:cancelEditRowtest-grid-id('\" + rowId + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/close.gif\\\" border=\\\"0\\\" alt=\\\"Cancel\\\"></a>\");\t}}function saveEdit2test-grid-id(rowid){\tmygridtest-grid-id.editStop();\t\trow = mygridtest-grid-id.getRowById(rowid);\t\tvar cols = row.childNodes.length;\tvar changed = false;\tfor (var j = 0; j < cols; j++)\t\tif (row.childNodes[j].wasChanged){\t\t\tchanged = true;\t\t\tbreak;\t\t}\t\tvar EditCol = getEditColtest-grid-id();\t    if(EditCol != null)\t\tmygridtest-grid-id.cells(rowid, EditCol).setValue(\"<img src='/_layouts/epmlive/images/loader1.gif'>\");\t\t\t\tif(changed)\t\tmyDataProcessortest-grid-id.sendData(rowid);\telse\t\tcancelEditRowtest-grid-id(rowid);}function saveEdittest-grid-id(rowid){\tsetTimeout(\"saveEdit2test-grid-id('\" + rowid + \"')\", 100);}function cancelEditRowtest-grid-id(rowid){\tvar EditCol = getEditColtest-grid-id();\t    mygridtest-grid-id.lockRow(rowid, true);    myDataProcessortest-grid-id.setUpdated(rowid, false, null);        if(EditCol != null)    {\t\tvar listid = mygridtest-grid-id.getUserData(rowid,\"listid\");\t\tvar itemid = mygridtest-grid-id.getUserData(rowid,\"itemid\");\t\tvar webid = mygridtest-grid-id.getUserData(rowid,\"webid\");\t\tvar siteid = mygridtest-grid-id.getUserData(rowid,\"siteid\");\t\tmygridtest-grid-id.cells(rowid, EditCol).setValue(\"<img src='/_layouts/epmlive/images/loader1.gif'>\");\t\tdhtmlxAjax.post(singleItemUrltest-grid-id, \"edit=false&siteid=\" + siteid + \"&webid=\" + webid + \"&listid=\" + listid + \"&itemid=\" + itemid + \"&rowid=\" + rowid,cancelEditRowResponsetest-grid-id);\t}\t}function cancelEditRowResponsetest-grid-id(loader){\tif(loader.xmlDoc.responseText!=null)\t{\t\tvar xmlDoc = loader.xmlDoc.responseXML;\t\t\t\tfor(var i = 0;i<xmlDoc.childNodes.length;i++)\t\t{\t\t\tvar rowXml = xmlDoc.childNodes[i];\t\t\tsetCRowValuestest-grid-id(rowXml);\t\t}\t}\telse\t\talert(\"Response contains no XML\");}function setCRowValuestest-grid-id(rowsXml){\tfor(var i = 0;i<rowsXml.childNodes.length;i++)\t{\t\tsetCRowValuetest-grid-id(rowsXml.childNodes[i])\t}}function setCRowValuetest-grid-id(rowXml){\tvar rowId = rowXml.getAttribute(\"id\");\tvar cellCounter = 0;\t\tfor(var i = 0;i<rowXml.childNodes.length;i++)\t{\t\tif(rowXml.childNodes[i].nodeName == \"userdata\")\t\t{\t\t\t//mygridtest-grid-id.setUserData(rowId,rowXml.childNodes[i].getAttribute(\"name\"),rowXml.childNodes[i].text);\t\t}\t\telse if(rowXml.childNodes[i].nodeName == \"cell\")\t\t{\t\t\tvar cellval = \"\";\t\t\t\t\t\tif(rowXml.childNodes[i].childNodes.length > 0)\t\t\t{\t\t\t\tcellval = rowXml.childNodes[i].firstChild.nodeValue;\t\t\t}\t\t\tif(mygridtest-grid-id.getColType(cellCounter) != \"tree\")\t\t\t\tmygridtest-grid-id.setCellExcellType(rowId, cellCounter, \"ro\");\t\t\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(cellval);\t\t\t\t\t\t\tcellCounter++;\t\t}\t}\t\tvar EditCol;\tfor(var i = 0;i<mygridtest-grid-id.getColumnsNum();i++)\t{\t\tif(mygridtest-grid-id.getColumnId(i) == \"<![CDATA[Edit]]>\")\t\t{\t\t\tEditCol = i;\t\t\tbreak;\t\t}\t}    \tif(EditCol != null)\t{\t\tmygridtest-grid-id.cells(rowId, i).setValue(\"<a onclick=\\\"javascript:editRowtest-grid-id('\" + rowId + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/edit.gif\\\" border=\\\"0\\\"></a>\");\t}}function ChangePagetest-grid-id(pg){curPagetest-grid-id = pg;loadXtest-grid-id(sftest-grid-id, svtest-grid-id, sttest-grid-id);}function NextPagetest-grid-id(){if(lastItemtest-grid-id != 0){curPagetest-grid-id = lastItemtest-grid-id;loadXtest-grid-id(sftest-grid-id, svtest-grid-id, sttest-grid-id);}}function PreviousPagetest-grid-id(){if(fItemHidetest-grid-id != firstItemtest-grid-id){curPagetest-grid-id = firstItemtest-grid-id;loadXtest-grid-id(sftest-grid-id, svtest-grid-id, sttest-grid-id);}}function loadXtest-grid-id(searchfield, searchvalue, searchtype){var ribbontestintervall = null; mygridwidthtest-grid-id = document.getElementById('WebPartdummy').offsetWidth - 25;if(searchfield){searchvalue = escape(searchvalue);mygridtest-grid-id.post(\"http://fake.url/_layouts/epmlive/getgriditems.aspx\",\"data=&edit=false&insertrow=False&width=\" + mygridwidthtest-grid-id + \"&searchfield=\" + searchfield + \"&searchvalue=\" + searchvalue + \"&searchtype=\" + searchtype + \"&page=\" + curPagetest-grid-id + \"&source=http%3a%2f%2ffake.url%2f\");}else{mygridtest-grid-id.post(\"http://fake.url/_layouts/epmlive/getgriditems.aspx\",\"data=&edit=false&insertrow=False&width=\" + mygridwidthtest-grid-id + \"&page=\" + curPagetest-grid-id + \"&source=http%3a%2f%2ffake.url%2f\");}}function showrib(){setTimeout(\"clickTab()\", 1);}function clickTab(){try{var wp = document.getElementById('MSOZoneCell_WebPartdummy');WpClick({target: wp});}catch(e){}}function clickbrowse(){try{var wp2 = document.getElementById('Ribbon.Read-title').firstChild;fireEvent(wp2, 'click');}catch(e){}}setTimeout(\"clickTab()\", 1000);_spBodyOnLoadFunctionNames.push(\"loadXtest-grid-id('test-search-field','test-search-string','1')\");</script><div id=\"dlgSavingtest-grid-id\" class=\"dialog\">    <table width=\"100%\">        <tr>            <td align=\"center\" class=\"ms-sectionheader\">                <img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/><br />                <H3 class=\"ms-standardheader\">Saving Items...</h3>            </td>        </tr>    </table></div> <div id=\"dlgRefreshtest-grid-id\" class=\"dialog\">    <table width=\"100%\">        <tr>            <td align=\"center\" class=\"ms-sectionheader\">                <img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/><br />                <H3 class=\"ms-standardheader\">Refreshing Data...</h3>            </td>        </tr>    </table></div> <div id=\"dlgErrortest-grid-id\" class=\"dialog\">    <table width=\"100%\" height=\"100%\" cellpadding=\"0\" cellspacing=\"3\">\t\t<tr>\t\t\t<td class=\"ms-sectionheader\"><H3 class=\"ms-standardheader\">Error: </h3></td>\t\t</tr>        <tr height=\"100%\">            <td align=\"left\"valign=\"top\">                <div id=\"dlgErrorTexttest-grid-id\" style=\"overflow: auto;height=90%;width=100%\" class=\"ms-descriptiontext\"></div><br>            </td>        </tr>        <tr>\t\t\t<td align=\"right\">\t\t\t\t<input type=\"button\" class=\"ms-input\" value=\"Close\" onClick=\"hm('dlgErrortest-grid-id');\">\t\t\t</td>\t\t</tr>    </table></div><div id=\"editItemtest-grid-id\" class=\"dialog\">    <table width=\"100%\" height=\"100%\" id=\"tblEditItem\" cellpadding=\"0\" cellspacing=\"0\">        <tr height=\"100%\">            <td align=\"center\" bgcolor=\"FFFFFF\">                <div id=\"editItemLoadtest-grid-id\">                    <img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/>                </div>                <iframe id=\"frmEditFrametest-grid-id\" width=\"100%\" height=\"100%\" frameborder=\"0\" src=\"http://fake.url/_layouts/epmlive/blank.gif\">                                    </iframe>            </td>        </tr>    </table></div><div id=\"dlgPosting\" class=\"dialog\">    <table width=\"100%\">        <tr>            <td align=\"center\" class=\"ms-sectionheader\">                <img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/><br />                <H3 class=\"ms-standardheader\">Posting Data...</h3>            </td>        </tr>    </table></div> <script>var bPageSetuptest-grid-id;var firstItemtest-grid-id;var lastItemtest-grid-id;var fItemHidetest-grid-id;function setupPagetest-grid-id(records, UseReporting, PageSize){\tvar pages = Math.ceil(records / PageSize);\tvar prev = document.getElementById(\"PagePrevioustest-grid-id\");\tvar next = document.getElementById(\"PageNexttest-grid-id\");\tvar pagediv = document.getElementById(\"pagedivtest-grid-id\");\tif(UseReporting)\t{\t\tif(pages > 1)\t\t{\t\t\tif(!bPageSetuptest-grid-id)\t\t\t{\t\t\t\tbPageSetuptest-grid-id = true;\t\t\t\t$(\"#pagedivtest-grid-id\").paginate({\t\t\t\t\tcount \t\t: pages,\t\t\t\t\tstart \t\t: 1,\t\t\t\t\tdisplay     : 12,\t\t\t\t\tborder\t\t\t\t\t: true,\t\t\t\t\tborder_color\t\t\t: '#CCCCCC',\t\t\t\t\ttext_color  \t\t\t: '#666666',\t\t\t\t\tbackground_color    \t: '#DDDDDD',\t\t\t\t\t\tborder_hover_color\t\t: '#878787',\t\t\t\t\ttext_hover_color  \t\t: '#ffffff',\t\t\t\t\tbackground_hover_color\t: '#9B9B9B', \t\t\t\t\trotate      : false,\t\t\t\t\timages\t\t: false,\t\t\t\t\tmouse\t\t: 'press',\t\t\t\t\tonChange\t: ChangePagetest-grid-id\t\t\t\t});\t\t\t}\t\t}\t\telse\t\t{\t\t\tpagediv.style.display = \"none\";\t\t}\t}\telse\t{\t\tpagediv.style.display = \"inline-block\";\t\tvar rec = records.split('|');\t\tfirstItemtest-grid-id = parseInt(rec[2]) * -1;\t\tlastItemtest-grid-id = rec[1];\t\tif(rec[0] == \"0\" || fItemHidetest-grid-id == firstItemtest-grid-id)\t\t{\t\t\tprev.style.background = \"#EFEFEF\";\t\t\tfItemHidetest-grid-id = firstItemtest-grid-id;\t\t}\t\telse\t\t{\t\t\tprev.style.background = \"#DDDDDD\";\t\t}\t\tif(rec[3] == \"true\")\t\t\tnext.style.background = \"#DDDDDD\";\t\telse\t\t{\t\t\tprev.style.background = \"#EFEFEF\";\t\t\tlastItemtest-grid-id = 0;\t\t}\t\tif(rec[3] != \"true\" && rec[0] == \"0\")\t\t{\t\t\tpagediv.style.display = \"none\";\t\t}\t}}</script><script>initmb();</script>"));
        }

        [TestMethod]
        public void GridListView_renderGrid_GivenArguments_InEditMode_ConfirmOutput()
        {
            // Arrange
            SetupShims();
            _testablePrivate.SetFieldOrProperty("inEditMode", true);

            // Act
            _testablePrivate.Invoke("renderGrid",
                new object[] { writer, web });

            // Assert
            _testablePrivate.ShouldSatisfyAllConditions(
                () => writeCount.ShouldBe(333),
                () => writerContent.ToString().Length.ShouldBe(74330),
                () => writerContent.ToString().ShouldBe("<style>.ms-usereditor { width:200px; }.grid_hover { border: 10px solid #91CDF2; background-color: #F2FAFF } </style><div id=\"peoplegrid\" style=\"display:none; border: 1px solid #808080; padding: 3px; background-color: #F9F9F9; width=200px;\"><div id=\"peoplechecktest-grid-id\" style=\"overflow: auto; width: 200px; height: 100px;  background-color: #FFFFFF; border: 1px solid #808080; margin-top:2px; padding:3px;\" class=\"ms-descriptiontext\"></div><table border=\"0\" width=\"100%\"><tr><td><a onclick=\"javascript:viewCheckstest-grid-id('test-grid-id');\"><img id=\"peoplecheckimgtest-grid-id\" src=\"_layouts/images/TPMAX1.GIF\" border=\"0\"></a><br></td><td align=\"right\"><font class=\"ms-descriptiontext\"><a onclick=\"javascript:mygridtest-grid-id.editStop();\">Close</a></font></td></tr></table><div id=\"divPetest-grid-id\" style=\"display:none;\"></div></div><div id=\"peoplesinglegrid\" style=\"display:none; border: 1px solid #808080; padding: 3px; background-color: #F9F9F9; width=200px;\"><div id=\"peoplechecksingletest-grid-id\" style=\"width: 200px; height: 100px;  background-color: #FFFFFF; border: 1px solid #808080; margin-top:2px; padding:0px;\" class=\"ms-descriptiontext\"><select size=\"6\" onclick=\"changeUsertest-grid-id(this);\" id=\"peoplecheckselecttest-grid-id\"  style=\"width:100%;height:100%\"><option>test</option></select></div><table border=\"0\" width=\"200\"><tr><td><a onclick=\"javascript:viewDropDowntest-grid-id('test-grid-id');\"><img id=\"peoplechecksingleimgtest-grid-id\" src=\"_layouts/images/TPMAX1.GIF\" border=\"0\"></a><br></td><td align=\"right\"><font class=\"ms-descriptiontext\"><a onclick=\"javascript:mygridtest-grid-id.editStop();\">Close</a></font></td></tr></table><div id=\"divPestest-grid-id\" style=\"display:none;\"></div></div><div id=\"multichoicegrid\" style=\"display:none; border: 1px solid #808080; padding: 3px; background-color: #F9F9F9; width:200px;height:180px\"><div id=\"multichoiceinnertest-grid-id\" style=\"width: 195px; height: 160px;  background-color: #FFFFFF; border: 1px solid #808080; margin-top:2px; padding:0px;overflow:auto\" class=\"ms-descriptiontext\">test</div><table border=\"0\" width=\"200\"><tr><td align=\"right\"><font class=\"ms-descriptiontext\"><a onclick=\"javascript:mygridtest-grid-id.editStop();\">Close</a></font></td></tr></table></div><div id=\"gridmenutest-grid-id\" style=\"position:absolute;left:0px;display:none;\" class=\"js-callout-mainElement ms-core-defaultFont  ms-alignLeft ms-shadow\"><ul class=\"ms-core-menu-list\" style=\"width: 173px;\"></ul></div><script>_css_prefix=\"/_layouts/epmlive/DHTML/xgrid/\"; _js_prefix=\"/_layouts/epmlive/DHTML/xgrid/\"; </script><script src=\"_layouts/epmlive/DHTML/xgrid/dhtmlxcommon.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/dhtmlxgrid.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/dhtmlxgridcell.js\"></script><script src=\"_layouts/epmlive/DHTML/xtreegrid/dhtmlxtreegrid.js\"></script><script src=\"_layouts/epmlive/DHTML/xtreegrid/ext/dhtmlxtreegrid_filter.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_post.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_nxml.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_filter.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_math.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_srnd.js\"></script><script src=\"/_layouts/epmlive/DHTML/xgrid/excells/dhtmlxgrid_excell_calendar.js\"></script><script src=\"/_layouts/epmlive/DHTML/xgrid/excells/dhtmlxgrid_excell_combo.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/excells/dhtmlxgrid_excell_dhxcalendar.js\"></script><script src=\"_layouts/epmlive/DHTML/xcombo/dhtmlxcombo.js\"></script><script src=\"_layouts/epmlive/DHTML/calendar/dhtmlxcalendar.js\"></script><script src=\"_layouts/epmlive/DHTML/xdataproc/dhtmlxdataprocessor.js\"></script><script type=\"text/javascript\" src=\"_layouts/epmlive/modal/modal.js\"></script> <script language=\"JavaScript\" src=\"_layouts/epmlive/dhtml/xmenu/dhtmlxmenu.js\"></script><script language=\"JavaScript\" src=\"_layouts/epmlive/dhtml/xmenu/ext/dhtmlxmenu_ext.js\"></script><style>.menuTable{background-color:#ffffff;}.secondMenuTable{background-color:#ffffff;}.contextMenuover, .contextMenudown{background-color:#9ac2e5;}.contextMenuover td{color:#000000;} </style><script src=\"_layouts/epmlive/epmlivegrid.js\"></script><script language=\"javascript\">var searchfieldstest-grid-id = {test-field: [ \"Yes\", \"No\" ]};function switchsearchtest-grid-id()            {                var searcher = document.getElementById('searchtest-grid-id');                var searchtext = document.getElementById('searchtexttest-grid-id');                var searchchoice = document.getElementById('searchchoicetest-grid-id');                var searchtypechoice = document.getElementById('searchtypetest-grid-id');                var searchfield = searcher.options[searcher.selectedIndex].value;                var sList = searchfieldstest-grid-id[searchfield];                if(sList) {                    searchtext.style.display='none';                    searchchoice.style.display='';                    searchchoice.options.length = 0;                    searchtypechoice.options[2].selected = true;                    searchtypechoice.disabled = true;                    for(var i=0; i < sList.length; i++) {                        var d = sList[i];                        searchchoice.options.add(new Option(d, d));                        if(d=='test-search-string') {                            searchchoice.options[searchchoice.options.length-1].selected = true;                        }                     }                 } else {                    searchtext.style.display='';                    searchchoice.style.display='none';                    searchtypechoice.disabled = false;                }            }function unSearchtest-grid-id(){var gri = document.getElementById('grid');gri.style.display = 'none';var loader = document.getElementById('loadinggrid');loader.style.display = '';var unsearch = document.getElementById('unsearchtest-grid-id');unsearch.style.display=\"none\";var searchtext = document.getElementById('searchtexttest-grid-id');searchtext.value = '';curPagetest-grid-id = 0;sftest-grid-id = null;svtest-grid-id = null;sttest-grid-id = null;loadXtest-grid-id();}function doSearchtest-grid-id(){var gri = document.getElementById('grid');                     gri.style.display = 'none';                     var loader = document.getElementById('loadinggrid');                     loader.style.display = '';                var searcher = document.getElementById('searchtest-grid-id');                var unsearch = document.getElementById('unsearchtest-grid-id');                unsearch.style.display=\"table-cell\";                var searchchoice = document.getElementById('searchchoicetest-grid-id');                var searchtext = document.getElementById('searchtexttest-grid-id');                var searchtypechoice = document.getElementById('searchtypetest-grid-id');                var searchfield = searcher.options[searcher.selectedIndex].value;                var searchtype = searchtypechoice.options[searchtypechoice.selectedIndex].value;                var sList = searchfieldstest-grid-id[searchfield];                var searchvalue = \"\";                if(sList){                    searchvalue = searchchoice.options[searchchoice.selectedIndex].value;                } else {                     searchvalue = searchtext.value;                }curPagetest-grid-id = 0;                         sftest-grid-id = searchfield;                         svtest-grid-id = searchvalue;                         sttest-grid-id = searchtype;                                loadXtest-grid-id(searcher.options[searcher.selectedIndex].value, searchvalue, searchtype);                            }function enablesearchertest-grid-id(){}</script><div id=\"search\" style=\"width:100%; height:25px; padding:10px\" class=\"ms-listviewtable\"><table><tr><td>Search: <select id=\"searchtest-grid-id\" onChange=\"switchsearchtest-grid-id();\" style=\"border: 1px solid #ABABAB; height:20px\"><option value=\"test-field\">test-field</option></select>&nbsp;&nbsp;<select id=\"searchtypetest-grid-id\" style=\"border: 1px solid #ABABAB; height:20px\"><option value=\"1\" selected>Contains</option><option value=\"8\" >Begins With</option><option value=\"2\" >Equals</option><option value=\"3\" >Does Not Equal</option><option value=\"4\" >Greater Than</option><option value=\"5\" >Greater Than or Equal</option><option value=\"6\" >Less Than</option><option value=\"7\" >Less Than or Equal</option></select>&nbsp;&nbsp;</td><td><div style=\"border: 1px solid #ABABAB;width: 150px;height: 20px;\">                    <div id=\"unsearchtest-grid-id\" class=\"\" style=\"padding-left:4px;display: none;min-width: 12px;align:top\">                        <img alt=\"Clear Search\" src=\"/_layouts/epmlive/images/unsearch.png\" style=\"padding-bottom:2px\" onclick=\"unSearchtest-grid-id()\"/>                    </div>                    <div style=\"display: table-cell\">                        <input type=\"text\" id=\"searchtexttest-grid-id\" value=\"test-search-string\" class=\"\" style=\"border: 0px; width:100%; margin-top:-5px; height:14px; font-family: 'Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size:13px\"/>                        <select id=\"searchchoicetest-grid-id\" style=\"border: 0px; width:100%\">                        </select>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    </div>                    <div class=\"\" style=\"padding-right:2px; padding-left:5px;padding-top:2px;display: table-cell;min-width: 10px;cursor:pointer\">                        <img onclick=\"GridSearch('test-grid-id')\" src=\"/_layouts/epmlive/images/find_icon.png\"/>                    </div>                </div></td></tr></table></div><script language=\"javascript\">switchsearchtest-grid-id();</script><div id=\"grid\" style=\"width:100%;display:none;\" class=\"ms-listviewtable\"></div><div id=\"errordivtest-grid-id\" style=\"font-color:red;font-size:11px;\"></div><div  width=\"100%\" id=\"loadinggrid\" align=\"center\"><img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/> Loading Items...</div><script language=\"javascript\">function viewCheckstest-grid-id(btn){var pp = document.getElementById('divPe' + btn);var ppi = document.getElementById('peoplecheckimg' + btn);if(pp.style.display == \"none\"){pp.style.display = \"\";ppi.src = \"_layouts/images/TPMIN1.GIF\";}else{pp.style.display = \"none\";ppi.src = \"_layouts/images/TPMAX1.GIF\";}}function viewDropDowntest-grid-id(btn){var pp = document.getElementById('divPes' + btn);var ppi = document.getElementById('peoplechecksingleimg' + btn);if(pp.style.display == \"none\"){pp.style.display = \"\";ppi.src = \"_layouts/images/TPMIN1.GIF\";}else{pp.style.display = \"none\";ppi.src = \"_layouts/images/TPMAX1.GIF\";}}function gridfiltertest-grid-id(value){var vals = value.split('|');mygridtest-grid-id.filterBy(vals[0],vals[1]);}function setSizetest-grid-id(){mygridtest-grid-id._askRealRows();}function printgridtest-grid-id() {var temp = mygridtest-grid-id.hdr.rows[2];var parent = temp.parentNode;parent.removeChild(temp,true);mygridtest-grid-id.printView();parent.appendChild(temp);}function switchFilterLoadtest-grid-id(){mygridtest-grid-id.switchFilter();mygridtest-grid-id.setSizes();}</script><script>var mygridtest-grid-idHidden = false;var listidtest-grid-id = '00000000-0000-0000-0000-000000000000';mygridtest-grid-id = new dhtmlXGridObject('grid');mygridtest-grid-id.setImagePath(\"_layouts/epmlive/dhtml/xgrid/imgs/\");mygridtest-grid-id.getTitles = function(){                            var lookups = \"\";            mygridtest-grid-id.forEachRow(function (id) {\t\t\t    var c = this.cells(id, 0);\t\t\t    if (c.isCheckbox() && !c.cell.firstChild.disabled && c.cell.firstChild.checked)                {                    var title = this.getUserData(id,\"title\");        \t        var itemid = this.getUserData(id,\"itemid\");                    if(itemid != \"\")                    {                        lookups += \",\" + title;                    }                }\t\t    });            if(lookups == \"\")            {                var rowId = mygridtest-grid-id.getSelectedRowId();                lookups = \",\" + mygridtest-grid-id.getUserData(rowId,\"title\");            }            if(lookups != \"\" && lookups[0] == ',')                lookups = lookups.substring(1);            return lookups;                }                mygridtest-grid-id.getCheckedRowIds = function(){                var ids = \"\";                this.forEachRow(function (id) {\t\t\t        var c = this.cells(id, 0);\t\t\t        if (c.isCheckbox() && !c.cell.firstChild.disabled && c.cell.firstChild.checked)                    {                        ids += \",\" + id;                    }\t\t        });                if(ids != \"\" && ids[0] == ',')                    ids = ids.substring(1);                if(ids == \"\")                    ids = this.getSelectedRowId();                return ids;            };mygridtest-grid-id.getCheckedIds = function(){                var ids = \"\";                this.forEachRow(function (id) {\t\t\t        var c = this.cells(id, 0);\t\t\t        if (c.isCheckbox() && !c.cell.firstChild.disabled && c.cell.firstChild.checked)                    {                        var listid = this.getUserData(id,\"listid\");        \t            var itemid = this.getUserData(id,\"itemid\");        \t            var webid = this.getUserData(id,\"webid\");                        if (this._useparent) {                            var parentid = this.getUserData(id, \"parentitemid\");                            if (parentid && parentid != \"\") {                                var newids = parentid.toString().split(\".\");                                webid = newids[0];                                listid = newids[1];                                itemid = newids[2];                            }                        }                        if(itemid != \"\")                        {                            ids += \",\" + webid + \".\" + listid + \".\" + itemid;                        }                    }\t\t        });                if(ids == \"\")                {                    var rowId = this.getSelectedRowId();                    var listid = this.getUserData(rowId,\"listid\");        \t        var itemid = this.getUserData(rowId,\"itemid\");        \t        var webid = this.getUserData(rowId,\"webid\");                    if (this._useparent) {                        var parentid = this.getUserData(rowId, \"parentitemid\");                        if (parentid && parentid != \"\") {                            var newids = parentid.toString().split(\".\");                            webid = newids[0];                            listid = newids[1];                            itemid = newids[2];                        }                    }                    if(itemid != \"\")                    {                        ids = webid + \".\" + listid + \".\" + itemid;                    }                }                if(ids != \"\" && ids[0] == ',')                    ids = ids.substring(1);                return ids;            };mygridtest-grid-id.getCheckedItems = function(){                var ids = \"\";                this.forEachRow(function (id) {\t\t\t        var c = this.cells(id, 0);\t\t\t        if (c.isCheckbox() && !c.cell.firstChild.disabled && c.cell.firstChild.checked)                    {                        var listid = this.getUserData(id,\"listid\");        \t            var itemid = this.getUserData(id,\"itemid\");        \t            var webid = this.getUserData(id,\"webid\");                        if(itemid != \"\")                        {                            ids += \",\" + itemid;                        }                    }\t\t        });                if(ids == \"\")                {                    var rowId = this.getSelectedRowId();                    var listid = this.getUserData(rowId,\"listid\");        \t        var itemid = this.getUserData(rowId,\"itemid\");        \t        var webid = this.getUserData(rowId,\"webid\");                    if(itemid != \"\")                    {                        ids = itemid;                    }                }                if(ids != \"\" && ids[0] == ',')                    ids = ids.substring(1);                return ids;            };mygridtest-grid-id.toggleSearch = function(){var searchDiv = document.getElementById('search');if(searchDiv.style.display == 'none'){searchDiv.style.display = '';}else{searchDiv.style.display = 'none';}};mygridtest-grid-id.switchFilter = function(){try{var input1 = mygridtest-grid-id.hdr.rows[2];if(mygridtest-grid-idHidden == false){input1.style.display = \"none\";mygridtest-grid-idHidden = true;}else{input1.style.display = \"\";mygridtest-grid-idHidden = false;}mygridtest-grid-id.setSizes();}catch(e){}};mygridtest-grid-id._enableCMenus = true;mygridtest-grid-id.PageSize = '0';mygridtest-grid-id.UseReporting = false;curPagetest-grid-id = 0;mygridtest-grid-id._epkview = '';mygridtest-grid-id._useparent = false;mygridtest-grid-id._curPlanner = '';mygridtest-grid-id._epkurl = '';mygridtest-grid-id._epkcostview = '';mygridtest-grid-id.canribbon = true;mygridtest-grid-id.addFocusedCommands = function($arr){return $arr;}mygridtest-grid-id.getGlobalCommands = function($arr){return $arr;}mygridtest-grid-id.canHandleCommand = function($Grid, commandId){return false;}mygridtest-grid-id.handleCommand = function($Grid, commandId, properites){if(typeof(properties) != 'undefined')return properties;}mygridtest-grid-id._webpartid = '';mygridtest-grid-id._outlookexport = '';mygridtest-grid-id._gridMode = '';mygridtest-grid-id._hasTemplateList = false;mygridtest-grid-id._newmenumode = 0;mygridtest-grid-id._newitemurl = 'test-server-url';mygridtest-grid-id._newfolder = false;mygridtest-grid-id._newmenu = \"<Button Id=\\'Ribbon.ListItem.New.NewListItem\\' Command=\\'NewItem\\' CommandValueId=\\'NewListItem\\' LabelText=\\'New Item\\' Description=\\'Create a New Item\\' Image32by32=\\'/_layouts/0/images/formatmap32x32.png\\' CommandType=\\'OptionSelection\\' Image32by32Top=\\'-160\\' Image32by32Left=\\'-384\\'/>\"mygridtest-grid-id._modifylist = false;mygridtest-grid-id._listperms = false;mygridtest-grid-id._shownewmenu = true;mygridtest-grid-id._allowedit = false;mygridtest-grid-id._listid = '00000000-0000-0000-0000-000000000000';mygridtest-grid-id._webid = '00000000-0000-0000-0000-000000000000';mygridtest-grid-id._listname = '';mygridtest-grid-id._viewid = '00000000-0000-0000-0000-000000000000';mygridtest-grid-id._viewurl = 'http://fake.url/http://fake.url';mygridtest-grid-id._siteurl = '';mygridtest-grid-id._webrelurl = 'test-server-url';mygridtest-grid-id._viewname = 'dummy';mygridtest-grid-id._basetype = 'GenericList';mygridtest-grid-id._templatetype = '0';mygridtest-grid-id._newrow = false;mygridtest-grid-id._rolluplists = '';mygridtest-grid-id._brollups = false;mygridtest-grid-id._requestList = false;mygridtest-grid-id._usepopup = false;mygridtest-grid-id._lookupfield = '';mygridtest-grid-id._lookupfieldlist = '';mygridtest-grid-id._excell = 'test-server-url\\u002f_vti_bin\\u002fowssvr.dll?CS=65001\\u0026Using=_layouts\\u002fquery.iqy\\u0026List=\\u00257B00000000\\u00252D0000\\u00252D0000\\u00252D0000\\u00252D000000000000\\u00257D\\u0026View=\\u00257B00000000\\u00252D0000\\u00252D0000\\u00252D0000\\u00252D000000000000\\u00257D\\u0026RootFolder=http:\\u0026CacheControl=1';mygridtest-grid-id._gridid = 'test-grid-id';mygridtest-grid-id._formmenus = \"\";mygridtest-grid-id.setSkin(\"editgrid\");mygridtest-grid-id.enableAlterCss(\"ms-itmhover\", \"ms-itmhover\");mygridtest-grid-id.enableAutoHeight(true);mygridtest-grid-id.enableSmartRendering(true);mygridtest-grid-id.enableSmartXMLParsing(true);mygridtest-grid-id.setAwaitedRowHeight(30);mygridtest-grid-id.setImageSize(1,1);mygridtest-grid-id._editmode = true;mygridtest-grid-id.enableEditEvents(true,false,false);document.onclick=function(){mygridtest-grid-id._curHover=false;mygridtest-grid-id.clearmenus();};mygridtest-grid-id.setDateFormat(\"%m/%d/%Y\");mygridtest-grid-id.attachEvent(\"onXLE\",clearLoader);mygridtest-grid-id.attachEvent(\"onXLE\",switchFilterLoadtest-grid-id);mygridtest-grid-id.attachEvent(\"onXLE\",enablesearchertest-grid-id);mygridtest-grid-id.attachEvent(\"onXLE\",showrib());mygridtest-grid-id.attachEvent(\"onRowSelect\",selectRowtest-grid-id);mygridtest-grid-id.attachEvent(\"onEditCell\",onEditCelltest-grid-id);mygridtest-grid-id.attachEvent(\"onKeyPress\",onKeyPresstest-grid-id);mygridtest-grid-id._singleItemUrl = \"http://fake.url/_layouts/epmlive/getsingleitem.aspx?data=&edit=true\";mygridtest-grid-id.init();singleItemUrltest-grid-id = \"http://fake.url/_layouts/epmlive/getsingleitem.aspx?data=&edit=true\";singleEditItemUrltest-grid-id = \"test-server-url/_layouts/epmlive/getedititem.aspx?data=\";inEditModetest-grid-id = true;myDataProcessortest-grid-id = new dataProcessor(\"http://fake.url/_layouts/epmlive/savegrid.aspx?columns=dGVzdC1maWVsZC0x&data=&edit=true\");myDataProcessortest-grid-id.setUpdateMode(\"off\");myDataProcessortest-grid-id.defineAction(\"error100\", myErrorHandlertest-grid-id);myDataProcessortest-grid-id.defineAction(\"error500\", error500test-grid-id);myDataProcessortest-grid-id.defineAction(\"alldatareturned\", alldatareturnedtest-grid-id);myDataProcessortest-grid-id.setTransactionMode(\"POST\", true);myDataProcessortest-grid-id.init(mygridtest-grid-id);mygridtest-grid-id.enableTreeCellEdit(false);function viewErrortest-grid-id(id){document.getElementById('dlgErrorTexttest-grid-id').innerText=mygridtest-grid-id.getUserData(id,\"lastError\");sm('dlgErrortest-grid-id',250,130);}function myErrorHandlertest-grid-id(obj){      var id = obj.getAttribute(\"sid\");      mygridtest-grid-id.cells(id,0).setValue(\"<a href=\\\"javascript:viewErrortest-grid-id('\" + id + \"');\\\"><img src='/_layouts/images/EXCLAIM.GIF' border='0'></a>\");      mygridtest-grid-id.setUserData(id,\"lastError\",obj.firstChild.data);      return true;}function alldatareturnedtest-grid-id(obj){      setRowValuestest-grid-id(obj.firstChild);}function error500test-grid-id(obj){      alert(obj.firstChild.data);      myDataProcessortest-grid-id.stopOnError = true;       hm('dlgSavingtest-grid-id');      return false;}myDataProcessortest-grid-id.setOnAfterUpdate(function(id,action,newid){if(action != \"error100\" && action != \"delete\"){mygridtest-grid-id.cells(id,0).setValue(\"\");mygridtest-grid-id.cells(id,0).setBgColor('#F0F0F0');}if(myDataProcessortest-grid-id.getSyncState()){    hm('dlgSavingtest-grid-id');    myDataProcessortest-grid-id.updatedRows = new Array(0);}});var singleItemUrltest-grid-id;var arrColumnLookupstest-grid-id;var defaultxmltest-grid-id;var minValuestest-grid-id;var maxValuestest-grid-id;var curPagetest-grid-id = 0;var firstItemtest-grid-id = 0;var lastItemtest-grid-id = 0;var fItemHidetest-grid-id = 0;var sftest-grid-id;var svtest-grid-id;var sttest-grid-id;var bPageSetuptest-grid-id = false;function selectRowtest-grid-id(id, ind){\t\tcurRowId = id;\tcurGrid = mygridtest-grid-id;\tvar c = curGrid.cells(id, 0);\tif (c.isCheckbox())\t{\t\tUnCheckAll(curGrid);\t\tc.cell.firstChild.checked = true;\t\tc.cell.firstChild.display = \"\";\t}\tRefreshCommandUI();\tif(curGrid.canribbon)\t{\t\tif(curGrid.getRowById(id)._locked)\t\t{\t\t\tSelectRibbonTab(\"Ribbon.ListItem\", true);\t\t\t//var wp2 = document.getElementById('Ribbon.ListItem-title');\t\t\t//if(wp2)\t\t\t//\tfireEvent(wp2.firstChild, 'click');\t\t}\t}}function UnCheckAll(grid){\tgrid.forEachRow(function (id) {\t\tvar c = this.cells(id, 0);\t\tif (c.isCheckbox())\t\t{\t\t\tc.cell.firstChild.checked = false;\t\t\tc.cell.firstChild.display = \"none\";\t\t}\t});}function viewItemtest-grid-id(link, action){    var rowIdFull = link.parentNode.parentNode.parentNode.parentNode.parentNode.idd;    var weburl = mygridtest-grid-id.getUserData(rowIdFull,\"SiteUrl\");    var listId = mygridtest-grid-id.getUserData(rowIdFull,\"listid\");    var webid = mygridtest-grid-id.getUserData(rowIdFull,\"webid\");    var siteid = mygridtest-grid-id.getUserData(rowIdFull,\"siteid\");    var editurl = mygridtest-grid-id.getUserData(rowIdFull,\"editurl\");    var viewurl = mygridtest-grid-id.getUserData(rowIdFull,\"viewurl\");    var itemId = mygridtest-grid-id.getUserData(rowIdFull,\"itemid\");    var FullURL = mygridtest-grid-id.getUserData(rowIdFull,\"FullURL\");    var wurl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=\" + action + \"&ListId=\" + listId + \"&ID=\" + itemId + \"&gridid=test-grid-id&siteid=\" + siteid + \"&webid=\" + webid + \"&rowid=\" + rowIdFull;        function myCallback(dialogResult, returnValue)\t{\t\tif(dialogResult == 1)\t\t{\t\t\tvar weburl = curGrid.getUserData(curRowId,\"SiteUrl\");\t\t\tvar listid = curGrid.getUserData(curRowId,\"listid\");\t\t\tvar itemid = curGrid.getUserData(curRowId,\"itemid\");\t\t\tvar webid = curGrid.getUserData(curRowId,\"webid\");\t\t\tvar siteid = curGrid.getUserData(curRowId,\"siteid\");\t\t\tgetSingleItemtest-grid-id(siteid,webid,listid,itemid,curRowId);\t\t}\t}\tvar options = { url: wurl, width: 600, dialogReturnValueCallback:myCallback };\tSP.UI.ModalDialog.showModalDialog(options);}function onKeyPresstest-grid-id(key, control, shift){\tif(!mygridtest-grid-id.editor)\t{\t\tif(key == 46)\t\t{\t\t\tvar rowId = mygridtest-grid-id.getSelectedRowId();\t\t\t\t\tvar isNew = mygridtest-grid-id.getUserData(rowId,\"isNewRow\");\t\t\tvar itemid = mygridtest-grid-id.getUserData(rowId,\"itemid\");\t\t\tif(isNew != \"1\" && itemid != \"\")\t\t\t{\t\t\t\tif(confirm('Are you sure you want to delete this item?')){\t\t\t\t\tmygridtest-grid-id.deleteRow(rowId);\t\t\t\t};            }\t\t}\t}\treturn true;}function newItemtest-grid-id(usepopup){\tvar wurl = mygridtest-grid-id._newitemurl;\tif(usepopup)\t{\t\tfunction NewItemCallback(dialogResult, returnValue){if(dialogResult){window.location.href=window.location.href;}}\t\tvar options = { url: wurl, width: 600, dialogReturnValueCallback:NewItemCallback };\t\tSP.UI.ModalDialog.showModalDialog(options);\t}\telse\t{\t\tlocation.href = wurl;\t}}function setDefaultstest-grid-id(id){\tvar dxml = id.xmlLoader;\t\tvar rows = dxml.doXPath(\"//rows/row[@id='_NEWROW_']\");\t\tvar ua = window.navigator.userAgent;    var msie = ua.indexOf(\"MSIE \");\tif (msie > 0)\t\tdefaultxmltest-grid-id = rows[0].xml;\telse\t\tdefaultxmltest-grid-id = rows[0].outerHTML;\tmygridtest-grid-id._defaults = defaultxmltest-grid-id;}function onEditCelltest-grid-id(stage, rowId, ind, nval, oval){\tif(stage != 2)        return true;        \tif(oval == null)\t\toval = \"\";\tif(!checkMintest-grid-id(rowId,ind,nval))    {        mygridtest-grid-id.cells(rowId,ind).setValue(oval);        return;    }        if(!checkMaxtest-grid-id(rowId,ind,nval))    {        mygridtest-grid-id.cells(rowId,ind).setValue(oval);        return;    }        //alert(\"OLD: \" + oval + \"\\r\\nNEW: \" + nval + \"\\r\\nTitle: \" + mygridtest-grid-id.cells(rowId,ind).getTitle());    \tif(stage == 2 && oval != nval)\t{\t\tvar isNew = mygridtest-grid-id.getUserData(rowId,\"isNewRow\");\t\tif(isNew != null && isNew == \"1\")\t\t{\t\t\tmygridtest-grid-id.setUserData(rowId,\"isNewRow\",\"\");\t\t\tmygridtest-grid-id.cells(rowId,0).setValue(\"\");\t\t\tinsertBlankRowtest-grid-id();\t\t}\t}\treturn true;}function insertBlankRowtest-grid-id(id){\tvar xmlDoc; \tvar moz = (typeof document.implementation != 'undefined') && (typeof \tdocument.implementation.createDocument != 'undefined'); \tvar ie = (typeof window.ActiveXObject != 'undefined'); \tif (window.DOMParser)\t{\t\tparser=new DOMParser();\t\txmlDoc=parser.parseFromString(defaultxmltest-grid-id,\"text/xml\");\t}\telse // code for IE\t{\t\txmlDoc=new ActiveXObject(\"Microsoft.XMLDOM\");\t\txmlDoc.async=false;\t\txmlDoc.loadXML(defaultxmltest-grid-id); \t}\tvar newId = \"_NEWROW_\" + mygridtest-grid-id.getUID();\tvar nRow = mygridtest-grid-id.addRow(newId,\"<img src=\\\"/_layouts/images/newitem.gif\\\">\");\txmlDoc.firstChild.setAttribute(\"id\",newId);\t\tsetRowValuetest-grid-id(xmlDoc.firstChild);\tmygridtest-grid-id.setUserData(newId,\"isNewRow\",\"1\");\tmyDataProcessortest-grid-id.setUpdated(newId,false);\t}dhtmlXGridObject.prototype.alerterror=function(msg){    document.getElementById(\"errordiv\" + this._gridid).innerHTML = \"Error: \" + msg;};dhtmlXGridObject.prototype.setuppaging=function(records){    \tvar pages = Math.ceil(records / this.PageSize);\tvar prev = document.getElementById(\"PagePrevious\"+ this._gridid);\tvar next = document.getElementById(\"PageNext\"+ this._gridid);\tvar pagediv = document.getElementById(\"pagediv\"+ this._gridid);\tvar pagetable = document.getElementById(\"pagetable\"+ this._gridid);\tif(this.UseReporting)\t{\t\tif(pages > 1)\t\t{\t\t\tif(!bPageSetuptest-grid-id)\t\t\t{\t\t\t\tbPageSetuptest-grid-id = true;\t\t\t\t$(\"#pagedivtest-grid-id\").paginate({\t\t\t\t\tcount \t\t: pages,\t\t\t\t\tstart \t\t: 1,\t\t\t\t\tdisplay     : 12,\t\t\t\t\tborder\t\t\t\t\t: true,\t\t\t\t\trotate      : false,\t\t\t\t\timages\t\t: false,\t\t\t\t\tmouse\t\t: 'press',\t\t\t\t\tonChange\t: ChangePagetest-grid-id\t\t\t\t});\t\t\t}\t\t}\t\telse\t\t{\t\t\tpagediv.style.display = \"none\";\t\t\tpagetable.style.display = \"none\";\t\t}\t}\telse\t{\t\tpagediv.style.display = \"inline-block\";\t\tpagetable.style.display = \"\";\t\tvar rec = records.split('|');\t\tfirstItemtest-grid-id = parseInt(rec[2]) * -1;\t\tlastItemtest-grid-id = rec[1];\t\tif(rec[0] == \"0\" || fItemHidetest-grid-id == firstItemtest-grid-id)\t\t{\t\t\tprev.style.background = \"#EFEFEF\";\t\t\tfItemHidetest-grid-id = firstItemtest-grid-id;\t\t}\t\telse\t\t{\t\t\tprev.style.background = \"#DDDDDD\";\t\t}\t\tif(rec[3] == \"true\")\t\t\tnext.style.background = \"#DDDDDD\";\t\telse\t\t{\t\t\tprev.style.background = \"#EFEFEF\";\t\t\tlastItemtest-grid-id = 0;\t\t}\t\tif(rec[3] != \"true\" && rec[0] == \"0\")\t\t{\t\t\tpagediv.style.display = \"none\";\t\t\tpagetable.style.display = \"none\";\t\t}\t}};dhtmlXGridObject.prototype.registerLookuptest-grid-id=function(col,vals){    if(arrColumnLookupstest-grid-id == null)        arrColumnLookupstest-grid-id = new Array(mygridtest-grid-id.getColumnsNum());\t\t    arrColumnLookupstest-grid-id[col] = vals;};//======================Multi User=====================function changeUsertest-grid-id(chkVal){\tdocument.getElementById(\"_downlevelTextBox\").value = \"\";\tdocument.getElementById(\"_upLevelDiv\").innerHTML = \"\";\t\t\tif(document.getElementById(\"_upLevelDiv\").firstChild == null)\t{\t\tvar oTN=document.createTextNode(\"\");\t\tdocument.getElementById(\"_upLevelDiv\").appendChild(oTN);\t}\tdocument.getElementById(\"_upLevelDiv\").firstChild.nodeValue = \"\";\t//chkVal.options[chkVal.selectedIndex].value;}function eXcell_usereditorm(cell){                                    //excell name is defined here    if (cell){                                                     //default pattern, just copy it        this.cell = cell;        this.grid = this.cell.parentNode.grid;        if(!this.grid._grid_pe)        {\t\t\tvar z=document.getElementById(\"people\" + cell.parentNode.grid.entBox.id);\t\t\tz.onclick=function(e){ (e||event).cancelBubble=true; }\t\t\t\t\t\tif (_isIE) { \t\t\t\tz.style.position=\"absolute\"\t\t\t\tz.style.top=\"0px\"\t\t\t}\t\t\tdocument.body.insertBefore(z,document.body.firstChild);\t\t\t \t\t\tthis.grid._grid_pe = z;\t\t}    }    this.setValue=function(val){\t\tvar strVal = \"&nbsp;\";\t\tvar strVals = val.split('\\t')[0].split('\\n');\t\tfor(var i = 1;i<strVals.length;i=i+2)\t\t{\t\t\tstrVal += \"; \" + strVals[i];\t\t}\t\tif(strVal != \"&nbsp;\")\t\t\tstrVal = strVal.substring(7);\t\t\t        this.setCValue(strVal);                   this.cell._displayValue = strVal;        this.cell._users = val.split('\\t')[0];                                           this.cell._Allusers = val === undefined ? [] : val.split('\\t')[1];                                       }    this.getValue=function(){       return this.cell._users; // get value    }    this.edit=function(){    \t\tthis.val=this.getValue();    \t\tdocument.getElementById(\"_downlevelTextBox\").value = \"\";\t\tdocument.getElementById(\"_upLevelDiv\").innerHTML = \"\";\t\tcopyUplevelToHidden('');\t\tupdateControlValue('');\t\tvar arg=getUplevel('');\t\tvar ctx='';\t\tEntityEditorSetWaitCursor(ctx);\t\tWebForm_DoCallback('',arg,EntityEditorHandleCheckNameResult,ctx,EntityEditorHandleCheckNameError,true);\t\t        var pp = document.getElementById(\"divPetest-grid-id\");        var ppi = document.getElementById(\"peoplecheckimgtest-grid-id\");        pp.style.display = \"none\";        ppi.src = \"_layouts/images/TPMAX1.GIF\";                    \t\tvar strVal = \"\";\t\tvar strAllUserChecks = \"\";\t\tvar strVals = this.cell._users.split('\\n');\t\tvar strAllUsers = this.cell._Allusers === undefined ? [] : this.cell._Allusers.split('\\n');\t\tvar strUserNames = '\\t';\t\t\t\tfor(var i = 0;i<strVals.length;i=i+2)\t\t{\t\t\tstrUserNames += strVals[i].toLowerCase() + '\\t';\t\t\tstrVal += \"; \" + strVals[i];\t\t}\t\tif(strVal.length > 1)\t\t\tstrVal = strVal.substring(1);\t\t\t\t\tfor(var i = 0;i<strAllUsers.length;i++)\t\t{\t\t\tvar isChecked = \"\";\t\t\tvar userInfo = strAllUsers[i].split(';#');\t\t\t\t\t\tif(strUserNames.indexOf('\\t' + userInfo[0].toLowerCase() + '\\t') > -1)\t\t\t\tisChecked = \"checked\";\t\t\t\t\t\t\tstrAllUserChecks += \"<br><input type=\\\"checkbox\\\" name=\\\"chkUserstest-grid-id\\\" value=\\\"\" + userInfo[0] + \"\\\" \" + isChecked + \">\" + userInfo[1];\t\t}\t\tif(strAllUserChecks.length > 1)\t\t\tstrAllUserChecks = strAllUserChecks.substring(4);\t\t\t\t\tdocument.getElementById(\"peoplechecktest-grid-id\").innerHTML = strAllUserChecks;\t\t\tvar arPos = this.grid.getPosition(this.cell);\t\tif(arPos[0] + 200 > document.body.clientWidth)\t\t\tthis.grid._grid_pe.style.left=document.body.clientWidth - 210;\t\telse\t\t\tthis.grid._grid_pe.style.left=arPos[0];\t\t\t\tif((arPos[1] + 100) > (document.body.clientHeight + document.body.scrollTop))\t\t\tthis.grid._grid_pe.style.top=document.body.clientHeight + document.body.scrollTop - 105;\t\telse\t\t\tthis.grid._grid_pe.style.top=arPos[1];\t\tthis.grid._grid_pe.style.display=\"\";\t\tthis.grid._grid_pe.style.position = \"absolute\";\t\tthis.grid._grid_pe.style.zIndex  = 99;    }    this.detach=function(){\t\tthis.grid._grid_pe.style.display=\"none\";\t\t\t\tvar strUsers = \"\";\t\tvar divChecks = document.getElementById(\"peoplechecktest-grid-id\");\t\tvar divChildChecks = divChecks.firstChild;\t\twhile(divChildChecks != null)\t\t{\t\t\tif(divChildChecks.nodeName == \"INPUT\")\t\t\t{\t\t\t\tif(divChildChecks.checked)\t\t\t\t{\t\t\t\t\tstrUsers += '\\n' + divChildChecks.value;\t\t\t\t\tstrUsers += '\\n' + divChildChecks.nextSibling.nodeValue;\t\t\t\t}\t\t\t}\t\t\tdivChildChecks = divChildChecks.nextSibling;\t\t}\t\tfor(var i = 0;i<document.getElementById(\"_upLevelDiv\").childNodes.length;i=i+2)\t\t{\t\t\tif(document.getElementById(\"_upLevelDiv\").childNodes[i].firstChild != null)\t\t\t{\t\t\t\tstrUsers += '\\n' + document.getElementById(\"_upLevelDiv\").childNodes[i].title;\t\t\t\tstrUsers += '\\n' + document.getElementById(\"_upLevelDiv\").childNodes[i].firstChild.nextSibling.innerText;\t\t\t}\t\t}\t\tif(strUsers.length > 1)\t\t\tstrUsers = strUsers.substring(1);\t\t\t\tvar oldValue = this.getValue();\t\t\t\t\tif(this.cell._Allusers !== undefined)\t\t\tthis.setValue(strUsers + '\\t' + this.cell._Allusers);         return oldValue != this.getValue();    }}eXcell_usereditorm.prototype = new eXcell;//================================User Single=================function eXcell_usereditor(cell){                                    //excell name is defined here    if (cell){        this.cell = cell;        this.grid = this.cell.parentNode.grid;        if(!this.grid._grid_pes)        {\t\t\tvar z=document.getElementById(\"peoplesingle\" + cell.parentNode.grid.entBox.id);\t\t\tz.onclick=function(e){ (e||event).cancelBubble=true; }\t\t\t\t\t\tif (_isIE) { \t\t\t\tz.style.position=\"absolute\"\t\t\t\tz.style.top=\"0px\"\t\t\t}\t\t\tdocument.body.insertBefore(z,document.body.firstChild);\t\t\t \t\t\tthis.grid._grid_pes = z;\t\t}    }    this.setValue=function(val){\t\tvar strVal = \"&nbsp;\";\t\tvar strVals = val.split('\\t')[0].split('\\n');\t\t\t\tfor(var i = 1;i<strVals.length;i=i+2)\t\t{\t\t\tstrVal += \"; \" + strVals[i];\t\t}\t\tif(strVal != \"&nbsp;\")\t\t\tstrVal = strVal.substring(7);\t\t\t        this.setCValue(strVal);                   this.cell._displayValue = strVal;        this.cell._users = val.split('\\t')[0];                                           this.cell._Allusers = val === undefined ? [] : val.split('\\t')[1];                                       }    this.getValue=function(){\t\t       return this.cell._users; // get value    }    this.edit=function(){\t\tthis.val=this.getValue();        var pp = document.getElementById(\"divPestest-grid-id\");        var ppi = document.getElementById(\"peoplechecksingleimgtest-grid-id\");        pp.style.display = \"none\";        ppi.src = \"_layouts/images/TPMAX1.GIF\";\t\tvar strVal = \"\";\t\tvar strAllUserChecks = \"\";\t\tvar strVals = this.cell._users.split('\\n');\t\tvar strAllUsers = this.cell._Allusers === undefined ? [] : this.cell._Allusers.split('\\n');\t\tvar strUserNames = '\\t';\t\tfor(var i = 0;i<strVals.length;i=i+2)\t\t{\t\t\tstrUserNames += strVals[i].toLowerCase() + '\\t';\t\t\tstrVal += \"; \" + strVals[i];\t\t}\t\tif(strVal.length > 1)\t\t\tstrVal = strVal.substring(1);\t\tvar slct = document.getElementById(\"peoplecheckselecttest-grid-id\");\t\tslct.options.length=0;\t\tvar oSelected = -1;\t\tvar oCounter = 0;\t\tfor(var i = 0;i<strAllUsers.length;i++)\t\t{\t\t\tvar isChecked = false;\t\t\tvar userInfo = strAllUsers[i].split(';#');\t\t\t\t\t\tif(strUserNames.indexOf('\\t' + userInfo[0].toLowerCase() + '\\t') > -1)\t\t\t\toSelected = oCounter;\t\t\t\t\t\t\tvar elOptNew = document.createElement('option');            elOptNew.text = userInfo[1];            elOptNew.value = userInfo[0];            try            {                slct.add(elOptNew, null);            }            catch(ex)            {                slct.add(elOptNew);            }\t\t\t\t\t\t\t\t\t\t//slct.add(new Option(userInfo[1], userInfo[0], false, isChecked));\t\t\toCounter++;\t\t}\t\t\t\tslct.selectedIndex = oSelected;\t\t\t\tdocument.getElementById(\"_downlevelTextBox\").value = \"\";\t\tdocument.getElementById(\"_upLevelDiv\").innerHTML = \"\";\t\t/*\t\tif(document.getElementById(\"_upLevelDiv\").firstChild == null)\t\t{\t\t\tvar oTN=document.createTextNode(\"\");\t\t\tdocument.getElementById(\"_upLevelDiv\").appendChild(oTN);\t\t}\t\tdocument.getElementById(\"_upLevelDiv\").firstChild.nodeValue = strVal;\t\t*/\t\tcopyUplevelToHidden('');\t\tupdateControlValue('');\t\tvar arg=getUplevel('');\t\tvar ctx='';\t\t\t\tEntityEditorSetWaitCursor(ctx);\t\tWebForm_DoCallback('',arg,EntityEditorHandleCheckNameResult,ctx,EntityEditorHandleCheckNameError,true);\t\t\t\t\t\tvar arPos = this.grid.getPosition(this.cell);\t\tif(arPos[0] + 200 > document.body.clientWidth)\t\t\tthis.grid._grid_pes.style.left=document.body.clientWidth - 210;\t\telse\t\t\tthis.grid._grid_pes.style.left=arPos[0];\t\t\t\tif((arPos[1] + 100) > (document.body.clientHeight + document.body.scrollTop))\t\t\tthis.grid._grid_pes.style.top=document.body.clientHeight + document.body.scrollTop - 105;\t\telse\t\t\tthis.grid._grid_pes.style.top=arPos[1];\t\tthis.grid._grid_pes.style.display=\"\";\t\tthis.grid._grid_pes.style.position = \"absolute\";\t\tthis.grid._grid_pes.style.zIndex  = 99;    }    this.detach=function(){\t\tthis.grid._grid_pes.style.display=\"none\";\t\t\t\tvar strUsers = \"\";\t\tfor(var i = 0;i<document.getElementById(\"_upLevelDiv\").childNodes.length;i=i+2)\t\t{\t\t\tif(document.getElementById(\"_upLevelDiv\").childNodes[i].firstChild != null)\t\t\t{\t\t\t\tstrUsers += '\\n' + document.getElementById(\"_upLevelDiv\").childNodes[i].title;\t\t\t\tstrUsers += '\\n' + document.getElementById(\"_upLevelDiv\").childNodes[i].firstChild.nextSibling.innerText;\t\t\t}\t\t}\t\tif(strUsers == \"\")\t\t{\t\t\tvar chkVal = document.getElementById(\"peoplecheckselecttest-grid-id\");\t\t\tif(chkVal.selectedIndex > -1)\t\t\t{\t\t\t\tstrUsers += '\\n' + chkVal.options[chkVal.selectedIndex].value;\t\t\t\tstrUsers += '\\n' + chkVal.options[chkVal.selectedIndex].text;\t\t\t}\t\t}\t\t\t\tif(strUsers.length > 1)\t\t\tstrUsers = strUsers.substring(1);\t\t\t\tvar oldValue = this.getValue();\t\t\t\t\tif(this.cell._Allusers !== undefined)\t\t\tthis.setValue(strUsers + '\\t' + this.cell._Allusers);         return oldValue != this.getValue();    }}eXcell_usereditor.prototype = new eXcell;//=========================choice========================function eXcell_choice(cell){                                    //excell name is defined here    if (cell){\t\t\t\t\t\t\t\t\t\t\t\t\t//default pattern, just copy it        this.cell = cell;        this.grid = this.cell.parentNode.grid;    }    this.setValue=function(val){\t\tvar strVal = \"\";\t\tvar dispVal = \"&nbsp;\";\t\tif(val == \";#\")\t\t\tval = \"\";\t\t\t\t\tval = val.replace(/&amp;/g,\"&\");\t\t\t\tif(val.split('\\t')[0] != \"\")\t\t{\t\t\tstrVal = val.split('\\t')[0];\t\t\tdispVal = strVal.split(';#')[1].replace(/&/g,\"&amp;\");\t\t}        this.setCValue(dispVal);        this.cell._value = strVal;        if(val.split('\\t').length > 1)\t\t\tthis.cell._allvalues = val.split('\\t')[1];    }    this.getValue=function(){\t\treturn this.cell._value;    }    this.edit=function(){\t\tthis.val=this.getValue();\t\tvar arPos = this.grid.getPosition(this.cell) //,this.grid.objBox)\t\tvar allvals = this.cell._allvalues;\t\tthis.obj=document.createElement(\"TEXTAREA\");\t\tthis.obj.className=\"dhx_combo_edit\";\t\tthis.obj.style.height=(this.cell.offsetHeight-4)+\"px\";\t\tthis.obj.wrap=\"soft\";\t\tthis.obj.style.textAlign=this.cell.align;\t\tthis.obj.onclick=function(e){\t\t\t(e||event).cancelBubble=true\t\t}\t\tthis.obj.value=this.text\t\tthis.obj.onselectstart=function(e){\t\t\tif (!e)\t\t\t\te=event;\t\t\te.cancelBubble=true;\t\t\treturn true;\t\t};\t\tvar editor_obj = this;\t\tthis.obj.onkeyup=function(e){\t\t\tvar val = this.readonly ? String.fromCharCode((e||event).keyCode) : this.value;\t\t\tvar c = editor_obj.list.options;\t\t\tfor (var i = 0; i < c.length; i++)\t\t\t\tif (c[i].text.indexOf(val) == 0)\t\t\t\t\treturn c[i].selected=true;\t\t}\t\tthis.list=document.createElement(\"SELECT\");\t\tthis.list.className='dhx_combo_select';\t\tthis.list.style.width=this.cell.offsetWidth+\"px\";\t\tthis.list.style.left=arPos[0]+\"px\";                       //arPos[0]\t\tthis.list.style.top=arPos[1]+this.cell.offsetHeight+\"px\"; //arPos[1]+this.cell.offsetHeight;\t\tthis.list.onclick=function(e){\t\t\tvar ev = e||window.event;\t\t\tev.cancelBubble=true;\t\t\tvar cell = ev.target||ev.srcElement\t\t\t//tbl.editor_obj.val=cell.combo_val;\t\t\tif (cell.tagName == \"OPTION\")\t\t\t\tcell=cell.parentNode;\t\t\teditor_obj.setValue(cell.value + \";#\" + cell.text);\t\t\teditor_obj.editable=false;\t\t\teditor_obj.grid.editStop();\t\t}\t\tvar comboKeys = this.cell._allvalues.split('\\n');\t\tvar fl = false;\t\tvar selOptId = 0;\t\tfor (var i = 0; i < comboKeys.length; i++){\t\t\tvar val = comboKeys[i].split(';#');\t\t\t\t\t\tvar elOptNew = document.createElement('option');            elOptNew.text = val[1];            elOptNew.value = val[0];            \t\t\tthis.list.options[this.list.options.length]=elOptNew\t\t\tif (comboKeys[i] == this.val){\t\t\t\tselOptId=this.list.options.length-1;\t\t\t\tfl=true;\t\t\t}\t\t}\t\tif (fl == false){ //if no such value in combo list\t\t\t\t\t\tvar elOptNew = document.createElement('option');            elOptNew.text = this.text;            elOptNew.value = this.val;            \t\t\t//this.list.options[this.list.options.length]=new Option(this.text, this.val === null ? \"\" : this.val);\t\t\t//this.list.options[this.list.options.length]=elOptNew;\t\t\t//selOptId=this.list.options.length-1;\t\t}\t\tdocument.body.appendChild(this.list) //nb:this.grid.objBox.appendChild(this.listBox);\t\tthis.list.size=\"6\";\t\tthis.cstate=1;\t\tif (this.editable){\t\t\tthis.cell.innerHTML=\"\";\t\t}\t\telse {\t\t\tthis.obj.style.width=\"1px\";\t\t\tthis.obj.style.height=\"1px\";\t\t}\t\tthis.cell.appendChild(this.obj);\t\tthis.list.options[selOptId].selected=true;\t\t\t\t    }    this.detach=function(){\t\t\t\tif (this.val != this.getValue())\t\t{\t\t\tthis.cell.wasChanged=true;\t\t}\t\tvar curVal = this.getValue();\t\tvar newVal = this.list.options[this.list.selectedIndex].value + \";#\" + this.list.options[this.list.selectedIndex].text;\t\tif(newVal == \";#\")\t\t\tnewVal = \"\";\t\t\t\tthis.setValue(newVal);\t\t\t\t\t\t/*if (this.list.parentNode != null)\t\t{\t\t\t\tif (this.obj.value._dhx_trim() != this.text){\t\t\t\t\tif (this.list.selectedIndex&&this.list.options[this.list.selectedIndex].text == this.obj.value)\t\t\t\t\t\tthis.setValue(this.list.value + '\\t' + this.cell._allvalues)\t\t\t\t\telse\t\t\t\t\t\tthis.setValue(this.obj.value + '\\t' + this.cell._allvalues)\t\t\t\t} else {\t\t\t\t\tthis.setValue(this.val + '\\t' + this.cell._allvalues)\t\t\t\t}\t\t}*/\t\tif (this.list.parentNode)\t\t\tthis.list.parentNode.removeChild(this.list);\t\tif (this.obj.parentNode)\t\t\tthis.obj.parentNode.removeChild(this.obj);\t\treturn newVal != curVal;\t\t    }}eXcell_choice.prototype = new eXcell;//=========================multichoice========================function eXcell_mchoice(cell){                                    //excell name is defined here    if (cell){                                                     //default pattern, just copy it        this.cell = cell;        this.grid = this.cell.parentNode.grid;        if(!this.grid._grid_mc)        {\t\t\tvar z=document.getElementById(\"multichoice\" + cell.parentNode.grid.entBox.id);\t\t\tz.onclick=function(e){ (e||event).cancelBubble=true; }\t\t\t\t\t\tif (_isIE) { \t\t\t\tz.style.position=\"absolute\"\t\t\t\tz.style.top=\"0px\"\t\t\t}\t\t\tdocument.body.insertBefore(z,document.body.firstChild); \t\t\tthis.grid._grid_mc = z;\t\t}    }    this.setValue=function(val){\t\tvar strVal = \"\";\t\t\t\tif(val.split('\\t')[0] != \"\")\t\t{\t\t\tvar strVals = val.split('\\t')[0].split('\\n');\t\t\tfor(var i = 0;i<strVals.length;i++)\t\t\t{\t\t\t\tvar valInfo = strVals[i].split(';#');\t\t\t\tstrVal += \", \" + valInfo[1];\t\t\t}\t\t\tif(strVal != \"\")\t\t\t\tstrVal = strVal.substring(2);\t\t}\t\tif(strVal != \"\")\t\t\tthis.setCValue(strVal.replace(\"&\",\"&amp;\"));\t\telse\t\t\tthis.setCValue(\"&nbsp;\");\t\t        this.cell._displayValue = strVal;        this.cell._values = val.split('\\t')[0];        this.cell._allvalues = val.split('\\t')[1];    }    this.getValue=function(){\t\treturn this.cell._values;    }    this.edit=function(){\t\tthis.val=this.getValue();\t\tvar strAllValueChecks = \"\";\t\tvar strVals = this.cell._values.split('\\n');\t\tvar strAllValues = this.cell._allvalues.split('\\n');\t\tvar strValues = '\\t';\t\t\t\tfor(var i = 0;i<strVals.length;i++)\t\t{\t\t\tvar valInfo = strVals[i].split(';#');\t\t\t\t\tstrValues += valInfo[0].toLowerCase() + '\\t';\t\t}\t\tfor(var i = 0;i<strAllValues.length;i++)\t\t{\t\t\tvar isChecked = \"\";\t\t\tvar valInfo = strAllValues[i].split(';#');\t\t\t\t\t\tif(strValues.indexOf('\\t' + valInfo[0].toLowerCase() + '\\t') > -1)\t\t\t\tisChecked = \"checked\";\t\t\tstrAllValueChecks += \"<br><input type=\\\"checkbox\\\" name=\\\"chkValuestest-grid-id\\\" value=\\\"\" + valInfo[0] + \"\\\" \" + isChecked + \">\" + valInfo[1];\t\t}\t\tif(strAllValueChecks.length > 1)\t\t\tstrAllValueChecks = strAllValueChecks.substring(4);\t\t\t\t\tdocument.getElementById(\"multichoiceinnertest-grid-id\").innerHTML = strAllValueChecks;\t\tvar arPos = this.grid.getPosition(this.cell);\t\tif(arPos[0] + 200 > document.body.clientWidth)\t\t\tthis.grid._grid_mc.style.left=document.body.clientWidth - 210;\t\telse\t\t\tthis.grid._grid_mc.style.left=arPos[0];\t\t\t\tif((arPos[1] + 100) > (document.body.clientHeight + document.body.scrollTop))\t\t\tthis.grid._grid_mc.style.top=document.body.clientHeight + document.body.scrollTop - 105;\t\telse\t\t\tthis.grid._grid_mc.style.top=arPos[1];\t\tthis.grid._grid_mc.style.display=\"\";\t\tthis.grid._grid_mc.style.position = \"absolute\";\t\tthis.grid._grid_mc.style.zIndex  = 99;    }    this.detach=function(){\t\t\t\tthis.grid._grid_mc.style.display=\"none\";\t\t\t\tvar child = document.getElementById(\"multichoiceinnertest-grid-id\").firstChild;\t\tvar val1 = \"\";\t\twhile(child != null)\t\t{\t\t\tif(child.nodeName == \"INPUT\")\t\t\t{\t\t\t\tif(child.checked)\t\t\t\t{\t\t\t\t\tval1 += '\\n' + child.value + \";#\" + child.nextSibling.nodeValue;\t\t\t\t}\t\t\t}\t\t\tchild = child.nextSibling;\t\t}\t\tif(val1.length > 1)\t\t\tval1 = val1.substring(1);\t\t\t\t\t\t\tvar oldValue = this.getValue();\t\t\t\tthis.cell._values = val1;\t\t\t        this.setValue(val1 + '\\t' + this.cell._allvalues);         return oldValue != this.getValue();\t\t    }}eXcell_mchoice.prototype = new eXcell;//=========================Calendar===========================eXcell_dhxCalendarA.prototype.edit = function(){\t                    var top;                    var left;                                        var arPos = this.grid.getPosition(this.cell);\t\t\t\t\tif(arPos[0] + this.cell.offsetWidth + 180 > document.body.clientWidth)\t\t\t\t\t\tleft = arPos[0] - 185;\t\t\t\t\telse\t\t\t\t\t\tleft=arPos[0] + this.cell.offsetWidth;\t\t\t\t\t\t\t\t\t\tif((arPos[1] + 170) > (document.body.clientHeight + document.body.scrollTop))\t\t\t\t\t\ttop=document.body.clientHeight + document.body.scrollTop - 180;\t\t\t\t\telse\t\t\t\t\t\ttop=arPos[1];                                        this.grid._grid_calendarA.setPosition(top,left);                    \t                    this.grid._grid_calendarA.show();\t                    this.grid._grid_calendarA._last_operation_calendar=false;\t\t\t\t\t//var arPos = this.grid.getPosition(this.cell);                    //var pval=this._date2str2(this.cell.val||new Date());                    //window._grid_calendar.render(arPos[0],arPos[1]+this.cell.offsetHeight,this,pval);                    this.cell._cediton=true;                    this.val=this.cell.val;                    //this.val=this.getValue();                    this._val=this.cell.innerHTML;                   // alert(this.cell.val);\t\t\t\t   \tthis.grid._grid_calendarA.setDateFormat((this.grid._dtmask||\"%d/%m/%Y\"));                    this.grid._grid_calendarA.setDate(this.val);                    this.grid._grid_calendarA.draw();                    \t\t\t\t\tthis.cell.atag=((!this.grid.multiLine)&&(_isKHTML||_isMacOS||_isFF))?\"INPUT\":\"TEXTAREA\";\t\t\t\t\t\t\t\t\t\tthis.obj = document.createElement(this.cell.atag);\t\t\t\t\tthis.obj.style.height = (this.cell.offsetHeight-(_isIE?4:2))+\"px\";                    this.obj.className=\"dhx_combo_edit\";\t\t\t\t   \tthis.obj.wrap = \"soft\";\t\t\t\t\tthis.obj.style.textAlign = this.cell.align;\t\t\t\t\tthis.obj.onclick = function(e){(e||event).cancelBubble = true}\t\t\t\t\tthis.obj.onmousedown = function(e){(e||event).cancelBubble = true}\t\t\t\t\tthis.obj.value = this.getValue();\t\t\t\t\tthis.cell.innerHTML = \"\";\t\t\t\t\tthis.cell.appendChild(this.obj);\t\t\t\t  \tif (_isFF) {\t\t\t\t\t\tthis.obj.style.overflow=\"visible\";\t\t\t\t\t\tif ((this.grid.multiLine)&&(this.obj.offsetHeight>=18)&&(this.obj.offsetHeight<40)){\t\t\t\t\t\t\tthis.obj.style.height=\"36px\";\t\t\t\t\t\t\tthis.obj.style.overflow=\"scroll\";\t\t\t\t\t\t}\t\t\t\t\t}                    this.obj.onselectstart=function(e){  if (!e) e=event; e.cancelBubble=true; return true;  };\t\t\t\t\tthis.obj.focus()  \t\t\t\t\tthis.obj.focus()\t\t\t\t                    \t\t\t\t}//============================================================function getSingleItemtest-grid-id(siteid,webid,listid,itemid,rowid){\tvar val = SP.UI.Notify.addNotification(\"Updating Saved Row...\", false,  \"\", null);\tdhtmlxAjax.post(singleItemUrltest-grid-id, \"siteid=\" + siteid + \"&webid=\" + webid + \"&listid=\" + listid + \"&itemid=\" + itemid + \"&rowid=\" + rowid,getSingleItemResponsetest-grid-id);}function getSingleItemResponsetest-grid-id(loader){\tif(loader.xmlDoc.responseText!=null)\t{\t\tvar xmlDoc = loader.xmlDoc.responseXML;\t\tfor(var i = 0;i<xmlDoc.childNodes.length;i++)\t\t{\t\t\tvar rowXml = xmlDoc.childNodes[i];\t\t\tsetRowValuestest-grid-id(rowXml);\t\t}\t}\telse\t\talert(\"Response contains no XML\");}function setRowValuestest-grid-id(rowsXml){\tfor(var i = 0;i<rowsXml.childNodes.length;i++)\t{\t\tsetRowValuetest-grid-id(rowsXml.childNodes[i])\t}}function setRowValuetest-grid-id(rowXml){\tvar rowId = rowXml.getAttribute(\"id\")\t\tvar cellCounter = 0;\tfor(var i = 0;i<rowXml.childNodes.length;i++)\t{\t\tif(rowXml.childNodes[i].nodeName == \"userdata\")\t\t{\t\t\tif(rowXml.childNodes[i].firstChild != null)\t\t\t\tmygridtest-grid-id.setUserData(rowId,rowXml.childNodes[i].getAttribute(\"name\"),rowXml.childNodes[i].firstChild.nodeValue);\t\t}\t\telse if(rowXml.childNodes[i].nodeName == \"cell\")\t\t{\t\t\tif(!inEditModetest-grid-id)\t\t\t{\t\t\t\tif(mygridtest-grid-id.getColType(cellCounter) != \"tree\")\t\t\t\t\tmygridtest-grid-id.setCellExcellType(rowId, cellCounter, \"ro\");\t\t\t\t\t\t\t\t\tmygridtest-grid-id.lockRow(rowId, true);\t\t\t}\t\t\t\t\t\tvar cellval = \"\";\t\t\tvar celltype = \"\";\t\t\ttry\t\t\t{\t\t\t\tcelltype = rowXml.childNodes[i].getAttribute(\"type\");\t\t\t}catch(e){}\t\t\t\t\t\t\t\t\tif(rowXml.childNodes[i].childNodes.length > 0)\t\t\t{\t\t\t\tcellval = rowXml.childNodes[i].firstChild.nodeValue;\t\t\t}\t\t\t\t\t\tif(celltype == \"combo\")\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(rowXml.childNodes[i]);\t\t\t\telse\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(cellval);\t\t\t\tcellCounter++;\t\t}\t}\t}function saveGridtest-grid-id(){\tmygridtest-grid-id.editStop();    sm('dlgSavingtest-grid-id',200,100);    if(myDataProcessortest-grid-id.updatedRows.length > 0)    {        myDataProcessortest-grid-id.sendData();    }    else        hm('dlgSavingtest-grid-id');}function onButtonClicktest-grid-id(menuitemId,grid_Id,grid){    var rowIdFull = grid_Id.split(\"_\")[0];    var weburl = context_grid.getUserData(rowIdFull,\"SiteUrl\");    var listId = context_grid.getUserData(rowIdFull,\"listid\");    var editurl = context_grid.getUserData(rowIdFull,\"editurl\");    var viewurl = context_grid.getUserData(rowIdFull,\"viewurl\");    var itemId = context_grid.getUserData(rowIdFull,\"itemid\");    var webId = context_grid.getUserData(rowIdFull,\"webid\");    var siteid = context_grid.getUserData(rowIdFull,\"siteid\");    var rowId = rowIdFull.split('.')[1];        var popup = context_grid.getUserData(rowIdFull,\"popup\");    var w = pageWidth() - 200;\tvar h = pageHeight() - 100;             switch(menuitemId)    {\t\tcase \"createworkspace\":\t\t\turl = weburl + \"/_layouts/epmlive/requestworkspace.aspx?list=\" + listidtest-grid-id + \"&ID=\" + itemId;\t\t\tdocument.location.href=url;\t\t\t\t\t\tbreak;\t\tcase \"workspace\":\t\t\tif(viewurl == null)                url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=workspace&webid=\" + webId ;            else                url = weburl;                \t\t\tdocument.location.href=url;\t\t\tbreak;\t\t\t\tcase \"workplan\":\t\t\tif(viewurl == null)\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=workplan&webid=\" + webId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\telse\t\t\t\turl = weburl + \"/_layouts/epmlive/tasks.aspx?ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t\t\t\t\tdocument.location.href=url;\t\t\tbreak;\t\t\t\t\tcase \"agile\":\t\t\tif(viewurl == null)\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=agile&webid=\" + webId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\telse\t\t\t\turl = weburl + \"/_layouts/epmlive/agile/tasks.aspx?ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t\t\t\t\tdocument.location.href=url;\t\t\tbreak;\t\t\t\tcase \"projectpro\":\t\t\tif(viewurl == null)\t\t\t{\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=getproject&webid=\" + webId + \"&ID=\" + itemId + \"&listID=\" + listId + \"&Source=\" + document.location.href;;\t\t\t\tdocument.location.href=url;\t\t\t}\t\t\telse\t\t\t{\t\t\t\tjavascript:window.open(weburl + '/_layouts/epmlive/getproject.aspx?listID=' + listId + '&ID=' + itemId,'', config='height=100,width=200, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, directories=no, status=no');\t\t\t}\t\t\tbreak;\t\t        case \"edit\":            var url = \"\";            if(popup==\"yes\")            {\t\t\t\t\t\t\t\tvar url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=viewedit2&ListId=\" + listId + \"&ID=\" + itemId + \"&Mode=2&gridid=test-grid-id&siteid=\" + siteid + \"&webid=\" + webId + \"&rowid=\" + rowIdFull;\t\t\t\tsm('editItemtest-grid-id',w,h);\t\t\t\tdocument.getElementById(\"frmEditFrametest-grid-id\").src = url;            }            else            {\t\t\t\tif(editurl == null)\t\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=edit&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t\telse\t\t\t\t\turl = editurl + \"?ListId=\" + listId + \"&ID=\" + itemId + \"&Mode=2&Source=\" + document.location.href;\t\t\t\tdocument.location.href=url;            }            break;        case \"perms\":\t\t\tvar url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=perms&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t            //var url = weburl + \"/_layouts/User.aspx?obj={\" + listId + \"},\" + itemId + \",LISTITEM&List={\" + listId + \"}&Source=\" + document.location.href;            document.location.href=url;            break;        case \"view\":\t\t\tif(popup==\"yes\")            {\t\t\t\tvar url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=viewedit2&ListId=\" + listId + \"&ID=\" + itemId + \"&Mode=1&gridid=test-grid-id&siteid=\" + siteid + \"&webid=\" + webId + \"&rowid=\" + rowIdFull;\t\t\t\tsm('editItemtest-grid-id',w,h);\t\t\t\tdocument.getElementById(\"frmEditFrametest-grid-id\").src=url;            }            else            {\t\t\t\tvar url;\t\t\t\tif(viewurl == null)\t\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=view&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t\telse\t\t\t\t\turl = viewurl + \"?ListId=\" + listId + \"&ID=\" + itemId + \"&Mode=1&Source=\" + document.location.href;\t\t\t\tdocument.location.href=url;            }            break;        case \"delete\":            if(confirm('Are you sure you want to send this item to the Recycle Bin?')){                var url;                if(viewurl == null)                {                    url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=delete&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&NextUsing=\" + document.location.href;                    document.location.href=url;                }                else                {                                            postDelete(weburl + '/_vti_bin/owssvr.dll?CS=65001&Cmd=Delete&List={' + listId + '}&ID=' + itemId + '&NextUsing=' + document.location.href);                                     }            };            break;        case \"alerts\":            var url;            if(viewurl == null)                url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=alerts&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;            else                url = weburl + \"/_layouts/SubNew.aspx?List={\" + listId + \"}&ID=\" + itemId + \"&Source=\" + document.location.href;                            document.location.href=url;            break;        case \"versions\":            var url = weburl + \"/_layouts/Versions.aspx?list={\" + listId + \"}&ID=\" + itemId + \"&Source=\" + document.location.href;            document.location.href=url;            break;        case \"approve\":            var url = weburl + \"/_layouts/approve.aspx?list={\" + listId + \"}&ID=\" + itemId + \"&Source=\" + document.location.href;            document.location.href=url;            break;        case \"workflows\":            var url = weburl + \"/_layouts/Workflow.aspx?list={\" + listId + \"}&ID=\" + itemId + \"&Source=\" + document.location.href;            document.location.href=url;            break;    };}function redoCss(rowindex){\tvar j = rowindex;\tfor (var i = rowindex; i < mygridtest-grid-id.rowsCol.length; i++){\t\t\tif (!mygridtest-grid-id.rowsCol[i])\t\t\t\tcontinue;\t\t\tif (mygridtest-grid-id.rowsCol[i].style.display != \"none\"){\t\t\t\tif (mygridtest-grid-id.rowsCol[i].className.indexOf(\"rowselected\") != -1){\t\t\t\t\tif (j%2 == 1)\t\t\t\t\t\tmygridtest-grid-id.rowsCol[i].className=mygridtest-grid-id._cssUnEven+\" rowselected \"+(mygridtest-grid-id.rowsCol[i]._css||\"\");\t\t\t\t\telse\t\t\t\t\t\tmygridtest-grid-id.rowsCol[i].className=mygridtest-grid-id._cssEven+\" rowselected \"+(mygridtest-grid-id.rowsCol[i]._css||\"\");\t\t\t\t} else {\t\t\t\t\tif (j%2 == 1)\t\t\t\t\t\tmygridtest-grid-id.rowsCol[i].className=mygridtest-grid-id._cssUnEven+(mygridtest-grid-id.rowsCol[i]._css||\"\");\t\t\t\t\telse\t\t\t\t\t\tmygridtest-grid-id.rowsCol[i].className=mygridtest-grid-id._cssEven+(mygridtest-grid-id.rowsCol[i]._css||\"\");\t\t\t\t}\t\t\t\tj++;\t\t\t}\t\t}}function leavePagetest-grid-id(e){\tvar hasupdates = false;\t\tfor(var i = 0;i < myDataProcessortest-grid-id.updatedRows.length;i++)\t{\t\tif(myDataProcessortest-grid-id.updatedRows[i] != null)\t\t{\t\t\thasupdates = true;\t\t}\t}    if(hasupdates )    {        if(!e) e = window.event;\t    //e.cancelBubble is supported by IE - this will kill the bubbling process.\t    //e.cancelBubble = true;\t    e.returnValue = 'You have unsaved changes.'; //This is displayed on the dialog\t    if (e.stopPropagation) {\t\t    e.stopPropagation();\t\t    e.preventDefault();\t    }    }}function URLEncode( plaintext ){\t// The Javascript escape and unescape functions do not correspond\t// with what browsers actually do...\tvar SAFECHARS = \"0123456789\" +\t\t\t\t\t// Numeric\t\t\t\t\t\"ABCDEFGHIJKLMNOPQRSTUVWXYZ\" +\t// Alphabetic\t\t\t\t\t\"abcdefghijklmnopqrstuvwxyz\" +\t\t\t\t\t\"-_.!~*'()\";\t\t\t\t\t// RFC2396 Mark characters\tvar HEX = \"0123456789ABCDEF\";\tvar encoded = \"\";\tfor (var i = 0; i < plaintext.length; i++ ) {\t\tvar ch = plaintext.charAt(i);\t    if (ch == \" \") {\t\t    encoded += \"+\";\t\t\t\t// x-www-urlencoded, rather than %20\t\t} else if (SAFECHARS.indexOf(ch) != -1) {\t\t    encoded += ch;\t\t} else {\t\t    var charCode = ch.charCodeAt(0);\t\t\tif (charCode > 255) {\t\t\t    alert( \"Unicode Character '\"                         + ch                         + \"' cannot be encoded using standard URL encoding.\\n\" +\t\t\t\t          \"(URL encoding only supports 8-bit characters.)\\n\" +\t\t\t\t\t\t  \"A space (+) will be substituted.\" );\t\t\t\tencoded += \"+\";\t\t\t} else {\t\t\t\tencoded += \"%\";\t\t\t\tencoded += HEX.charAt((charCode >> 4) & 0xF);\t\t\t\tencoded += HEX.charAt(charCode & 0xF);\t\t\t}\t\t}\t}\treturn encoded;};function checkMintest-grid-id(rowId,cellIndex,value){    if(minValuestest-grid-id[cellIndex] != \"\")    {        var val = parseFloat(value);        var min = parseFloat(minValuestest-grid-id[cellIndex]);        if(val < min)        {            alert('You must enter a value greater than ' + min);            return false;        }    }    return true;}function checkMaxtest-grid-id(rowId,cellIndex,value){    if(maxValuestest-grid-id[cellIndex] != \"\")    {        var val = parseFloat(value);        var max = parseFloat(maxValuestest-grid-id[cellIndex]);        if(val > max)        {            alert('You must enter a value less than ' + max);                        return false;        }    }    return true;}dhtmlXGridObject.prototype._in_header_master_checkbox2 = function (t, i, c) { \tt.innerHTML = c[0] + \"<input type='checkbox' />\" + c[1]; \tvar self = this; \tt.firstChild.onclick = function (e) \t{ \t\tself._build_m_order(); \t\tvar j = self._m_order ? self._m_order[i] : i;\t\tvar val = this.checked;// ? true : false;\t\tself.forEachRow(function (id) {\t\t\tvar c = this.cells(id, j);\t\t\tif (c.isCheckbox() && !c.cell.firstChild.disabled)\t\t\t{\t\t\t\tc.cell.firstChild.checked = val;\t\t\t\tif(val)\t\t\t\t\tc.cell.firstChild.style.display = \"\";\t\t\t\telse\t\t\t\t\tc.cell.firstChild.style.display = \"none\";\t\t\t}\t\t});\t\t(e || event).cancelBubble = true;\t} };dhtmlXGridObject.prototype.checksubs = function(row){\tvar rowid = row.parentNode.parentNode.idd;\tif(this.hasChildren(rowid) > 0)\t{\t\tvar rowids = this.getAllSubItems(rowid).split(',');\t\tfor(var i = 0;i<rowids.length;i++)\t\t{\t\t\tvar curRow = rowids[i];\t\t\tthis.cells(curRow, 0).cell.firstChild.checked = row.checked;\t\t\tif(row.checked)\t\t\t\tthis.cells(curRow, 0).cell.firstChild.style.display = \"\";\t\t\telse\t\t\t\tthis.cells(curRow, 0).cell.firstChild.style.display = \"none\";\t\t}\t\t\t}};window.onbeforeunload=leavePagetest-grid-id;minValuestest-grid-id = [\"\",\"1\"];maxValuestest-grid-id = [\"\",\"1\"];var singleEditItemUrltest-grid-id;var inEditModetest-grid-id;function fireEvent(element,event){    if (document.createEventObject){        // dispatch for IE        var evt = document.createEventObject();        return element.fireEvent('on'+event,evt)    }    else{        // dispatch for firefox + others        var evt = document.createEvent(\"HTMLEvents\");        evt.initEvent(event, true, true ); // event type,bubbling,cancelable        return !element.dispatchEvent(evt);    }}function editRowtest-grid-id(rowid){\tvar EditCol = getEditColtest-grid-id();        if(EditCol != null)    {    \t\tvar listId = mygridtest-grid-id.getUserData(rowid,\"listid\");\t\tvar itemId = mygridtest-grid-id.getUserData(rowid,\"itemid\");\t\tvar webId = mygridtest-grid-id.getUserData(rowid,\"webid\");\t\tvar siteId = mygridtest-grid-id.getUserData(rowid,\"siteid\");    \t\tmygridtest-grid-id.cells(rowid, EditCol).setValue(\"<img src='/_layouts/epmlive/images/loader1.gif'>\");\t\tdhtmlxAjax.post(singleEditItemUrltest-grid-id, \"siteid=\" + siteId + \"&webid=\" + webId + \"&listid=\" + listId + \"&itemid=\" + itemId + \"&rowid=\" + rowid,editRowResponsetest-grid-id);    }}function getEditColtest-grid-id(){\tvar EditCol;\tfor(var i = 0;i<mygridtest-grid-id.getColumnsNum();i++)    {        if(mygridtest-grid-id.getColumnId(i) == \"<![CDATA[Edit]]>\")        {            EditCol = i;\t\t\tbreak;        }    }    return EditCol;}function editRowResponsetest-grid-id(loader){\tif(loader.xmlDoc.responseText!=null)\t{\t\t\tvar xmlDoc = loader.xmlDoc.responseXML;\t\tfor(var i = 0;i<xmlDoc.childNodes.length;i++)\t\t{\t\t\tvar rowXml = xmlDoc.childNodes[i];\t\t\tsetEditRowstest-grid-id(rowXml);\t\t\t}\t}\telse\t\talert(\"Response contains no XML\");}function setEditRowstest-grid-id(rowsXml){\tfor(var i = 0;i<rowsXml.childNodes.length;i++)\t{\t\tsetEditRowtest-grid-id(rowsXml.childNodes[i])\t}}function setEditRowtest-grid-id(rowXml){\tvar rowId = rowXml.getAttribute(\"id\")\t\tvar cellCounter = 0;\tmygridtest-grid-id.lockRow(rowId, false);\tfor(var i = 0;i<rowXml.childNodes.length;i++)\t{\t\tif(rowXml.childNodes[i].nodeName == \"userdata\")\t\t{\t\t\t//mygridtest-grid-id.setUserData(rowId,rowXml.childNodes[i].getAttribute(\"name\"),rowXml.childNodes[i].firstChild.nodeValue);\t\t}\t\telse if(rowXml.childNodes[i].nodeName == \"cell\")\t\t{\t\t\tvar cellval = \"\";\t\t\tvar celltype = \"\";\t\t\ttry\t\t\t{\t\t\t\tcelltype = rowXml.childNodes[i].getAttribute(\"type\");\t\t\t}catch(e){}\t\t\tif(rowXml.childNodes[i].childNodes.length > 0)\t\t\t{\t\t\t\tcellval = rowXml.childNodes[i].firstChild.nodeValue;\t\t\t}\t\t\tif(celltype == \"combo\")\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(rowXml.childNodes[i]);\t\t\t\telse\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(cellval);\t\t\t\t\t\t\tif(celltype != null)\t\t\t{\t\t\t\tmygridtest-grid-id.setCellExcellType(rowId, i, celltype);\t\t\t}\t\t\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(cellval);\t\t\t\tcellCounter++;\t\t}\t}\tvar EditCol = getEditColtest-grid-id();    \tif(EditCol != null)\t{\t\tmygridtest-grid-id.cells(rowId, EditCol).setValue(\"<a onclick=\\\"javascript:saveEdittest-grid-id('\" + rowId + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/saveitem.gif\\\" border=\\\"0\\\" alt=\\\"Save\\\"></a> <a onclick=\\\"javascript:cancelEditRowtest-grid-id('\" + rowId + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/close.gif\\\" border=\\\"0\\\" alt=\\\"Cancel\\\"></a>\");\t}}function saveEdit2test-grid-id(rowid){\tmygridtest-grid-id.editStop();\t\trow = mygridtest-grid-id.getRowById(rowid);\t\tvar cols = row.childNodes.length;\tvar changed = false;\tfor (var j = 0; j < cols; j++)\t\tif (row.childNodes[j].wasChanged){\t\t\tchanged = true;\t\t\tbreak;\t\t}\t\tvar EditCol = getEditColtest-grid-id();\t    if(EditCol != null)\t\tmygridtest-grid-id.cells(rowid, EditCol).setValue(\"<img src='/_layouts/epmlive/images/loader1.gif'>\");\t\t\t\tif(changed)\t\tmyDataProcessortest-grid-id.sendData(rowid);\telse\t\tcancelEditRowtest-grid-id(rowid);}function saveEdittest-grid-id(rowid){\tsetTimeout(\"saveEdit2test-grid-id('\" + rowid + \"')\", 100);}function cancelEditRowtest-grid-id(rowid){\tvar EditCol = getEditColtest-grid-id();\t    mygridtest-grid-id.lockRow(rowid, true);    myDataProcessortest-grid-id.setUpdated(rowid, false, null);        if(EditCol != null)    {\t\tvar listid = mygridtest-grid-id.getUserData(rowid,\"listid\");\t\tvar itemid = mygridtest-grid-id.getUserData(rowid,\"itemid\");\t\tvar webid = mygridtest-grid-id.getUserData(rowid,\"webid\");\t\tvar siteid = mygridtest-grid-id.getUserData(rowid,\"siteid\");\t\tmygridtest-grid-id.cells(rowid, EditCol).setValue(\"<img src='/_layouts/epmlive/images/loader1.gif'>\");\t\tdhtmlxAjax.post(singleItemUrltest-grid-id, \"edit=false&siteid=\" + siteid + \"&webid=\" + webid + \"&listid=\" + listid + \"&itemid=\" + itemid + \"&rowid=\" + rowid,cancelEditRowResponsetest-grid-id);\t}\t}function cancelEditRowResponsetest-grid-id(loader){\tif(loader.xmlDoc.responseText!=null)\t{\t\tvar xmlDoc = loader.xmlDoc.responseXML;\t\t\t\tfor(var i = 0;i<xmlDoc.childNodes.length;i++)\t\t{\t\t\tvar rowXml = xmlDoc.childNodes[i];\t\t\tsetCRowValuestest-grid-id(rowXml);\t\t}\t}\telse\t\talert(\"Response contains no XML\");}function setCRowValuestest-grid-id(rowsXml){\tfor(var i = 0;i<rowsXml.childNodes.length;i++)\t{\t\tsetCRowValuetest-grid-id(rowsXml.childNodes[i])\t}}function setCRowValuetest-grid-id(rowXml){\tvar rowId = rowXml.getAttribute(\"id\");\tvar cellCounter = 0;\t\tfor(var i = 0;i<rowXml.childNodes.length;i++)\t{\t\tif(rowXml.childNodes[i].nodeName == \"userdata\")\t\t{\t\t\t//mygridtest-grid-id.setUserData(rowId,rowXml.childNodes[i].getAttribute(\"name\"),rowXml.childNodes[i].text);\t\t}\t\telse if(rowXml.childNodes[i].nodeName == \"cell\")\t\t{\t\t\tvar cellval = \"\";\t\t\t\t\t\tif(rowXml.childNodes[i].childNodes.length > 0)\t\t\t{\t\t\t\tcellval = rowXml.childNodes[i].firstChild.nodeValue;\t\t\t}\t\t\tif(mygridtest-grid-id.getColType(cellCounter) != \"tree\")\t\t\t\tmygridtest-grid-id.setCellExcellType(rowId, cellCounter, \"ro\");\t\t\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(cellval);\t\t\t\t\t\t\tcellCounter++;\t\t}\t}\t\tvar EditCol;\tfor(var i = 0;i<mygridtest-grid-id.getColumnsNum();i++)\t{\t\tif(mygridtest-grid-id.getColumnId(i) == \"<![CDATA[Edit]]>\")\t\t{\t\t\tEditCol = i;\t\t\tbreak;\t\t}\t}    \tif(EditCol != null)\t{\t\tmygridtest-grid-id.cells(rowId, i).setValue(\"<a onclick=\\\"javascript:editRowtest-grid-id('\" + rowId + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/edit.gif\\\" border=\\\"0\\\"></a>\");\t}}function ChangePagetest-grid-id(pg){curPagetest-grid-id = pg;loadXtest-grid-id(sftest-grid-id, svtest-grid-id, sttest-grid-id);}function NextPagetest-grid-id(){if(lastItemtest-grid-id != 0){curPagetest-grid-id = lastItemtest-grid-id;loadXtest-grid-id(sftest-grid-id, svtest-grid-id, sttest-grid-id);}}function PreviousPagetest-grid-id(){if(fItemHidetest-grid-id != firstItemtest-grid-id){curPagetest-grid-id = firstItemtest-grid-id;loadXtest-grid-id(sftest-grid-id, svtest-grid-id, sttest-grid-id);}}function loadXtest-grid-id(searchfield, searchvalue, searchtype){var ribbontestintervall = null; mygridwidthtest-grid-id = document.getElementById('WebPartdummy').offsetWidth - 25;if(searchfield){searchvalue = escape(searchvalue);mygridtest-grid-id.post(\"http://fake.url/_layouts/epmlive/getgriditems.aspx\",\"data=&edit=true&insertrow=False&width=\" + mygridwidthtest-grid-id + \"&searchfield=\" + searchfield + \"&searchvalue=\" + searchvalue + \"&searchtype=\" + searchtype + \"&page=\" + curPagetest-grid-id + \"&source=http%3a%2f%2ffake.url%2f\");}else{mygridtest-grid-id.post(\"http://fake.url/_layouts/epmlive/getgriditems.aspx\",\"data=&edit=true&insertrow=False&width=\" + mygridwidthtest-grid-id + \"&page=\" + curPagetest-grid-id + \"&source=http%3a%2f%2ffake.url%2f\");}}function showrib(){setTimeout(\"clickTab()\", 1);}function clickTab(){try{var wp = document.getElementById('MSOZoneCell_WebPartdummy');WpClick({target: wp});}catch(e){}}function clickbrowse(){try{var wp2 = document.getElementById('Ribbon.Read-title').firstChild;fireEvent(wp2, 'click');}catch(e){}}setTimeout(\"clickTab()\", 1000);_spBodyOnLoadFunctionNames.push(\"loadXtest-grid-id('test-search-field','test-search-string','1')\");</script><div id=\"dlgSavingtest-grid-id\" class=\"dialog\">    <table width=\"100%\">        <tr>            <td align=\"center\" class=\"ms-sectionheader\">                <img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/><br />                <H3 class=\"ms-standardheader\">Saving Items...</h3>            </td>        </tr>    </table></div> <div id=\"dlgRefreshtest-grid-id\" class=\"dialog\">    <table width=\"100%\">        <tr>            <td align=\"center\" class=\"ms-sectionheader\">                <img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/><br />                <H3 class=\"ms-standardheader\">Refreshing Data...</h3>            </td>        </tr>    </table></div> <div id=\"dlgErrortest-grid-id\" class=\"dialog\">    <table width=\"100%\" height=\"100%\" cellpadding=\"0\" cellspacing=\"3\">\t\t<tr>\t\t\t<td class=\"ms-sectionheader\"><H3 class=\"ms-standardheader\">Error: </h3></td>\t\t</tr>        <tr height=\"100%\">            <td align=\"left\"valign=\"top\">                <div id=\"dlgErrorTexttest-grid-id\" style=\"overflow: auto;height=90%;width=100%\" class=\"ms-descriptiontext\"></div><br>            </td>        </tr>        <tr>\t\t\t<td align=\"right\">\t\t\t\t<input type=\"button\" class=\"ms-input\" value=\"Close\" onClick=\"hm('dlgErrortest-grid-id');\">\t\t\t</td>\t\t</tr>    </table></div><div id=\"editItemtest-grid-id\" class=\"dialog\">    <table width=\"100%\" height=\"100%\" id=\"tblEditItem\" cellpadding=\"0\" cellspacing=\"0\">        <tr height=\"100%\">            <td align=\"center\" bgcolor=\"FFFFFF\">                <div id=\"editItemLoadtest-grid-id\">                    <img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/>                </div>                <iframe id=\"frmEditFrametest-grid-id\" width=\"100%\" height=\"100%\" frameborder=\"0\" src=\"http://fake.url/_layouts/epmlive/blank.gif\">                                    </iframe>            </td>        </tr>    </table></div><div id=\"dlgPosting\" class=\"dialog\">    <table width=\"100%\">        <tr>            <td align=\"center\" class=\"ms-sectionheader\">                <img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/><br />                <H3 class=\"ms-standardheader\">Posting Data...</h3>            </td>        </tr>    </table></div> <script>var bPageSetuptest-grid-id;var firstItemtest-grid-id;var lastItemtest-grid-id;var fItemHidetest-grid-id;function setupPagetest-grid-id(records, UseReporting, PageSize){\tvar pages = Math.ceil(records / PageSize);\tvar prev = document.getElementById(\"PagePrevioustest-grid-id\");\tvar next = document.getElementById(\"PageNexttest-grid-id\");\tvar pagediv = document.getElementById(\"pagedivtest-grid-id\");\tif(UseReporting)\t{\t\tif(pages > 1)\t\t{\t\t\tif(!bPageSetuptest-grid-id)\t\t\t{\t\t\t\tbPageSetuptest-grid-id = true;\t\t\t\t$(\"#pagedivtest-grid-id\").paginate({\t\t\t\t\tcount \t\t: pages,\t\t\t\t\tstart \t\t: 1,\t\t\t\t\tdisplay     : 12,\t\t\t\t\tborder\t\t\t\t\t: true,\t\t\t\t\tborder_color\t\t\t: '#CCCCCC',\t\t\t\t\ttext_color  \t\t\t: '#666666',\t\t\t\t\tbackground_color    \t: '#DDDDDD',\t\t\t\t\t\tborder_hover_color\t\t: '#878787',\t\t\t\t\ttext_hover_color  \t\t: '#ffffff',\t\t\t\t\tbackground_hover_color\t: '#9B9B9B', \t\t\t\t\trotate      : false,\t\t\t\t\timages\t\t: false,\t\t\t\t\tmouse\t\t: 'press',\t\t\t\t\tonChange\t: ChangePagetest-grid-id\t\t\t\t});\t\t\t}\t\t}\t\telse\t\t{\t\t\tpagediv.style.display = \"none\";\t\t}\t}\telse\t{\t\tpagediv.style.display = \"inline-block\";\t\tvar rec = records.split('|');\t\tfirstItemtest-grid-id = parseInt(rec[2]) * -1;\t\tlastItemtest-grid-id = rec[1];\t\tif(rec[0] == \"0\" || fItemHidetest-grid-id == firstItemtest-grid-id)\t\t{\t\t\tprev.style.background = \"#EFEFEF\";\t\t\tfItemHidetest-grid-id = firstItemtest-grid-id;\t\t}\t\telse\t\t{\t\t\tprev.style.background = \"#DDDDDD\";\t\t}\t\tif(rec[3] == \"true\")\t\t\tnext.style.background = \"#DDDDDD\";\t\telse\t\t{\t\t\tprev.style.background = \"#EFEFEF\";\t\t\tlastItemtest-grid-id = 0;\t\t}\t\tif(rec[3] != \"true\" && rec[0] == \"0\")\t\t{\t\t\tpagediv.style.display = \"none\";\t\t}\t}}</script><script>initmb();</script>"));
        }

        [TestMethod]
        public void GridListView_renderGrid_GivenArguments_TabularView_ConfirmOutput()
        {
            // Arrange
            SetupShims();
            ShimSPView.AllInstances.TabularViewGet = (_) => true;

            // Act
            _testablePrivate.Invoke("renderGrid",
                new object[] { writer, web });

            // Assert
            _testablePrivate.ShouldSatisfyAllConditions(
                () => writeCount.ShouldBe(336),
                () => writerContent.ToString().Length.ShouldBe(75461),
                () => writerContent.ToString().ShouldBe("<style>.ms-usereditor { width:200px; }.grid_hover { border: 10px solid #91CDF2; background-color: #F2FAFF } </style><div id=\"peoplegrid\" style=\"display:none; border: 1px solid #808080; padding: 3px; background-color: #F9F9F9; width=200px;\"><div id=\"peoplechecktest-grid-id\" style=\"overflow: auto; width: 200px; height: 100px;  background-color: #FFFFFF; border: 1px solid #808080; margin-top:2px; padding:3px;\" class=\"ms-descriptiontext\"></div><table border=\"0\" width=\"100%\"><tr><td><a onclick=\"javascript:viewCheckstest-grid-id('test-grid-id');\"><img id=\"peoplecheckimgtest-grid-id\" src=\"_layouts/images/TPMAX1.GIF\" border=\"0\"></a><br></td><td align=\"right\"><font class=\"ms-descriptiontext\"><a onclick=\"javascript:mygridtest-grid-id.editStop();\">Close</a></font></td></tr></table><div id=\"divPetest-grid-id\" style=\"display:none;\"></div></div><div id=\"peoplesinglegrid\" style=\"display:none; border: 1px solid #808080; padding: 3px; background-color: #F9F9F9; width=200px;\"><div id=\"peoplechecksingletest-grid-id\" style=\"width: 200px; height: 100px;  background-color: #FFFFFF; border: 1px solid #808080; margin-top:2px; padding:0px;\" class=\"ms-descriptiontext\"><select size=\"6\" onclick=\"changeUsertest-grid-id(this);\" id=\"peoplecheckselecttest-grid-id\"  style=\"width:100%;height:100%\"><option>test</option></select></div><table border=\"0\" width=\"200\"><tr><td><a onclick=\"javascript:viewDropDowntest-grid-id('test-grid-id');\"><img id=\"peoplechecksingleimgtest-grid-id\" src=\"_layouts/images/TPMAX1.GIF\" border=\"0\"></a><br></td><td align=\"right\"><font class=\"ms-descriptiontext\"><a onclick=\"javascript:mygridtest-grid-id.editStop();\">Close</a></font></td></tr></table><div id=\"divPestest-grid-id\" style=\"display:none;\"></div></div><div id=\"multichoicegrid\" style=\"display:none; border: 1px solid #808080; padding: 3px; background-color: #F9F9F9; width:200px;height:180px\"><div id=\"multichoiceinnertest-grid-id\" style=\"width: 195px; height: 160px;  background-color: #FFFFFF; border: 1px solid #808080; margin-top:2px; padding:0px;overflow:auto\" class=\"ms-descriptiontext\">test</div><table border=\"0\" width=\"200\"><tr><td align=\"right\"><font class=\"ms-descriptiontext\"><a onclick=\"javascript:mygridtest-grid-id.editStop();\">Close</a></font></td></tr></table></div><div id=\"gridmenutest-grid-id\" style=\"position:absolute;left:0px;display:none;\" class=\"js-callout-mainElement ms-core-defaultFont  ms-alignLeft ms-shadow\"><ul class=\"ms-core-menu-list\" style=\"width: 173px;\"></ul></div><script>_css_prefix=\"/_layouts/epmlive/DHTML/xgrid/\"; _js_prefix=\"/_layouts/epmlive/DHTML/xgrid/\"; </script><script src=\"_layouts/epmlive/DHTML/xgrid/dhtmlxcommon.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/dhtmlxgrid.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/dhtmlxgridcell.js\"></script><script src=\"_layouts/epmlive/DHTML/xtreegrid/dhtmlxtreegrid.js\"></script><script src=\"_layouts/epmlive/DHTML/xtreegrid/ext/dhtmlxtreegrid_filter.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_post.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_nxml.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_filter.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_math.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/ext/dhtmlxgrid_srnd.js\"></script><script src=\"/_layouts/epmlive/DHTML/xgrid/excells/dhtmlxgrid_excell_calendar.js\"></script><script src=\"/_layouts/epmlive/DHTML/xgrid/excells/dhtmlxgrid_excell_combo.js\"></script><script src=\"_layouts/epmlive/DHTML/xgrid/excells/dhtmlxgrid_excell_dhxcalendar.js\"></script><script src=\"_layouts/epmlive/DHTML/xcombo/dhtmlxcombo.js\"></script><script src=\"_layouts/epmlive/DHTML/calendar/dhtmlxcalendar.js\"></script><script src=\"_layouts/epmlive/DHTML/xdataproc/dhtmlxdataprocessor.js\"></script><script type=\"text/javascript\" src=\"_layouts/epmlive/modal/modal.js\"></script> <script language=\"JavaScript\" src=\"_layouts/epmlive/dhtml/xmenu/dhtmlxmenu.js\"></script><script language=\"JavaScript\" src=\"_layouts/epmlive/dhtml/xmenu/ext/dhtmlxmenu_ext.js\"></script><style>.menuTable{background-color:#ffffff;}.secondMenuTable{background-color:#ffffff;}.contextMenuover, .contextMenudown{background-color:#9ac2e5;}.contextMenuover td{color:#000000;} </style><script src=\"_layouts/epmlive/epmlivegrid.js\"></script><script language=\"javascript\">var searchfieldstest-grid-id = {test-field: [ \"Yes\", \"No\" ]};function switchsearchtest-grid-id()            {                var searcher = document.getElementById('searchtest-grid-id');                var searchtext = document.getElementById('searchtexttest-grid-id');                var searchchoice = document.getElementById('searchchoicetest-grid-id');                var searchtypechoice = document.getElementById('searchtypetest-grid-id');                var searchfield = searcher.options[searcher.selectedIndex].value;                var sList = searchfieldstest-grid-id[searchfield];                if(sList) {                    searchtext.style.display='none';                    searchchoice.style.display='';                    searchchoice.options.length = 0;                    searchtypechoice.options[2].selected = true;                    searchtypechoice.disabled = true;                    for(var i=0; i < sList.length; i++) {                        var d = sList[i];                        searchchoice.options.add(new Option(d, d));                        if(d=='test-search-string') {                            searchchoice.options[searchchoice.options.length-1].selected = true;                        }                     }                 } else {                    searchtext.style.display='';                    searchchoice.style.display='none';                    searchtypechoice.disabled = false;                }            }function unSearchtest-grid-id(){var gri = document.getElementById('grid');gri.style.display = 'none';var loader = document.getElementById('loadinggrid');loader.style.display = '';var unsearch = document.getElementById('unsearchtest-grid-id');unsearch.style.display=\"none\";var searchtext = document.getElementById('searchtexttest-grid-id');searchtext.value = '';curPagetest-grid-id = 0;sftest-grid-id = null;svtest-grid-id = null;sttest-grid-id = null;loadXtest-grid-id();}function doSearchtest-grid-id(){var gri = document.getElementById('grid');                     gri.style.display = 'none';                     var loader = document.getElementById('loadinggrid');                     loader.style.display = '';                var searcher = document.getElementById('searchtest-grid-id');                var unsearch = document.getElementById('unsearchtest-grid-id');                unsearch.style.display=\"table-cell\";                var searchchoice = document.getElementById('searchchoicetest-grid-id');                var searchtext = document.getElementById('searchtexttest-grid-id');                var searchtypechoice = document.getElementById('searchtypetest-grid-id');                var searchfield = searcher.options[searcher.selectedIndex].value;                var searchtype = searchtypechoice.options[searchtypechoice.selectedIndex].value;                var sList = searchfieldstest-grid-id[searchfield];                var searchvalue = \"\";                if(sList){                    searchvalue = searchchoice.options[searchchoice.selectedIndex].value;                } else {                     searchvalue = searchtext.value;                }curPagetest-grid-id = 0;                         sftest-grid-id = searchfield;                         svtest-grid-id = searchvalue;                         sttest-grid-id = searchtype;                                loadXtest-grid-id(searcher.options[searcher.selectedIndex].value, searchvalue, searchtype);                            }function enablesearchertest-grid-id(){}</script><div id=\"search\" style=\"width:100%; height:25px; padding:10px\" class=\"ms-listviewtable\"><table><tr><td>Search: <select id=\"searchtest-grid-id\" onChange=\"switchsearchtest-grid-id();\" style=\"border: 1px solid #ABABAB; height:20px\"><option value=\"test-field\">test-field</option></select>&nbsp;&nbsp;<select id=\"searchtypetest-grid-id\" style=\"border: 1px solid #ABABAB; height:20px\"><option value=\"1\" selected>Contains</option><option value=\"8\" >Begins With</option><option value=\"2\" >Equals</option><option value=\"3\" >Does Not Equal</option><option value=\"4\" >Greater Than</option><option value=\"5\" >Greater Than or Equal</option><option value=\"6\" >Less Than</option><option value=\"7\" >Less Than or Equal</option></select>&nbsp;&nbsp;</td><td><div style=\"border: 1px solid #ABABAB;width: 150px;height: 20px;\">                    <div id=\"unsearchtest-grid-id\" class=\"\" style=\"padding-left:4px;display: none;min-width: 12px;align:top\">                        <img alt=\"Clear Search\" src=\"/_layouts/epmlive/images/unsearch.png\" style=\"padding-bottom:2px\" onclick=\"unSearchtest-grid-id()\"/>                    </div>                    <div style=\"display: table-cell\">                        <input type=\"text\" id=\"searchtexttest-grid-id\" value=\"test-search-string\" class=\"\" style=\"border: 0px; width:100%; margin-top:-5px; height:14px; font-family: 'Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size:13px\"/>                        <select id=\"searchchoicetest-grid-id\" style=\"border: 0px; width:100%\">                        </select>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    </div>                    <div class=\"\" style=\"padding-right:2px; padding-left:5px;padding-top:2px;display: table-cell;min-width: 10px;cursor:pointer\">                        <img onclick=\"GridSearch('test-grid-id')\" src=\"/_layouts/epmlive/images/find_icon.png\"/>                    </div>                </div></td></tr></table></div><script language=\"javascript\">switchsearchtest-grid-id();</script><div id=\"grid\" style=\"width:100%;display:none;\" class=\"ms-listviewtable\"></div><div id=\"errordivtest-grid-id\" style=\"font-color:red;font-size:11px;\"></div><div  width=\"100%\" id=\"loadinggrid\" align=\"center\"><img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/> Loading Items...</div><script language=\"javascript\">function viewCheckstest-grid-id(btn){var pp = document.getElementById('divPe' + btn);var ppi = document.getElementById('peoplecheckimg' + btn);if(pp.style.display == \"none\"){pp.style.display = \"\";ppi.src = \"_layouts/images/TPMIN1.GIF\";}else{pp.style.display = \"none\";ppi.src = \"_layouts/images/TPMAX1.GIF\";}}function viewDropDowntest-grid-id(btn){var pp = document.getElementById('divPes' + btn);var ppi = document.getElementById('peoplechecksingleimg' + btn);if(pp.style.display == \"none\"){pp.style.display = \"\";ppi.src = \"_layouts/images/TPMIN1.GIF\";}else{pp.style.display = \"none\";ppi.src = \"_layouts/images/TPMAX1.GIF\";}}function gridfiltertest-grid-id(value){var vals = value.split('|');mygridtest-grid-id.filterBy(vals[0],vals[1]);}function setSizetest-grid-id(){mygridtest-grid-id._askRealRows();}function printgridtest-grid-id() {var temp = mygridtest-grid-id.hdr.rows[2];var parent = temp.parentNode;parent.removeChild(temp,true);mygridtest-grid-id.printView();parent.appendChild(temp);}function switchFilterLoadtest-grid-id(){mygridtest-grid-id.switchFilter();mygridtest-grid-id.setSizes();}</script><script>var mygridtest-grid-idHidden = false;var listidtest-grid-id = '00000000-0000-0000-0000-000000000000';mygridtest-grid-id = new dhtmlXGridObject('grid');mygridtest-grid-id.setImagePath(\"_layouts/epmlive/dhtml/xgrid/imgs/\");mygridtest-grid-id.getTitles = function(){                            var lookups = \"\";            mygridtest-grid-id.forEachRow(function (id) {\t\t\t    var c = this.cells(id, 0);\t\t\t    if (c.isCheckbox() && !c.cell.firstChild.disabled && c.cell.firstChild.checked)                {                    var title = this.getUserData(id,\"title\");        \t        var itemid = this.getUserData(id,\"itemid\");                    if(itemid != \"\")                    {                        lookups += \",\" + title;                    }                }\t\t    });            if(lookups == \"\")            {                var rowId = mygridtest-grid-id.getSelectedRowId();                lookups = \",\" + mygridtest-grid-id.getUserData(rowId,\"title\");            }            if(lookups != \"\" && lookups[0] == ',')                lookups = lookups.substring(1);            return lookups;                }                mygridtest-grid-id.getCheckedRowIds = function(){                var ids = \"\";                this.forEachRow(function (id) {\t\t\t        var c = this.cells(id, 0);\t\t\t        if (c.isCheckbox() && !c.cell.firstChild.disabled && c.cell.firstChild.checked)                    {                        ids += \",\" + id;                    }\t\t        });                if(ids != \"\" && ids[0] == ',')                    ids = ids.substring(1);                if(ids == \"\")                    ids = this.getSelectedRowId();                return ids;            };mygridtest-grid-id.getCheckedIds = function(){                var ids = \"\";                this.forEachRow(function (id) {\t\t\t        var c = this.cells(id, 0);\t\t\t        if (c.isCheckbox() && !c.cell.firstChild.disabled && c.cell.firstChild.checked)                    {                        var listid = this.getUserData(id,\"listid\");        \t            var itemid = this.getUserData(id,\"itemid\");        \t            var webid = this.getUserData(id,\"webid\");                        if (this._useparent) {                            var parentid = this.getUserData(id, \"parentitemid\");                            if (parentid && parentid != \"\") {                                var newids = parentid.toString().split(\".\");                                webid = newids[0];                                listid = newids[1];                                itemid = newids[2];                            }                        }                        if(itemid != \"\")                        {                            ids += \",\" + webid + \".\" + listid + \".\" + itemid;                        }                    }\t\t        });                if(ids == \"\")                {                    var rowId = this.getSelectedRowId();                    var listid = this.getUserData(rowId,\"listid\");        \t        var itemid = this.getUserData(rowId,\"itemid\");        \t        var webid = this.getUserData(rowId,\"webid\");                    if (this._useparent) {                        var parentid = this.getUserData(rowId, \"parentitemid\");                        if (parentid && parentid != \"\") {                            var newids = parentid.toString().split(\".\");                            webid = newids[0];                            listid = newids[1];                            itemid = newids[2];                        }                    }                    if(itemid != \"\")                    {                        ids = webid + \".\" + listid + \".\" + itemid;                    }                }                if(ids != \"\" && ids[0] == ',')                    ids = ids.substring(1);                return ids;            };mygridtest-grid-id.getCheckedItems = function(){                var ids = \"\";                this.forEachRow(function (id) {\t\t\t        var c = this.cells(id, 0);\t\t\t        if (c.isCheckbox() && !c.cell.firstChild.disabled && c.cell.firstChild.checked)                    {                        var listid = this.getUserData(id,\"listid\");        \t            var itemid = this.getUserData(id,\"itemid\");        \t            var webid = this.getUserData(id,\"webid\");                        if(itemid != \"\")                        {                            ids += \",\" + itemid;                        }                    }\t\t        });                if(ids == \"\")                {                    var rowId = this.getSelectedRowId();                    var listid = this.getUserData(rowId,\"listid\");        \t        var itemid = this.getUserData(rowId,\"itemid\");        \t        var webid = this.getUserData(rowId,\"webid\");                    if(itemid != \"\")                    {                        ids = itemid;                    }                }                if(ids != \"\" && ids[0] == ',')                    ids = ids.substring(1);                return ids;            };mygridtest-grid-id.toggleSearch = function(){var searchDiv = document.getElementById('search');if(searchDiv.style.display == 'none'){searchDiv.style.display = '';}else{searchDiv.style.display = 'none';}};mygridtest-grid-id.switchFilter = function(){try{var input1 = mygridtest-grid-id.hdr.rows[2];if(mygridtest-grid-idHidden == false){input1.style.display = \"none\";mygridtest-grid-idHidden = true;}else{input1.style.display = \"\";mygridtest-grid-idHidden = false;}mygridtest-grid-id.setSizes();}catch(e){}};mygridtest-grid-id._enableCMenus = true;mygridtest-grid-id.PageSize = '0';mygridtest-grid-id.UseReporting = false;curPagetest-grid-id = 0;mygridtest-grid-id._epkview = '';mygridtest-grid-id._useparent = false;mygridtest-grid-id._curPlanner = '';mygridtest-grid-id._epkurl = '';mygridtest-grid-id._epkcostview = '';mygridtest-grid-id.canribbon = true;mygridtest-grid-id.addFocusedCommands = function($arr){return $arr;}mygridtest-grid-id.getGlobalCommands = function($arr){return $arr;}mygridtest-grid-id.canHandleCommand = function($Grid, commandId){return false;}mygridtest-grid-id.handleCommand = function($Grid, commandId, properites){if(typeof(properties) != 'undefined')return properties;}mygridtest-grid-id._webpartid = '';mygridtest-grid-id._outlookexport = '';mygridtest-grid-id._gridMode = '';mygridtest-grid-id._hasTemplateList = false;mygridtest-grid-id._newmenumode = 0;mygridtest-grid-id._newitemurl = 'test-server-url';mygridtest-grid-id._newfolder = false;mygridtest-grid-id._newmenu = \"<Button Id=\\'Ribbon.ListItem.New.NewListItem\\' Command=\\'NewItem\\' CommandValueId=\\'NewListItem\\' LabelText=\\'New Item\\' Description=\\'Create a New Item\\' Image32by32=\\'/_layouts/0/images/formatmap32x32.png\\' CommandType=\\'OptionSelection\\' Image32by32Top=\\'-160\\' Image32by32Left=\\'-384\\'/>\"mygridtest-grid-id._modifylist = false;mygridtest-grid-id._listperms = false;mygridtest-grid-id._shownewmenu = true;mygridtest-grid-id._allowedit = false;mygridtest-grid-id._listid = '00000000-0000-0000-0000-000000000000';mygridtest-grid-id._webid = '00000000-0000-0000-0000-000000000000';mygridtest-grid-id._listname = '';mygridtest-grid-id._viewid = '00000000-0000-0000-0000-000000000000';mygridtest-grid-id._viewurl = 'http://fake.url/http://fake.url';mygridtest-grid-id._siteurl = '';mygridtest-grid-id._webrelurl = 'test-server-url';mygridtest-grid-id._viewname = 'dummy';mygridtest-grid-id._basetype = 'GenericList';mygridtest-grid-id._templatetype = '0';mygridtest-grid-id._newrow = false;mygridtest-grid-id._rolluplists = '';mygridtest-grid-id._brollups = false;mygridtest-grid-id._requestList = false;mygridtest-grid-id._usepopup = false;mygridtest-grid-id._lookupfield = '';mygridtest-grid-id._lookupfieldlist = '';mygridtest-grid-id._excell = 'test-server-url\\u002f_vti_bin\\u002fowssvr.dll?CS=65001\\u0026Using=_layouts\\u002fquery.iqy\\u0026List=\\u00257B00000000\\u00252D0000\\u00252D0000\\u00252D0000\\u00252D000000000000\\u00257D\\u0026View=\\u00257B00000000\\u00252D0000\\u00252D0000\\u00252D0000\\u00252D000000000000\\u00257D\\u0026RootFolder=http:\\u0026CacheControl=1';mygridtest-grid-id._gridid = 'test-grid-id';mygridtest-grid-id._formmenus = \"\";mygridtest-grid-id.setSkin(\"modern\");mygridtest-grid-id.enableAlterCss(\"ms-itmhover\", \"ms-itmhover\");mygridtest-grid-id.enableAutoHeight(true);mygridtest-grid-id.enableSmartRendering(true);mygridtest-grid-id.enableSmartXMLParsing(true);mygridtest-grid-id.setAwaitedRowHeight(30);mygridtest-grid-id.setImageSize(1,1);mygridtest-grid-id._editmode = false;mygridtest-grid-id.enableEditEvents(true,false,false);document.onclick=function(){mygridtest-grid-id._curHover=false;mygridtest-grid-id.clearmenus();};mygridtest-grid-id.setDateFormat(\"%m/%d/%Y\");mygridtest-grid-id.attachEvent(\"onXLE\",clearLoader);mygridtest-grid-id.attachEvent(\"onXLE\",switchFilterLoadtest-grid-id);mygridtest-grid-id.attachEvent(\"onXLE\",enablesearchertest-grid-id);mygridtest-grid-id.attachEvent(\"onXLE\",showrib());mygridtest-grid-id.attachEvent(\"onRowSelect\",selectRowtest-grid-id);mygridtest-grid-id.hovered = \"\";                    mygridtest-grid-id.attachEvent(\"onMouseOver\", function(id,ind){                        if(mygridtest-grid-id.hovered != id)                        {                            var c = this.cells(id, 0);\t\t\t                if (c.isCheckbox())                            {                                c.cell.firstChild.style.display=\"\";                                try                                {                                    var c = this.cells(mygridtest-grid-id.hovered, 0);                                    if(c && !c.cell.firstChild.checked)                                        c.cell.firstChild.style.display=\"none\";                                }catch(e){}                                mygridtest-grid-id.hovered = id;                            }                        }                    });mygridtest-grid-id._singleItemUrl = \"http://fake.url/_layouts/epmlive/getsingleitem.aspx?data=&edit=false\";mygridtest-grid-id.init();singleItemUrltest-grid-id = \"http://fake.url/_layouts/epmlive/getsingleitem.aspx?data=&edit=false\";singleEditItemUrltest-grid-id = \"test-server-url/_layouts/epmlive/getedititem.aspx?data=\";inEditModetest-grid-id = false;myDataProcessortest-grid-id = new dataProcessor(\"http://fake.url/_layouts/epmlive/savegrid.aspx?columns=dGVzdC1maWVsZC0x&data=&edit=false\");myDataProcessortest-grid-id.setUpdateMode(\"off\");myDataProcessortest-grid-id.defineAction(\"error100\", myErrorHandlertest-grid-id);myDataProcessortest-grid-id.defineAction(\"error500\", error500test-grid-id);myDataProcessortest-grid-id.defineAction(\"alldatareturned\", alldatareturnedtest-grid-id);myDataProcessortest-grid-id.setTransactionMode(\"POST\", true);myDataProcessortest-grid-id.init(mygridtest-grid-id);mygridtest-grid-id.enableTreeCellEdit(false);function viewErrortest-grid-id(id){document.getElementById('dlgErrorTexttest-grid-id').innerText=mygridtest-grid-id.getUserData(id,\"lastError\");sm('dlgErrortest-grid-id',250,130);}function myErrorHandlertest-grid-id(obj){      var id = obj.getAttribute(\"sid\");var EditCol = getEditColtest-grid-id();if(EditCol != null){      mygridtest-grid-id.cells(id,EditCol).setValue(\"<a href=\\\"javascript:viewErrortest-grid-id('\" + id + \"');\\\"><img src='/_layouts/images/EXCLAIM.GIF' border='0'></a> <a onclick=\\\"javascript:saveEdittest-grid-id('\" + id + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/saveitem.gif\\\" border=\\\"0\\\" alt=\\\"Save\\\"></a> <a onclick=\\\"javascript:cancelEditRowtest-grid-id('\" + id + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/close.gif\\\" border=\\\"0\\\" alt=\\\"Cancel\\\"></a>\");}      mygridtest-grid-id.setUserData(id,\"lastError\",obj.firstChild.data);      return true;}function alldatareturnedtest-grid-id(obj){      setRowValuestest-grid-id(obj.firstChild);}function error500test-grid-id(obj){      alert(obj.firstChild.data);      myDataProcessortest-grid-id.stopOnError = true;       hm('dlgSavingtest-grid-id');      return false;}myDataProcessortest-grid-id.setOnAfterUpdate(function(id,action,newid){if(action != \"error100\" && action != \"delete\"){mygridtest-grid-id.cells(id,0).setValue(\"\");mygridtest-grid-id.cells(id,0).setBgColor('#F0F0F0');}if(myDataProcessortest-grid-id.getSyncState()){    hm('dlgSavingtest-grid-id');    myDataProcessortest-grid-id.updatedRows = new Array(0);}});var singleItemUrltest-grid-id;var arrColumnLookupstest-grid-id;var defaultxmltest-grid-id;var minValuestest-grid-id;var maxValuestest-grid-id;var curPagetest-grid-id = 0;var firstItemtest-grid-id = 0;var lastItemtest-grid-id = 0;var fItemHidetest-grid-id = 0;var sftest-grid-id;var svtest-grid-id;var sttest-grid-id;var bPageSetuptest-grid-id = false;function selectRowtest-grid-id(id, ind){\t\tcurRowId = id;\tcurGrid = mygridtest-grid-id;\tvar c = curGrid.cells(id, 0);\tif (c.isCheckbox())\t{\t\tUnCheckAll(curGrid);\t\tc.cell.firstChild.checked = true;\t\tc.cell.firstChild.display = \"\";\t}\tRefreshCommandUI();\tif(curGrid.canribbon)\t{\t\tif(curGrid.getRowById(id)._locked)\t\t{\t\t\tSelectRibbonTab(\"Ribbon.ListItem\", true);\t\t\t//var wp2 = document.getElementById('Ribbon.ListItem-title');\t\t\t//if(wp2)\t\t\t//\tfireEvent(wp2.firstChild, 'click');\t\t}\t}}function UnCheckAll(grid){\tgrid.forEachRow(function (id) {\t\tvar c = this.cells(id, 0);\t\tif (c.isCheckbox())\t\t{\t\t\tc.cell.firstChild.checked = false;\t\t\tc.cell.firstChild.display = \"none\";\t\t}\t});}function viewItemtest-grid-id(link, action){    var rowIdFull = link.parentNode.parentNode.parentNode.parentNode.parentNode.idd;    var weburl = mygridtest-grid-id.getUserData(rowIdFull,\"SiteUrl\");    var listId = mygridtest-grid-id.getUserData(rowIdFull,\"listid\");    var webid = mygridtest-grid-id.getUserData(rowIdFull,\"webid\");    var siteid = mygridtest-grid-id.getUserData(rowIdFull,\"siteid\");    var editurl = mygridtest-grid-id.getUserData(rowIdFull,\"editurl\");    var viewurl = mygridtest-grid-id.getUserData(rowIdFull,\"viewurl\");    var itemId = mygridtest-grid-id.getUserData(rowIdFull,\"itemid\");    var FullURL = mygridtest-grid-id.getUserData(rowIdFull,\"FullURL\");    var wurl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=\" + action + \"&ListId=\" + listId + \"&ID=\" + itemId + \"&gridid=test-grid-id&siteid=\" + siteid + \"&webid=\" + webid + \"&rowid=\" + rowIdFull;        function myCallback(dialogResult, returnValue)\t{\t\tif(dialogResult == 1)\t\t{\t\t\tvar weburl = curGrid.getUserData(curRowId,\"SiteUrl\");\t\t\tvar listid = curGrid.getUserData(curRowId,\"listid\");\t\t\tvar itemid = curGrid.getUserData(curRowId,\"itemid\");\t\t\tvar webid = curGrid.getUserData(curRowId,\"webid\");\t\t\tvar siteid = curGrid.getUserData(curRowId,\"siteid\");\t\t\tgetSingleItemtest-grid-id(siteid,webid,listid,itemid,curRowId);\t\t}\t}\tvar options = { url: wurl, width: 600, dialogReturnValueCallback:myCallback };\tSP.UI.ModalDialog.showModalDialog(options);}function onKeyPresstest-grid-id(key, control, shift){\tif(!mygridtest-grid-id.editor)\t{\t\tif(key == 46)\t\t{\t\t\tvar rowId = mygridtest-grid-id.getSelectedRowId();\t\t\t\t\tvar isNew = mygridtest-grid-id.getUserData(rowId,\"isNewRow\");\t\t\tvar itemid = mygridtest-grid-id.getUserData(rowId,\"itemid\");\t\t\tif(isNew != \"1\" && itemid != \"\")\t\t\t{\t\t\t\tif(confirm('Are you sure you want to delete this item?')){\t\t\t\t\tmygridtest-grid-id.deleteRow(rowId);\t\t\t\t};            }\t\t}\t}\treturn true;}function newItemtest-grid-id(usepopup){\tvar wurl = mygridtest-grid-id._newitemurl;\tif(usepopup)\t{\t\tfunction NewItemCallback(dialogResult, returnValue){if(dialogResult){window.location.href=window.location.href;}}\t\tvar options = { url: wurl, width: 600, dialogReturnValueCallback:NewItemCallback };\t\tSP.UI.ModalDialog.showModalDialog(options);\t}\telse\t{\t\tlocation.href = wurl;\t}}function setDefaultstest-grid-id(id){\tvar dxml = id.xmlLoader;\t\tvar rows = dxml.doXPath(\"//rows/row[@id='_NEWROW_']\");\t\tvar ua = window.navigator.userAgent;    var msie = ua.indexOf(\"MSIE \");\tif (msie > 0)\t\tdefaultxmltest-grid-id = rows[0].xml;\telse\t\tdefaultxmltest-grid-id = rows[0].outerHTML;\tmygridtest-grid-id._defaults = defaultxmltest-grid-id;}function onEditCelltest-grid-id(stage, rowId, ind, nval, oval){\tif(stage != 2)        return true;        \tif(oval == null)\t\toval = \"\";\tif(!checkMintest-grid-id(rowId,ind,nval))    {        mygridtest-grid-id.cells(rowId,ind).setValue(oval);        return;    }        if(!checkMaxtest-grid-id(rowId,ind,nval))    {        mygridtest-grid-id.cells(rowId,ind).setValue(oval);        return;    }        //alert(\"OLD: \" + oval + \"\\r\\nNEW: \" + nval + \"\\r\\nTitle: \" + mygridtest-grid-id.cells(rowId,ind).getTitle());    \tif(stage == 2 && oval != nval)\t{\t\tvar isNew = mygridtest-grid-id.getUserData(rowId,\"isNewRow\");\t\tif(isNew != null && isNew == \"1\")\t\t{\t\t\tmygridtest-grid-id.setUserData(rowId,\"isNewRow\",\"\");\t\t\tmygridtest-grid-id.cells(rowId,0).setValue(\"\");\t\t\tinsertBlankRowtest-grid-id();\t\t}\t}\treturn true;}function insertBlankRowtest-grid-id(id){\tvar xmlDoc; \tvar moz = (typeof document.implementation != 'undefined') && (typeof \tdocument.implementation.createDocument != 'undefined'); \tvar ie = (typeof window.ActiveXObject != 'undefined'); \tif (window.DOMParser)\t{\t\tparser=new DOMParser();\t\txmlDoc=parser.parseFromString(defaultxmltest-grid-id,\"text/xml\");\t}\telse // code for IE\t{\t\txmlDoc=new ActiveXObject(\"Microsoft.XMLDOM\");\t\txmlDoc.async=false;\t\txmlDoc.loadXML(defaultxmltest-grid-id); \t}\tvar newId = \"_NEWROW_\" + mygridtest-grid-id.getUID();\tvar nRow = mygridtest-grid-id.addRow(newId,\"<img src=\\\"/_layouts/images/newitem.gif\\\">\");\txmlDoc.firstChild.setAttribute(\"id\",newId);\t\tsetRowValuetest-grid-id(xmlDoc.firstChild);\tmygridtest-grid-id.setUserData(newId,\"isNewRow\",\"1\");\tmyDataProcessortest-grid-id.setUpdated(newId,false);\t}dhtmlXGridObject.prototype.alerterror=function(msg){    document.getElementById(\"errordiv\" + this._gridid).innerHTML = \"Error: \" + msg;};dhtmlXGridObject.prototype.setuppaging=function(records){    \tvar pages = Math.ceil(records / this.PageSize);\tvar prev = document.getElementById(\"PagePrevious\"+ this._gridid);\tvar next = document.getElementById(\"PageNext\"+ this._gridid);\tvar pagediv = document.getElementById(\"pagediv\"+ this._gridid);\tvar pagetable = document.getElementById(\"pagetable\"+ this._gridid);\tif(this.UseReporting)\t{\t\tif(pages > 1)\t\t{\t\t\tif(!bPageSetuptest-grid-id)\t\t\t{\t\t\t\tbPageSetuptest-grid-id = true;\t\t\t\t$(\"#pagedivtest-grid-id\").paginate({\t\t\t\t\tcount \t\t: pages,\t\t\t\t\tstart \t\t: 1,\t\t\t\t\tdisplay     : 12,\t\t\t\t\tborder\t\t\t\t\t: true,\t\t\t\t\trotate      : false,\t\t\t\t\timages\t\t: false,\t\t\t\t\tmouse\t\t: 'press',\t\t\t\t\tonChange\t: ChangePagetest-grid-id\t\t\t\t});\t\t\t}\t\t}\t\telse\t\t{\t\t\tpagediv.style.display = \"none\";\t\t\tpagetable.style.display = \"none\";\t\t}\t}\telse\t{\t\tpagediv.style.display = \"inline-block\";\t\tpagetable.style.display = \"\";\t\tvar rec = records.split('|');\t\tfirstItemtest-grid-id = parseInt(rec[2]) * -1;\t\tlastItemtest-grid-id = rec[1];\t\tif(rec[0] == \"0\" || fItemHidetest-grid-id == firstItemtest-grid-id)\t\t{\t\t\tprev.style.background = \"#EFEFEF\";\t\t\tfItemHidetest-grid-id = firstItemtest-grid-id;\t\t}\t\telse\t\t{\t\t\tprev.style.background = \"#DDDDDD\";\t\t}\t\tif(rec[3] == \"true\")\t\t\tnext.style.background = \"#DDDDDD\";\t\telse\t\t{\t\t\tprev.style.background = \"#EFEFEF\";\t\t\tlastItemtest-grid-id = 0;\t\t}\t\tif(rec[3] != \"true\" && rec[0] == \"0\")\t\t{\t\t\tpagediv.style.display = \"none\";\t\t\tpagetable.style.display = \"none\";\t\t}\t}};dhtmlXGridObject.prototype.registerLookuptest-grid-id=function(col,vals){    if(arrColumnLookupstest-grid-id == null)        arrColumnLookupstest-grid-id = new Array(mygridtest-grid-id.getColumnsNum());\t\t    arrColumnLookupstest-grid-id[col] = vals;};//======================Multi User=====================function changeUsertest-grid-id(chkVal){\tdocument.getElementById(\"_downlevelTextBox\").value = \"\";\tdocument.getElementById(\"_upLevelDiv\").innerHTML = \"\";\t\t\tif(document.getElementById(\"_upLevelDiv\").firstChild == null)\t{\t\tvar oTN=document.createTextNode(\"\");\t\tdocument.getElementById(\"_upLevelDiv\").appendChild(oTN);\t}\tdocument.getElementById(\"_upLevelDiv\").firstChild.nodeValue = \"\";\t//chkVal.options[chkVal.selectedIndex].value;}function eXcell_usereditorm(cell){                                    //excell name is defined here    if (cell){                                                     //default pattern, just copy it        this.cell = cell;        this.grid = this.cell.parentNode.grid;        if(!this.grid._grid_pe)        {\t\t\tvar z=document.getElementById(\"people\" + cell.parentNode.grid.entBox.id);\t\t\tz.onclick=function(e){ (e||event).cancelBubble=true; }\t\t\t\t\t\tif (_isIE) { \t\t\t\tz.style.position=\"absolute\"\t\t\t\tz.style.top=\"0px\"\t\t\t}\t\t\tdocument.body.insertBefore(z,document.body.firstChild);\t\t\t \t\t\tthis.grid._grid_pe = z;\t\t}    }    this.setValue=function(val){\t\tvar strVal = \"&nbsp;\";\t\tvar strVals = val.split('\\t')[0].split('\\n');\t\tfor(var i = 1;i<strVals.length;i=i+2)\t\t{\t\t\tstrVal += \"; \" + strVals[i];\t\t}\t\tif(strVal != \"&nbsp;\")\t\t\tstrVal = strVal.substring(7);\t\t\t        this.setCValue(strVal);                   this.cell._displayValue = strVal;        this.cell._users = val.split('\\t')[0];                                           this.cell._Allusers = val === undefined ? [] : val.split('\\t')[1];                                       }    this.getValue=function(){       return this.cell._users; // get value    }    this.edit=function(){    \t\tthis.val=this.getValue();    \t\tdocument.getElementById(\"_downlevelTextBox\").value = \"\";\t\tdocument.getElementById(\"_upLevelDiv\").innerHTML = \"\";\t\tcopyUplevelToHidden('');\t\tupdateControlValue('');\t\tvar arg=getUplevel('');\t\tvar ctx='';\t\tEntityEditorSetWaitCursor(ctx);\t\tWebForm_DoCallback('',arg,EntityEditorHandleCheckNameResult,ctx,EntityEditorHandleCheckNameError,true);\t\t        var pp = document.getElementById(\"divPetest-grid-id\");        var ppi = document.getElementById(\"peoplecheckimgtest-grid-id\");        pp.style.display = \"none\";        ppi.src = \"_layouts/images/TPMAX1.GIF\";                    \t\tvar strVal = \"\";\t\tvar strAllUserChecks = \"\";\t\tvar strVals = this.cell._users.split('\\n');\t\tvar strAllUsers = this.cell._Allusers === undefined ? [] : this.cell._Allusers.split('\\n');\t\tvar strUserNames = '\\t';\t\t\t\tfor(var i = 0;i<strVals.length;i=i+2)\t\t{\t\t\tstrUserNames += strVals[i].toLowerCase() + '\\t';\t\t\tstrVal += \"; \" + strVals[i];\t\t}\t\tif(strVal.length > 1)\t\t\tstrVal = strVal.substring(1);\t\t\t\t\tfor(var i = 0;i<strAllUsers.length;i++)\t\t{\t\t\tvar isChecked = \"\";\t\t\tvar userInfo = strAllUsers[i].split(';#');\t\t\t\t\t\tif(strUserNames.indexOf('\\t' + userInfo[0].toLowerCase() + '\\t') > -1)\t\t\t\tisChecked = \"checked\";\t\t\t\t\t\t\tstrAllUserChecks += \"<br><input type=\\\"checkbox\\\" name=\\\"chkUserstest-grid-id\\\" value=\\\"\" + userInfo[0] + \"\\\" \" + isChecked + \">\" + userInfo[1];\t\t}\t\tif(strAllUserChecks.length > 1)\t\t\tstrAllUserChecks = strAllUserChecks.substring(4);\t\t\t\t\tdocument.getElementById(\"peoplechecktest-grid-id\").innerHTML = strAllUserChecks;\t\t\tvar arPos = this.grid.getPosition(this.cell);\t\tif(arPos[0] + 200 > document.body.clientWidth)\t\t\tthis.grid._grid_pe.style.left=document.body.clientWidth - 210;\t\telse\t\t\tthis.grid._grid_pe.style.left=arPos[0];\t\t\t\tif((arPos[1] + 100) > (document.body.clientHeight + document.body.scrollTop))\t\t\tthis.grid._grid_pe.style.top=document.body.clientHeight + document.body.scrollTop - 105;\t\telse\t\t\tthis.grid._grid_pe.style.top=arPos[1];\t\tthis.grid._grid_pe.style.display=\"\";\t\tthis.grid._grid_pe.style.position = \"absolute\";\t\tthis.grid._grid_pe.style.zIndex  = 99;    }    this.detach=function(){\t\tthis.grid._grid_pe.style.display=\"none\";\t\t\t\tvar strUsers = \"\";\t\tvar divChecks = document.getElementById(\"peoplechecktest-grid-id\");\t\tvar divChildChecks = divChecks.firstChild;\t\twhile(divChildChecks != null)\t\t{\t\t\tif(divChildChecks.nodeName == \"INPUT\")\t\t\t{\t\t\t\tif(divChildChecks.checked)\t\t\t\t{\t\t\t\t\tstrUsers += '\\n' + divChildChecks.value;\t\t\t\t\tstrUsers += '\\n' + divChildChecks.nextSibling.nodeValue;\t\t\t\t}\t\t\t}\t\t\tdivChildChecks = divChildChecks.nextSibling;\t\t}\t\tfor(var i = 0;i<document.getElementById(\"_upLevelDiv\").childNodes.length;i=i+2)\t\t{\t\t\tif(document.getElementById(\"_upLevelDiv\").childNodes[i].firstChild != null)\t\t\t{\t\t\t\tstrUsers += '\\n' + document.getElementById(\"_upLevelDiv\").childNodes[i].title;\t\t\t\tstrUsers += '\\n' + document.getElementById(\"_upLevelDiv\").childNodes[i].firstChild.nextSibling.innerText;\t\t\t}\t\t}\t\tif(strUsers.length > 1)\t\t\tstrUsers = strUsers.substring(1);\t\t\t\tvar oldValue = this.getValue();\t\t\t\t\tif(this.cell._Allusers !== undefined)\t\t\tthis.setValue(strUsers + '\\t' + this.cell._Allusers);         return oldValue != this.getValue();    }}eXcell_usereditorm.prototype = new eXcell;//================================User Single=================function eXcell_usereditor(cell){                                    //excell name is defined here    if (cell){        this.cell = cell;        this.grid = this.cell.parentNode.grid;        if(!this.grid._grid_pes)        {\t\t\tvar z=document.getElementById(\"peoplesingle\" + cell.parentNode.grid.entBox.id);\t\t\tz.onclick=function(e){ (e||event).cancelBubble=true; }\t\t\t\t\t\tif (_isIE) { \t\t\t\tz.style.position=\"absolute\"\t\t\t\tz.style.top=\"0px\"\t\t\t}\t\t\tdocument.body.insertBefore(z,document.body.firstChild);\t\t\t \t\t\tthis.grid._grid_pes = z;\t\t}    }    this.setValue=function(val){\t\tvar strVal = \"&nbsp;\";\t\tvar strVals = val.split('\\t')[0].split('\\n');\t\t\t\tfor(var i = 1;i<strVals.length;i=i+2)\t\t{\t\t\tstrVal += \"; \" + strVals[i];\t\t}\t\tif(strVal != \"&nbsp;\")\t\t\tstrVal = strVal.substring(7);\t\t\t        this.setCValue(strVal);                   this.cell._displayValue = strVal;        this.cell._users = val.split('\\t')[0];                                           this.cell._Allusers = val === undefined ? [] : val.split('\\t')[1];                                       }    this.getValue=function(){\t\t       return this.cell._users; // get value    }    this.edit=function(){\t\tthis.val=this.getValue();        var pp = document.getElementById(\"divPestest-grid-id\");        var ppi = document.getElementById(\"peoplechecksingleimgtest-grid-id\");        pp.style.display = \"none\";        ppi.src = \"_layouts/images/TPMAX1.GIF\";\t\tvar strVal = \"\";\t\tvar strAllUserChecks = \"\";\t\tvar strVals = this.cell._users.split('\\n');\t\tvar strAllUsers = this.cell._Allusers === undefined ? [] : this.cell._Allusers.split('\\n');\t\tvar strUserNames = '\\t';\t\tfor(var i = 0;i<strVals.length;i=i+2)\t\t{\t\t\tstrUserNames += strVals[i].toLowerCase() + '\\t';\t\t\tstrVal += \"; \" + strVals[i];\t\t}\t\tif(strVal.length > 1)\t\t\tstrVal = strVal.substring(1);\t\tvar slct = document.getElementById(\"peoplecheckselecttest-grid-id\");\t\tslct.options.length=0;\t\tvar oSelected = -1;\t\tvar oCounter = 0;\t\tfor(var i = 0;i<strAllUsers.length;i++)\t\t{\t\t\tvar isChecked = false;\t\t\tvar userInfo = strAllUsers[i].split(';#');\t\t\t\t\t\tif(strUserNames.indexOf('\\t' + userInfo[0].toLowerCase() + '\\t') > -1)\t\t\t\toSelected = oCounter;\t\t\t\t\t\t\tvar elOptNew = document.createElement('option');            elOptNew.text = userInfo[1];            elOptNew.value = userInfo[0];            try            {                slct.add(elOptNew, null);            }            catch(ex)            {                slct.add(elOptNew);            }\t\t\t\t\t\t\t\t\t\t//slct.add(new Option(userInfo[1], userInfo[0], false, isChecked));\t\t\toCounter++;\t\t}\t\t\t\tslct.selectedIndex = oSelected;\t\t\t\tdocument.getElementById(\"_downlevelTextBox\").value = \"\";\t\tdocument.getElementById(\"_upLevelDiv\").innerHTML = \"\";\t\t/*\t\tif(document.getElementById(\"_upLevelDiv\").firstChild == null)\t\t{\t\t\tvar oTN=document.createTextNode(\"\");\t\t\tdocument.getElementById(\"_upLevelDiv\").appendChild(oTN);\t\t}\t\tdocument.getElementById(\"_upLevelDiv\").firstChild.nodeValue = strVal;\t\t*/\t\tcopyUplevelToHidden('');\t\tupdateControlValue('');\t\tvar arg=getUplevel('');\t\tvar ctx='';\t\t\t\tEntityEditorSetWaitCursor(ctx);\t\tWebForm_DoCallback('',arg,EntityEditorHandleCheckNameResult,ctx,EntityEditorHandleCheckNameError,true);\t\t\t\t\t\tvar arPos = this.grid.getPosition(this.cell);\t\tif(arPos[0] + 200 > document.body.clientWidth)\t\t\tthis.grid._grid_pes.style.left=document.body.clientWidth - 210;\t\telse\t\t\tthis.grid._grid_pes.style.left=arPos[0];\t\t\t\tif((arPos[1] + 100) > (document.body.clientHeight + document.body.scrollTop))\t\t\tthis.grid._grid_pes.style.top=document.body.clientHeight + document.body.scrollTop - 105;\t\telse\t\t\tthis.grid._grid_pes.style.top=arPos[1];\t\tthis.grid._grid_pes.style.display=\"\";\t\tthis.grid._grid_pes.style.position = \"absolute\";\t\tthis.grid._grid_pes.style.zIndex  = 99;    }    this.detach=function(){\t\tthis.grid._grid_pes.style.display=\"none\";\t\t\t\tvar strUsers = \"\";\t\tfor(var i = 0;i<document.getElementById(\"_upLevelDiv\").childNodes.length;i=i+2)\t\t{\t\t\tif(document.getElementById(\"_upLevelDiv\").childNodes[i].firstChild != null)\t\t\t{\t\t\t\tstrUsers += '\\n' + document.getElementById(\"_upLevelDiv\").childNodes[i].title;\t\t\t\tstrUsers += '\\n' + document.getElementById(\"_upLevelDiv\").childNodes[i].firstChild.nextSibling.innerText;\t\t\t}\t\t}\t\tif(strUsers == \"\")\t\t{\t\t\tvar chkVal = document.getElementById(\"peoplecheckselecttest-grid-id\");\t\t\tif(chkVal.selectedIndex > -1)\t\t\t{\t\t\t\tstrUsers += '\\n' + chkVal.options[chkVal.selectedIndex].value;\t\t\t\tstrUsers += '\\n' + chkVal.options[chkVal.selectedIndex].text;\t\t\t}\t\t}\t\t\t\tif(strUsers.length > 1)\t\t\tstrUsers = strUsers.substring(1);\t\t\t\tvar oldValue = this.getValue();\t\t\t\t\tif(this.cell._Allusers !== undefined)\t\t\tthis.setValue(strUsers + '\\t' + this.cell._Allusers);         return oldValue != this.getValue();    }}eXcell_usereditor.prototype = new eXcell;//=========================choice========================function eXcell_choice(cell){                                    //excell name is defined here    if (cell){\t\t\t\t\t\t\t\t\t\t\t\t\t//default pattern, just copy it        this.cell = cell;        this.grid = this.cell.parentNode.grid;    }    this.setValue=function(val){\t\tvar strVal = \"\";\t\tvar dispVal = \"&nbsp;\";\t\tif(val == \";#\")\t\t\tval = \"\";\t\t\t\t\tval = val.replace(/&amp;/g,\"&\");\t\t\t\tif(val.split('\\t')[0] != \"\")\t\t{\t\t\tstrVal = val.split('\\t')[0];\t\t\tdispVal = strVal.split(';#')[1].replace(/&/g,\"&amp;\");\t\t}        this.setCValue(dispVal);        this.cell._value = strVal;        if(val.split('\\t').length > 1)\t\t\tthis.cell._allvalues = val.split('\\t')[1];    }    this.getValue=function(){\t\treturn this.cell._value;    }    this.edit=function(){\t\tthis.val=this.getValue();\t\tvar arPos = this.grid.getPosition(this.cell) //,this.grid.objBox)\t\tvar allvals = this.cell._allvalues;\t\tthis.obj=document.createElement(\"TEXTAREA\");\t\tthis.obj.className=\"dhx_combo_edit\";\t\tthis.obj.style.height=(this.cell.offsetHeight-4)+\"px\";\t\tthis.obj.wrap=\"soft\";\t\tthis.obj.style.textAlign=this.cell.align;\t\tthis.obj.onclick=function(e){\t\t\t(e||event).cancelBubble=true\t\t}\t\tthis.obj.value=this.text\t\tthis.obj.onselectstart=function(e){\t\t\tif (!e)\t\t\t\te=event;\t\t\te.cancelBubble=true;\t\t\treturn true;\t\t};\t\tvar editor_obj = this;\t\tthis.obj.onkeyup=function(e){\t\t\tvar val = this.readonly ? String.fromCharCode((e||event).keyCode) : this.value;\t\t\tvar c = editor_obj.list.options;\t\t\tfor (var i = 0; i < c.length; i++)\t\t\t\tif (c[i].text.indexOf(val) == 0)\t\t\t\t\treturn c[i].selected=true;\t\t}\t\tthis.list=document.createElement(\"SELECT\");\t\tthis.list.className='dhx_combo_select';\t\tthis.list.style.width=this.cell.offsetWidth+\"px\";\t\tthis.list.style.left=arPos[0]+\"px\";                       //arPos[0]\t\tthis.list.style.top=arPos[1]+this.cell.offsetHeight+\"px\"; //arPos[1]+this.cell.offsetHeight;\t\tthis.list.onclick=function(e){\t\t\tvar ev = e||window.event;\t\t\tev.cancelBubble=true;\t\t\tvar cell = ev.target||ev.srcElement\t\t\t//tbl.editor_obj.val=cell.combo_val;\t\t\tif (cell.tagName == \"OPTION\")\t\t\t\tcell=cell.parentNode;\t\t\teditor_obj.setValue(cell.value + \";#\" + cell.text);\t\t\teditor_obj.editable=false;\t\t\teditor_obj.grid.editStop();\t\t}\t\tvar comboKeys = this.cell._allvalues.split('\\n');\t\tvar fl = false;\t\tvar selOptId = 0;\t\tfor (var i = 0; i < comboKeys.length; i++){\t\t\tvar val = comboKeys[i].split(';#');\t\t\t\t\t\tvar elOptNew = document.createElement('option');            elOptNew.text = val[1];            elOptNew.value = val[0];            \t\t\tthis.list.options[this.list.options.length]=elOptNew\t\t\tif (comboKeys[i] == this.val){\t\t\t\tselOptId=this.list.options.length-1;\t\t\t\tfl=true;\t\t\t}\t\t}\t\tif (fl == false){ //if no such value in combo list\t\t\t\t\t\tvar elOptNew = document.createElement('option');            elOptNew.text = this.text;            elOptNew.value = this.val;            \t\t\t//this.list.options[this.list.options.length]=new Option(this.text, this.val === null ? \"\" : this.val);\t\t\t//this.list.options[this.list.options.length]=elOptNew;\t\t\t//selOptId=this.list.options.length-1;\t\t}\t\tdocument.body.appendChild(this.list) //nb:this.grid.objBox.appendChild(this.listBox);\t\tthis.list.size=\"6\";\t\tthis.cstate=1;\t\tif (this.editable){\t\t\tthis.cell.innerHTML=\"\";\t\t}\t\telse {\t\t\tthis.obj.style.width=\"1px\";\t\t\tthis.obj.style.height=\"1px\";\t\t}\t\tthis.cell.appendChild(this.obj);\t\tthis.list.options[selOptId].selected=true;\t\t\t\t    }    this.detach=function(){\t\t\t\tif (this.val != this.getValue())\t\t{\t\t\tthis.cell.wasChanged=true;\t\t}\t\tvar curVal = this.getValue();\t\tvar newVal = this.list.options[this.list.selectedIndex].value + \";#\" + this.list.options[this.list.selectedIndex].text;\t\tif(newVal == \";#\")\t\t\tnewVal = \"\";\t\t\t\tthis.setValue(newVal);\t\t\t\t\t\t/*if (this.list.parentNode != null)\t\t{\t\t\t\tif (this.obj.value._dhx_trim() != this.text){\t\t\t\t\tif (this.list.selectedIndex&&this.list.options[this.list.selectedIndex].text == this.obj.value)\t\t\t\t\t\tthis.setValue(this.list.value + '\\t' + this.cell._allvalues)\t\t\t\t\telse\t\t\t\t\t\tthis.setValue(this.obj.value + '\\t' + this.cell._allvalues)\t\t\t\t} else {\t\t\t\t\tthis.setValue(this.val + '\\t' + this.cell._allvalues)\t\t\t\t}\t\t}*/\t\tif (this.list.parentNode)\t\t\tthis.list.parentNode.removeChild(this.list);\t\tif (this.obj.parentNode)\t\t\tthis.obj.parentNode.removeChild(this.obj);\t\treturn newVal != curVal;\t\t    }}eXcell_choice.prototype = new eXcell;//=========================multichoice========================function eXcell_mchoice(cell){                                    //excell name is defined here    if (cell){                                                     //default pattern, just copy it        this.cell = cell;        this.grid = this.cell.parentNode.grid;        if(!this.grid._grid_mc)        {\t\t\tvar z=document.getElementById(\"multichoice\" + cell.parentNode.grid.entBox.id);\t\t\tz.onclick=function(e){ (e||event).cancelBubble=true; }\t\t\t\t\t\tif (_isIE) { \t\t\t\tz.style.position=\"absolute\"\t\t\t\tz.style.top=\"0px\"\t\t\t}\t\t\tdocument.body.insertBefore(z,document.body.firstChild); \t\t\tthis.grid._grid_mc = z;\t\t}    }    this.setValue=function(val){\t\tvar strVal = \"\";\t\t\t\tif(val.split('\\t')[0] != \"\")\t\t{\t\t\tvar strVals = val.split('\\t')[0].split('\\n');\t\t\tfor(var i = 0;i<strVals.length;i++)\t\t\t{\t\t\t\tvar valInfo = strVals[i].split(';#');\t\t\t\tstrVal += \", \" + valInfo[1];\t\t\t}\t\t\tif(strVal != \"\")\t\t\t\tstrVal = strVal.substring(2);\t\t}\t\tif(strVal != \"\")\t\t\tthis.setCValue(strVal.replace(\"&\",\"&amp;\"));\t\telse\t\t\tthis.setCValue(\"&nbsp;\");\t\t        this.cell._displayValue = strVal;        this.cell._values = val.split('\\t')[0];        this.cell._allvalues = val.split('\\t')[1];    }    this.getValue=function(){\t\treturn this.cell._values;    }    this.edit=function(){\t\tthis.val=this.getValue();\t\tvar strAllValueChecks = \"\";\t\tvar strVals = this.cell._values.split('\\n');\t\tvar strAllValues = this.cell._allvalues.split('\\n');\t\tvar strValues = '\\t';\t\t\t\tfor(var i = 0;i<strVals.length;i++)\t\t{\t\t\tvar valInfo = strVals[i].split(';#');\t\t\t\t\tstrValues += valInfo[0].toLowerCase() + '\\t';\t\t}\t\tfor(var i = 0;i<strAllValues.length;i++)\t\t{\t\t\tvar isChecked = \"\";\t\t\tvar valInfo = strAllValues[i].split(';#');\t\t\t\t\t\tif(strValues.indexOf('\\t' + valInfo[0].toLowerCase() + '\\t') > -1)\t\t\t\tisChecked = \"checked\";\t\t\tstrAllValueChecks += \"<br><input type=\\\"checkbox\\\" name=\\\"chkValuestest-grid-id\\\" value=\\\"\" + valInfo[0] + \"\\\" \" + isChecked + \">\" + valInfo[1];\t\t}\t\tif(strAllValueChecks.length > 1)\t\t\tstrAllValueChecks = strAllValueChecks.substring(4);\t\t\t\t\tdocument.getElementById(\"multichoiceinnertest-grid-id\").innerHTML = strAllValueChecks;\t\tvar arPos = this.grid.getPosition(this.cell);\t\tif(arPos[0] + 200 > document.body.clientWidth)\t\t\tthis.grid._grid_mc.style.left=document.body.clientWidth - 210;\t\telse\t\t\tthis.grid._grid_mc.style.left=arPos[0];\t\t\t\tif((arPos[1] + 100) > (document.body.clientHeight + document.body.scrollTop))\t\t\tthis.grid._grid_mc.style.top=document.body.clientHeight + document.body.scrollTop - 105;\t\telse\t\t\tthis.grid._grid_mc.style.top=arPos[1];\t\tthis.grid._grid_mc.style.display=\"\";\t\tthis.grid._grid_mc.style.position = \"absolute\";\t\tthis.grid._grid_mc.style.zIndex  = 99;    }    this.detach=function(){\t\t\t\tthis.grid._grid_mc.style.display=\"none\";\t\t\t\tvar child = document.getElementById(\"multichoiceinnertest-grid-id\").firstChild;\t\tvar val1 = \"\";\t\twhile(child != null)\t\t{\t\t\tif(child.nodeName == \"INPUT\")\t\t\t{\t\t\t\tif(child.checked)\t\t\t\t{\t\t\t\t\tval1 += '\\n' + child.value + \";#\" + child.nextSibling.nodeValue;\t\t\t\t}\t\t\t}\t\t\tchild = child.nextSibling;\t\t}\t\tif(val1.length > 1)\t\t\tval1 = val1.substring(1);\t\t\t\t\t\t\tvar oldValue = this.getValue();\t\t\t\tthis.cell._values = val1;\t\t\t        this.setValue(val1 + '\\t' + this.cell._allvalues);         return oldValue != this.getValue();\t\t    }}eXcell_mchoice.prototype = new eXcell;//=========================Calendar===========================eXcell_dhxCalendarA.prototype.edit = function(){\t                    var top;                    var left;                                        var arPos = this.grid.getPosition(this.cell);\t\t\t\t\tif(arPos[0] + this.cell.offsetWidth + 180 > document.body.clientWidth)\t\t\t\t\t\tleft = arPos[0] - 185;\t\t\t\t\telse\t\t\t\t\t\tleft=arPos[0] + this.cell.offsetWidth;\t\t\t\t\t\t\t\t\t\tif((arPos[1] + 170) > (document.body.clientHeight + document.body.scrollTop))\t\t\t\t\t\ttop=document.body.clientHeight + document.body.scrollTop - 180;\t\t\t\t\telse\t\t\t\t\t\ttop=arPos[1];                                        this.grid._grid_calendarA.setPosition(top,left);                    \t                    this.grid._grid_calendarA.show();\t                    this.grid._grid_calendarA._last_operation_calendar=false;\t\t\t\t\t//var arPos = this.grid.getPosition(this.cell);                    //var pval=this._date2str2(this.cell.val||new Date());                    //window._grid_calendar.render(arPos[0],arPos[1]+this.cell.offsetHeight,this,pval);                    this.cell._cediton=true;                    this.val=this.cell.val;                    //this.val=this.getValue();                    this._val=this.cell.innerHTML;                   // alert(this.cell.val);\t\t\t\t   \tthis.grid._grid_calendarA.setDateFormat((this.grid._dtmask||\"%d/%m/%Y\"));                    this.grid._grid_calendarA.setDate(this.val);                    this.grid._grid_calendarA.draw();                    \t\t\t\t\tthis.cell.atag=((!this.grid.multiLine)&&(_isKHTML||_isMacOS||_isFF))?\"INPUT\":\"TEXTAREA\";\t\t\t\t\t\t\t\t\t\tthis.obj = document.createElement(this.cell.atag);\t\t\t\t\tthis.obj.style.height = (this.cell.offsetHeight-(_isIE?4:2))+\"px\";                    this.obj.className=\"dhx_combo_edit\";\t\t\t\t   \tthis.obj.wrap = \"soft\";\t\t\t\t\tthis.obj.style.textAlign = this.cell.align;\t\t\t\t\tthis.obj.onclick = function(e){(e||event).cancelBubble = true}\t\t\t\t\tthis.obj.onmousedown = function(e){(e||event).cancelBubble = true}\t\t\t\t\tthis.obj.value = this.getValue();\t\t\t\t\tthis.cell.innerHTML = \"\";\t\t\t\t\tthis.cell.appendChild(this.obj);\t\t\t\t  \tif (_isFF) {\t\t\t\t\t\tthis.obj.style.overflow=\"visible\";\t\t\t\t\t\tif ((this.grid.multiLine)&&(this.obj.offsetHeight>=18)&&(this.obj.offsetHeight<40)){\t\t\t\t\t\t\tthis.obj.style.height=\"36px\";\t\t\t\t\t\t\tthis.obj.style.overflow=\"scroll\";\t\t\t\t\t\t}\t\t\t\t\t}                    this.obj.onselectstart=function(e){  if (!e) e=event; e.cancelBubble=true; return true;  };\t\t\t\t\tthis.obj.focus()  \t\t\t\t\tthis.obj.focus()\t\t\t\t                    \t\t\t\t}//============================================================function getSingleItemtest-grid-id(siteid,webid,listid,itemid,rowid){\tvar val = SP.UI.Notify.addNotification(\"Updating Saved Row...\", false,  \"\", null);\tdhtmlxAjax.post(singleItemUrltest-grid-id, \"siteid=\" + siteid + \"&webid=\" + webid + \"&listid=\" + listid + \"&itemid=\" + itemid + \"&rowid=\" + rowid,getSingleItemResponsetest-grid-id);}function getSingleItemResponsetest-grid-id(loader){\tif(loader.xmlDoc.responseText!=null)\t{\t\tvar xmlDoc = loader.xmlDoc.responseXML;\t\tfor(var i = 0;i<xmlDoc.childNodes.length;i++)\t\t{\t\t\tvar rowXml = xmlDoc.childNodes[i];\t\t\tsetRowValuestest-grid-id(rowXml);\t\t}\t}\telse\t\talert(\"Response contains no XML\");}function setRowValuestest-grid-id(rowsXml){\tfor(var i = 0;i<rowsXml.childNodes.length;i++)\t{\t\tsetRowValuetest-grid-id(rowsXml.childNodes[i])\t}}function setRowValuetest-grid-id(rowXml){\tvar rowId = rowXml.getAttribute(\"id\")\t\tvar cellCounter = 0;\tfor(var i = 0;i<rowXml.childNodes.length;i++)\t{\t\tif(rowXml.childNodes[i].nodeName == \"userdata\")\t\t{\t\t\tif(rowXml.childNodes[i].firstChild != null)\t\t\t\tmygridtest-grid-id.setUserData(rowId,rowXml.childNodes[i].getAttribute(\"name\"),rowXml.childNodes[i].firstChild.nodeValue);\t\t}\t\telse if(rowXml.childNodes[i].nodeName == \"cell\")\t\t{\t\t\tif(!inEditModetest-grid-id)\t\t\t{\t\t\t\tif(mygridtest-grid-id.getColType(cellCounter) != \"tree\")\t\t\t\t\tmygridtest-grid-id.setCellExcellType(rowId, cellCounter, \"ro\");\t\t\t\t\t\t\t\t\tmygridtest-grid-id.lockRow(rowId, true);\t\t\t}\t\t\t\t\t\tvar cellval = \"\";\t\t\tvar celltype = \"\";\t\t\ttry\t\t\t{\t\t\t\tcelltype = rowXml.childNodes[i].getAttribute(\"type\");\t\t\t}catch(e){}\t\t\t\t\t\t\t\t\tif(rowXml.childNodes[i].childNodes.length > 0)\t\t\t{\t\t\t\tcellval = rowXml.childNodes[i].firstChild.nodeValue;\t\t\t}\t\t\t\t\t\tif(celltype == \"combo\")\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(rowXml.childNodes[i]);\t\t\t\telse\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(cellval);\t\t\t\tcellCounter++;\t\t}\t}\t}function saveGridtest-grid-id(){\tmygridtest-grid-id.editStop();    sm('dlgSavingtest-grid-id',200,100);    if(myDataProcessortest-grid-id.updatedRows.length > 0)    {        myDataProcessortest-grid-id.sendData();    }    else        hm('dlgSavingtest-grid-id');}function onButtonClicktest-grid-id(menuitemId,grid_Id,grid){    var rowIdFull = grid_Id.split(\"_\")[0];    var weburl = context_grid.getUserData(rowIdFull,\"SiteUrl\");    var listId = context_grid.getUserData(rowIdFull,\"listid\");    var editurl = context_grid.getUserData(rowIdFull,\"editurl\");    var viewurl = context_grid.getUserData(rowIdFull,\"viewurl\");    var itemId = context_grid.getUserData(rowIdFull,\"itemid\");    var webId = context_grid.getUserData(rowIdFull,\"webid\");    var siteid = context_grid.getUserData(rowIdFull,\"siteid\");    var rowId = rowIdFull.split('.')[1];        var popup = context_grid.getUserData(rowIdFull,\"popup\");    var w = pageWidth() - 200;\tvar h = pageHeight() - 100;             switch(menuitemId)    {\t\tcase \"createworkspace\":\t\t\turl = weburl + \"/_layouts/epmlive/requestworkspace.aspx?list=\" + listidtest-grid-id + \"&ID=\" + itemId;\t\t\tdocument.location.href=url;\t\t\t\t\t\tbreak;\t\tcase \"workspace\":\t\t\tif(viewurl == null)                url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=workspace&webid=\" + webId ;            else                url = weburl;                \t\t\tdocument.location.href=url;\t\t\tbreak;\t\t\t\tcase \"workplan\":\t\t\tif(viewurl == null)\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=workplan&webid=\" + webId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\telse\t\t\t\turl = weburl + \"/_layouts/epmlive/tasks.aspx?ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t\t\t\t\tdocument.location.href=url;\t\t\tbreak;\t\t\t\t\tcase \"agile\":\t\t\tif(viewurl == null)\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=agile&webid=\" + webId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\telse\t\t\t\turl = weburl + \"/_layouts/epmlive/agile/tasks.aspx?ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t\t\t\t\tdocument.location.href=url;\t\t\tbreak;\t\t\t\tcase \"projectpro\":\t\t\tif(viewurl == null)\t\t\t{\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=getproject&webid=\" + webId + \"&ID=\" + itemId + \"&listID=\" + listId + \"&Source=\" + document.location.href;;\t\t\t\tdocument.location.href=url;\t\t\t}\t\t\telse\t\t\t{\t\t\t\tjavascript:window.open(weburl + '/_layouts/epmlive/getproject.aspx?listID=' + listId + '&ID=' + itemId,'', config='height=100,width=200, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, directories=no, status=no');\t\t\t}\t\t\tbreak;\t\t        case \"edit\":            var url = \"\";            if(popup==\"yes\")            {\t\t\t\t\t\t\t\tvar url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=viewedit2&ListId=\" + listId + \"&ID=\" + itemId + \"&Mode=2&gridid=test-grid-id&siteid=\" + siteid + \"&webid=\" + webId + \"&rowid=\" + rowIdFull;\t\t\t\tsm('editItemtest-grid-id',w,h);\t\t\t\tdocument.getElementById(\"frmEditFrametest-grid-id\").src = url;            }            else            {\t\t\t\tif(editurl == null)\t\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=edit&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t\telse\t\t\t\t\turl = editurl + \"?ListId=\" + listId + \"&ID=\" + itemId + \"&Mode=2&Source=\" + document.location.href;\t\t\t\tdocument.location.href=url;            }            break;        case \"perms\":\t\t\tvar url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=perms&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t            //var url = weburl + \"/_layouts/User.aspx?obj={\" + listId + \"},\" + itemId + \",LISTITEM&List={\" + listId + \"}&Source=\" + document.location.href;            document.location.href=url;            break;        case \"view\":\t\t\tif(popup==\"yes\")            {\t\t\t\tvar url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=viewedit2&ListId=\" + listId + \"&ID=\" + itemId + \"&Mode=1&gridid=test-grid-id&siteid=\" + siteid + \"&webid=\" + webId + \"&rowid=\" + rowIdFull;\t\t\t\tsm('editItemtest-grid-id',w,h);\t\t\t\tdocument.getElementById(\"frmEditFrametest-grid-id\").src=url;            }            else            {\t\t\t\tvar url;\t\t\t\tif(viewurl == null)\t\t\t\t\turl = weburl + \"/_layouts/epmlive/gridaction.aspx?action=view&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;\t\t\t\telse\t\t\t\t\turl = viewurl + \"?ListId=\" + listId + \"&ID=\" + itemId + \"&Mode=1&Source=\" + document.location.href;\t\t\t\tdocument.location.href=url;            }            break;        case \"delete\":            if(confirm('Are you sure you want to send this item to the Recycle Bin?')){                var url;                if(viewurl == null)                {                    url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=delete&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&NextUsing=\" + document.location.href;                    document.location.href=url;                }                else                {                                            postDelete(weburl + '/_vti_bin/owssvr.dll?CS=65001&Cmd=Delete&List={' + listId + '}&ID=' + itemId + '&NextUsing=' + document.location.href);                                     }            };            break;        case \"alerts\":            var url;            if(viewurl == null)                url = weburl + \"/_layouts/epmlive/gridaction.aspx?action=alerts&webid=\" + webId+ \"&ListId=\" + listId + \"&ID=\" + itemId + \"&Source=\" + document.location.href;            else                url = weburl + \"/_layouts/SubNew.aspx?List={\" + listId + \"}&ID=\" + itemId + \"&Source=\" + document.location.href;                            document.location.href=url;            break;        case \"versions\":            var url = weburl + \"/_layouts/Versions.aspx?list={\" + listId + \"}&ID=\" + itemId + \"&Source=\" + document.location.href;            document.location.href=url;            break;        case \"approve\":            var url = weburl + \"/_layouts/approve.aspx?list={\" + listId + \"}&ID=\" + itemId + \"&Source=\" + document.location.href;            document.location.href=url;            break;        case \"workflows\":            var url = weburl + \"/_layouts/Workflow.aspx?list={\" + listId + \"}&ID=\" + itemId + \"&Source=\" + document.location.href;            document.location.href=url;            break;    };}function redoCss(rowindex){\tvar j = rowindex;\tfor (var i = rowindex; i < mygridtest-grid-id.rowsCol.length; i++){\t\t\tif (!mygridtest-grid-id.rowsCol[i])\t\t\t\tcontinue;\t\t\tif (mygridtest-grid-id.rowsCol[i].style.display != \"none\"){\t\t\t\tif (mygridtest-grid-id.rowsCol[i].className.indexOf(\"rowselected\") != -1){\t\t\t\t\tif (j%2 == 1)\t\t\t\t\t\tmygridtest-grid-id.rowsCol[i].className=mygridtest-grid-id._cssUnEven+\" rowselected \"+(mygridtest-grid-id.rowsCol[i]._css||\"\");\t\t\t\t\telse\t\t\t\t\t\tmygridtest-grid-id.rowsCol[i].className=mygridtest-grid-id._cssEven+\" rowselected \"+(mygridtest-grid-id.rowsCol[i]._css||\"\");\t\t\t\t} else {\t\t\t\t\tif (j%2 == 1)\t\t\t\t\t\tmygridtest-grid-id.rowsCol[i].className=mygridtest-grid-id._cssUnEven+(mygridtest-grid-id.rowsCol[i]._css||\"\");\t\t\t\t\telse\t\t\t\t\t\tmygridtest-grid-id.rowsCol[i].className=mygridtest-grid-id._cssEven+(mygridtest-grid-id.rowsCol[i]._css||\"\");\t\t\t\t}\t\t\t\tj++;\t\t\t}\t\t}}function leavePagetest-grid-id(e){\tvar hasupdates = false;\t\tfor(var i = 0;i < myDataProcessortest-grid-id.updatedRows.length;i++)\t{\t\tif(myDataProcessortest-grid-id.updatedRows[i] != null)\t\t{\t\t\thasupdates = true;\t\t}\t}    if(hasupdates )    {        if(!e) e = window.event;\t    //e.cancelBubble is supported by IE - this will kill the bubbling process.\t    //e.cancelBubble = true;\t    e.returnValue = 'You have unsaved changes.'; //This is displayed on the dialog\t    if (e.stopPropagation) {\t\t    e.stopPropagation();\t\t    e.preventDefault();\t    }    }}function URLEncode( plaintext ){\t// The Javascript escape and unescape functions do not correspond\t// with what browsers actually do...\tvar SAFECHARS = \"0123456789\" +\t\t\t\t\t// Numeric\t\t\t\t\t\"ABCDEFGHIJKLMNOPQRSTUVWXYZ\" +\t// Alphabetic\t\t\t\t\t\"abcdefghijklmnopqrstuvwxyz\" +\t\t\t\t\t\"-_.!~*'()\";\t\t\t\t\t// RFC2396 Mark characters\tvar HEX = \"0123456789ABCDEF\";\tvar encoded = \"\";\tfor (var i = 0; i < plaintext.length; i++ ) {\t\tvar ch = plaintext.charAt(i);\t    if (ch == \" \") {\t\t    encoded += \"+\";\t\t\t\t// x-www-urlencoded, rather than %20\t\t} else if (SAFECHARS.indexOf(ch) != -1) {\t\t    encoded += ch;\t\t} else {\t\t    var charCode = ch.charCodeAt(0);\t\t\tif (charCode > 255) {\t\t\t    alert( \"Unicode Character '\"                         + ch                         + \"' cannot be encoded using standard URL encoding.\\n\" +\t\t\t\t          \"(URL encoding only supports 8-bit characters.)\\n\" +\t\t\t\t\t\t  \"A space (+) will be substituted.\" );\t\t\t\tencoded += \"+\";\t\t\t} else {\t\t\t\tencoded += \"%\";\t\t\t\tencoded += HEX.charAt((charCode >> 4) & 0xF);\t\t\t\tencoded += HEX.charAt(charCode & 0xF);\t\t\t}\t\t}\t}\treturn encoded;};function checkMintest-grid-id(rowId,cellIndex,value){    if(minValuestest-grid-id[cellIndex] != \"\")    {        var val = parseFloat(value);        var min = parseFloat(minValuestest-grid-id[cellIndex]);        if(val < min)        {            alert('You must enter a value greater than ' + min);            return false;        }    }    return true;}function checkMaxtest-grid-id(rowId,cellIndex,value){    if(maxValuestest-grid-id[cellIndex] != \"\")    {        var val = parseFloat(value);        var max = parseFloat(maxValuestest-grid-id[cellIndex]);        if(val > max)        {            alert('You must enter a value less than ' + max);                        return false;        }    }    return true;}dhtmlXGridObject.prototype._in_header_master_checkbox2 = function (t, i, c) { \tt.innerHTML = c[0] + \"<input type='checkbox' />\" + c[1]; \tvar self = this; \tt.firstChild.onclick = function (e) \t{ \t\tself._build_m_order(); \t\tvar j = self._m_order ? self._m_order[i] : i;\t\tvar val = this.checked;// ? true : false;\t\tself.forEachRow(function (id) {\t\t\tvar c = this.cells(id, j);\t\t\tif (c.isCheckbox() && !c.cell.firstChild.disabled)\t\t\t{\t\t\t\tc.cell.firstChild.checked = val;\t\t\t\tif(val)\t\t\t\t\tc.cell.firstChild.style.display = \"\";\t\t\t\telse\t\t\t\t\tc.cell.firstChild.style.display = \"none\";\t\t\t}\t\t});\t\t(e || event).cancelBubble = true;\t} };dhtmlXGridObject.prototype.checksubs = function(row){\tvar rowid = row.parentNode.parentNode.idd;\tif(this.hasChildren(rowid) > 0)\t{\t\tvar rowids = this.getAllSubItems(rowid).split(',');\t\tfor(var i = 0;i<rowids.length;i++)\t\t{\t\t\tvar curRow = rowids[i];\t\t\tthis.cells(curRow, 0).cell.firstChild.checked = row.checked;\t\t\tif(row.checked)\t\t\t\tthis.cells(curRow, 0).cell.firstChild.style.display = \"\";\t\t\telse\t\t\t\tthis.cells(curRow, 0).cell.firstChild.style.display = \"none\";\t\t}\t\t\t}};window.onbeforeunload=leavePagetest-grid-id;minValuestest-grid-id = [\"\",\"1\"];maxValuestest-grid-id = [\"\",\"1\"];var singleEditItemUrltest-grid-id;var inEditModetest-grid-id;function fireEvent(element,event){    if (document.createEventObject){        // dispatch for IE        var evt = document.createEventObject();        return element.fireEvent('on'+event,evt)    }    else{        // dispatch for firefox + others        var evt = document.createEvent(\"HTMLEvents\");        evt.initEvent(event, true, true ); // event type,bubbling,cancelable        return !element.dispatchEvent(evt);    }}function editRowtest-grid-id(rowid){\tvar EditCol = getEditColtest-grid-id();        if(EditCol != null)    {    \t\tvar listId = mygridtest-grid-id.getUserData(rowid,\"listid\");\t\tvar itemId = mygridtest-grid-id.getUserData(rowid,\"itemid\");\t\tvar webId = mygridtest-grid-id.getUserData(rowid,\"webid\");\t\tvar siteId = mygridtest-grid-id.getUserData(rowid,\"siteid\");    \t\tmygridtest-grid-id.cells(rowid, EditCol).setValue(\"<img src='/_layouts/epmlive/images/loader1.gif'>\");\t\tdhtmlxAjax.post(singleEditItemUrltest-grid-id, \"siteid=\" + siteId + \"&webid=\" + webId + \"&listid=\" + listId + \"&itemid=\" + itemId + \"&rowid=\" + rowid,editRowResponsetest-grid-id);    }}function getEditColtest-grid-id(){\tvar EditCol;\tfor(var i = 0;i<mygridtest-grid-id.getColumnsNum();i++)    {        if(mygridtest-grid-id.getColumnId(i) == \"<![CDATA[Edit]]>\")        {            EditCol = i;\t\t\tbreak;        }    }    return EditCol;}function editRowResponsetest-grid-id(loader){\tif(loader.xmlDoc.responseText!=null)\t{\t\t\tvar xmlDoc = loader.xmlDoc.responseXML;\t\tfor(var i = 0;i<xmlDoc.childNodes.length;i++)\t\t{\t\t\tvar rowXml = xmlDoc.childNodes[i];\t\t\tsetEditRowstest-grid-id(rowXml);\t\t\t}\t}\telse\t\talert(\"Response contains no XML\");}function setEditRowstest-grid-id(rowsXml){\tfor(var i = 0;i<rowsXml.childNodes.length;i++)\t{\t\tsetEditRowtest-grid-id(rowsXml.childNodes[i])\t}}function setEditRowtest-grid-id(rowXml){\tvar rowId = rowXml.getAttribute(\"id\")\t\tvar cellCounter = 0;\tmygridtest-grid-id.lockRow(rowId, false);\tfor(var i = 0;i<rowXml.childNodes.length;i++)\t{\t\tif(rowXml.childNodes[i].nodeName == \"userdata\")\t\t{\t\t\t//mygridtest-grid-id.setUserData(rowId,rowXml.childNodes[i].getAttribute(\"name\"),rowXml.childNodes[i].firstChild.nodeValue);\t\t}\t\telse if(rowXml.childNodes[i].nodeName == \"cell\")\t\t{\t\t\tvar cellval = \"\";\t\t\tvar celltype = \"\";\t\t\ttry\t\t\t{\t\t\t\tcelltype = rowXml.childNodes[i].getAttribute(\"type\");\t\t\t}catch(e){}\t\t\tif(rowXml.childNodes[i].childNodes.length > 0)\t\t\t{\t\t\t\tcellval = rowXml.childNodes[i].firstChild.nodeValue;\t\t\t}\t\t\tif(celltype == \"combo\")\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(rowXml.childNodes[i]);\t\t\t\telse\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(cellval);\t\t\t\t\t\t\tif(celltype != null)\t\t\t{\t\t\t\tmygridtest-grid-id.setCellExcellType(rowId, i, celltype);\t\t\t}\t\t\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(cellval);\t\t\t\tcellCounter++;\t\t}\t}\tvar EditCol = getEditColtest-grid-id();    \tif(EditCol != null)\t{\t\tmygridtest-grid-id.cells(rowId, EditCol).setValue(\"<a onclick=\\\"javascript:saveEdittest-grid-id('\" + rowId + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/saveitem.gif\\\" border=\\\"0\\\" alt=\\\"Save\\\"></a> <a onclick=\\\"javascript:cancelEditRowtest-grid-id('\" + rowId + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/close.gif\\\" border=\\\"0\\\" alt=\\\"Cancel\\\"></a>\");\t}}function saveEdit2test-grid-id(rowid){\tmygridtest-grid-id.editStop();\t\trow = mygridtest-grid-id.getRowById(rowid);\t\tvar cols = row.childNodes.length;\tvar changed = false;\tfor (var j = 0; j < cols; j++)\t\tif (row.childNodes[j].wasChanged){\t\t\tchanged = true;\t\t\tbreak;\t\t}\t\tvar EditCol = getEditColtest-grid-id();\t    if(EditCol != null)\t\tmygridtest-grid-id.cells(rowid, EditCol).setValue(\"<img src='/_layouts/epmlive/images/loader1.gif'>\");\t\t\t\tif(changed)\t\tmyDataProcessortest-grid-id.sendData(rowid);\telse\t\tcancelEditRowtest-grid-id(rowid);}function saveEdittest-grid-id(rowid){\tsetTimeout(\"saveEdit2test-grid-id('\" + rowid + \"')\", 100);}function cancelEditRowtest-grid-id(rowid){\tvar EditCol = getEditColtest-grid-id();\t    mygridtest-grid-id.lockRow(rowid, true);    myDataProcessortest-grid-id.setUpdated(rowid, false, null);        if(EditCol != null)    {\t\tvar listid = mygridtest-grid-id.getUserData(rowid,\"listid\");\t\tvar itemid = mygridtest-grid-id.getUserData(rowid,\"itemid\");\t\tvar webid = mygridtest-grid-id.getUserData(rowid,\"webid\");\t\tvar siteid = mygridtest-grid-id.getUserData(rowid,\"siteid\");\t\tmygridtest-grid-id.cells(rowid, EditCol).setValue(\"<img src='/_layouts/epmlive/images/loader1.gif'>\");\t\tdhtmlxAjax.post(singleItemUrltest-grid-id, \"edit=false&siteid=\" + siteid + \"&webid=\" + webid + \"&listid=\" + listid + \"&itemid=\" + itemid + \"&rowid=\" + rowid,cancelEditRowResponsetest-grid-id);\t}\t}function cancelEditRowResponsetest-grid-id(loader){\tif(loader.xmlDoc.responseText!=null)\t{\t\tvar xmlDoc = loader.xmlDoc.responseXML;\t\t\t\tfor(var i = 0;i<xmlDoc.childNodes.length;i++)\t\t{\t\t\tvar rowXml = xmlDoc.childNodes[i];\t\t\tsetCRowValuestest-grid-id(rowXml);\t\t}\t}\telse\t\talert(\"Response contains no XML\");}function setCRowValuestest-grid-id(rowsXml){\tfor(var i = 0;i<rowsXml.childNodes.length;i++)\t{\t\tsetCRowValuetest-grid-id(rowsXml.childNodes[i])\t}}function setCRowValuetest-grid-id(rowXml){\tvar rowId = rowXml.getAttribute(\"id\");\tvar cellCounter = 0;\t\tfor(var i = 0;i<rowXml.childNodes.length;i++)\t{\t\tif(rowXml.childNodes[i].nodeName == \"userdata\")\t\t{\t\t\t//mygridtest-grid-id.setUserData(rowId,rowXml.childNodes[i].getAttribute(\"name\"),rowXml.childNodes[i].text);\t\t}\t\telse if(rowXml.childNodes[i].nodeName == \"cell\")\t\t{\t\t\tvar cellval = \"\";\t\t\t\t\t\tif(rowXml.childNodes[i].childNodes.length > 0)\t\t\t{\t\t\t\tcellval = rowXml.childNodes[i].firstChild.nodeValue;\t\t\t}\t\t\tif(mygridtest-grid-id.getColType(cellCounter) != \"tree\")\t\t\t\tmygridtest-grid-id.setCellExcellType(rowId, cellCounter, \"ro\");\t\t\t\t\t\tmygridtest-grid-id.cells(rowId,cellCounter).setValue(cellval);\t\t\t\t\t\t\tcellCounter++;\t\t}\t}\t\tvar EditCol;\tfor(var i = 0;i<mygridtest-grid-id.getColumnsNum();i++)\t{\t\tif(mygridtest-grid-id.getColumnId(i) == \"<![CDATA[Edit]]>\")\t\t{\t\t\tEditCol = i;\t\t\tbreak;\t\t}\t}    \tif(EditCol != null)\t{\t\tmygridtest-grid-id.cells(rowId, i).setValue(\"<a onclick=\\\"javascript:editRowtest-grid-id('\" + rowId + \"');\\\" style=\\\"cursor:hand\\\"><img src=\\\"/_layouts/images/edit.gif\\\" border=\\\"0\\\"></a>\");\t}}function ChangePagetest-grid-id(pg){curPagetest-grid-id = pg;loadXtest-grid-id(sftest-grid-id, svtest-grid-id, sttest-grid-id);}function NextPagetest-grid-id(){if(lastItemtest-grid-id != 0){curPagetest-grid-id = lastItemtest-grid-id;loadXtest-grid-id(sftest-grid-id, svtest-grid-id, sttest-grid-id);}}function PreviousPagetest-grid-id(){if(fItemHidetest-grid-id != firstItemtest-grid-id){curPagetest-grid-id = firstItemtest-grid-id;loadXtest-grid-id(sftest-grid-id, svtest-grid-id, sttest-grid-id);}}function loadXtest-grid-id(searchfield, searchvalue, searchtype){var ribbontestintervall = null; mygridwidthtest-grid-id = document.getElementById('WebPartdummy').offsetWidth - 25;if(searchfield){searchvalue = escape(searchvalue);mygridtest-grid-id.post(\"http://fake.url/_layouts/epmlive/getgriditems.aspx\",\"data=&edit=false&insertrow=False&width=\" + mygridwidthtest-grid-id + \"&searchfield=\" + searchfield + \"&searchvalue=\" + searchvalue + \"&searchtype=\" + searchtype + \"&page=\" + curPagetest-grid-id + \"&source=http%3a%2f%2ffake.url%2f\");}else{mygridtest-grid-id.post(\"http://fake.url/_layouts/epmlive/getgriditems.aspx\",\"data=&edit=false&insertrow=False&width=\" + mygridwidthtest-grid-id + \"&page=\" + curPagetest-grid-id + \"&source=http%3a%2f%2ffake.url%2f\");}}function showrib(){setTimeout(\"clickTab()\", 1);}function clickTab(){try{var wp = document.getElementById('MSOZoneCell_WebPartdummy');WpClick({target: wp});}catch(e){}}function clickbrowse(){try{var wp2 = document.getElementById('Ribbon.Read-title').firstChild;fireEvent(wp2, 'click');}catch(e){}}setTimeout(\"clickTab()\", 1000);_spBodyOnLoadFunctionNames.push(\"loadXtest-grid-id('test-search-field','test-search-string','1')\");</script><div id=\"dlgSavingtest-grid-id\" class=\"dialog\">    <table width=\"100%\">        <tr>            <td align=\"center\" class=\"ms-sectionheader\">                <img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/><br />                <H3 class=\"ms-standardheader\">Saving Items...</h3>            </td>        </tr>    </table></div> <div id=\"dlgRefreshtest-grid-id\" class=\"dialog\">    <table width=\"100%\">        <tr>            <td align=\"center\" class=\"ms-sectionheader\">                <img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/><br />                <H3 class=\"ms-standardheader\">Refreshing Data...</h3>            </td>        </tr>    </table></div> <div id=\"dlgErrortest-grid-id\" class=\"dialog\">    <table width=\"100%\" height=\"100%\" cellpadding=\"0\" cellspacing=\"3\">\t\t<tr>\t\t\t<td class=\"ms-sectionheader\"><H3 class=\"ms-standardheader\">Error: </h3></td>\t\t</tr>        <tr height=\"100%\">            <td align=\"left\"valign=\"top\">                <div id=\"dlgErrorTexttest-grid-id\" style=\"overflow: auto;height=90%;width=100%\" class=\"ms-descriptiontext\"></div><br>            </td>        </tr>        <tr>\t\t\t<td align=\"right\">\t\t\t\t<input type=\"button\" class=\"ms-input\" value=\"Close\" onClick=\"hm('dlgErrortest-grid-id');\">\t\t\t</td>\t\t</tr>    </table></div><div id=\"editItemtest-grid-id\" class=\"dialog\">    <table width=\"100%\" height=\"100%\" id=\"tblEditItem\" cellpadding=\"0\" cellspacing=\"0\">        <tr height=\"100%\">            <td align=\"center\" bgcolor=\"FFFFFF\">                <div id=\"editItemLoadtest-grid-id\">                    <img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/>                </div>                <iframe id=\"frmEditFrametest-grid-id\" width=\"100%\" height=\"100%\" frameborder=\"0\" src=\"http://fake.url/_layouts/epmlive/blank.gif\">                                    </iframe>            </td>        </tr>    </table></div><div id=\"dlgPosting\" class=\"dialog\">    <table width=\"100%\">        <tr>            <td align=\"center\" class=\"ms-sectionheader\">                <img src=\"_layouts/images/gears_anv4.gif\" style=\"vertical-align: middle;\"/><br />                <H3 class=\"ms-standardheader\">Posting Data...</h3>            </td>        </tr>    </table></div> <script>var bPageSetuptest-grid-id;var firstItemtest-grid-id;var lastItemtest-grid-id;var fItemHidetest-grid-id;function setupPagetest-grid-id(records, UseReporting, PageSize){\tvar pages = Math.ceil(records / PageSize);\tvar prev = document.getElementById(\"PagePrevioustest-grid-id\");\tvar next = document.getElementById(\"PageNexttest-grid-id\");\tvar pagediv = document.getElementById(\"pagedivtest-grid-id\");\tif(UseReporting)\t{\t\tif(pages > 1)\t\t{\t\t\tif(!bPageSetuptest-grid-id)\t\t\t{\t\t\t\tbPageSetuptest-grid-id = true;\t\t\t\t$(\"#pagedivtest-grid-id\").paginate({\t\t\t\t\tcount \t\t: pages,\t\t\t\t\tstart \t\t: 1,\t\t\t\t\tdisplay     : 12,\t\t\t\t\tborder\t\t\t\t\t: true,\t\t\t\t\tborder_color\t\t\t: '#CCCCCC',\t\t\t\t\ttext_color  \t\t\t: '#666666',\t\t\t\t\tbackground_color    \t: '#DDDDDD',\t\t\t\t\t\tborder_hover_color\t\t: '#878787',\t\t\t\t\ttext_hover_color  \t\t: '#ffffff',\t\t\t\t\tbackground_hover_color\t: '#9B9B9B', \t\t\t\t\trotate      : false,\t\t\t\t\timages\t\t: false,\t\t\t\t\tmouse\t\t: 'press',\t\t\t\t\tonChange\t: ChangePagetest-grid-id\t\t\t\t});\t\t\t}\t\t}\t\telse\t\t{\t\t\tpagediv.style.display = \"none\";\t\t}\t}\telse\t{\t\tpagediv.style.display = \"inline-block\";\t\tvar rec = records.split('|');\t\tfirstItemtest-grid-id = parseInt(rec[2]) * -1;\t\tlastItemtest-grid-id = rec[1];\t\tif(rec[0] == \"0\" || fItemHidetest-grid-id == firstItemtest-grid-id)\t\t{\t\t\tprev.style.background = \"#EFEFEF\";\t\t\tfItemHidetest-grid-id = firstItemtest-grid-id;\t\t}\t\telse\t\t{\t\t\tprev.style.background = \"#DDDDDD\";\t\t}\t\tif(rec[3] == \"true\")\t\t\tnext.style.background = \"#DDDDDD\";\t\telse\t\t{\t\t\tprev.style.background = \"#EFEFEF\";\t\t\tlastItemtest-grid-id = 0;\t\t}\t\tif(rec[3] != \"true\" && rec[0] == \"0\")\t\t{\t\t\tpagediv.style.display = \"none\";\t\t}\t}}</script><script>initmb();</script>"));
        }

        [TestMethod]
        public void GridListView_BuildParams_ConfirmSFullParamList()
        {
            // Arrange
            SetupShims();
            _testablePrivate.SetFieldOrProperty("tb", new TimeDebug(DummyString, DummyString));
            ShimSPContext.AllInstances.ListGet = (_) => _sharepointShims.ListShim.Instance;
            ShimSPList.AllInstances.FormsGet = (_) => _sharepointShims.FormsShim.Instance;
            ShimSPFormCollection.AllInstances.ItemGetInt32 = (_, __) => _sharepointShims.FormShim.Instance;
            ShimSPWeb.AllInstances.GetListString = (_, __) => _sharepointShims.ListShim.Instance;
            ((GridGanttSettings)_testablePrivate.GetField("gSettings")).RollupSites = "";
            ShimSPViewCollection.AllInstances.ItemGetString = (_,__) => _sharepointShims.ViewShim.Instance;
            ShimHttpRequest.AllInstances.ItemGetString = (_, __) => DummyString;

            // Act
            _testablePrivate.Invoke("buildParams",
                new object[] { });

            // Assert
            var sFullParamList = _testablePrivate.GetFieldOrProperty("sFullParamList") as String;
            _testablePrivate.ShouldSatisfyAllConditions(
                () => sFullParamList.ShouldBe("TGlzdAkKVmlldwlkdW1teQpGaWx0ZXJGaWVsZAlkdW1teQpGaWx0ZXJWYWx1ZQlkdW1teQpMb29rdXBGaWVsZAlkdW1teQpMb29rdXBGaWVsZExpc3QJZHVtbXkKR3JpZE5hbWUJdGVzdC1ncmlkLWlkCkFHcm91cHMJfApFeHBhbmQJMTAKU3RhcnQJCkZpbmlzaAkKUGVyY2VudAkKV0JTCQpNaWxlc3RvbmUJCkV4ZWN1dGl2ZQkKSW5mbwkKTFR5cGUJClJMaXN0cwkKUlNpdGVzCQpIaWRlTmV3CUZhbHNlClVzZVBlcmYJRmFsc2UKQWxsb3dFZGl0CUZhbHNlCkVkaXREZWZhdWx0CUZhbHNlClNob3dJbnNlcnQJRmFsc2UKRGlzYWJsZU5ldwlGYWxzZQpVc2VOZXcJRmFsc2UKTmV3TmFtZQkKVXNlUG9wdXAJRmFsc2UKUmVxdWVzdHMJRmFsc2UKVXNlUmVwb3J0aW5nCUZhbHNlClVzZVBhcmVudAlmYWxzZQpTaG93Q2hlY2tib3hlcwlGYWxzZQpXUElECQ=="));
        }

        [TestMethod]
        public void GridListView_BuildParams_SPContextCurrentListItem_NotNull_ConfirmSFullParamList()
        {
            // Arrange
            SetupShims();
            _testablePrivate.SetFieldOrProperty("tb", new TimeDebug(DummyString, DummyString));
            ShimSPContext.AllInstances.ListGet = (_) => _sharepointShims.ListShim.Instance;
            ShimSPList.AllInstances.FormsGet = (_) => _sharepointShims.FormsShim.Instance;
            ShimSPFormCollection.AllInstances.ItemGetInt32 = (_, __) => _sharepointShims.FormShim.Instance;
            ShimSPWeb.AllInstances.GetListString = (_, __) => _sharepointShims.ListShim.Instance;
            ((GridGanttSettings)_testablePrivate.GetField("gSettings")).RollupSites = "";
            ShimSPViewCollection.AllInstances.ItemGetString = (_, __) => _sharepointShims.ViewShim.Instance;
            ShimHttpRequest.AllInstances.ItemGetString = (_, __) => DummyString;
            _testablePrivate.SetFieldOrProperty("_myProvider", new ShimReportingFilter()
            {
                ReportIDGet = () => DummyString,
            }.Instance);
            _testablePrivate.SetFieldOrProperty("bIsFormWebpart", true);
            ShimGridListView.AllInstances.GetLinkedItemInfoSPWeb = (_, __) => 1;

            // Act
            _testablePrivate.Invoke("buildParams",
                new object[] { });

            // Assert
            var sFullParamList = _testablePrivate.GetFieldOrProperty("sFullParamList") as String;
            _testablePrivate.ShouldSatisfyAllConditions(
                () => sFullParamList.ShouldBe("TGlzdAkKVmlldwlkdW1teQpGaWx0ZXJGaWVsZAlkdW1teQpGaWx0ZXJWYWx1ZQlkdW1teQpMb29rdXBGaWVsZAlkdW1teQpMb29rdXBGaWVsZExpc3QJZHVtbXkKR3JpZE5hbWUJdGVzdC1ncmlkLWlkCkFHcm91cHMJfApFeHBhbmQJMTAKUmVwb3J0SUQJbW15ClN0YXJ0CQpGaW5pc2gJClBlcmNlbnQJCldCUwkKTWlsZXN0b25lCQpFeGVjdXRpdmUJCkluZm8JCkxUeXBlCQpSTGlzdHMJClJTaXRlcwkKSGlkZU5ldwlGYWxzZQpVc2VQZXJmCUZhbHNlCkFsbG93RWRpdAlGYWxzZQpFZGl0RGVmYXVsdAlGYWxzZQpTaG93SW5zZXJ0CUZhbHNlCkRpc2FibGVOZXcJRmFsc2UKVXNlTmV3CUZhbHNlCk5ld05hbWUJClVzZVBvcHVwCUZhbHNlClJlcXVlc3RzCUZhbHNlClVzZVJlcG9ydGluZwlGYWxzZQpVc2VQYXJlbnQJZmFsc2UKU2hvd0NoZWNrYm94ZXMJRmFsc2UKV1BJRAk="));
        }

        [TestMethod]
        public void GridListView_BuildParams_PropUseDefaultsValue_FALSE_ConfirmSFullParamList()
        {
            // Arrange
            SetupShims();
            _testablePrivate.SetFieldOrProperty("tb", new TimeDebug(DummyString, DummyString));
            ShimSPContext.AllInstances.ListGet = (_) => _sharepointShims.ListShim.Instance;
            ShimSPList.AllInstances.FormsGet = (_) => _sharepointShims.FormsShim.Instance;
            ShimSPFormCollection.AllInstances.ItemGetInt32 = (_, __) => _sharepointShims.FormShim.Instance;
            ShimSPWeb.AllInstances.GetListString = (_, __) => _sharepointShims.ListShim.Instance;
            ((GridGanttSettings)_testablePrivate.GetField("gSettings")).RollupSites = "";
            ShimSPViewCollection.AllInstances.ItemGetString = (_, __) => _sharepointShims.ViewShim.Instance;
            ShimHttpRequest.AllInstances.ItemGetString = (_, __) => DummyString;
            _testablePrivate.SetFieldOrProperty("PropUseDefaults", false);

            // Act
            _testablePrivate.Invoke("buildParams",
                new object[] { });

            // Assert
            var sFullParamList = _testablePrivate.GetFieldOrProperty("sFullParamList") as String;
            _testablePrivate.ShouldSatisfyAllConditions(
                () => sFullParamList.ShouldBe("TGlzdAkKVmlldwlkdW1teQpGaWx0ZXJGaWVsZAlkdW1teQpGaWx0ZXJWYWx1ZQlkdW1teQpMb29rdXBGaWVsZAlkdW1teQpMb29rdXBGaWVsZExpc3QJZHVtbXkKR3JpZE5hbWUJdGVzdC1ncmlkLWlkCkFHcm91cHMJfApFeHBhbmQJMTAKU3RhcnQJU3RhcnREYXRlCkZpbmlzaAlEdWVEYXRlClBlcmNlbnQJUGVyY2VudENvbXBsZXRlCldCUwlPdXRsaW5lTnVtYmVyCk1pbGVzdG9uZQlNaWxlc3RvbmUKRXhlY3V0aXZlCQpJbmZvCQpMVHlwZQkKUkxpc3RzCQpSU2l0ZXMJCkhpZGVOZXcJRmFsc2UKVXNlUGVyZglGYWxzZQpBbGxvd0VkaXQJRmFsc2UKRWRpdERlZmF1bHQJRmFsc2UKU2hvd0luc2VydAlGYWxzZQpVc2VQb3B1cAlGYWxzZQpVc2VOZXcJRmFsc2UKTmV3TmFtZQkKUmVxdWVzdHMJRmFsc2UKVXNlUGFyZW50CWZhbHNlClNob3dDaGVja2JveGVzCUZhbHNlCldQSUQJ"));
        }
    }
}
